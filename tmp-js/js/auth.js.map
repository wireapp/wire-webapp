{"version":3,"file":"min/auth.js","mappings":"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MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,QAAS,CACL,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KACA,MAEJ,GAAM,CACF,IACA,IACA,KAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,MAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,SAAU,CACN,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,IACA,MAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,SAAU,CACN,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,KACA,KACA,KAEJ,GAAM,CACF,IACA,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ASnkC,KAAKmkC,SACd0H,EAAW7rC,KAAKiD,QAAQ0gC,WAAWQ,GAAU1d,GAAQ,MAAU,EAAI,IACvE,OAAOolB,QAA2CA,EAAW,IACjE,EACO3H,CACX,CA/yB2B,GAszB3B,SAASkB,GAASqB,GACd,OAASA,GAAa,IAAMA,GAAa,KACpCA,GAAa,IAAMA,GAAa,EACzC,CA8BA,SAASzC,GAAcD,GACnB,OAASA,GAAK,GAAUA,GAAK,IACnB,KAANA,GACM,MAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,CACR,CAKA,SAASE,GAAiBF,GACtB,OAASA,GAAK,IAAUA,GAAK,IACnB,KAANA,GACCA,GAAK,IAAUA,GAAK,IACf,KAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,GACCA,GAAK,IAAUA,GAAK,IACpBA,GAAK,IAAUA,GAAK,IACpBA,GAAK,IAAUA,GAAK,IACpBA,GAAK,IAAUA,GAAK,IACf,KAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACCA,GAAK,KAAUA,GAAK,KACf,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACM,OAANA,GACM,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,KACf,OAANA,GACM,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACpBA,GAAK,MAAUA,GAAK,MACf,OAANA,GACCA,GAAK,MAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACf,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACf,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OAAUA,GAAK,OACf,QAANA,GACM,QAANA,GACM,QAANA,GACCA,GAAK,OAAUA,GAAK,OACpBA,GAAK,OA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Q,CAAC,EAAG,CACjDxC,SAAUgnL,GAEd,CACF,CACF,8CC9rBA9N,EAAOvqL,QAAU,shBCAjBuqL,EAAOvqL,QAAU,mXCAjBuqL,EAAOvqL,QAAU,yVCAjBuqL,EAAOvqL,QAAU,4XCAjBuqL,EAAOvqL,QAAU,uNCAjBuqL,EAAOvqL,QAAU,6NCAjBuqL,EAAOvqL,QAAU,+PCAjBuqL,EAAOvqL,QAAU,0mBCAjBuqL,EAAOvqL,QAAU,kRCAjBuqL,EAAOvqL,QAAU,mYCAjBuqL,EAAOvqL,QAAU,uMCAjBuqL,EAAOvqL,QAAU,sNCAjBuqL,EAAOvqL,QAAU,gPCAjBuqL,EAAOvqL,QAAU,+RCAjBuqL,EAAOvqL,QAAU,8mBCAjBuqL,EAAOvqL,QAAU,ywBCAjBuqL,EAAOvqL,QAAU,wMCAjBuqL,EAAOvqL,QAAU,0OCAjBuqL,EAAOvqL,QAAU,4TCAjBuqL,EAAOvqL,QAAU,uRCAjBuqL,EAAOvqL,QAAU,qgBCAjBuqL,EAAOvqL,QAAU,0VCAjBuqL,EAAOvqL,QAAU,6SCAjBuqL,EAAOvqL,QAAU,wSCAjBuqL,EAAOvqL,QAAU,4RCAjBuqL,EAAOvqL,QAAU,2uBCAjBuqL,EAAOvqL,QAAU,0LCAjBuqL,EAAOvqL,QAAU,6RCAjBuqL,EAAOvqL,QAAU,6PCAjBuqL,EAAOvqL,QAAU,uhBCAjBuqL,EAAOvqL,QAAU,qdCAjBuqL,EAAOvqL,QAAU,6dCAjBuqL,EAAOvqL,QAAU,qdCAjBuqL,EAAOvqL,QAAU,2QCAjBuqL,EAAOvqL,QAAU,sOCAjBuqL,EAAOvqL,QAAU,wUCAjBuqL,EAAOvqL,QAAU,klCCAjBuqL,EAAOvqL,QAAU,kWCAjBuqL,EAAOvqL,QAAU,sXCAjBuqL,EAAOvqL,QAAU,8WCAjBuqL,EAAOvqL,QAAU,uRCAjBuqL,EAAOvqL,QAAU,yTCAjBuqL,EAAOvqL,QAAU,uMCAjBuqL,EAAOvqL,QAAU,ucCAjBuqL,EAAOvqL,QAAU,imBCAjBuqL,EAAOvqL,QAAU,skBCAjBuqL,EAAOvqL,QAAU,2OCAjBuqL,EAAOvqL,QAAU,m7BCAjBuqL,EAAOvqL,QAAU,6fCAjBuqL,EAAOvqL,QAAU,o1BCAjBuqL,EAAOvqL,QAAU,6lBCAjBuqL,EAAOvqL,QAAU,mQCAjBuqL,EAAOvqL,QAAU,2RCAjBuqL,EAAOvqL,QAAU,yjBCAjBuqL,EAAOvqL,QAAU,4TCAjBuqL,EAAOvqL,QAAU,mKCAjBuqL,EAAOvqL,QAAU,8WCAjBuqL,EAAOvqL,QAAU,sQCAjBuqL,EAAOvqL,QAAU,mTCAjBuqL,EAAOvqL,QAAU,2YCAjBuqL,EAAOvqL,QAAU,2aCAjBuqL,EAAOvqL,QAAU,0PCAjBuqL,EAAOvqL,QAAU,4RCAjBuqL,EAAOvqL,QAAU,+XCAjBuqL,EAAOvqL,QAAU,qsBCAjBuqL,EAAOvqL,QAAU,uLCAjBuqL,EAAOvqL,QAAU,sVCAjBuqL,EAAOvqL,QAAU,mQCAjBuqL,EAAOvqL,QAAU,uYCAjBuqL,EAAOvqL,QAAU,8UCAjBuqL,EAAOvqL,QAAU,kZCAjBuqL,EAAOvqL,QAAU,0PCAjBuqL,EAAOvqL,QAAU,mkBCAjBuqL,EAAOvqL,QAAU,8cCAjBuqL,EAAOvqL,QAAU,iVCAjBuqL,EAAOvqL,QAAU,mnBCAjBuqL,EAAOvqL,QAAU,2TCAjBuqL,EAAOvqL,QAAU,+RCAjBuqL,EAAOvqL,QAAU,qlbCAjB,IAAIomB,EAAM,CACT,mBAAoB,uCACpB,8BAA+B,kDAC/B,4BAA6B,gDAC7B,qBAAsB,yCACtB,6BAA8B,iDAC9B,wBAAyB,4CACzB,wBAAyB,4CACzB,wBAAyB,4CACzB,mBAAoB,uCACpB,gBAAiB,oCACjB,oCAAqC,wDACrC,+BAAgC,mDAChC,+BAAgC,mDAChC,mBAAoB,uCACpB,oBAAqB,wCACrB,wBAAyB,4CACzB,mBAAoB,uCACpB,qBAAsB,yCACtB,sBAAuB,0CACvB,mBAAoB,uCACpB,kCAAmC,sDACnC,kCAAmC,sDACnC,kBAAmB,sCACnB,oBAAqB,wCACrB,qBAAsB,yCACtB,qBAAsB,yCACtB,sBAAuB,0CACvB,kBAAmB,sCACnB,sBAAuB,0CACvB,oBAAqB,wCACrB,yBAA0B,6CAC1B,sBAAuB,0CACvB,wBAAyB,4CACzB,kBAAmB,sCACnB,wBAAyB,4CACzB,iBAAkB,qCAClB,yBAA0B,6CAC1B,mBAAoB,uCACpB,mBAAoB,uCACpB,oBAAqB,wCACrB,mBAAoB,uCACpB,kBAAmB,sCACnB,mBAAoB,uCACpB,kBAAmB,sCACnB,kBAAmB,sCACnB,qBAAsB,yCACtB,sBAAuB,0CACvB,uBAAwB,2CACxB,kBAAmB,sCACnB,sBAAuB,0CACvB,qBAAsB,yCACtB,qBAAsB,yCACtB,4BAA6B,gDAC7B,qBAAsB,yCACtB,oBAAqB,wCACrB,mBAAoB,uCACpB,kBAAmB,sCACnB,0BAA2B,8CAC3B,0BAA2B,8CAC3B,qBAAsB,yCACtB,qBAAsB,yCACtB,qBAAsB,yCACtB,oBAAqB,wCACrB,oBAAqB,wCACrB,kBAAmB,sCACnB,kBAAmB,sCACnB,qBAAsB,yCACtB,kBAAmB,sCACnB,mBAAoB,uCACpB,yBAA0B,6CAC1B,6BAA8B,iDAC9B,kBAAmB,sCACnB,qBAAsB,yCACtB,sBAAuB,0CACvB,qBAAsB,yCACtB,mBAAoB,uCACpB,kBAAmB,sCACnB,sBAAuB,0CACvB,uBAAwB,4CAIzB,SAASqyK,EAAeC,GACvB,IAAI7vK,EAAK8vK,EAAsBD,GAC/B,OAAOE,EAAoB/vK,EAC5B,CACA,SAAS8vK,EAAsBD,GAC9B,IAAIE,EAAoBzE,EAAE/tK,EAAKsyK,GAAM,CACpC,IAAIt+K,EAAI,IAAI7V,MAAM,uBAAyBm0L,EAAM,KAEjD,MADAt+K,EAAEoS,KAAO,mBACHpS,CACP,CACA,OAAOgM,EAAIsyK,EACZ,CACAD,EAAe3iL,KAAO,WACrB,OAAOpN,OAAOoN,KAAKsQ,EACpB,EACAqyK,EAAe1xK,QAAU4xK,EACzBpO,EAAOvqL,QAAUy4L,EACjBA,EAAe5vK,GAAK,8GCpGpB,IAAIzC,EAAM,CACT,eAAgB,uCAChB,mBAAoB,uCACpB,0BAA2B,kDAC3B,8BAA+B,kDAC/B,wBAAyB,gDACzB,4BAA6B,gDAC7B,iBAAkB,yCAClB,qBAAsB,yCACtB,yBAA0B,iDAC1B,6BAA8B,iDAC9B,oBAAqB,4CACrB,wBAAyB,4CACzB,oBAAqB,4CACrB,wBAAyB,4CACzB,oBAAqB,4CACrB,wBAAyB,4CACzB,eAAgB,uCAChB,mBAAoB,uCACpB,YAAa,oCACb,gBAAiB,oCACjB,gCAAiC,wDACjC,oCAAqC,wDACrC,2BAA4B,mDAC5B,+BAAgC,mDAChC,2BAA4B,mDAC5B,+BAAgC,mDAChC,eAAgB,uCAChB,mBAAoB,uCACpB,gBAAiB,wCACjB,oBAAqB,wCACrB,oBAAqB,4CACrB,wBAAyB,4CACzB,eAAgB,uCAChB,mBAAoB,uCACpB,iBAAkB,yCAClB,qBAAsB,yCACtB,kBAAmB,0CACnB,sBAAuB,0CACvB,eAAgB,uCAChB,mBAAoB,uCACpB,8BAA+B,sDAC/B,kCAAmC,sDACnC,8BAA+B,sDAC/B,kCAAmC,sDACnC,cAAe,sCACf,kBAAmB,sCACnB,gBAAiB,wCACjB,oBAAqB,wCACrB,iBAAkB,yCAClB,qBAAsB,yCACtB,iBAAkB,yCAClB,qBAAsB,yCACtB,kBAAmB,0CACnB,sBAAuB,0CACvB,cAAe,sCACf,kBAAmB,sCACnB,kBAAmB,0CACnB,sBAAuB,0CACvB,gBAAiB,wCACjB,oBAAqB,wCACrB,qBAAsB,6CACtB,yBAA0B,6CAC1B,kBAAmB,0CACnB,sBAAuB,0CACvB,oBAAqB,4CACrB,wBAAyB,4CACzB,cAAe,sCACf,kBAAmB,sCACnB,oBAAqB,4CACrB,wBAAyB,4CACzB,aAAc,qCACd,iBAAkB,qCAClB,qBAAsB,6CACtB,yBAA0B,6CAC1B,eAAgB,uCAChB,mBAAoB,uCACpB,eAAgB,uCAChB,mBAAoB,uCACpB,gBAAiB,wCACjB,oBAAqB,wCACrB,eAAgB,uCAChB,mBAAoB,uCACpB,cAAe,sCACf,kBAAmB,sCACnB,eAAgB,uCAChB,mBAAoB,uCACpB,cAAe,sCACf,kBAAmB,sCACnB,cAAe,sCACf,kBAAmB,sCACnB,iBAAkB,yCAClB,qBAAsB,yCACtB,kBAAmB,0CACnB,sBAAuB,0CACvB,mBAAoB,2CACpB,uBAAwB,2CACxB,cAAe,sCACf,kBAAmB,sCACnB,kBAAmB,0CACnB,sBAAuB,0CACvB,iBAAkB,yCAClB,qBAAsB,yCACtB,iBAAkB,yCAClB,qBAAsB,yCACtB,wBAAyB,gDACzB,4BAA6B,gDAC7B,iBAAkB,yCAClB,qBAAsB,yCACtB,gBAAiB,wCACjB,oBAAqB,wCACrB,eAAgB,uCAChB,mBAAoB,uCACpB,cAAe,sCACf,kBAAmB,sCACnB,sBAAuB,8CACvB,0BAA2B,8CAC3B,sBAAuB,8CACvB,0BAA2B,8CAC3B,iBAAkB,yCAClB,qBAAsB,yCACtB,iBAAkB,yCAClB,qBAAsB,yCACtB,iBAAkB,yCAClB,qBAAsB,yCACtB,gBAAiB,wCACjB,oBAAqB,wCACrB,gBAAiB,wCACjB,oBAAqB,wCACrB,cAAe,sCACf,kBAAmB,sCACnB,cAAe,sCACf,kBAAmB,sCACnB,iBAAkB,yCAClB,qBAAsB,yCACtB,cAAe,sCACf,kBAAmB,sCACnB,eAAgB,uCAChB,mBAAoB,uCACpB,qBAAsB,6CACtB,yBAA0B,6CAC1B,yBAA0B,iDAC1B,6BAA8B,iDAC9B,cAAe,sCACf,kBAAmB,sCACnB,iBAAkB,yCAClB,qBAAsB,yCACtB,kBAAmB,0CACnB,sBAAuB,0CACvB,iBAAkB,yCAClB,qBAAsB,yCACtB,eAAgB,uCAChB,mBAAoB,uCACpB,cAAe,sCACf,kBAAmB,sCACnB,kBAAmB,0CACnB,sBAAuB,0CACvB,mBAAoB,2CACpB,uBAAwB,4CAIzB,SAASqyK,EAAeC,GACvB,IAAI7vK,EAAK8vK,EAAsBD,GAC/B,OAAOE,EAAoB/vK,EAC5B,CACA,SAAS8vK,EAAsBD,GAC9B,IAAIE,EAAoBzE,EAAE/tK,EAAKsyK,GAAM,CACpC,IAAIt+K,EAAI,IAAI7V,MAAM,uBAAyBm0L,EAAM,KAEjD,MADAt+K,EAAEoS,KAAO,mBACHpS,CACP,CACA,OAAOgM,EAAIsyK,EACZ,CACAD,EAAe3iL,KAAO,WACrB,OAAOpN,OAAOoN,KAAKsQ,EACpB,EACAqyK,EAAe1xK,QAAU4xK,EACzBpO,EAAOvqL,QAAUy4L,EACjBA,EAAe5vK,GAAK,2GCnLpB,IAAIzC,EAAM,CACT,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,wBAChB,eAAgB,yBAIjB,SAASqyK,EAAeC,GACvB,IAAI7vK,EAAK8vK,EAAsBD,GAC/B,OAAOE,EAAoB/vK,EAC5B,CACA,SAAS8vK,EAAsBD,GAC9B,IAAIE,EAAoBzE,EAAE/tK,EAAKsyK,GAAM,CACpC,IAAIt+K,EAAI,IAAI7V,MAAM,uBAAyBm0L,EAAM,KAEjD,MADAt+K,EAAEoS,KAAO,mBACHpS,CACP,CACA,OAAOgM,EAAIsyK,EACZ,CACAD,EAAe3iL,KAAO,WACrB,OAAOpN,OAAOoN,KAAKsQ,EACpB,EACAqyK,EAAe1xK,QAAU4xK,EACzBpO,EAAOvqL,QAAUy4L,EACjBA,EAAe5vK,GAAK,2EClEpB0hK,EAAOvqL,QAAU,CAAC","sources":["webpack://wire-webapp/./node_modules/@wireapp/api-client/lib/auth/VerificationActionType.js","webpack://wire-webapp/./src/script/Config.ts","webpack://wire-webapp/./src/script/assets/AssetCrypto.ts","webpack://wire-webapp/./src/script/assets/AssetRemoteData.ts","webpack://wire-webapp/./src/script/assets/AssetURLCache.ts","webpack://wire-webapp/./src/script/assets/AssetRepository.ts","webpack://wire-webapp/./src/script/assets/AssetService.ts","webpack://wire-webapp/./src/script/assets/AssetTransferState.ts","webpack://wire-webapp/./src/script/assets/AssetType.ts","webpack://wire-webapp/./src/script/auth/SignOutReason.ts","webpack://wire-webapp/./src/script/auth/URLParameter.ts","webpack://wire-webapp/./src/script/auth/supportedLocales.ts","webpack://wire-webapp/./src/script/auth/localeConfig.ts","webpack://wire-webapp/./node_modules/react-redux/es/utils/batch.js","webpack://wire-webapp/./node_modules/react-redux/es/components/Context.js","webpack://wire-webapp/./node_modules/react-redux/es/hooks/useSelector.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/selectorFactory.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/wrapMapToProps.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/invalidArgFactory.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/mergeProps.js","webpack://wire-webapp/./node_modules/react-redux/es/utils/Subscription.js","webpack://wire-webapp/./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js","webpack://wire-webapp/./node_modules/react-redux/es/utils/shallowEqual.js","webpack://wire-webapp/./node_modules/react-redux/es/utils/useSyncExternalStore.js","webpack://wire-webapp/./node_modules/react-redux/es/components/connect.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/mapStateToProps.js","webpack://wire-webapp/./node_modules/react-redux/es/connect/mapDispatchToProps.js","webpack://wire-webapp/./node_modules/react-redux/es/utils/bindActionCreators.js","webpack://wire-webapp/./node_modules/react-redux/es/components/Provider.js","webpack://wire-webapp/./node_modules/react-redux/es/index.js","webpack://wire-webapp/./src/script/auth/configureEnvironment.ts","webpack://wire-webapp/./node_modules/redux-thunk/es/index.js","webpack://wire-webapp/./src/script/auth/module/action/creator/AuthActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/ClientActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/ConversationActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/InvitationActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/LanguageActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/LocalStorageActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/RuntimeActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/SelfActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/action/creator/UserActionCreator.ts","webpack://wire-webapp/./src/script/auth/module/selector/RuntimeSelector.ts","webpack://wire-webapp/./src/script/auth/util/urlUtil.ts","webpack://wire-webapp/./src/script/auth/module/action/RuntimeAction.ts","webpack://wire-webapp/./src/script/auth/module/selector/AuthSelector.ts","webpack://wire-webapp/./src/script/auth/module/reducer/authReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/clientReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/conversationReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/inviteReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/languageReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/runtimeReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/selfReducer.ts","webpack://wire-webapp/./src/script/auth/module/reducer/index.ts","webpack://wire-webapp/./src/script/auth/configureStore.ts","webpack://wire-webapp/./src/script/auth/module/action/BackendError.ts","webpack://wire-webapp/./src/script/auth/module/action/LabeledError.ts","webpack://wire-webapp/./src/script/auth/module/action/LocalStorageAction.ts","webpack://wire-webapp/./src/script/auth/module/action/AuthAction.ts","webpack://wire-webapp/./src/script/auth/util/stringUtil.ts","webpack://wire-webapp/./src/script/auth/module/action/ClientAction.ts","webpack://wire-webapp/./src/script/auth/module/action/ConversationAction.ts","webpack://wire-webapp/./src/script/auth/module/selector/InviteSelector.ts","webpack://wire-webapp/./src/script/auth/module/selector/LanguageSelector.ts","webpack://wire-webapp/./src/script/auth/module/selector/SelfSelector.ts","webpack://wire-webapp/./src/script/auth/module/action/InvitationAction.ts","webpack://wire-webapp/./src/script/auth/module/action/NavigationAction.ts","webpack://wire-webapp/./src/script/auth/module/action/NotificationAction.ts","webpack://wire-webapp/./src/script/auth/module/action/WebSocketAction.ts","webpack://wire-webapp/./src/script/auth/module/action/SelfAction.ts","webpack://wire-webapp/./src/script/auth/module/action/UserAction.ts","webpack://wire-webapp/./src/script/auth/module/action/WrapperEventAction.ts","webpack://wire-webapp/./src/script/auth/module/action/index.ts","webpack://wire-webapp/./node_modules/tslib/tslib.es6.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/components/injectIntl.js","webpack://wire-webapp/./node_modules/@formatjs/ecma402-abstract/lib/utils.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/error.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/types.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/regex.generated.js","webpack://wire-webapp/./node_modules/@formatjs/icu-skeleton-parser/lib/date-time.js","webpack://wire-webapp/./node_modules/@formatjs/icu-skeleton-parser/lib/regex.generated.js","webpack://wire-webapp/./node_modules/@formatjs/icu-skeleton-parser/lib/number.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/time-data.generated.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/parser.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/date-time-pattern-generator.js","webpack://wire-webapp/./node_modules/@formatjs/icu-messageformat-parser/lib/index.js","webpack://wire-webapp/./node_modules/@formatjs/fast-memoize/lib/index.js","webpack://wire-webapp/./node_modules/intl-messageformat/lib/src/error.js","webpack://wire-webapp/./node_modules/intl-messageformat/lib/src/formatters.js","webpack://wire-webapp/./node_modules/intl-messageformat/lib/src/core.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/error.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/utils.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/utils.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/message.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/number.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/relativeTime.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/dateTime.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/plural.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/list.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/displayName.js","webpack://wire-webapp/./node_modules/@formatjs/intl/lib/src/create-intl.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/components/provider.js","webpack://wire-webapp/./node_modules/@remix-run/router/dist/router.js","webpack://wire-webapp/./node_modules/react-router/dist/index.js","webpack://wire-webapp/./node_modules/react-router-dom/dist/index.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/components/useIntl.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/components/message.js","webpack://wire-webapp/./node_modules/react-intl/lib/src/components/createFormattedComponent.js","webpack://wire-webapp/./node_modules/react-intl/lib/index.js","webpack://wire-webapp/./src/script/auth/module/action/ValidationError.ts","webpack://wire-webapp/./src/script/strings.ts","webpack://wire-webapp/./src/script/auth/externalRoute.ts","webpack://wire-webapp/./src/script/auth/component/WirelessContainer.tsx","webpack://wire-webapp/./src/script/auth/component/UnsupportedBrowser.tsx","webpack://wire-webapp/./src/script/auth/page/Page.tsx","webpack://wire-webapp/./src/script/auth/component/Exception.tsx","webpack://wire-webapp/./src/script/auth/page/CheckPassword.tsx","webpack://wire-webapp/./src/script/auth/util/errorUtil.tsx","webpack://wire-webapp/./src/script/auth/component/ClientItem.tsx","webpack://wire-webapp/./src/script/auth/module/selector/ClientSelector.ts","webpack://wire-webapp/./src/script/auth/component/ClientList.tsx","webpack://wire-webapp/./src/script/auth/page/ClientManager.tsx","webpack://wire-webapp/./src/script/util/Entropy.ts","webpack://wire-webapp/./src/script/hooks/usePausableInterval.ts","webpack://wire-webapp/./src/script/auth/component/EntropyCanvas.tsx","webpack://wire-webapp/./src/script/auth/component/ProgressBar.tsx","webpack://wire-webapp/./src/script/auth/page/EntropyContainer.tsx","webpack://wire-webapp/./src/script/auth/component/AppAlreadyOpen.tsx","webpack://wire-webapp/./src/script/auth/component/RouterLink.tsx","webpack://wire-webapp/./src/script/auth/module/selector/ConversationSelector.ts","webpack://wire-webapp/./src/script/auth/util/randomUtil.ts","webpack://wire-webapp/./src/script/auth/util/AccentColor.ts","webpack://wire-webapp/./src/script/auth/page/ConversationJoin.tsx","webpack://wire-webapp/./src/script/auth/page/ConversationJoinInvalid.tsx","webpack://wire-webapp/./src/script/auth/component/AccountForm.tsx","webpack://wire-webapp/./src/script/auth/page/CreateAccount.tsx","webpack://wire-webapp/./src/script/auth/page/CreatePersonalAccount.tsx","webpack://wire-webapp/./src/script/auth/page/CustomEnvironmentRedirect.tsx","webpack://wire-webapp/./src/script/auth/page/HistoryInfo.tsx","webpack://wire-webapp/./src/script/auth/page/Index.tsx","webpack://wire-webapp/./src/script/auth/page/InitialInvite.tsx","webpack://wire-webapp/./src/script/auth/component/LoginForm.tsx","webpack://wire-webapp/./src/script/auth/page/Login.tsx","webpack://wire-webapp/./src/script/util/CountryCodes.ts","webpack://wire-webapp/./src/script/auth/component/PhoneLoginForm.tsx","webpack://wire-webapp/./src/script/auth/page/PhoneLogin.tsx","webpack://wire-webapp/./src/script/auth/page/SetAccountType.tsx","webpack://wire-webapp/./src/script/auth/page/SetEmail.tsx","webpack://wire-webapp/./src/script/auth/page/SetEntropyPage.tsx","webpack://wire-webapp/./src/script/auth/component/AcceptNewsModal.tsx","webpack://wire-webapp/./src/script/auth/util/handleUtil.ts","webpack://wire-webapp/./src/script/auth/page/SetHandle.tsx","webpack://wire-webapp/./src/script/auth/page/SetPassword.tsx","webpack://wire-webapp/./src/script/auth/page/SingleSignOnForm.tsx","webpack://wire-webapp/./src/script/auth/page/SingleSignOn.tsx","webpack://wire-webapp/./src/script/auth/page/TeamName.tsx","webpack://wire-webapp/./src/script/auth/component/LinkButton.tsx","webpack://wire-webapp/./src/script/auth/page/VerifyEmailCode.tsx","webpack://wire-webapp/./src/script/auth/page/VerifyEmailLink.tsx","webpack://wire-webapp/./src/script/auth/page/VerifyPhoneCode.tsx","webpack://wire-webapp/./src/script/auth/page/Root.tsx","webpack://wire-webapp/./src/script/auth/main.tsx","webpack://wire-webapp/./src/script/auth/route.ts","webpack://wire-webapp/./src/script/auth/util/SVGProvider.ts","webpack://wire-webapp/./src/script/calling/enum/LeaveCallReason.ts","webpack://wire-webapp/./src/script/calling/enum/TerminationReason.ts","webpack://wire-webapp/./src/script/client/ClientEntity.ts","webpack://wire-webapp/./src/script/client/ClientIdUtil.ts","webpack://wire-webapp/./src/script/client/ClientMapper.ts","webpack://wire-webapp/./src/script/client/ClientState.ts","webpack://wire-webapp/./src/script/client/ClientRepository.ts","webpack://wire-webapp/./src/script/client/ClientService.ts","webpack://wire-webapp/./src/script/components/AvailabilityState.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarBackground.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarBorder.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarImage.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarWrapper.tsx","webpack://wire-webapp/./src/script/components/avatar/ServiceAvatar.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarBadge.tsx","webpack://wire-webapp/./src/script/components/avatar/AvatarInitials.tsx","webpack://wire-webapp/./src/script/components/avatar/UserAvatar.tsx","webpack://wire-webapp/./src/script/components/avatar/TemporaryGuestAvatar.tsx","webpack://wire-webapp/./src/script/components/Avatar.tsx","webpack://wire-webapp/./src/script/components/DeviceId.tsx","webpack://wire-webapp/./src/script/components/Icon.tsx","webpack://wire-webapp/./src/script/components/InputBar/components/TypingIndicator/TypingIndicator.state.tsx","webpack://wire-webapp/./src/script/components/InputBar/components/TypingIndicator/TypingIndicator.styles.ts","webpack://wire-webapp/./src/script/components/InputBar/components/TypingIndicator/TypingIndicator.tsx","webpack://wire-webapp/./src/script/components/InputBar/components/TypingIndicator/index.ts","webpack://wire-webapp/./src/script/components/LegalHoldDot.tsx","webpack://wire-webapp/./src/script/components/MessagesList/Message/util/index.ts","webpack://wire-webapp/./src/script/components/ModalComponent.tsx","webpack://wire-webapp/./src/script/components/Modals/LegalHoldModal/LegalHoldModal.state.ts","webpack://wire-webapp/./src/script/components/Modals/LegalHoldModal/LegalHoldModal.tsx","webpack://wire-webapp/./src/script/components/Modals/PrimaryModal/PrimaryModalState.ts","webpack://wire-webapp/./src/script/components/Modals/PrimaryModal/PrimaryModalTypes.ts","webpack://wire-webapp/./src/script/components/Modals/PrimaryModal/index.ts","webpack://wire-webapp/./src/script/components/userDevices/DeviceCard.tsx","webpack://wire-webapp/./src/script/components/userDevices/DeviceDetails.tsx","webpack://wire-webapp/./src/script/components/userDevices/DeviceList.tsx","webpack://wire-webapp/./src/script/components/userDevices/NoDevicesFound.tsx","webpack://wire-webapp/./src/script/components/userDevices/SelfFingerprint.tsx","webpack://wire-webapp/./src/script/components/UserDevices.tsx","webpack://wire-webapp/./src/script/components/UserList.tsx","webpack://wire-webapp/./src/script/components/UserSearchableList.tsx","webpack://wire-webapp/./src/script/components/VerifiedIcon.tsx","webpack://wire-webapp/./src/script/components/calling/ParticipantMicOnIcon.tsx","webpack://wire-webapp/./src/script/components/list/ParticipantItem.tsx","webpack://wire-webapp/./src/script/util/DOM/overlayedObserver.ts","webpack://wire-webapp/./src/script/util/DOM/viewportObserver.ts","webpack://wire-webapp/./src/script/components/utils/InViewport.tsx","webpack://wire-webapp/./src/script/connection/ConnectionEntity.ts","webpack://wire-webapp/./src/script/conversation/AbstractConversationEventHandler.ts","webpack://wire-webapp/./src/script/conversation/AccessState.ts","webpack://wire-webapp/./src/script/conversation/ClientMismatchUtil.ts","webpack://wire-webapp/./src/script/conversation/ConversationAccessPermission.ts","webpack://wire-webapp/./src/script/conversation/ConversationEphemeralHandler.ts","webpack://wire-webapp/./src/script/conversation/ConversationFilter.ts","webpack://wire-webapp/./src/script/util/TypedEventTarget.ts","webpack://wire-webapp/./src/script/conversation/ConversationLabelRepository.ts","webpack://wire-webapp/./src/script/conversation/ConversationMapper.ts","webpack://wire-webapp/./src/script/util/PromiseQueue.ts","webpack://wire-webapp/./src/script/conversation/ConversationRoleRepository.ts","webpack://wire-webapp/./src/script/conversation/ConversationStateHandler.ts","webpack://wire-webapp/./src/script/conversation/ConversationVerificationStateHandler.ts","webpack://wire-webapp/./src/script/entity/message/DeleteConversationMessage.ts","webpack://wire-webapp/./src/script/legal-hold/LegalHoldEvaluator.ts","webpack://wire-webapp/./src/script/user/UserFilter.ts","webpack://wire-webapp/./src/script/conversation/ConversationRepository.ts","webpack://wire-webapp/./src/script/conversation/ConversationSelectors.ts","webpack://wire-webapp/./src/script/conversation/ConversationState.ts","webpack://wire-webapp/./src/script/conversation/ConversationStatus.ts","webpack://wire-webapp/./src/script/conversation/ConversationVerificationState.ts","webpack://wire-webapp/./src/script/conversation/EventBuilder.ts","webpack://wire-webapp/./src/script/entity/message/CallingTimeoutMessage.ts","webpack://wire-webapp/./src/script/message/CallMessageType.ts","webpack://wire-webapp/./src/script/entity/message/CallMessage.ts","webpack://wire-webapp/./src/script/entity/message/DecryptErrorMessage.ts","webpack://wire-webapp/./src/script/entity/message/DeleteMessage.ts","webpack://wire-webapp/./src/script/entity/message/FileAsset.ts","webpack://wire-webapp/./src/script/entity/message/FileTypeRestrictedMessage.ts","webpack://wire-webapp/./src/script/entity/message/LegalHoldMessage.ts","webpack://wire-webapp/./src/script/entity/message/LinkPreview.ts","webpack://wire-webapp/./src/script/entity/message/Location.ts","webpack://wire-webapp/./src/script/entity/message/MediumImage.ts","webpack://wire-webapp/./src/script/entity/message/MessageTimerUpdateMessage.ts","webpack://wire-webapp/./src/script/entity/message/MissedMessage.ts","webpack://wire-webapp/./src/script/entity/message/PingMessage.ts","webpack://wire-webapp/./src/script/entity/message/ReceiptModeUpdateMessage.ts","webpack://wire-webapp/./src/script/entity/message/RenameMessage.ts","webpack://wire-webapp/./src/script/entity/message/VerificationMessage.ts","webpack://wire-webapp/./src/script/conversation/EventMapper.ts","webpack://wire-webapp/./src/script/conversation/NotificationSetting.ts","webpack://wire-webapp/./src/script/conversation/linkPreviews/helpers.ts","webpack://wire-webapp/./src/script/cryptography/CryptographyMapper.ts","webpack://wire-webapp/./src/script/cryptography/GenericMessageType.ts","webpack://wire-webapp/./src/script/cryptography/ProtoMessageType.ts","webpack://wire-webapp/./src/script/entity/Conversation.ts","webpack://wire-webapp/./src/script/entity/User.ts","webpack://wire-webapp/./src/script/entity/message/Asset.ts","webpack://wire-webapp/./src/script/entity/message/Button.ts","webpack://wire-webapp/./src/script/entity/message/CompositeMessage.ts","webpack://wire-webapp/./src/script/entity/message/ContentMessage.ts","webpack://wire-webapp/./src/script/entity/message/MemberMessage.ts","webpack://wire-webapp/./src/script/entity/message/Message.ts","webpack://wire-webapp/./src/script/entity/message/SystemMessage.ts","webpack://wire-webapp/./src/script/media/MediaEmbeds.ts","webpack://wire-webapp/./src/script/media/MediaParser.ts","webpack://wire-webapp/./src/script/entity/message/Text.ts","webpack://wire-webapp/./src/script/error/AuthError.ts","webpack://wire-webapp/./src/script/error/BackendClientError.ts","webpack://wire-webapp/./src/script/error/BaseError.ts","webpack://wire-webapp/./src/script/error/ClientError.ts","webpack://wire-webapp/./src/script/error/ConversationError.ts","webpack://wire-webapp/./src/script/error/CryptographyError.ts","webpack://wire-webapp/./src/script/error/StorageError.ts","webpack://wire-webapp/./src/script/error/TeamError.ts","webpack://wire-webapp/./src/script/event/Client.ts","webpack://wire-webapp/./src/script/event/EventType.ts","webpack://wire-webapp/./src/script/event/EventValidation.ts","webpack://wire-webapp/./src/script/error/EventError.ts","webpack://wire-webapp/./src/script/event/EventRepository.ts","webpack://wire-webapp/./src/script/event/EventValidator.ts","webpack://wire-webapp/./src/script/event/EventSource.ts","webpack://wire-webapp/./src/script/event/EventTypeHandling.ts","webpack://wire-webapp/./src/script/event/NotificationHandlingState.ts","webpack://wire-webapp/./src/script/externalRoute.ts","webpack://wire-webapp/./src/script/guards/Message.ts","webpack://wire-webapp/./src/script/guards/Service.ts","webpack://wire-webapp/./src/script/hooks/useSingleInstance.ts","webpack://wire-webapp/./src/script/integration/ServiceEntity.ts","webpack://wire-webapp/./src/script/localization/Localizer.ts","webpack://wire-webapp/./src/script/message/EphemeralStatusType.ts","webpack://wire-webapp/./src/script/message/MentionEntity.ts","webpack://wire-webapp/./src/script/message/MessageCategorization.ts","webpack://wire-webapp/./src/script/message/MessageCategory.ts","webpack://wire-webapp/./src/script/message/QuoteEntity.ts","webpack://wire-webapp/./src/script/message/StatusType.ts","webpack://wire-webapp/./src/script/message/SuperType.ts","webpack://wire-webapp/./src/script/message/SystemMessageType.ts","webpack://wire-webapp/./src/script/message/VerificationMessageType.ts","webpack://wire-webapp/./src/script/mls/mlsConversationState/conversationStateStorage.ts","webpack://wire-webapp/./src/script/mls/mlsConversationState/mlsConversationState.ts","webpack://wire-webapp/./src/script/mls/MLSConversations.ts","webpack://wire-webapp/./src/script/motion/MotionDuration.ts","webpack://wire-webapp/./src/script/notification/PermissionState.ts","webpack://wire-webapp/./src/script/search/SearchRepository.ts","webpack://wire-webapp/./src/script/service/APIClientSingleton.ts","webpack://wire-webapp/./src/script/service/BackendEnvironment.ts","webpack://wire-webapp/./src/script/util/ephemeralValueStore.ts","webpack://wire-webapp/./src/script/storage/DexieDatabase.ts","webpack://wire-webapp/./src/script/storage/SQLeetSchemata.ts","webpack://wire-webapp/./src/script/service/StoreEngineProvider.ts","webpack://wire-webapp/./src/script/service/CoreSingleton.ts","webpack://wire-webapp/./src/script/storage/StorageKey.ts","webpack://wire-webapp/./src/script/storage/StorageSchemata.ts","webpack://wire-webapp/./src/script/storage/StorageService.ts","webpack://wire-webapp/./src/script/storage/StorageRepository.ts","webpack://wire-webapp/./src/script/team/TeamState.ts","webpack://wire-webapp/./src/script/tracking/EventName.ts","webpack://wire-webapp/./src/script/user/UserHandleGenerator.ts","webpack://wire-webapp/./src/script/user/UserPermission.ts","webpack://wire-webapp/./src/script/user/UserState.ts","webpack://wire-webapp/./src/script/util/ArrayUtil.ts","webpack://wire-webapp/./src/script/util/CSSMixin.ts","webpack://wire-webapp/./src/script/util/ClipboardUtil.ts","webpack://wire-webapp/./src/script/util/ComponentUtil.ts","webpack://wire-webapp/./src/script/util/EmojiUtil.ts","webpack://wire-webapp/./src/script/util/Environment.ts","webpack://wire-webapp/./src/script/util/FileTypeUtil.ts","webpack://wire-webapp/./src/script/util/KeyboardUtil.ts","webpack://wire-webapp/./src/script/util/LocalizerUtil.ts","webpack://wire-webapp/./src/script/util/Logger.ts","webpack://wire-webapp/./src/script/util/LoggerUtil.ts","webpack://wire-webapp/./src/script/util/MentionUtil.ts","webpack://wire-webapp/./src/script/util/NumberUtil.ts","webpack://wire-webapp/./src/script/util/QualifiedId.ts","webpack://wire-webapp/./src/script/util/SanitizationUtil.ts","webpack://wire-webapp/./src/script/util/StorageUtil.ts","webpack://wire-webapp/./src/script/util/StringUtil.ts","webpack://wire-webapp/./src/script/util/TimeUtil.ts","webpack://wire-webapp/./src/script/util/TypePredicateUtil.ts","webpack://wire-webapp/./src/script/util/UrlUtil.ts","webpack://wire-webapp/./src/script/util/ValidationUtil.ts","webpack://wire-webapp/./src/script/util/localStorage.ts","webpack://wire-webapp/./src/script/util/messageRenderer.ts","webpack://wire-webapp/./src/script/util/util.ts","webpack://wire-webapp/./src/script/util/worker.ts","webpack://wire-webapp/./src/script/util/wrapper.ts","webpack://wire-webapp/./src/script/view_model/WarningsContainer/WarningsContainer.tsx","webpack://wire-webapp/./src/script/view_model/WarningsContainer/WarningsState.ts","webpack://wire-webapp/./src/script/view_model/WarningsContainer/WarningsTypes.ts","webpack://wire-webapp/./src/script/view_model/WarningsContainer/index.ts","webpack://wire-webapp/./node_modules/core-js/actual/object/index.js","webpack://wire-webapp/./node_modules/core-js/es/object/index.js","webpack://wire-webapp/./node_modules/core-js/full/object/index.js","webpack://wire-webapp/./node_modules/core-js/internals/object-iterator.js","webpack://wire-webapp/./node_modules/core-js/internals/object-prototype-accessors-forced.js","webpack://wire-webapp/./node_modules/core-js/internals/symbol-define-to-primitive.js","webpack://wire-webapp/./node_modules/core-js/internals/symbol-registry-detection.js","webpack://wire-webapp/./node_modules/core-js/modules/es.json.stringify.js","webpack://wire-webapp/./node_modules/core-js/modules/es.json.to-string-tag.js","webpack://wire-webapp/./node_modules/core-js/modules/es.math.to-string-tag.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.create.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.define-getter.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.define-properties.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.define-property.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.define-setter.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.freeze.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.from-entries.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.get-own-property-descriptor.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.get-own-property-names.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.get-own-property-symbols.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.has-own.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.is-extensible.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.is-frozen.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.is-sealed.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.is.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.keys.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.lookup-getter.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.lookup-setter.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.prevent-extensions.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.proto.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.seal.js","webpack://wire-webapp/./node_modules/core-js/modules/es.object.set-prototype-of.js","webpack://wire-webapp/./node_modules/core-js/modules/es.symbol.constructor.js","webpack://wire-webapp/./node_modules/core-js/modules/es.symbol.for.js","webpack://wire-webapp/./node_modules/core-js/modules/es.symbol.js","webpack://wire-webapp/./node_modules/core-js/modules/es.symbol.key-for.js","webpack://wire-webapp/./node_modules/core-js/modules/esnext.object.has-own.js","webpack://wire-webapp/./node_modules/core-js/modules/esnext.object.iterate-entries.js","webpack://wire-webapp/./node_modules/core-js/modules/esnext.object.iterate-keys.js","webpack://wire-webapp/./node_modules/core-js/modules/esnext.object.iterate-values.js","webpack://wire-webapp/./node_modules/core-js/stable/object/index.js","webpack://wire-webapp/./node_modules/react-is/cjs/react-is.production.min.js","webpack://wire-webapp/./node_modules/react-is/index.js","webpack://wire-webapp/./node_modules/redux-devtools-extension/developmentOnly.js","webpack://wire-webapp/./node_modules/redux-logdown/node_modules/logdown/dist/logdown.min.js","webpack://wire-webapp/./node_modules/redux-logdown/src/index.js","webpack://wire-webapp/./node_modules/redux/es/redux.js","webpack://wire-webapp/./resource/image/icon/about-icon.svg","webpack://wire-webapp/./resource/image/icon/add-participants-icon.svg","webpack://wire-webapp/./resource/image/icon/animated-check-icon.svg","webpack://wire-webapp/./resource/image/icon/archive-icon.svg","webpack://wire-webapp/./resource/image/icon/arrow-down-long-icon.svg","webpack://wire-webapp/./resource/image/icon/arrow-left-icon.svg","webpack://wire-webapp/./resource/image/icon/arrow-next-icon.svg","webpack://wire-webapp/./resource/image/icon/attachment-icon.svg","webpack://wire-webapp/./resource/image/icon/audio-icon.svg","webpack://wire-webapp/./resource/image/icon/av-icon.svg","webpack://wire-webapp/./resource/image/icon/availability-available-icon.svg","webpack://wire-webapp/./resource/image/icon/availability-away-icon.svg","webpack://wire-webapp/./resource/image/icon/availability-busy-icon.svg","webpack://wire-webapp/./resource/image/icon/block-icon.svg","webpack://wire-webapp/./resource/image/icon/camera-icon.svg","webpack://wire-webapp/./resource/image/icon/camera-off-icon.svg","webpack://wire-webapp/./resource/image/icon/check-icon.svg","webpack://wire-webapp/./resource/image/icon/chevron-icon.svg","webpack://wire-webapp/./resource/image/icon/chevron-right.svg","webpack://wire-webapp/./resource/image/icon/close-icon.svg","webpack://wire-webapp/./resource/image/icon/conversations-folder-icon.svg","webpack://wire-webapp/./resource/image/icon/conversations-recent-icon.svg","webpack://wire-webapp/./resource/image/icon/copy-icon.svg","webpack://wire-webapp/./resource/image/icon/delete-icon.svg","webpack://wire-webapp/./resource/image/icon/desktop-icon.svg","webpack://wire-webapp/./resource/image/icon/devices-icon.svg","webpack://wire-webapp/./resource/image/icon/disclose-icon.svg","webpack://wire-webapp/./resource/image/icon/edit-icon.svg","webpack://wire-webapp/./resource/image/icon/ellipsis-icon.svg","webpack://wire-webapp/./resource/image/icon/eraser-icon.svg","webpack://wire-webapp/./resource/image/icon/exclamation-mark.svg","webpack://wire-webapp/./resource/image/icon/external-icon.svg","webpack://wire-webapp/./resource/image/icon/federation-icon.svg","webpack://wire-webapp/./resource/image/icon/file-icon.svg","webpack://wire-webapp/./resource/image/icon/fullscreen-icon.svg","webpack://wire-webapp/./resource/image/icon/gif-icon.svg","webpack://wire-webapp/./resource/image/icon/group-admin-icon.svg","webpack://wire-webapp/./resource/image/icon/group-icon.svg","webpack://wire-webapp/./resource/image/icon/guest-icon.svg","webpack://wire-webapp/./resource/image/icon/hangup-icon.svg","webpack://wire-webapp/./resource/image/icon/image-icon.svg","webpack://wire-webapp/./resource/image/icon/info-icon.svg","webpack://wire-webapp/./resource/image/icon/leave-icon.svg","webpack://wire-webapp/./resource/image/icon/like-icon.svg","webpack://wire-webapp/./resource/image/icon/link-icon.svg","webpack://wire-webapp/./resource/image/icon/loading-icon.svg","webpack://wire-webapp/./resource/image/icon/location-icon.svg","webpack://wire-webapp/./resource/image/icon/logo-full-icon.svg","webpack://wire-webapp/./resource/image/icon/logo-icon.svg","webpack://wire-webapp/./resource/image/icon/markdown-icon.svg","webpack://wire-webapp/./resource/image/icon/mention-icon.svg","webpack://wire-webapp/./resource/image/icon/message-icon.svg","webpack://wire-webapp/./resource/image/icon/message-unread-icon.svg","webpack://wire-webapp/./resource/image/icon/mic-off-icon.svg","webpack://wire-webapp/./resource/image/icon/mic-on-icon.svg","webpack://wire-webapp/./resource/image/icon/minus-icon.svg","webpack://wire-webapp/./resource/image/icon/mute-icon.svg","webpack://wire-webapp/./resource/image/icon/not-verified-icon.svg","webpack://wire-webapp/./resource/image/icon/notification-icon.svg","webpack://wire-webapp/./resource/image/icon/options-icon.svg","webpack://wire-webapp/./resource/image/icon/partner-icon.svg","webpack://wire-webapp/./resource/image/icon/pending-icon.svg","webpack://wire-webapp/./resource/image/icon/people-icon.svg","webpack://wire-webapp/./resource/image/icon/pickup-icon.svg","webpack://wire-webapp/./resource/image/icon/ping-icon.svg","webpack://wire-webapp/./resource/image/icon/plus-icon.svg","webpack://wire-webapp/./resource/image/icon/profile-icon.svg","webpack://wire-webapp/./resource/image/icon/read-icon.svg","webpack://wire-webapp/./resource/image/icon/reply-icon.svg","webpack://wire-webapp/./resource/image/icon/screenshare-icon.svg","webpack://wire-webapp/./resource/image/icon/screenshare-off-icon.svg","webpack://wire-webapp/./resource/image/icon/send-icon.svg","webpack://wire-webapp/./resource/image/icon/service-icon.svg","webpack://wire-webapp/./resource/image/icon/settings-icon.svg","webpack://wire-webapp/./resource/image/icon/speaker-icon.svg","webpack://wire-webapp/./resource/image/icon/timer-icon.svg","webpack://wire-webapp/./resource/image/icon/undo-icon.svg","webpack://wire-webapp/./resource/image/icon/verified-icon.svg","webpack://wire-webapp/./resource/image/icon/watermark-icon.svg","webpack://wire-webapp/./resource/image/icon/ sync .+\\.svg$","webpack://wire-webapp/./resource/image/icon/ sync ^\\.\\/.*$","webpack://wire-webapp/./src/i18n/ sync ^\\.\\/.*\\.json$","webpack://wire-webapp/external var \"{}\""],"sourcesContent":["\"use strict\";\n/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.VerificationActionType = void 0;\nvar VerificationActionType;\n(function (VerificationActionType) {\n    VerificationActionType[\"CREATE_SCIM_TOKEN\"] = \"create_scim_token\";\n    VerificationActionType[\"LOGIN\"] = \"login\";\n    VerificationActionType[\"DELETE_TEAM\"] = \"delete_team\";\n})(VerificationActionType = exports.VerificationActionType || (exports.VerificationActionType = {}));\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ValidationUtil, Runtime} from '@wireapp/commons';\n\nimport {createRandomUuid} from 'Util/util';\nconst env = window.wire.env;\n\nexport const ACCENT_ID = {\n  AMBER: 5,\n  BLUE: 1,\n  GREEN: 2,\n  PURPLE: 7,\n  RED: 4,\n  TURQUOISE: 6,\n};\n\nexport class Configuration {\n  readonly APP_BASE = env.APP_BASE || 'https://app.wire.com';\n  readonly APP_NAME = env.APP_NAME || 'Webapp';\n  readonly APP_INSTANCE_ID = createRandomUuid();\n  readonly BACKEND_NAME = env.BACKEND_NAME || 'Wire';\n  readonly BACKEND_REST = env.BACKEND_REST || 'https://prod-nginz-https.wire.com';\n  readonly BACKEND_WS = env.BACKEND_WS || 'wss://prod-nginz-ssl.wire.com';\n  readonly BRAND_NAME = env.BRAND_NAME || 'Wire';\n  readonly COUNTLY_API_KEY = env.COUNTLY_API_KEY;\n  readonly ENABLE_DEV_BACKEND_API = env.ENABLE_DEV_BACKEND_API;\n  readonly ENVIRONMENT = env.ENVIRONMENT || 'production';\n  readonly FEATURE = {\n    ...env.FEATURE,\n    ENABLE_EXTRA_CLIENT_ENTROPY:\n      env.FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY && (Runtime.isWindows() || env.FEATURE.FORCE_EXTRA_CLIENT_ENTROPY),\n  };\n  readonly MAX_GROUP_PARTICIPANTS = env.MAX_GROUP_PARTICIPANTS || 500;\n  readonly MAX_VIDEO_PARTICIPANTS = env.MAX_VIDEO_PARTICIPANTS || 4;\n  readonly NEW_PASSWORD_MINIMUM_LENGTH = env.NEW_PASSWORD_MINIMUM_LENGTH || ValidationUtil.DEFAULT_PASSWORD_MIN_LENGTH;\n  readonly URL = {\n    ACCOUNT_BASE: 'https://account.wire.com',\n    MOBILE_BASE: '',\n    PRICING: '#',\n    PRIVACY_POLICY: 'https://wire-website-staging.zinfra.io/security',\n    SUPPORT: {\n      BUG_REPORT: 'https://support.wire.com/new?ticket_form_id=101615',\n      CALLING: 'https://support.wire.com/hc/articles/202969412',\n      CAMERA_ACCESS_DENIED: 'https://support.wire.com/hc/articles/202935412',\n      CONTACT: 'https://support.wire.com/new',\n      DEVICE_ACCESS_DENIED: 'https://support.wire.com/hc/articles/213512545',\n      DEVICE_NOT_FOUND: 'https://support.wire.com/hc/articles/202970662',\n      EMAIL_EXISTS: 'https://support.wire.com/hc/articles/115004082129',\n      HISTORY: 'https://support.wire.com/hc/articles/207834645',\n      INDEX: 'https://support.wire.com/',\n      LEGAL_HOLD_BLOCK: '#',\n      MICROPHONE_ACCESS_DENIED: 'https://support.wire.com/hc/articles/202590081',\n      PRIVACY_VERIFY_FINGERPRINT: 'https://support.wire.com/hc/en-us/articles/207692235',\n      SCREEN_ACCESS_DENIED: 'https://support.wire.com/hc/articles/202935412',\n    },\n    TEAMS_BASE: 'https://teams.wire.com',\n    TEAMS_BILLING: 'https://teams.wire.com/billing',\n    TEAMS_CREATE: 'https://wire.com/create-team/?pk_campaign=client&pk_kwd=desktop',\n    TERMS_OF_USE_PERSONAL: 'https://wire-website-staging.zinfra.io/legal/terms/personal',\n    TERMS_OF_USE_TEAMS: 'https://wire-website-staging.zinfra.io/legal/terms/teams',\n    WEBSITE_BASE: 'https://wire.com',\n    WHATS_NEW: 'https://medium.com/wire-news/webapp-updates/home',\n    ...env.URL,\n  };\n  readonly VERSION = env.VERSION || '0.0.0';\n  readonly WEBSITE_LABEL = env.WEBSITE_LABEL;\n\n  /** 25 megabyte upload limit for personal use (private users & guests) */\n  readonly MAXIMUM_ASSET_FILE_SIZE_PERSONAL = 25 * 1024 * 1024;\n\n  /** 100 megabyte upload limit for organizations (team members) */\n  readonly MAXIMUM_ASSET_FILE_SIZE_TEAM = 100 * 1024 * 1024;\n\n  /** 15 megabyte image upload limit */\n  readonly MAXIMUM_IMAGE_FILE_SIZE = 15 * 1024 * 1024;\n\n  /** maximum chars for link preview titles and descriptions */\n  readonly MAXIMUM_LINK_PREVIEW_CHARS = 200;\n\n  /** Maximum characters per sent message */\n  readonly MAXIMUM_MESSAGE_LENGTH = 8000;\n\n  /**\n   * Maximum characters per received message\n   * Encryption is approx. +40% of the original payload so let's round it at +50%\n   */\n  readonly MAXIMUM_MESSAGE_LENGTH_RECEIVING = 12000 * 1.5;\n\n  /** bigger requests will be split in chunks with a maximum size as defined */\n  readonly MAXIMUM_USERS_PER_REQUEST = 200;\n\n  /** number of messages that will be pulled */\n  readonly MESSAGES_FETCH_LIMIT = 30;\n\n  readonly MINIMUM_PASSWORD_LENGTH = 8;\n\n  /** measured in pixel */\n  readonly SCROLL_TO_LAST_MESSAGE_THRESHOLD = 100;\n\n  /** Image MIME types */\n  readonly ALLOWED_IMAGE_TYPES = ['image/bmp', 'image/gif', 'image/jpeg', 'image/jpg', 'image/png'];\n\n  /** Which versions of the backend api do we support */\n  readonly SUPPORTED_API_VERSIONS = [3, 2, 1, 0];\n}\n\nlet instance: Configuration;\n\nconst Config = {\n  getConfig: () => {\n    if (!instance) {\n      instance = new Configuration();\n    }\n    return instance;\n  },\n};\n\nexport {Config};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport interface EncryptedAsset {\n  cipherText: ArrayBuffer;\n  keyBytes: ArrayBuffer;\n  sha256: ArrayBuffer;\n}\n\n/**\n * @param cipherText Encrypted plaintext\n * @param keyBytes AES key used for encryption\n * @param referenceSha256 SHA-256 checksum of the cipherText\n * @returns Resolves with the decrypted asset\n */\nexport const decryptAesAsset = async (\n  cipherText: ArrayBuffer,\n  keyBytes: ArrayBuffer,\n  referenceSha256: ArrayBuffer,\n): Promise<ArrayBuffer> => {\n  const computedSha256 = await window.crypto.subtle.digest('SHA-256', cipherText);\n  if (!equalHashes(referenceSha256, computedSha256)) {\n    throw new Error('Encrypted asset does not match its SHA-256 hash');\n  }\n  const aesKey = await window.crypto.subtle.importKey('raw', keyBytes, 'AES-CBC', false, ['decrypt']);\n  const initializationVector = cipherText.slice(0, 16);\n  const assetCipherText = cipherText.slice(16);\n  return window.crypto.subtle.decrypt({iv: initializationVector, name: 'AES-CBC'}, aesKey, assetCipherText);\n};\n\nexport const encryptAesAsset = async (plaintext: ArrayBuffer): Promise<EncryptedAsset> => {\n  const initializationVector = generateRandomBytes(16);\n  const rawKeyBytes = generateRandomBytes(32);\n  const key = await window.crypto.subtle.importKey('raw', rawKeyBytes.buffer, 'AES-CBC', true, ['encrypt']);\n  const cipherText = await window.crypto.subtle.encrypt(\n    {iv: initializationVector.buffer, name: 'AES-CBC'},\n    key,\n    plaintext,\n  );\n  const ivCipherText = new Uint8Array(cipherText.byteLength + initializationVector.byteLength);\n  ivCipherText.set(initializationVector, 0);\n  ivCipherText.set(new Uint8Array(cipherText), initializationVector.byteLength);\n\n  const digest = await window.crypto.subtle.digest('SHA-256', ivCipherText);\n  const keyBytes = await window.crypto.subtle.exportKey('raw', key);\n\n  return {cipherText: ivCipherText.buffer, keyBytes: keyBytes, sha256: digest};\n};\n\nconst equalHashes = (bufferA: ArrayBuffer, bufferB: ArrayBuffer): boolean => {\n  const arrayA = new Uint32Array(bufferA);\n  const arrayB = new Uint32Array(bufferB);\n  return arrayA.length === arrayB.length && arrayA.every((value, index) => value === arrayB[index]);\n};\n\nconst generateRandomBytes = (length: number): Uint8Array => {\n  const getRandomValue = () => {\n    const buffer = new Uint32Array(1);\n    window.crypto.getRandomValues(buffer);\n    return buffer[0] >>> 0;\n  };\n\n  const randomValues = new Uint32Array(length / 4).map(getRandomValue);\n  const randomBytes = new Uint8Array(randomValues.buffer);\n  if (randomBytes.length && !randomBytes.every(byte => byte === 0)) {\n    return randomBytes;\n  }\n  throw new Error('Failed to initialize initialization vector with random values');\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nexport type AssetUrlData = AssetUrlDataVersion1 | AssetUrlDataVersion2 | AssetUrlDataVersion3 | AssetUrlDataVersion4;\n\nexport interface AssetUrlDataVersion3 {\n  assetKey: string;\n  assetToken: string;\n  forceCaching: boolean;\n  version: 3;\n}\nexport interface AssetUrlDataVersion4 extends Omit<AssetUrlDataVersion3, 'version'> {\n  assetDomain: string;\n  version: 4;\n}\n\nexport interface AssetUrlDataVersion2 {\n  assetId: string;\n  conversationId: string;\n  forceCaching: boolean;\n  version: 2;\n}\n\nexport interface AssetUrlDataVersion1 {\n  assetId: string;\n  conversationId: string;\n  forceCaching: boolean;\n  version: 1;\n}\n\nexport class AssetRemoteData {\n  public cancelDownload: () => void;\n  public readonly downloadProgress: ko.Observable<number>;\n\n  constructor(\n    public readonly identifier: string,\n    public readonly urlData: AssetUrlData,\n    public readonly otrKey?: Uint8Array,\n    public readonly sha256?: Uint8Array,\n  ) {\n    this.downloadProgress = ko.observable(0);\n    this.cancelDownload = () => {};\n  }\n\n  /**\n   * Will generate a v3 or v4 (depending on the given domain) asset payload.\n   * Assets v3 and v4 only differ by the domain, so it doesn't make sense to split those into 2 different methods\n   */\n  static v3(\n    assetKey: string,\n    assetDomain?: string,\n    otrKey?: Uint8Array,\n    sha256?: Uint8Array,\n    assetToken?: string,\n    forceCaching: boolean = false,\n  ) {\n    const baseProperties: AssetUrlDataVersion3 = {\n      assetKey,\n      assetToken,\n      forceCaching,\n      version: 3,\n    };\n    const urlData = assetDomain\n      ? ({\n          ...baseProperties,\n          assetDomain,\n          version: 4,\n        } as AssetUrlDataVersion4)\n      : baseProperties;\n    return new AssetRemoteData(assetKey, urlData, otrKey, sha256);\n  }\n\n  static v2(\n    conversationId: string,\n    assetId: string,\n    otrKey: Uint8Array,\n    sha256: Uint8Array,\n    forceCaching: boolean = false,\n  ) {\n    return new AssetRemoteData(\n      `${conversationId}${assetId}`,\n      {\n        assetId,\n        conversationId,\n        forceCaching,\n        version: 2,\n      },\n      otrKey,\n      sha256,\n    );\n  }\n\n  static v1(conversationId: string, assetId: string, forceCaching: boolean = false) {\n    return new AssetRemoteData(`${conversationId}${assetId}`, {\n      assetId,\n      conversationId,\n      forceCaching,\n      version: 1,\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nconst cache = new Map<string, string>();\n\nexport const getAssetUrl = (identifier: string): string | undefined => cache.get(identifier);\n\nexport const setAssetUrl = (identifier: string, url: string) => {\n  const isExistingUrl = getAssetUrl(identifier);\n\n  if (!isExistingUrl) {\n    cache.set(identifier, url);\n  }\n\n  return url;\n};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AssetOptions, AssetRetentionPolicy} from '@wireapp/api-client/lib/asset/';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\nimport ko from 'knockout';\nimport {container, singleton} from 'tsyringe';\n\nimport {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport {getLogger, Logger} from 'Util/Logger';\nimport {downloadBlob, loadFileBuffer, loadImage} from 'Util/util';\nimport {WebWorker} from 'Util/worker';\n\nimport {decryptAesAsset} from './AssetCrypto';\nimport {AssetRemoteData} from './AssetRemoteData';\nimport {AssetService} from './AssetService';\nimport {AssetTransferState} from './AssetTransferState';\nimport {getAssetUrl, setAssetUrl} from './AssetURLCache';\n\nimport {Conversation} from '../entity/Conversation';\nimport {FileAsset} from '../entity/message/FileAsset';\nimport type {User} from '../entity/User';\nimport {Core} from '../service/CoreSingleton';\n\nexport interface CompressedImage {\n  compressedBytes: Uint8Array;\n  compressedImage: HTMLImageElement;\n}\n\nexport interface AssetUploadOptions extends AssetOptions {\n  domain?: string;\n  expectsReadConfirmation: boolean;\n  legalHoldStatus?: LegalHoldStatus;\n}\n\nexport interface UploadStatus {\n  messageId: string;\n  progress: ko.Observable<number>;\n}\n\n@singleton()\nexport class AssetRepository {\n  readonly uploadProgressQueue: ko.ObservableArray<UploadStatus> = ko.observableArray();\n  readonly uploadCancelTokens: {[messageId: string]: () => void} = {};\n  logger: Logger;\n\n  constructor(\n    private readonly assetService = container.resolve(AssetService),\n    private readonly core = container.resolve(Core),\n  ) {\n    this.logger = getLogger('AssetRepository');\n  }\n\n  get assetCoreService() {\n    return this.core.service!.asset;\n  }\n\n  async getObjectUrl(asset: AssetRemoteData): Promise<string | undefined> {\n    const objectUrl = getAssetUrl(asset.identifier);\n    if (objectUrl) {\n      return objectUrl;\n    }\n\n    const blob = await this.load(asset);\n    if (!blob) {\n      return undefined;\n    }\n    const url = window.URL.createObjectURL(blob);\n    return setAssetUrl(asset.identifier, url);\n  }\n\n  public async load(asset: AssetRemoteData): Promise<undefined | Blob> {\n    try {\n      let plaintext: ArrayBuffer;\n      const {buffer, mimeType} = await this.loadBuffer(asset);\n      const isEncryptedAsset = !!asset.otrKey && !!asset.sha256;\n\n      if (isEncryptedAsset) {\n        const otrKey = asset.otrKey instanceof Uint8Array ? asset.otrKey : Uint8Array.from(Object.values(asset.otrKey));\n        const sha256 = asset.sha256 instanceof Uint8Array ? asset.sha256 : Uint8Array.from(Object.values(asset.sha256));\n        plaintext = await decryptAesAsset(buffer, otrKey.buffer, sha256.buffer);\n      } else {\n        plaintext = buffer;\n      }\n      return new Blob([new Uint8Array(plaintext)], {type: mimeType});\n    } catch (error) {\n      if (error instanceof Error) {\n        const isAssetNotFound = error.message.endsWith(HTTP_STATUS.NOT_FOUND.toString());\n        const isServerError = error.message.endsWith(HTTP_STATUS.INTERNAL_SERVER_ERROR.toString());\n\n        const isExpectedError = isAssetNotFound || isServerError;\n\n        if (!isExpectedError) {\n          throw error;\n        }\n      }\n      return undefined;\n    }\n  }\n\n  public generateAssetUrl(asset: AssetRemoteData) {\n    switch (asset.urlData.version) {\n      case 3:\n        return this.assetService.generateAssetUrlV3(\n          asset.urlData.assetKey,\n          asset.urlData.assetToken,\n          asset.urlData.forceCaching,\n        );\n      case 2:\n        return this.assetService.generateAssetUrlV2(\n          asset.urlData.assetId,\n          asset.urlData.conversationId,\n          asset.urlData.forceCaching,\n        );\n      case 1:\n        return this.assetService.generateAssetUrl(\n          asset.urlData.assetId,\n          asset.urlData.conversationId,\n          asset.urlData.forceCaching,\n        );\n      default:\n        throw Error('Cannot map URL data.');\n    }\n  }\n\n  private loadBuffer(asset: AssetRemoteData) {\n    const request = this.core.service!.asset.downloadAsset(asset.urlData, fraction => {\n      asset.downloadProgress(fraction * 100);\n    });\n    asset.cancelDownload = request.cancel;\n    return request.response;\n  }\n\n  public async download(asset: AssetRemoteData, fileName: string) {\n    try {\n      const blob = await this.load(asset);\n      if (!blob) {\n        throw new Error('No blob received.');\n      }\n      return downloadBlob(blob, fileName);\n    } catch (error) {\n      return this.logger.error('Failed to download blob', error);\n    }\n  }\n\n  public async downloadFile(asset: FileAsset) {\n    try {\n      asset.status(AssetTransferState.DOWNLOADING);\n      const blob = await this.load(asset.original_resource());\n      if (!blob) {\n        throw new Error('No blob received.');\n      }\n      asset.status(AssetTransferState.UPLOADED);\n      return downloadBlob(blob, asset.file_name);\n    } catch (error) {\n      if (error instanceof Error) {\n        if (error.message.endsWith('Encrypted asset does not match its SHA-256 hash')) {\n          asset.status(AssetTransferState.DOWNLOAD_FAILED_HASH);\n        } else {\n          asset.status(AssetTransferState.DOWNLOAD_FAILED_DECRPYT);\n        }\n      }\n      return this.logger.error('Failed to download FileAsset blob', error);\n    }\n  }\n\n  async uploadProfileImage(image: Blob): Promise<{\n    mediumImageKey: {domain?: string; key: string};\n    previewImageKey: {domain?: string; key: string};\n  }> {\n    const [{compressedBytes: previewImage}, {compressedBytes: mediumImage}] = await Promise.all([\n      this.compressImage(image),\n      this.compressImage(image, true),\n    ]);\n\n    const options: AssetUploadOptions = {\n      expectsReadConfirmation: false,\n      public: true,\n      retention: AssetRetentionPolicy.ETERNAL,\n    };\n\n    const [previewImageKey, mediumImageKey] = await Promise.all([\n      this.assetCoreService.uploadRawAsset(previewImage, options).response,\n      this.assetCoreService.uploadRawAsset(mediumImage, options).response,\n    ]);\n\n    return {mediumImageKey, previewImageKey};\n  }\n\n  private async compressImage(image: Blob, useProfileImageSize: boolean = false): Promise<CompressedImage> {\n    const skipCompression = image.type === 'image/gif';\n    const buffer = await loadFileBuffer(image);\n    let compressedBytes: ArrayBuffer;\n    if (skipCompression === true) {\n      compressedBytes = new Uint8Array(buffer as ArrayBuffer);\n    } else {\n      const worker = new WebWorker('/worker/image-worker.js');\n      compressedBytes = await worker.post({buffer, useProfileImageSize});\n    }\n    const compressedImage = await loadImage(new Blob([compressedBytes], {type: image.type}));\n    return {\n      compressedBytes: new Uint8Array(compressedBytes),\n      compressedImage,\n    };\n  }\n\n  getAssetRetention(userEntity: User, conversationEntity: Conversation): AssetRetentionPolicy {\n    const isTeamMember = userEntity.inTeam();\n    const isTeamConversation = conversationEntity.inTeam();\n    const isTeamUserInConversation = conversationEntity\n      .participating_user_ets()\n      .some(conversationParticipant => conversationParticipant.inTeam());\n\n    const isEternalInfrequentAccess = isTeamMember || isTeamConversation || isTeamUserInConversation;\n    return isEternalInfrequentAccess ? AssetRetentionPolicy.ETERNAL_INFREQUENT_ACCESS : AssetRetentionPolicy.EXPIRING;\n  }\n\n  /**\n   * Uploads a file to the backend\n   *\n   * @param file The raw content of the file to upload\n   * @param messageId The message the file is associated with\n   * @param options\n   * @param onCancel? Will be called if the upload has been canceled\n   */\n  async uploadFile(file: Blob, messageId: string, options: AssetUploadOptions, onCancel?: () => void) {\n    const bytes = await loadFileBuffer(file);\n    const progressObservable = ko.observable(0);\n    this.uploadProgressQueue.push({messageId, progress: progressObservable});\n\n    const request = await this.assetCoreService.uploadAsset(\n      Buffer.from(bytes),\n      {\n        domain: options.domain,\n        public: options.public,\n        retention: options.retention,\n      },\n      fraction => {\n        const percentage = fraction * 100;\n        progressObservable(percentage);\n      },\n    );\n    this.uploadCancelTokens[messageId] = () => {\n      request.cancel();\n      onCancel?.();\n    };\n\n    const response = await request.response;\n    this.removeFromUploadQueue(messageId);\n    return response;\n  }\n\n  cancelUpload(messageId: string): void {\n    const cancelToken = this.uploadCancelTokens[messageId];\n    if (cancelToken) {\n      cancelToken();\n      this.removeFromUploadQueue(messageId);\n    }\n  }\n\n  getNumberOfOngoingUploads(): number {\n    return this.uploadProgressQueue().length;\n  }\n\n  getUploadProgress(messageId: string): ko.PureComputed<number> {\n    return ko.pureComputed(() => this.findUploadStatus(messageId)?.progress() ?? -1);\n  }\n\n  private findUploadStatus(messageId: string): UploadStatus {\n    return this.uploadProgressQueue().find(upload => upload.messageId === messageId);\n  }\n\n  private removeFromUploadQueue(messageId: string): void {\n    this.uploadProgressQueue(this.uploadProgressQueue().filter(upload => upload.messageId !== messageId));\n    delete this.uploadCancelTokens[messageId];\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ProgressCallback} from '@wireapp/api-client/lib/http/';\nimport {singleton, container} from 'tsyringe';\n\nimport {legacyAsset, assetV3, isValidApiPath} from 'Util/ValidationUtil';\n\nimport {APIClient} from '../service/APIClientSingleton';\n\n@singleton()\nexport class AssetService {\n  constructor(private readonly apiClient = container.resolve(APIClient)) {}\n\n  async generateAssetUrl(assetId: string, conversationId: string, forceCaching: boolean): Promise<string> {\n    legacyAsset(assetId, conversationId);\n\n    const path = `/assets/${assetId}`;\n    isValidApiPath(path);\n\n    const url = `${this.apiClient.config.urls.rest}${path}`;\n    const cachingParam = forceCaching ? '&forceCaching=true' : '';\n    const conversationIdParam = `&conv_id=${encodeURIComponent(conversationId)}`;\n    return `${url}?access_token=${this.apiClient['accessTokenStore'].accessToken?.access_token}${conversationIdParam}${cachingParam}`;\n  }\n\n  async generateAssetUrlV2(assetId: string, conversationId: string, forceCaching: boolean): Promise<string> {\n    legacyAsset(assetId, conversationId);\n\n    const path = `/conversations/${conversationId}/otr/assets/${assetId}`;\n    isValidApiPath(path);\n\n    const url = `${this.apiClient.config.urls.rest}${path}`;\n    const cachingParam = forceCaching ? '&forceCaching=true' : '';\n    return `${url}?access_token=${this.apiClient['accessTokenStore'].accessToken?.access_token}${cachingParam}`;\n  }\n\n  async generateAssetUrlV3(assetKey: string, assetToken: string, forceCaching: boolean): Promise<string> {\n    assetV3(assetKey, assetToken);\n\n    const path = `/assets/v3/${assetKey}`;\n    isValidApiPath(path);\n\n    const url = `${this.apiClient.config.urls.rest}${path}`;\n    const assetTokenParam = assetToken ? `&asset_token=${encodeURIComponent(assetToken)}` : '';\n    const cachingParam = forceCaching ? '&forceCaching=true' : '';\n    return `${url}?access_token=${this.apiClient['accessTokenStore'].accessToken?.access_token}${assetTokenParam}${cachingParam}`;\n  }\n\n  async downloadAssetV1(\n    assetId: string,\n    conversationId: string,\n    forceCaching?: boolean,\n    progressCallback?: ProgressCallback,\n  ) {\n    return this.apiClient.api.asset.getAssetV1(assetId, conversationId, forceCaching, progressCallback);\n  }\n\n  async downloadAssetV2(\n    assetId: string,\n    conversationId: string,\n    forceCaching?: boolean,\n    progressCallback?: ProgressCallback,\n  ) {\n    return this.apiClient.api.asset.getAssetV2(assetId, conversationId, forceCaching, progressCallback);\n  }\n\n  async downloadAssetV3(assetId: string, token?: string, forceCaching?: boolean, progressCallback?: ProgressCallback) {\n    return this.apiClient.api.asset.getAssetV3(assetId, token, forceCaching, progressCallback);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AssetTransferState {\n  DOWNLOADING = 'downloading',\n  UPLOAD_FAILED = 'upload-failed',\n  UPLOAD_PENDING = 'upload-pending',\n  UPLOADED = 'uploaded',\n  UPLOADING = 'uploading',\n  DOWNLOAD_FAILED_DECRPYT = 'download-failed-decrypt',\n  DOWNLOAD_FAILED_HASH = 'download-failed-hash',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AssetType {\n  BUTTON = 'Button',\n  FILE = 'File',\n  IMAGE = 'Image',\n  LOCATION = 'Location',\n  TEXT = 'Text',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum SIGN_OUT_REASON {\n  ACCOUNT_DELETED = 'deleted',\n  APP_INIT = 'app_init',\n  CLIENT_REMOVED = 'client_removed',\n  INDEXED_DB = 'indexedDb',\n  MULTIPLE_TABS = 'multiple_tabs',\n  NO_APP_CONFIG = 'no_app_config',\n  NOT_SIGNED_IN = 'not_signed_in',\n  SESSION_EXPIRED = 'expired',\n  USER_REQUESTED = 'user_requested',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n// TODO: Deprecated. Should be replaced with \"QUERY_KEY\" from \"src/script/auth/route.ts\"\nexport enum URLParameter {\n  ENVIRONMENT = 'env',\n  LOCALE = 'hl',\n  MODE = 'mode',\n  REASON = 'reason',\n  TRACKING = 'tracking',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport const supportedLocales: string[] = [\n  'cs-CZ',\n  'da-DK',\n  'de-DE',\n  'el-GR',\n  'en-US',\n  'es-ES',\n  'et-EE',\n  'fi-FI',\n  'fr-FR',\n  'hr-HR',\n  'hu-HU',\n  'it-IT',\n  'lt-LT',\n  'nl-NL',\n  'pl-PL',\n  'pt-PT',\n  'ro-RO',\n  'ru-RU',\n  'sk-SK',\n  'sl-SI',\n  'tr-TR',\n  'uk-UA',\n];\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {SupportedCurrency} from '@wireapp/api-client/lib/team/payment/';\n\nimport {UrlUtil} from '@wireapp/commons';\n\nimport {QUERY_KEY} from './route';\nimport {supportedLocales as Locales} from './supportedLocales';\n\nexport const DEFAULT_CURRENCY = SupportedCurrency.EUR;\nexport const DEFAULT_LANGUAGE = 'en-US';\n\nfunction getLocale(): string {\n  return mapLanguage(navigator.languages?.length ? navigator.languages[0] : navigator.language);\n}\n\nexport function currentLanguage(): string {\n  return mapLanguage(UrlUtil.getURLParameter(QUERY_KEY.LANGUAGE) || getLocale());\n}\n\nexport function currentCurrency(): SupportedCurrency {\n  return (UrlUtil.getURLParameter(QUERY_KEY.CURRENCY).toUpperCase() as SupportedCurrency) || DEFAULT_CURRENCY;\n}\n\nexport function normalizeLanguage(language: string = DEFAULT_LANGUAGE): string {\n  const LANGUAGE_SHORTHAND_LENGTH = 2;\n  return language.substring(0, LANGUAGE_SHORTHAND_LENGTH);\n}\n\nexport function findLanguage(language: string = DEFAULT_LANGUAGE): string {\n  language = normalizeLanguage(language);\n  return Locales.find(locale => locale.startsWith(language));\n}\n\nexport function mapLanguage(language: string = DEFAULT_LANGUAGE): string {\n  return findLanguage(language) || DEFAULT_LANGUAGE;\n}\n","// Default to a dummy \"batch\" implementation that just runs the callback\nfunction defaultNoopBatch(callback) {\n  callback();\n}\n\nlet batch = defaultNoopBatch; // Allow injecting another batching function later\n\nexport const setBatch = newBatch => batch = newBatch; // Supply a getter just to skip dealing with ESM bindings\n\nexport const getBatch = () => batch;","import { createContext } from 'react';\nexport const ReactReduxContext = /*#__PURE__*/createContext(null);\n\nif (process.env.NODE_ENV !== 'production') {\n  ReactReduxContext.displayName = 'ReactRedux';\n}\n\nexport default ReactReduxContext;","import { useContext, useDebugValue } from 'react';\nimport { useReduxContext as useDefaultReduxContext } from './useReduxContext';\nimport { ReactReduxContext } from '../components/Context';\nimport { notInitialized } from '../utils/useSyncExternalStore';\nlet useSyncExternalStoreWithSelector = notInitialized;\nexport const initializeUseSelector = fn => {\n  useSyncExternalStoreWithSelector = fn;\n};\n\nconst refEquality = (a, b) => a === b;\n/**\r\n * Hook factory, which creates a `useSelector` hook bound to a given context.\r\n *\r\n * @param {React.Context} [context=ReactReduxContext] Context passed to your `<Provider>`.\r\n * @returns {Function} A `useSelector` hook bound to the specified context.\r\n */\n\n\nexport function createSelectorHook(context = ReactReduxContext) {\n  const useReduxContext = context === ReactReduxContext ? useDefaultReduxContext : () => useContext(context);\n  return function useSelector(selector, equalityFn = refEquality) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (!selector) {\n        throw new Error(`You must pass a selector to useSelector`);\n      }\n\n      if (typeof selector !== 'function') {\n        throw new Error(`You must pass a function as a selector to useSelector`);\n      }\n\n      if (typeof equalityFn !== 'function') {\n        throw new Error(`You must pass a function as an equality function to useSelector`);\n      }\n    }\n\n    const {\n      store,\n      subscription,\n      getServerState\n    } = useReduxContext();\n    const selectedState = useSyncExternalStoreWithSelector(subscription.addNestedSub, store.getState, getServerState || store.getState, selector, equalityFn);\n    useDebugValue(selectedState);\n    return selectedState;\n  };\n}\n/**\r\n * A hook to access the redux store's state. This hook takes a selector function\r\n * as an argument. The selector is called with the store state.\r\n *\r\n * This hook takes an optional equality comparison function as the second parameter\r\n * that allows you to customize the way the selected state is compared to determine\r\n * whether the component needs to be re-rendered.\r\n *\r\n * @param {Function} selector the selector function\r\n * @param {Function=} equalityFn the function that will be used to determine equality\r\n *\r\n * @returns {any} the selected state\r\n *\r\n * @example\r\n *\r\n * import React from 'react'\r\n * import { useSelector } from 'react-redux'\r\n *\r\n * export const CounterComponent = () => {\r\n *   const counter = useSelector(state => state.counter)\r\n *   return <div>{counter}</div>\r\n * }\r\n */\n\nexport const useSelector = /*#__PURE__*/createSelectorHook();","import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"initMapStateToProps\", \"initMapDispatchToProps\", \"initMergeProps\"];\nimport verifySubselectors from './verifySubselectors';\nexport function pureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, {\n  areStatesEqual,\n  areOwnPropsEqual,\n  areStatePropsEqual\n}) {\n  let hasRunAtLeastOnce = false;\n  let state;\n  let ownProps;\n  let stateProps;\n  let dispatchProps;\n  let mergedProps;\n\n  function handleFirstCall(firstState, firstOwnProps) {\n    state = firstState;\n    ownProps = firstOwnProps;\n    stateProps = mapStateToProps(state, ownProps);\n    dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    hasRunAtLeastOnce = true;\n    return mergedProps;\n  }\n\n  function handleNewPropsAndNewState() {\n    stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewProps() {\n    if (mapStateToProps.dependsOnOwnProps) stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewState() {\n    const nextStateProps = mapStateToProps(state, ownProps);\n    const statePropsChanged = !areStatePropsEqual(nextStateProps, stateProps);\n    stateProps = nextStateProps;\n    if (statePropsChanged) mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleSubsequentCalls(nextState, nextOwnProps) {\n    const propsChanged = !areOwnPropsEqual(nextOwnProps, ownProps);\n    const stateChanged = !areStatesEqual(nextState, state, nextOwnProps, ownProps);\n    state = nextState;\n    ownProps = nextOwnProps;\n    if (propsChanged && stateChanged) return handleNewPropsAndNewState();\n    if (propsChanged) return handleNewProps();\n    if (stateChanged) return handleNewState();\n    return mergedProps;\n  }\n\n  return function pureFinalPropsSelector(nextState, nextOwnProps) {\n    return hasRunAtLeastOnce ? handleSubsequentCalls(nextState, nextOwnProps) : handleFirstCall(nextState, nextOwnProps);\n  };\n}\n// TODO: Add more comments\n// The selector returned by selectorFactory will memoize its results,\n// allowing connect's shouldComponentUpdate to return false if final\n// props have not changed.\nexport default function finalPropsSelectorFactory(dispatch, _ref) {\n  let {\n    initMapStateToProps,\n    initMapDispatchToProps,\n    initMergeProps\n  } = _ref,\n      options = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  const mapStateToProps = initMapStateToProps(dispatch, options);\n  const mapDispatchToProps = initMapDispatchToProps(dispatch, options);\n  const mergeProps = initMergeProps(dispatch, options);\n\n  if (process.env.NODE_ENV !== 'production') {\n    verifySubselectors(mapStateToProps, mapDispatchToProps, mergeProps);\n  }\n\n  return pureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, options);\n}","import verifyPlainObject from '../utils/verifyPlainObject';\nexport function wrapMapToPropsConstant( // * Note:\n//  It seems that the dispatch argument\n//  could be a dispatch function in some cases (ex: whenMapDispatchToPropsIsMissing)\n//  and a state object in some others (ex: whenMapStateToPropsIsMissing)\n// eslint-disable-next-line no-unused-vars\ngetConstant) {\n  return function initConstantSelector(dispatch) {\n    const constant = getConstant(dispatch);\n\n    function constantSelector() {\n      return constant;\n    }\n\n    constantSelector.dependsOnOwnProps = false;\n    return constantSelector;\n  };\n} // dependsOnOwnProps is used by createMapToPropsProxy to determine whether to pass props as args\n// to the mapToProps function being wrapped. It is also used by makePurePropsSelector to determine\n// whether mapToProps needs to be invoked when props have changed.\n//\n// A length of one signals that mapToProps does not depend on props from the parent component.\n// A length of zero is assumed to mean mapToProps is getting args via arguments or ...args and\n// therefore not reporting its length accurately..\n// TODO Can this get pulled out so that we can subscribe directly to the store if we don't need ownProps?\n\nexport function getDependsOnOwnProps(mapToProps) {\n  return mapToProps.dependsOnOwnProps ? Boolean(mapToProps.dependsOnOwnProps) : mapToProps.length !== 1;\n} // Used by whenMapStateToPropsIsFunction and whenMapDispatchToPropsIsFunction,\n// this function wraps mapToProps in a proxy function which does several things:\n//\n//  * Detects whether the mapToProps function being called depends on props, which\n//    is used by selectorFactory to decide if it should reinvoke on props changes.\n//\n//  * On first call, handles mapToProps if returns another function, and treats that\n//    new function as the true mapToProps for subsequent calls.\n//\n//  * On first call, verifies the first result is a plain object, in order to warn\n//    the developer that their mapToProps function is not returning a valid result.\n//\n\nexport function wrapMapToPropsFunc(mapToProps, methodName) {\n  return function initProxySelector(dispatch, {\n    displayName\n  }) {\n    const proxy = function mapToPropsProxy(stateOrDispatch, ownProps) {\n      return proxy.dependsOnOwnProps ? proxy.mapToProps(stateOrDispatch, ownProps) : proxy.mapToProps(stateOrDispatch, undefined);\n    }; // allow detectFactoryAndVerify to get ownProps\n\n\n    proxy.dependsOnOwnProps = true;\n\n    proxy.mapToProps = function detectFactoryAndVerify(stateOrDispatch, ownProps) {\n      proxy.mapToProps = mapToProps;\n      proxy.dependsOnOwnProps = getDependsOnOwnProps(mapToProps);\n      let props = proxy(stateOrDispatch, ownProps);\n\n      if (typeof props === 'function') {\n        proxy.mapToProps = props;\n        proxy.dependsOnOwnProps = getDependsOnOwnProps(props);\n        props = proxy(stateOrDispatch, ownProps);\n      }\n\n      if (process.env.NODE_ENV !== 'production') verifyPlainObject(props, displayName, methodName);\n      return props;\n    };\n\n    return proxy;\n  };\n}","export function createInvalidArgFactory(arg, name) {\n  return (dispatch, options) => {\n    throw new Error(`Invalid value of type ${typeof arg} for ${name} argument when connecting component ${options.wrappedComponentName}.`);\n  };\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport verifyPlainObject from '../utils/verifyPlainObject';\nimport { createInvalidArgFactory } from './invalidArgFactory';\nexport function defaultMergeProps(stateProps, dispatchProps, ownProps) {\n  // @ts-ignore\n  return _extends({}, ownProps, stateProps, dispatchProps);\n}\nexport function wrapMergePropsFunc(mergeProps) {\n  return function initMergePropsProxy(dispatch, {\n    displayName,\n    areMergedPropsEqual\n  }) {\n    let hasRunOnce = false;\n    let mergedProps;\n    return function mergePropsProxy(stateProps, dispatchProps, ownProps) {\n      const nextMergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n\n      if (hasRunOnce) {\n        if (!areMergedPropsEqual(nextMergedProps, mergedProps)) mergedProps = nextMergedProps;\n      } else {\n        hasRunOnce = true;\n        mergedProps = nextMergedProps;\n        if (process.env.NODE_ENV !== 'production') verifyPlainObject(mergedProps, displayName, 'mergeProps');\n      }\n\n      return mergedProps;\n    };\n  };\n}\nexport function mergePropsFactory(mergeProps) {\n  return !mergeProps ? () => defaultMergeProps : typeof mergeProps === 'function' ? wrapMergePropsFunc(mergeProps) : createInvalidArgFactory(mergeProps, 'mergeProps');\n}","import { getBatch } from './batch'; // encapsulates the subscription logic for connecting a component to the redux store, as\n// well as nesting subscriptions of descendant components, so that we can ensure the\n// ancestor components re-render before descendants\n\nfunction createListenerCollection() {\n  const batch = getBatch();\n  let first = null;\n  let last = null;\n  return {\n    clear() {\n      first = null;\n      last = null;\n    },\n\n    notify() {\n      batch(() => {\n        let listener = first;\n\n        while (listener) {\n          listener.callback();\n          listener = listener.next;\n        }\n      });\n    },\n\n    get() {\n      let listeners = [];\n      let listener = first;\n\n      while (listener) {\n        listeners.push(listener);\n        listener = listener.next;\n      }\n\n      return listeners;\n    },\n\n    subscribe(callback) {\n      let isSubscribed = true;\n      let listener = last = {\n        callback,\n        next: null,\n        prev: last\n      };\n\n      if (listener.prev) {\n        listener.prev.next = listener;\n      } else {\n        first = listener;\n      }\n\n      return function unsubscribe() {\n        if (!isSubscribed || first === null) return;\n        isSubscribed = false;\n\n        if (listener.next) {\n          listener.next.prev = listener.prev;\n        } else {\n          last = listener.prev;\n        }\n\n        if (listener.prev) {\n          listener.prev.next = listener.next;\n        } else {\n          first = listener.next;\n        }\n      };\n    }\n\n  };\n}\n\nconst nullListeners = {\n  notify() {},\n\n  get: () => []\n};\nexport function createSubscription(store, parentSub) {\n  let unsubscribe;\n  let listeners = nullListeners;\n\n  function addNestedSub(listener) {\n    trySubscribe();\n    return listeners.subscribe(listener);\n  }\n\n  function notifyNestedSubs() {\n    listeners.notify();\n  }\n\n  function handleChangeWrapper() {\n    if (subscription.onStateChange) {\n      subscription.onStateChange();\n    }\n  }\n\n  function isSubscribed() {\n    return Boolean(unsubscribe);\n  }\n\n  function trySubscribe() {\n    if (!unsubscribe) {\n      unsubscribe = parentSub ? parentSub.addNestedSub(handleChangeWrapper) : store.subscribe(handleChangeWrapper);\n      listeners = createListenerCollection();\n    }\n  }\n\n  function tryUnsubscribe() {\n    if (unsubscribe) {\n      unsubscribe();\n      unsubscribe = undefined;\n      listeners.clear();\n      listeners = nullListeners;\n    }\n  }\n\n  const subscription = {\n    addNestedSub,\n    notifyNestedSubs,\n    handleChangeWrapper,\n    isSubscribed,\n    trySubscribe,\n    tryUnsubscribe,\n    getListeners: () => listeners\n  };\n  return subscription;\n}","import { useEffect, useLayoutEffect } from 'react'; // React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser. We need useLayoutEffect to ensure the store\n// subscription callback always has the selector from the latest render commit\n// available, otherwise a store update may happen between render and the effect,\n// which may cause missed updates; we also must ensure the store subscription\n// is created synchronously, otherwise a store update may occur before the\n// subscription is created and an inconsistent state may be observed\n// Matches logic in React's `shared/ExecutionEnvironment` file\n\nexport const canUseDOM = !!(typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined');\nexport const useIsomorphicLayoutEffect = canUseDOM ? useLayoutEffect : useEffect;","function is(x, y) {\n  if (x === y) {\n    return x !== 0 || y !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\n\nexport default function shallowEqual(objA, objB) {\n  if (is(objA, objB)) return true;\n\n  if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n  if (keysA.length !== keysB.length) return false;\n\n  for (let i = 0; i < keysA.length; i++) {\n    if (!Object.prototype.hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\n      return false;\n    }\n  }\n\n  return true;\n}","export const notInitialized = () => {\n  throw new Error('uSES not initialized!');\n};","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"reactReduxForwardedRef\"];\n\n/* eslint-disable valid-jsdoc, @typescript-eslint/no-unused-vars */\nimport hoistStatics from 'hoist-non-react-statics';\nimport React, { useContext, useMemo, useRef } from 'react';\nimport { isValidElementType, isContextConsumer } from 'react-is';\nimport defaultSelectorFactory from '../connect/selectorFactory';\nimport { mapDispatchToPropsFactory } from '../connect/mapDispatchToProps';\nimport { mapStateToPropsFactory } from '../connect/mapStateToProps';\nimport { mergePropsFactory } from '../connect/mergeProps';\nimport { createSubscription } from '../utils/Subscription';\nimport { useIsomorphicLayoutEffect } from '../utils/useIsomorphicLayoutEffect';\nimport shallowEqual from '../utils/shallowEqual';\nimport warning from '../utils/warning';\nimport { ReactReduxContext } from './Context';\nimport { notInitialized } from '../utils/useSyncExternalStore';\nlet useSyncExternalStore = notInitialized;\nexport const initializeConnect = fn => {\n  useSyncExternalStore = fn;\n}; // Define some constant arrays just to avoid re-creating these\n\nconst EMPTY_ARRAY = [null, 0];\nconst NO_SUBSCRIPTION_ARRAY = [null, null]; // Attempts to stringify whatever not-really-a-component value we were given\n// for logging in an error message\n\nconst stringifyComponent = Comp => {\n  try {\n    return JSON.stringify(Comp);\n  } catch (err) {\n    return String(Comp);\n  }\n};\n\n// This is \"just\" a `useLayoutEffect`, but with two modifications:\n// - we need to fall back to `useEffect` in SSR to avoid annoying warnings\n// - we extract this to a separate function to avoid closing over values\n//   and causing memory leaks\nfunction useIsomorphicLayoutEffectWithArgs(effectFunc, effectArgs, dependencies) {\n  useIsomorphicLayoutEffect(() => effectFunc(...effectArgs), dependencies);\n} // Effect callback, extracted: assign the latest props values to refs for later usage\n\n\nfunction captureWrapperProps(lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, // actualChildProps: unknown,\nchildPropsFromStoreUpdate, notifyNestedSubs) {\n  // We want to capture the wrapper props and child props we used for later comparisons\n  lastWrapperProps.current = wrapperProps;\n  renderIsScheduled.current = false; // If the render was from a store update, clear out that reference and cascade the subscriber update\n\n  if (childPropsFromStoreUpdate.current) {\n    childPropsFromStoreUpdate.current = null;\n    notifyNestedSubs();\n  }\n} // Effect callback, extracted: subscribe to the Redux store or nearest connected ancestor,\n// check for updates after dispatched actions, and trigger re-renders.\n\n\nfunction subscribeUpdates(shouldHandleStateChanges, store, subscription, childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, isMounted, childPropsFromStoreUpdate, notifyNestedSubs, // forceComponentUpdateDispatch: React.Dispatch<any>,\nadditionalSubscribeListener) {\n  // If we're not subscribed to the store, nothing to do here\n  if (!shouldHandleStateChanges) return () => {}; // Capture values for checking if and when this component unmounts\n\n  let didUnsubscribe = false;\n  let lastThrownError = null; // We'll run this callback every time a store subscription update propagates to this component\n\n  const checkForUpdates = () => {\n    if (didUnsubscribe || !isMounted.current) {\n      // Don't run stale listeners.\n      // Redux doesn't guarantee unsubscriptions happen until next dispatch.\n      return;\n    } // TODO We're currently calling getState ourselves here, rather than letting `uSES` do it\n\n\n    const latestStoreState = store.getState();\n    let newChildProps, error;\n\n    try {\n      // Actually run the selector with the most recent store state and wrapper props\n      // to determine what the child props should be\n      newChildProps = childPropsSelector(latestStoreState, lastWrapperProps.current);\n    } catch (e) {\n      error = e;\n      lastThrownError = e;\n    }\n\n    if (!error) {\n      lastThrownError = null;\n    } // If the child props haven't changed, nothing to do here - cascade the subscription update\n\n\n    if (newChildProps === lastChildProps.current) {\n      if (!renderIsScheduled.current) {\n        notifyNestedSubs();\n      }\n    } else {\n      // Save references to the new child props.  Note that we track the \"child props from store update\"\n      // as a ref instead of a useState/useReducer because we need a way to determine if that value has\n      // been processed.  If this went into useState/useReducer, we couldn't clear out the value without\n      // forcing another re-render, which we don't want.\n      lastChildProps.current = newChildProps;\n      childPropsFromStoreUpdate.current = newChildProps;\n      renderIsScheduled.current = true; // TODO This is hacky and not how `uSES` is meant to be used\n      // Trigger the React `useSyncExternalStore` subscriber\n\n      additionalSubscribeListener();\n    }\n  }; // Actually subscribe to the nearest connected ancestor (or store)\n\n\n  subscription.onStateChange = checkForUpdates;\n  subscription.trySubscribe(); // Pull data from the store after first render in case the store has\n  // changed since we began.\n\n  checkForUpdates();\n\n  const unsubscribeWrapper = () => {\n    didUnsubscribe = true;\n    subscription.tryUnsubscribe();\n    subscription.onStateChange = null;\n\n    if (lastThrownError) {\n      // It's possible that we caught an error due to a bad mapState function, but the\n      // parent re-rendered without this component and we're about to unmount.\n      // This shouldn't happen as long as we do top-down subscriptions correctly, but\n      // if we ever do those wrong, this throw will surface the error in our tests.\n      // In that case, throw the error from here so it doesn't get lost.\n      throw lastThrownError;\n    }\n  };\n\n  return unsubscribeWrapper;\n} // Reducer initial state creation for our update reducer\n\n\nconst initStateUpdates = () => EMPTY_ARRAY;\n\nfunction strictEqual(a, b) {\n  return a === b;\n}\n/**\r\n * Infers the type of props that a connector will inject into a component.\r\n */\n\n\nlet hasWarnedAboutDeprecatedPureOption = false;\n/**\r\n * Connects a React component to a Redux store.\r\n *\r\n * - Without arguments, just wraps the component, without changing the behavior / props\r\n *\r\n * - If 2 params are passed (3rd param, mergeProps, is skipped), default behavior\r\n * is to override ownProps (as stated in the docs), so what remains is everything that's\r\n * not a state or dispatch prop\r\n *\r\n * - When 3rd param is passed, we don't know if ownProps propagate and whether they\r\n * should be valid component props, because it depends on mergeProps implementation.\r\n * As such, it is the user's responsibility to extend ownProps interface from state or\r\n * dispatch props or both when applicable\r\n *\r\n * @param mapStateToProps A function that extracts values from state\r\n * @param mapDispatchToProps Setup for dispatching actions\r\n * @param mergeProps Optional callback to merge state and dispatch props together\r\n * @param options Options for configuring the connection\r\n *\r\n */\n\nfunction connect(mapStateToProps, mapDispatchToProps, mergeProps, {\n  // The `pure` option has been removed, so TS doesn't like us destructuring this to check its existence.\n  // @ts-ignore\n  pure,\n  areStatesEqual = strictEqual,\n  areOwnPropsEqual = shallowEqual,\n  areStatePropsEqual = shallowEqual,\n  areMergedPropsEqual = shallowEqual,\n  // use React's forwardRef to expose a ref of the wrapped component\n  forwardRef = false,\n  // the context consumer to use\n  context = ReactReduxContext\n} = {}) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (pure !== undefined && !hasWarnedAboutDeprecatedPureOption) {\n      hasWarnedAboutDeprecatedPureOption = true;\n      warning('The `pure` option has been removed. `connect` is now always a \"pure/memoized\" component');\n    }\n  }\n\n  const Context = context;\n  const initMapStateToProps = mapStateToPropsFactory(mapStateToProps);\n  const initMapDispatchToProps = mapDispatchToPropsFactory(mapDispatchToProps);\n  const initMergeProps = mergePropsFactory(mergeProps);\n  const shouldHandleStateChanges = Boolean(mapStateToProps);\n\n  const wrapWithConnect = WrappedComponent => {\n    if (process.env.NODE_ENV !== 'production' && !isValidElementType(WrappedComponent)) {\n      throw new Error(`You must pass a component to the function returned by connect. Instead received ${stringifyComponent(WrappedComponent)}`);\n    }\n\n    const wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n    const displayName = `Connect(${wrappedComponentName})`;\n    const selectorFactoryOptions = {\n      shouldHandleStateChanges,\n      displayName,\n      wrappedComponentName,\n      WrappedComponent,\n      // @ts-ignore\n      initMapStateToProps,\n      // @ts-ignore\n      initMapDispatchToProps,\n      initMergeProps,\n      areStatesEqual,\n      areStatePropsEqual,\n      areOwnPropsEqual,\n      areMergedPropsEqual\n    };\n\n    function ConnectFunction(props) {\n      const [propsContext, reactReduxForwardedRef, wrapperProps] = useMemo(() => {\n        // Distinguish between actual \"data\" props that were passed to the wrapper component,\n        // and values needed to control behavior (forwarded refs, alternate context instances).\n        // To maintain the wrapperProps object reference, memoize this destructuring.\n        const {\n          reactReduxForwardedRef\n        } = props,\n              wrapperProps = _objectWithoutPropertiesLoose(props, _excluded);\n\n        return [props.context, reactReduxForwardedRef, wrapperProps];\n      }, [props]);\n      const ContextToUse = useMemo(() => {\n        // Users may optionally pass in a custom context instance to use instead of our ReactReduxContext.\n        // Memoize the check that determines which context instance we should use.\n        return propsContext && propsContext.Consumer && // @ts-ignore\n        isContextConsumer( /*#__PURE__*/React.createElement(propsContext.Consumer, null)) ? propsContext : Context;\n      }, [propsContext, Context]); // Retrieve the store and ancestor subscription via context, if available\n\n      const contextValue = useContext(ContextToUse); // The store _must_ exist as either a prop or in context.\n      // We'll check to see if it _looks_ like a Redux store first.\n      // This allows us to pass through a `store` prop that is just a plain value.\n\n      const didStoreComeFromProps = Boolean(props.store) && Boolean(props.store.getState) && Boolean(props.store.dispatch);\n      const didStoreComeFromContext = Boolean(contextValue) && Boolean(contextValue.store);\n\n      if (process.env.NODE_ENV !== 'production' && !didStoreComeFromProps && !didStoreComeFromContext) {\n        throw new Error(`Could not find \"store\" in the context of ` + `\"${displayName}\". Either wrap the root component in a <Provider>, ` + `or pass a custom React context provider to <Provider> and the corresponding ` + `React context consumer to ${displayName} in connect options.`);\n      } // Based on the previous check, one of these must be true\n\n\n      const store = didStoreComeFromProps ? props.store : contextValue.store;\n      const getServerState = didStoreComeFromContext ? contextValue.getServerState : store.getState;\n      const childPropsSelector = useMemo(() => {\n        // The child props selector needs the store reference as an input.\n        // Re-create this selector whenever the store changes.\n        return defaultSelectorFactory(store.dispatch, selectorFactoryOptions);\n      }, [store]);\n      const [subscription, notifyNestedSubs] = useMemo(() => {\n        if (!shouldHandleStateChanges) return NO_SUBSCRIPTION_ARRAY; // This Subscription's source should match where store came from: props vs. context. A component\n        // connected to the store via props shouldn't use subscription from context, or vice versa.\n\n        const subscription = createSubscription(store, didStoreComeFromProps ? undefined : contextValue.subscription); // `notifyNestedSubs` is duplicated to handle the case where the component is unmounted in\n        // the middle of the notification loop, where `subscription` will then be null. This can\n        // probably be avoided if Subscription's listeners logic is changed to not call listeners\n        // that have been unsubscribed in the  middle of the notification loop.\n\n        const notifyNestedSubs = subscription.notifyNestedSubs.bind(subscription);\n        return [subscription, notifyNestedSubs];\n      }, [store, didStoreComeFromProps, contextValue]); // Determine what {store, subscription} value should be put into nested context, if necessary,\n      // and memoize that value to avoid unnecessary context updates.\n\n      const overriddenContextValue = useMemo(() => {\n        if (didStoreComeFromProps) {\n          // This component is directly subscribed to a store from props.\n          // We don't want descendants reading from this store - pass down whatever\n          // the existing context value is from the nearest connected ancestor.\n          return contextValue;\n        } // Otherwise, put this component's subscription instance into context, so that\n        // connected descendants won't update until after this component is done\n\n\n        return _extends({}, contextValue, {\n          subscription\n        });\n      }, [didStoreComeFromProps, contextValue, subscription]); // Set up refs to coordinate values between the subscription effect and the render logic\n\n      const lastChildProps = useRef();\n      const lastWrapperProps = useRef(wrapperProps);\n      const childPropsFromStoreUpdate = useRef();\n      const renderIsScheduled = useRef(false);\n      const isProcessingDispatch = useRef(false);\n      const isMounted = useRef(false);\n      const latestSubscriptionCallbackError = useRef();\n      useIsomorphicLayoutEffect(() => {\n        isMounted.current = true;\n        return () => {\n          isMounted.current = false;\n        };\n      }, []);\n      const actualChildPropsSelector = useMemo(() => {\n        const selector = () => {\n          // Tricky logic here:\n          // - This render may have been triggered by a Redux store update that produced new child props\n          // - However, we may have gotten new wrapper props after that\n          // If we have new child props, and the same wrapper props, we know we should use the new child props as-is.\n          // But, if we have new wrapper props, those might change the child props, so we have to recalculate things.\n          // So, we'll use the child props from store update only if the wrapper props are the same as last time.\n          if (childPropsFromStoreUpdate.current && wrapperProps === lastWrapperProps.current) {\n            return childPropsFromStoreUpdate.current;\n          } // TODO We're reading the store directly in render() here. Bad idea?\n          // This will likely cause Bad Things (TM) to happen in Concurrent Mode.\n          // Note that we do this because on renders _not_ caused by store updates, we need the latest store state\n          // to determine what the child props should be.\n\n\n          return childPropsSelector(store.getState(), wrapperProps);\n        };\n\n        return selector;\n      }, [store, wrapperProps]); // We need this to execute synchronously every time we re-render. However, React warns\n      // about useLayoutEffect in SSR, so we try to detect environment and fall back to\n      // just useEffect instead to avoid the warning, since neither will run anyway.\n\n      const subscribeForReact = useMemo(() => {\n        const subscribe = reactListener => {\n          if (!subscription) {\n            return () => {};\n          }\n\n          return subscribeUpdates(shouldHandleStateChanges, store, subscription, // @ts-ignore\n          childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, isMounted, childPropsFromStoreUpdate, notifyNestedSubs, reactListener);\n        };\n\n        return subscribe;\n      }, [subscription]);\n      useIsomorphicLayoutEffectWithArgs(captureWrapperProps, [lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, childPropsFromStoreUpdate, notifyNestedSubs]);\n      let actualChildProps;\n\n      try {\n        actualChildProps = useSyncExternalStore( // TODO We're passing through a big wrapper that does a bunch of extra side effects besides subscribing\n        subscribeForReact, // TODO This is incredibly hacky. We've already processed the store update and calculated new child props,\n        // TODO and we're just passing that through so it triggers a re-render for us rather than relying on `uSES`.\n        actualChildPropsSelector, getServerState ? () => childPropsSelector(getServerState(), wrapperProps) : actualChildPropsSelector);\n      } catch (err) {\n        if (latestSubscriptionCallbackError.current) {\n          ;\n          err.message += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\n`;\n        }\n\n        throw err;\n      }\n\n      useIsomorphicLayoutEffect(() => {\n        latestSubscriptionCallbackError.current = undefined;\n        childPropsFromStoreUpdate.current = undefined;\n        lastChildProps.current = actualChildProps;\n      }); // Now that all that's done, we can finally try to actually render the child component.\n      // We memoize the elements for the rendered child component as an optimization.\n\n      const renderedWrappedComponent = useMemo(() => {\n        return (\n          /*#__PURE__*/\n          // @ts-ignore\n          React.createElement(WrappedComponent, _extends({}, actualChildProps, {\n            ref: reactReduxForwardedRef\n          }))\n        );\n      }, [reactReduxForwardedRef, WrappedComponent, actualChildProps]); // If React sees the exact same element reference as last time, it bails out of re-rendering\n      // that child, same as if it was wrapped in React.memo() or returned false from shouldComponentUpdate.\n\n      const renderedChild = useMemo(() => {\n        if (shouldHandleStateChanges) {\n          // If this component is subscribed to store updates, we need to pass its own\n          // subscription instance down to our descendants. That means rendering the same\n          // Context instance, and putting a different value into the context.\n          return /*#__PURE__*/React.createElement(ContextToUse.Provider, {\n            value: overriddenContextValue\n          }, renderedWrappedComponent);\n        }\n\n        return renderedWrappedComponent;\n      }, [ContextToUse, renderedWrappedComponent, overriddenContextValue]);\n      return renderedChild;\n    }\n\n    const _Connect = React.memo(ConnectFunction);\n\n    // Add a hacky cast to get the right output type\n    const Connect = _Connect;\n    Connect.WrappedComponent = WrappedComponent;\n    Connect.displayName = ConnectFunction.displayName = displayName;\n\n    if (forwardRef) {\n      const _forwarded = React.forwardRef(function forwardConnectRef(props, ref) {\n        // @ts-ignore\n        return /*#__PURE__*/React.createElement(Connect, _extends({}, props, {\n          reactReduxForwardedRef: ref\n        }));\n      });\n\n      const forwarded = _forwarded;\n      forwarded.displayName = displayName;\n      forwarded.WrappedComponent = WrappedComponent;\n      return hoistStatics(forwarded, WrappedComponent);\n    }\n\n    return hoistStatics(Connect, WrappedComponent);\n  };\n\n  return wrapWithConnect;\n}\n\nexport default connect;","import { wrapMapToPropsConstant, wrapMapToPropsFunc } from './wrapMapToProps';\nimport { createInvalidArgFactory } from './invalidArgFactory';\nexport function mapStateToPropsFactory(mapStateToProps) {\n  return !mapStateToProps ? wrapMapToPropsConstant(() => ({})) : typeof mapStateToProps === 'function' ? // @ts-ignore\n  wrapMapToPropsFunc(mapStateToProps, 'mapStateToProps') : createInvalidArgFactory(mapStateToProps, 'mapStateToProps');\n}","import bindActionCreators from '../utils/bindActionCreators';\nimport { wrapMapToPropsConstant, wrapMapToPropsFunc } from './wrapMapToProps';\nimport { createInvalidArgFactory } from './invalidArgFactory';\nexport function mapDispatchToPropsFactory(mapDispatchToProps) {\n  return mapDispatchToProps && typeof mapDispatchToProps === 'object' ? wrapMapToPropsConstant(dispatch => // @ts-ignore\n  bindActionCreators(mapDispatchToProps, dispatch)) : !mapDispatchToProps ? wrapMapToPropsConstant(dispatch => ({\n    dispatch\n  })) : typeof mapDispatchToProps === 'function' ? // @ts-ignore\n  wrapMapToPropsFunc(mapDispatchToProps, 'mapDispatchToProps') : createInvalidArgFactory(mapDispatchToProps, 'mapDispatchToProps');\n}","export default function bindActionCreators(actionCreators, dispatch) {\n  const boundActionCreators = {};\n\n  for (const key in actionCreators) {\n    const actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = (...args) => dispatch(actionCreator(...args));\n    }\n  }\n\n  return boundActionCreators;\n}","import React, { useMemo } from 'react';\nimport { ReactReduxContext } from './Context';\nimport { createSubscription } from '../utils/Subscription';\nimport { useIsomorphicLayoutEffect } from '../utils/useIsomorphicLayoutEffect';\n\nfunction Provider({\n  store,\n  context,\n  children,\n  serverState\n}) {\n  const contextValue = useMemo(() => {\n    const subscription = createSubscription(store);\n    return {\n      store,\n      subscription,\n      getServerState: serverState ? () => serverState : undefined\n    };\n  }, [store, serverState]);\n  const previousState = useMemo(() => store.getState(), [store]);\n  useIsomorphicLayoutEffect(() => {\n    const {\n      subscription\n    } = contextValue;\n    subscription.onStateChange = subscription.notifyNestedSubs;\n    subscription.trySubscribe();\n\n    if (previousState !== store.getState()) {\n      subscription.notifyNestedSubs();\n    }\n\n    return () => {\n      subscription.tryUnsubscribe();\n      subscription.onStateChange = undefined;\n    };\n  }, [contextValue, previousState]);\n  const Context = context || ReactReduxContext; // @ts-ignore 'AnyAction' is assignable to the constraint of type 'A', but 'A' could be instantiated with a different subtype\n\n  return /*#__PURE__*/React.createElement(Context.Provider, {\n    value: contextValue\n  }, children);\n}\n\nexport default Provider;","// The primary entry point assumes we're working with standard ReactDOM/RN, but\n// older versions that do not include `useSyncExternalStore` (React 16.9 - 17.x).\n// Because of that, the useSyncExternalStore compat shim is needed.\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/shim/with-selector';\nimport { unstable_batchedUpdates as batch } from './utils/reactBatchedUpdates';\nimport { setBatch } from './utils/batch';\nimport { initializeUseSelector } from './hooks/useSelector';\nimport { initializeConnect } from './components/connect';\ninitializeUseSelector(useSyncExternalStoreWithSelector);\ninitializeConnect(useSyncExternalStore); // Enable batched updates in our subscriptions for use\n// with standard React renderers (ReactDOM, React Native)\n\nsetBatch(batch);\nexport { batch };\nexport * from './exports';","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {amplify} from 'amplify';\nimport jQuery from 'jquery';\n\nimport '../event/Client';\nimport '../message/MessageCategorization';\nimport '../message/MessageCategory';\nimport '../service/BackendEnvironment';\nimport '../storage/StorageSchemata';\n\nwindow.amplify = amplify;\nwindow.jQuery = jQuery;\n// eslint-disable-next-line id-length\nwindow.$ = jQuery;\n","/** A function that accepts a potential \"extra argument\" value to be injected later,\r\n * and returns an instance of the thunk middleware that uses that value\r\n */\nfunction createThunkMiddleware(extraArgument) {\n  // Standard Redux middleware definition pattern:\n  // See: https://redux.js.org/tutorials/fundamentals/part-4-store#writing-custom-middleware\n  var middleware = function middleware(_ref) {\n    var dispatch = _ref.dispatch,\n        getState = _ref.getState;\n    return function (next) {\n      return function (action) {\n        // The thunk middleware looks for any functions that were passed to `store.dispatch`.\n        // If this \"action\" is really a function, call it and return the result.\n        if (typeof action === 'function') {\n          // Inject the store's `dispatch` and `getState` methods, as well as any \"extra arg\"\n          return action(dispatch, getState, extraArgument);\n        } // Otherwise, pass the action down the middleware chain as usual\n\n\n        return next(action);\n      };\n    };\n  };\n\n  return middleware;\n}\n\nvar thunk = createThunkMiddleware(); // Attach the factory function so users can create a customized version\n// with whatever \"extra arg\" they want to inject into their thunks\n\nthunk.withExtraArgument = createThunkMiddleware;\nexport default thunk;","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {SSOSettings} from '@wireapp/api-client/lib/account/SSOSettings';\nimport type {RegisterData} from '@wireapp/api-client/lib/auth/';\n\nimport type {LoginDataState, RegistrationDataState} from '../../reducer/authReducer';\n\nimport type {AppAction} from '.';\n\nexport enum AUTH_ACTION {\n  AUTH_RESET_ERROR = 'AUTH_RESET_ERROR',\n  ENTER_GENERIC_INVITATION_FLOW = 'ENTER_GENERIC_INVITATION_FLOW',\n  ENTER_PERSONAL_CREATION_FLOW = 'ENTER_PERSONAL_CREATION_FLOW',\n  ENTER_TEAM_CREATION_FLOW = 'ENTER_TEAM_CREATION_FLOW',\n  GET_SSO_SETTINGS_FAILED = 'GET_SSO_SETTINGS_FAILED',\n  GET_SSO_SETTINGS_START = 'GET_SSO_SETTINGS_START',\n  GET_SSO_SETTINGS_SUCCESS = 'GET_SSO_SETTINGS_SUCCESS',\n  LOGIN_FAILED = 'LOGIN_FAILED',\n  LOGIN_START = 'LOGIN_START',\n  LOGIN_SUCCESS = 'LOGIN_SUCCESS',\n  LOGOUT_FAILED = 'LOGOUT_FAILED',\n  LOGOUT_SUCCESS = 'LOGOUT_SUCCESS',\n  PUSH_LOGIN_DATA = 'PUSH_LOGIN_DATA',\n  REFRESH_FAILED = 'REFRESH_FAILED',\n  REFRESH_START = 'REFRESH_START',\n  REFRESH_SUCCESS = 'REFRESH_SUCCESS',\n  REGISTER_JOIN_FAILED = 'REGISTER_JOIN_FAILED',\n  REGISTER_JOIN_START = 'REGISTER_JOIN_START',\n  REGISTER_JOIN_SUCCESS = 'REGISTER_JOIN_SUCCESS',\n  REGISTER_PERSONAL_FAILED = 'REGISTER_PERSONAL_FAILED',\n  REGISTER_PERSONAL_START = 'REGISTER_PERSONAL_START',\n  REGISTER_PERSONAL_SUCCESS = 'REGISTER_PERSONAL_SUCCESS',\n  REGISTER_PUSH_ACCOUNT_DATA = 'REGISTER_PUSH_ACCOUNT_DATA',\n  REGISTER_PUSH_ENTROPY_DATA = 'REGISTER_PUSH_ENTROPY_DATA',\n  REGISTER_RESET_ACCOUNT_DATA = 'REGISTER_RESET_ACCOUNT_DATA',\n  REGISTER_TEAM_FAILED = 'REGISTER_TEAM_FAILED',\n  REGISTER_TEAM_START = 'REGISTER_TEAM_START',\n  REGISTER_TEAM_SUCCESS = 'REGISTER_TEAM_SUCCESS',\n  REGISTER_WIRELESS_FAILED = 'REGISTER_WIRELESS_FAILED',\n  REGISTER_WIRELESS_START = 'REGISTER_WIRELESS_START',\n  REGISTER_WIRELESS_SUCCESS = 'REGISTER_WIRELESS_SUCCESS',\n  RESET_LOGIN_DATA = 'RESET_LOGIN_DATA',\n  SEND_PHONE_LOGIN_CODE_FAILED = 'SEND_PHONE_LOGIN_CODE_FAILED',\n  SEND_PHONE_LOGIN_CODE_START = 'SEND_PHONE_LOGIN_CODE_START',\n  SEND_PHONE_LOGIN_CODE_SUCCESS = 'SEND_PHONE_LOGIN_CODE_SUCCESS',\n  SEND_TWO_FACTOR_CODE_FAILED = 'SEND_TWO_FACTOR_CODE_FAILED',\n  SEND_TWO_FACTOR_CODE_START = 'SEND_TWO_FACTOR_CODE_START',\n  SEND_TWO_FACTOR_CODE_SUCCESS = 'SEND_TWO_FACTOR_CODE_SUCCESS',\n  SILENT_LOGOUT_FAILED = 'SILENT_LOGOUT_FAILED',\n  SILENT_LOGOUT_SUCCESS = 'SILENT_LOGOUT_SUCCESS',\n}\n\nexport type AuthActions =\n  | LoginStartAction\n  | LoginSuccessAction\n  | LoginFailedAction\n  | SendTwoFactorCodeStartAction\n  | SendTwoFactorCodeSuccessAction\n  | SendTwoFactorCodeFailedAction\n  | SendPhoneLoginCodeStartAction\n  | SendPhoneLoginCodeSuccessAction\n  | SendPhoneLoginCodeFailedAction\n  | RegisterTeamStartAction\n  | RegisterTeamSuccessAction\n  | RegisterTeamFailedAction\n  | RegisterPersonalStartAction\n  | RegisterPersonalSuccessAction\n  | RegisterPersonalFailedAction\n  | RegisterWirelessStartAction\n  | RegisterWirelessSuccessAction\n  | RegisterWirelessFailedAction\n  | RegisterJoinStartAction\n  | RegisterJoinSuccessAction\n  | RegisterJoinFailedAction\n  | RefreshStartAction\n  | RefreshSuccessAction\n  | RefreshFailedAction\n  | GetSSOSettingsStartAction\n  | GetSSOSettingsSuccessAction\n  | GetSSOSettingsFailedAction\n  | LogoutSuccessAction\n  | LogoutFailedAction\n  | LogoutSilentSuccessAction\n  | LogoutSilentFailedAction\n  | ResetAuthErrorsAction\n  | ResetRegistrationDataAction\n  | PushRegistrationDataAction\n  | PushEntropyDataAction\n  | ResetLoginDataAction\n  | PushLoginDataAction\n  | EnterTeamCreationFlowAction\n  | EnterPersonalCreationFlowAction\n  | EnterGenericInvitationCreationFlowAction;\n\nexport interface LoginStartAction extends AppAction {\n  readonly type: AUTH_ACTION.LOGIN_START;\n}\nexport interface LoginSuccessAction extends AppAction {\n  readonly type: AUTH_ACTION.LOGIN_SUCCESS;\n}\nexport interface LoginFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.LOGIN_FAILED;\n}\n\nexport interface SendPhoneLoginCodeStartAction extends AppAction {\n  readonly type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_START;\n}\nexport interface SendPhoneLoginCodeSuccessAction extends AppAction {\n  readonly payload: {\n    expiresIn: number;\n  };\n  readonly type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_SUCCESS;\n}\nexport interface SendPhoneLoginCodeFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_FAILED;\n}\n\nexport interface SendTwoFactorCodeStartAction extends AppAction {\n  readonly type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_START;\n}\nexport interface SendTwoFactorCodeSuccessAction extends AppAction {\n  readonly type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_SUCCESS;\n}\nexport interface SendTwoFactorCodeFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_FAILED;\n}\n\nexport interface RegisterTeamStartAction extends AppAction {\n  readonly type: AUTH_ACTION.REGISTER_TEAM_START;\n}\nexport interface RegisterTeamSuccessAction extends AppAction {\n  readonly payload: RegisterData;\n  readonly type: AUTH_ACTION.REGISTER_TEAM_SUCCESS;\n}\nexport interface RegisterTeamFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.REGISTER_TEAM_FAILED;\n}\n\nexport interface RegisterPersonalStartAction extends AppAction {\n  readonly type: AUTH_ACTION.REGISTER_PERSONAL_START;\n}\nexport interface RegisterPersonalSuccessAction extends AppAction {\n  readonly payload: RegisterData;\n  readonly type: AUTH_ACTION.REGISTER_PERSONAL_SUCCESS;\n}\nexport interface RegisterPersonalFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.REGISTER_PERSONAL_FAILED;\n}\n\nexport interface RegisterWirelessStartAction extends AppAction {\n  readonly type: AUTH_ACTION.REGISTER_WIRELESS_START;\n}\nexport interface RegisterWirelessSuccessAction extends AppAction {\n  readonly payload: RegisterData;\n  readonly type: AUTH_ACTION.REGISTER_WIRELESS_SUCCESS;\n}\nexport interface RegisterWirelessFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.REGISTER_WIRELESS_FAILED;\n}\n\nexport interface RegisterJoinStartAction extends AppAction {\n  readonly type: AUTH_ACTION.REGISTER_JOIN_START;\n}\nexport interface RegisterJoinSuccessAction extends AppAction {\n  readonly payload: RegisterData;\n  readonly type: AUTH_ACTION.REGISTER_JOIN_SUCCESS;\n}\nexport interface RegisterJoinFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.REGISTER_JOIN_FAILED;\n}\n\nexport interface RefreshStartAction extends AppAction {\n  readonly type: AUTH_ACTION.REFRESH_START;\n}\nexport interface RefreshSuccessAction extends AppAction {\n  readonly type: AUTH_ACTION.REFRESH_SUCCESS;\n}\nexport interface RefreshFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.REFRESH_FAILED;\n}\n\nexport interface GetSSOSettingsStartAction extends AppAction {\n  readonly type: AUTH_ACTION.GET_SSO_SETTINGS_START;\n}\nexport interface GetSSOSettingsSuccessAction extends AppAction {\n  readonly payload: SSOSettings;\n  readonly type: AUTH_ACTION.GET_SSO_SETTINGS_SUCCESS;\n}\nexport interface GetSSOSettingsFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.GET_SSO_SETTINGS_FAILED;\n}\n\nexport interface LogoutSuccessAction extends AppAction {\n  readonly type: AUTH_ACTION.LOGOUT_SUCCESS;\n}\nexport interface LogoutFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.LOGOUT_FAILED;\n}\n\nexport interface LogoutSilentSuccessAction extends AppAction {\n  readonly type: AUTH_ACTION.SILENT_LOGOUT_SUCCESS;\n}\nexport interface LogoutSilentFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: AUTH_ACTION.SILENT_LOGOUT_FAILED;\n}\n\nexport interface ResetAuthErrorsAction extends AppAction {\n  readonly type: AUTH_ACTION.AUTH_RESET_ERROR;\n}\n\nexport interface ResetRegistrationDataAction extends AppAction {\n  readonly type: AUTH_ACTION.REGISTER_RESET_ACCOUNT_DATA;\n}\nexport interface PushRegistrationDataAction extends AppAction {\n  readonly payload: Partial<RegistrationDataState>;\n  readonly type: AUTH_ACTION.REGISTER_PUSH_ACCOUNT_DATA;\n}\n\nexport interface PushEntropyDataAction extends AppAction {\n  readonly payload: Uint8Array;\n  readonly type: AUTH_ACTION.REGISTER_PUSH_ENTROPY_DATA;\n}\nexport interface ResetLoginDataAction extends AppAction {\n  readonly type: AUTH_ACTION.RESET_LOGIN_DATA;\n}\nexport interface PushLoginDataAction extends AppAction {\n  readonly payload: Partial<LoginDataState>;\n  readonly type: AUTH_ACTION.PUSH_LOGIN_DATA;\n}\n\nexport interface EnterTeamCreationFlowAction extends AppAction {\n  readonly type: AUTH_ACTION.ENTER_TEAM_CREATION_FLOW;\n}\nexport interface EnterPersonalCreationFlowAction extends AppAction {\n  readonly type: AUTH_ACTION.ENTER_PERSONAL_CREATION_FLOW;\n}\nexport interface EnterGenericInvitationCreationFlowAction extends AppAction {\n  readonly type: AUTH_ACTION.ENTER_GENERIC_INVITATION_FLOW;\n}\n\nexport class AuthActionCreator {\n  static startLogin = (): LoginStartAction => ({\n    type: AUTH_ACTION.LOGIN_START,\n  });\n\n  static successfulLogin = (): LoginSuccessAction => ({\n    type: AUTH_ACTION.LOGIN_SUCCESS,\n  });\n\n  static failedLogin = (error: Error): LoginFailedAction => ({\n    error,\n    type: AUTH_ACTION.LOGIN_FAILED,\n  });\n\n  static startSendPhoneLoginCode = (): SendPhoneLoginCodeStartAction => ({\n    type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_START,\n  });\n\n  static successfulSendPhoneLoginCode = (expiresIn: number): SendPhoneLoginCodeSuccessAction => ({\n    payload: {expiresIn},\n    type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_SUCCESS,\n  });\n\n  static failedSendPhoneLoginCode = (error: Error): SendPhoneLoginCodeFailedAction => ({\n    error,\n    type: AUTH_ACTION.SEND_PHONE_LOGIN_CODE_FAILED,\n  });\n\n  static startSendTwoFactorCode = (): SendTwoFactorCodeStartAction => ({\n    type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_START,\n  });\n\n  static successfulSendTwoFactorCode = (): SendTwoFactorCodeSuccessAction => ({\n    type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_SUCCESS,\n  });\n\n  static failedSendTwoFactorCode = (error: Error): SendTwoFactorCodeFailedAction => ({\n    error,\n    type: AUTH_ACTION.SEND_TWO_FACTOR_CODE_FAILED,\n  });\n\n  static startRegisterTeam = (): RegisterTeamStartAction => ({\n    type: AUTH_ACTION.REGISTER_TEAM_START,\n  });\n\n  static successfulRegisterTeam = (authData: RegisterData): RegisterTeamSuccessAction => ({\n    payload: authData,\n    type: AUTH_ACTION.REGISTER_TEAM_SUCCESS,\n  });\n\n  static failedRegisterTeam = (error: Error): RegisterTeamFailedAction => ({\n    error,\n    type: AUTH_ACTION.REGISTER_TEAM_FAILED,\n  });\n\n  static startRegisterPersonal = (): RegisterPersonalStartAction => ({\n    type: AUTH_ACTION.REGISTER_PERSONAL_START,\n  });\n\n  static successfulRegisterPersonal = (authData: RegisterData): RegisterPersonalSuccessAction => ({\n    payload: authData,\n    type: AUTH_ACTION.REGISTER_PERSONAL_SUCCESS,\n  });\n\n  static failedRegisterPersonal = (error: Error): RegisterPersonalFailedAction => ({\n    error,\n    type: AUTH_ACTION.REGISTER_PERSONAL_FAILED,\n  });\n\n  static startRegisterWireless = (): RegisterWirelessStartAction => ({\n    type: AUTH_ACTION.REGISTER_WIRELESS_START,\n  });\n\n  static successfulRegisterWireless = (authData: RegisterData): RegisterWirelessSuccessAction => ({\n    payload: authData,\n    type: AUTH_ACTION.REGISTER_WIRELESS_SUCCESS,\n  });\n\n  static failedRegisterWireless = (error: Error): RegisterWirelessFailedAction => ({\n    error,\n    type: AUTH_ACTION.REGISTER_WIRELESS_FAILED,\n  });\n\n  static startRegisterJoin = (): RegisterJoinStartAction => ({\n    type: AUTH_ACTION.REGISTER_JOIN_START,\n  });\n\n  static successfulRegisterJoin = (authData: RegisterData): RegisterJoinSuccessAction => ({\n    payload: authData,\n    type: AUTH_ACTION.REGISTER_JOIN_SUCCESS,\n  });\n\n  static failedRegisterJoin = (error: Error): RegisterJoinFailedAction => ({\n    error,\n    type: AUTH_ACTION.REGISTER_JOIN_FAILED,\n  });\n\n  static startRefresh = (): RefreshStartAction => ({\n    type: AUTH_ACTION.REFRESH_START,\n  });\n\n  static successfulRefresh = (): RefreshSuccessAction => ({\n    type: AUTH_ACTION.REFRESH_SUCCESS,\n  });\n\n  static failedRefresh = (error: Error): RefreshFailedAction => ({\n    error,\n    type: AUTH_ACTION.REFRESH_FAILED,\n  });\n\n  static startGetSSOSettings = (): GetSSOSettingsStartAction => ({\n    type: AUTH_ACTION.GET_SSO_SETTINGS_START,\n  });\n\n  static successfulGetSSOSettings = (ssoSettings: SSOSettings): GetSSOSettingsSuccessAction => ({\n    payload: ssoSettings,\n    type: AUTH_ACTION.GET_SSO_SETTINGS_SUCCESS,\n  });\n\n  static failedGetSSOSettings = (error: Error): GetSSOSettingsFailedAction => ({\n    error,\n    type: AUTH_ACTION.GET_SSO_SETTINGS_FAILED,\n  });\n\n  static successfulLogout = (): LogoutSuccessAction => ({\n    type: AUTH_ACTION.LOGOUT_SUCCESS,\n  });\n\n  static failedLogout = (error: Error): LogoutFailedAction => ({\n    error,\n    type: AUTH_ACTION.LOGOUT_FAILED,\n  });\n\n  static successfulSilentLogout = (): LogoutSilentSuccessAction => ({\n    type: AUTH_ACTION.SILENT_LOGOUT_SUCCESS,\n  });\n\n  static failedSilentLogout = (error: Error): LogoutSilentFailedAction => ({\n    error,\n    type: AUTH_ACTION.SILENT_LOGOUT_FAILED,\n  });\n\n  static resetError = (): ResetAuthErrorsAction => ({\n    type: AUTH_ACTION.AUTH_RESET_ERROR,\n  });\n\n  static resetAccountData = (): ResetRegistrationDataAction => ({\n    type: AUTH_ACTION.REGISTER_RESET_ACCOUNT_DATA,\n  });\n\n  static pushAccountRegistrationData = (accountData: Partial<RegistrationDataState>): PushRegistrationDataAction => ({\n    payload: accountData,\n    type: AUTH_ACTION.REGISTER_PUSH_ACCOUNT_DATA,\n  });\n\n  static pushEntropyData = (entropy: Uint8Array): PushEntropyDataAction => {\n    return {\n      payload: entropy,\n      type: AUTH_ACTION.REGISTER_PUSH_ENTROPY_DATA,\n    };\n  };\n\n  static pushLoginData = (loginData: Partial<LoginDataState>): PushLoginDataAction => ({\n    payload: loginData,\n    type: AUTH_ACTION.PUSH_LOGIN_DATA,\n  });\n\n  static resetLoginData = (): ResetLoginDataAction => ({\n    type: AUTH_ACTION.RESET_LOGIN_DATA,\n  });\n\n  static enterTeamCreationFlow = (): EnterTeamCreationFlowAction => ({\n    type: AUTH_ACTION.ENTER_TEAM_CREATION_FLOW,\n  });\n\n  static enterPersonalCreationFlow = (): EnterPersonalCreationFlowAction => ({\n    type: AUTH_ACTION.ENTER_PERSONAL_CREATION_FLOW,\n  });\n\n  static enterGenericInviteCreationFlow = (): EnterGenericInvitationCreationFlowAction => ({\n    type: AUTH_ACTION.ENTER_GENERIC_INVITATION_FLOW,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {RegisteredClient} from '@wireapp/api-client/lib/client/';\n\nimport type {AppAction} from './';\n\nexport enum CLIENT_ACTION {\n  CLIENT_INIT_SUCCESS = 'CLIENT_INIT_SUCCESS',\n\n  CLIENT_REMOVE_FAILED = 'CLIENT_REMOVE_FAILED',\n  CLIENT_REMOVE_START = 'CLIENT_REMOVE_START',\n  CLIENT_REMOVE_SUCCESS = 'CLIENT_REMOVE_SUCCESS',\n\n  CLIENT_RESET_ERROR = 'CLIENT_RESET_ERROR',\n  CLIENTS_FETCH_FAILED = 'CLIENTS_FETCH_FAILED',\n  CLIENTS_FETCH_START = 'CLIENTS_FETCH_START',\n\n  CLIENTS_FETCH_SUCCESS = 'CLIENTS_FETCH_SUCCESS',\n}\n\nexport type ClientActions =\n  | GetAllClientsStartAction\n  | GetAllClientsSuccessAction\n  | GetAllClientsFailedAction\n  | RemoveClientStartAction\n  | RemoveClientSuccessAction\n  | RemoveClientFailedAction\n  | InitializeClientSuccessAction\n  | ResetClientErrorsAction;\n\nexport interface GetAllClientsStartAction extends AppAction {\n  readonly type: CLIENT_ACTION.CLIENTS_FETCH_START;\n}\nexport interface GetAllClientsSuccessAction extends AppAction {\n  readonly payload: RegisteredClient[];\n  readonly type: CLIENT_ACTION.CLIENTS_FETCH_SUCCESS;\n}\nexport interface GetAllClientsFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: CLIENT_ACTION.CLIENTS_FETCH_FAILED;\n}\n\nexport interface RemoveClientStartAction extends AppAction {\n  readonly type: CLIENT_ACTION.CLIENT_REMOVE_START;\n}\nexport interface RemoveClientSuccessAction extends AppAction {\n  readonly payload: string;\n  readonly type: CLIENT_ACTION.CLIENT_REMOVE_SUCCESS;\n}\nexport interface RemoveClientFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: CLIENT_ACTION.CLIENT_REMOVE_FAILED;\n}\n\nexport interface InitializeClientSuccessAction extends AppAction {\n  readonly payload: {\n    isNew: boolean;\n    client: RegisteredClient;\n  };\n  readonly type: CLIENT_ACTION.CLIENT_INIT_SUCCESS;\n}\n\nexport interface ResetClientErrorsAction extends AppAction {\n  readonly type: CLIENT_ACTION.CLIENT_RESET_ERROR;\n}\n\nexport class ClientActionCreator {\n  static startGetAllClients = (): GetAllClientsStartAction => ({\n    type: CLIENT_ACTION.CLIENTS_FETCH_START,\n  });\n  static successfulGetAllClients = (clients: RegisteredClient[]): GetAllClientsSuccessAction => ({\n    payload: clients,\n    type: CLIENT_ACTION.CLIENTS_FETCH_SUCCESS,\n  });\n  static failedGetAllClients = (error: Error): GetAllClientsFailedAction => ({\n    error,\n    type: CLIENT_ACTION.CLIENTS_FETCH_FAILED,\n  });\n\n  static startRemoveClient = (): RemoveClientStartAction => ({\n    type: CLIENT_ACTION.CLIENT_REMOVE_START,\n  });\n  static successfulRemoveClient = (deletedClientId: string): RemoveClientSuccessAction => ({\n    payload: deletedClientId,\n    type: CLIENT_ACTION.CLIENT_REMOVE_SUCCESS,\n  });\n  static failedRemoveClient = (error: Error): RemoveClientFailedAction => ({\n    error,\n    type: CLIENT_ACTION.CLIENT_REMOVE_FAILED,\n  });\n\n  static successfulInitializeClient = (creationStatus: {\n    isNew: boolean;\n    client: RegisteredClient;\n  }): InitializeClientSuccessAction => ({\n    payload: creationStatus,\n    type: CLIENT_ACTION.CLIENT_INIT_SUCCESS,\n  });\n\n  static resetError = (): ResetClientErrorsAction => ({\n    type: CLIENT_ACTION.CLIENT_RESET_ERROR,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ConversationEvent} from '@wireapp/api-client/lib/event/';\n\nimport type {AppAction} from '.';\n\nexport enum CONVERSATION_ACTION {\n  CONVERSATION_CODE_CHECK_FAILED = 'CONVERSATION_CODE_CHECK_FAILED',\n  CONVERSATION_CODE_CHECK_START = 'CONVERSATION_CODE_CHECK_START',\n  CONVERSATION_CODE_CHECK_SUCCESS = 'CONVERSATION_CODE_CHECK_SUCCESS',\n  CONVERSATION_CODE_JOIN_FAILED = 'CONVERSATION_CODE_JOIN_FAILED',\n  CONVERSATION_CODE_JOIN_START = 'CONVERSATION_CODE_JOIN_START',\n  CONVERSATION_CODE_JOIN_SUCCESS = 'CONVERSATION_CODE_JOIN_SUCCESS',\n}\n\nexport type ConversationActions =\n  | ConversationCodeCheckStartAction\n  | ConversationCodeCheckSuccessAction\n  | ConversationCodeCheckFailedAction\n  | ConversationCodeJoinStartAction\n  | ConversationCodeJoinSuccessAction\n  | ConversationCodeJoinFailedAction;\n\nexport interface ConversationCodeCheckStartAction extends AppAction {\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_START;\n}\nexport interface ConversationCodeCheckSuccessAction extends AppAction {\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_SUCCESS;\n}\nexport interface ConversationCodeCheckFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_FAILED;\n}\n\nexport interface ConversationCodeJoinStartAction extends AppAction {\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_START;\n}\nexport interface ConversationCodeJoinSuccessAction extends AppAction {\n  readonly payload: ConversationEvent;\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_SUCCESS;\n}\nexport interface ConversationCodeJoinFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_FAILED;\n}\n\nexport class ConversationActionCreator {\n  static startConversationCodeCheck = (): ConversationCodeCheckStartAction => ({\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_START,\n  });\n  static successfulConversationCodeCheck = (): ConversationCodeCheckSuccessAction => ({\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_SUCCESS,\n  });\n  static failedConversationCodeCheck = (error: Error): ConversationCodeCheckFailedAction => ({\n    error,\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_FAILED,\n  });\n\n  static startJoinConversationByCode = (): ConversationCodeJoinStartAction => ({\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_START,\n  });\n  static successfulJoinConversationByCode = (data: ConversationEvent): ConversationCodeJoinSuccessAction => ({\n    payload: data,\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_SUCCESS,\n  });\n  static failedJoinConversationByCode = (error: Error): ConversationCodeJoinFailedAction => ({\n    error,\n    type: CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_FAILED,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {TeamInvitation} from '@wireapp/api-client/lib/team/';\n\nexport enum INVITATION_ACTION {\n  INVITE_ADD_FAILED = 'INVITE_ADD_FAILED',\n  INVITE_ADD_START = 'INVITE_ADD_START',\n  INVITE_ADD_SUCCESS = 'INVITE_ADD_SUCCESS',\n\n  INVITE_RESET_ERROR = 'INVITE_RESET_ERROR',\n}\n\nexport type InvitationActions =\n  | AddInviteStartAction\n  | AddInviteSuccessAction\n  | AddInviteFailedAction\n  | ResetInviteErrorAction;\n\nexport interface AddInviteStartAction {\n  type: INVITATION_ACTION.INVITE_ADD_START;\n}\nexport interface AddInviteSuccessAction {\n  payload: {invite: TeamInvitation};\n  type: INVITATION_ACTION.INVITE_ADD_SUCCESS;\n}\nexport interface AddInviteFailedAction {\n  error: Error;\n  type: INVITATION_ACTION.INVITE_ADD_FAILED;\n}\n\nexport interface ResetInviteErrorAction {\n  type: INVITATION_ACTION.INVITE_RESET_ERROR;\n}\n\nexport class InvitationActionCreator {\n  static startAddInvite = (): AddInviteStartAction => ({\n    type: INVITATION_ACTION.INVITE_ADD_START,\n  });\n  static successfulAddInvite = (invite: any): AddInviteSuccessAction => ({\n    payload: {invite},\n    type: INVITATION_ACTION.INVITE_ADD_SUCCESS,\n  });\n  static failedAddInvite = (error: Error): AddInviteFailedAction => ({\n    error,\n    type: INVITATION_ACTION.INVITE_ADD_FAILED,\n  });\n\n  static resetError = (): ResetInviteErrorAction => ({\n    type: INVITATION_ACTION.INVITE_RESET_ERROR,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {AppAction} from '.';\n\nexport enum LANGUAGE_ACTION {\n  SWITCH_LANGUAGE_FAILED = 'SWITCH_LANGUAGE_FAILED',\n  SWITCH_LANGUAGE_START = 'SWITCH_LANGUAGE_START',\n  SWITCH_LANGUAGE_SUCCESS = 'SWITCH_LANGUAGE_SUCCESS',\n}\n\nexport type LanguageActions = LanguageSwitchStartAction | LanguageSwitchSuccessAction | LanguageSwitchFailedAction;\n\nexport interface LanguageSwitchStartAction extends AppAction {\n  readonly type: LANGUAGE_ACTION.SWITCH_LANGUAGE_START;\n}\nexport interface LanguageSwitchSuccessAction extends AppAction {\n  readonly payload: string;\n  readonly type: LANGUAGE_ACTION.SWITCH_LANGUAGE_SUCCESS;\n}\nexport interface LanguageSwitchFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: LANGUAGE_ACTION.SWITCH_LANGUAGE_FAILED;\n}\n\nexport class LanguageActionCreator {\n  static startSwitchLanguage = (): LanguageSwitchStartAction => ({\n    type: LANGUAGE_ACTION.SWITCH_LANGUAGE_START,\n  });\n  static successfulSwitchLanguage = (language: string): LanguageSwitchSuccessAction => ({\n    payload: language,\n    type: LANGUAGE_ACTION.SWITCH_LANGUAGE_SUCCESS,\n  });\n  static failedSwitchLanguage = (error: Error): LanguageSwitchFailedAction => ({\n    error,\n    type: LANGUAGE_ACTION.SWITCH_LANGUAGE_FAILED,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {AppAction} from '.';\n\nexport enum LOCAL_STORAGE_ACTION {\n  LOCAL_STORAGE_DELETE_FAILED = 'LOCAL_STORAGE_DELETE_FAILED',\n  LOCAL_STORAGE_DELETE_START = 'LOCAL_STORAGE_DELETE_START',\n  LOCAL_STORAGE_DELETE_SUCCESS = 'LOCAL_STORAGE_DELETE_SUCCESS',\n\n  LOCAL_STORAGE_GET_FAILED = 'LOCAL_STORAGE_GET_FAILED',\n  LOCAL_STORAGE_GET_START = 'LOCAL_STORAGE_GET_START',\n  LOCAL_STORAGE_GET_SUCCESS = 'LOCAL_STORAGE_GET_SUCCESS',\n\n  LOCAL_STORAGE_SET_FAILED = 'LOCAL_STORAGE_SET_FAILED',\n  LOCAL_STORAGE_SET_START = 'LOCAL_STORAGE_SET_START',\n  LOCAL_STORAGE_SET_SUCCESS = 'LOCAL_STORAGE_SET_SUCCESS',\n}\n\nexport type LocalStorageActions =\n  | SetStartAction\n  | SetSuccessAction\n  | SetFailedAction\n  | GetStartAction\n  | GetSuccessAction\n  | GetFailedAction\n  | DeleteStartAction\n  | DeleteSuccessAction\n  | DeleteFailedAction;\n\nexport interface SetStartAction extends AppAction {\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_START;\n}\nexport interface SetSuccessAction extends AppAction {\n  readonly payload: {key: string; value: string | boolean | number};\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_SUCCESS;\n}\nexport interface SetFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_FAILED;\n}\n\nexport interface GetStartAction extends AppAction {\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_START;\n}\nexport interface GetSuccessAction extends AppAction {\n  readonly payload: {key: string; value: string | boolean | number};\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_SUCCESS;\n}\nexport interface GetFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_FAILED;\n}\n\nexport interface DeleteStartAction extends AppAction {\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_START;\n}\nexport interface DeleteSuccessAction extends AppAction {\n  readonly payload: {key: string};\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_SUCCESS;\n}\nexport interface DeleteFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_FAILED;\n}\n\nexport class LocalStorageActionCreator {\n  static startLocalStorageSet = (): SetStartAction => ({\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_START,\n  });\n  static successfulLocalStorageSet = (key: string, value: string | boolean | number): SetSuccessAction => ({\n    payload: {key, value},\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_SUCCESS,\n  });\n  static failedLocalStorageSet = (error: Error): SetFailedAction => ({\n    error,\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_SET_FAILED,\n  });\n\n  static startLocalStorageGet = (): GetStartAction => ({\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_START,\n  });\n  static successfulLocalStorageGet = (key: string, value: string | boolean | number): GetSuccessAction => ({\n    payload: {key, value},\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_SUCCESS,\n  });\n  static failedLocalStorageGet = (error: Error): GetFailedAction => ({\n    error,\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_GET_FAILED,\n  });\n\n  static startLocalStorageDelete = (): DeleteStartAction => ({\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_START,\n  });\n  static successfulLocalStorageDelete = (key: string): DeleteSuccessAction => ({\n    payload: {key},\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_SUCCESS,\n  });\n  static failedLocalStorageDelete = (error: Error): DeleteFailedAction => ({\n    error,\n    type: LOCAL_STORAGE_ACTION.LOCAL_STORAGE_DELETE_FAILED,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {AppAction} from '.';\n\nexport enum RUNTIME_ACTION {\n  RUNTIME_CHECK_COOKIE_FINISH = 'RUNTIME_CHECK_COOKIE_FINISH',\n  RUNTIME_CHECK_COOKIE_START = 'RUNTIME_CHECK_COOKIE_START',\n  RUNTIME_CHECK_INDEXEDDB_FINISH = 'RUNTIME_CHECK_INDEXEDDB_FINISH',\n  RUNTIME_CHECK_INDEXEDDB_START = 'RUNTIME_CHECK_INDEXEDDB_START',\n  RUNTIME_CONFIRM_SUPPORTED_BROWSER = 'RUNTIME_CONFIRM_SUPPORTED_BROWSER',\n}\n\nexport type RuntimeActions =\n  | CheckIndexedDBStartAction\n  | CheckIndexedDBSuccessAction\n  | CheckCookieStartAction\n  | CheckCookieSuccessAction\n  | ConfirmSupportedBrowserAction;\n\nexport interface CheckIndexedDBStartAction extends AppAction {\n  readonly type: RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_START;\n}\nexport interface CheckIndexedDBSuccessAction extends AppAction {\n  readonly payload: boolean;\n  readonly type: RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_FINISH;\n}\n\nexport interface CheckCookieStartAction extends AppAction {\n  readonly type: RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_START;\n}\nexport interface CheckCookieSuccessAction extends AppAction {\n  readonly payload: boolean;\n  readonly type: RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_FINISH;\n}\n\nexport interface ConfirmSupportedBrowserAction extends AppAction {\n  readonly type: RUNTIME_ACTION.RUNTIME_CONFIRM_SUPPORTED_BROWSER;\n}\n\nexport class RuntimeActionCreator {\n  static startCheckIndexedDb = (): CheckIndexedDBStartAction => ({\n    type: RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_START,\n  });\n  static finishCheckIndexedDb = (result: boolean): CheckIndexedDBSuccessAction => ({\n    payload: result,\n    type: RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_FINISH,\n  });\n\n  static startCheckCookie = (): CheckCookieStartAction => ({\n    type: RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_START,\n  });\n  static finishCheckCookie = (result: boolean): CheckCookieSuccessAction => ({\n    payload: result,\n    type: RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_FINISH,\n  });\n\n  static confirmSupportedBrowser = (): ConfirmSupportedBrowserAction => ({\n    type: RUNTIME_ACTION.RUNTIME_CONFIRM_SUPPORTED_BROWSER,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {Consent, Self} from '@wireapp/api-client/lib/self/';\n\nimport type {AppAction} from '.';\n\nexport enum SELF_ACTION {\n  CONSENT_GET_FAILED = 'CONSENT_GET_FAILED',\n  CONSENT_GET_START = 'CONSENT_GET_START',\n  CONSENT_GET_SUCCESS = 'CONSENT_GET_SUCCESS',\n\n  CONSENT_SET_FAILED = 'CONSENT_SET_FAILED',\n  CONSENT_SET_START = 'CONSENT_SET_START',\n  CONSENT_SET_SUCCESS = 'CONSENT_SET_SUCCESS',\n\n  HANDLE_SET_FAILED = 'HANDLE_SET_FAILED',\n  HANDLE_SET_START = 'HANDLE_SET_START',\n  HANDLE_SET_SUCCESS = 'HANDLE_SET_SUCCESS',\n\n  SELF_FETCH_FAILED = 'SELF_FETCH_FAILED',\n  SELF_FETCH_START = 'SELF_FETCH_START',\n  SELF_FETCH_SUCCESS = 'SELF_FETCH_SUCCESS',\n\n  SELF_SET_EMAIL_FAILED = 'SELF_SET_EMAIL_FAILED',\n  SELF_SET_EMAIL_START = 'SELF_SET_EMAIL_START',\n  SELF_SET_EMAIL_SUCCESS = 'SELF_SET_EMAIL_SUCCESS',\n\n  SELF_SET_PASSWORD_FAILED = 'SELF_SET_PASSWORD_FAILED',\n  SELF_SET_PASSWORD_START = 'SELF_SET_PASSWORD_START',\n  SELF_SET_PASSWORD_STATE_FAILED = 'SELF_SET_PASSWORD_STATE_FAILED',\n\n  SELF_SET_PASSWORD_STATE_START = 'SELF_SET_PASSWORD_STATE_START',\n  SELF_SET_PASSWORD_STATE_SUCCESS = 'SELF_SET_PASSWORD_STATE_SUCCESS',\n  SELF_SET_PASSWORD_SUCCESS = 'SELF_SET_PASSWORD_SUCCESS',\n}\n\nexport type SelfActions =\n  | FetchSelfStartAction\n  | FetchSelfSuccessAction\n  | FetchSelfFailedAction\n  | SetHandleStartAction\n  | SetHandleSuccessAction\n  | SetHandleFailedAction\n  | SetPasswordStateStartAction\n  | SetPasswordStateSuccessAction\n  | SetPasswordStateFailedAction\n  | GetConsentsStartAction\n  | GetConsentsSuccessAction\n  | GetConsentsFailedAction\n  | SetConsentStartAction\n  | SetConsentSuccessAction\n  | SetConsentFailedAction\n  | SetSelfEmailStartAction\n  | SetSelfEmailSuccessAction\n  | SetSelfEmailFailedAction\n  | SetSelfPasswordStartAction\n  | SetSelfPasswordSuccessAction\n  | SetSelfPasswordFailedAction;\n\nexport interface SetHandleStartAction extends AppAction {\n  readonly type: SELF_ACTION.HANDLE_SET_START;\n}\nexport interface SetHandleSuccessAction extends AppAction {\n  readonly payload: Self;\n  readonly type: SELF_ACTION.HANDLE_SET_SUCCESS;\n}\nexport interface SetHandleFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.HANDLE_SET_FAILED;\n}\n\nexport interface SetPasswordStateStartAction extends AppAction {\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_STATE_START;\n}\nexport interface SetPasswordStateSuccessAction extends AppAction {\n  readonly payload: boolean;\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_STATE_SUCCESS;\n}\nexport interface SetPasswordStateFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_STATE_FAILED;\n}\n\nexport interface FetchSelfStartAction extends AppAction {\n  readonly type: SELF_ACTION.SELF_FETCH_START;\n}\nexport interface FetchSelfSuccessAction extends AppAction {\n  readonly payload: Self;\n  readonly type: SELF_ACTION.SELF_FETCH_SUCCESS;\n}\nexport interface FetchSelfFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.SELF_FETCH_FAILED;\n}\n\nexport interface GetConsentsStartAction extends AppAction {\n  readonly type: SELF_ACTION.CONSENT_GET_START;\n}\nexport interface GetConsentsSuccessAction extends AppAction {\n  readonly payload: Consent[];\n  readonly type: SELF_ACTION.CONSENT_GET_SUCCESS;\n}\nexport interface GetConsentsFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.CONSENT_GET_FAILED;\n}\n\nexport interface SetConsentStartAction extends AppAction {\n  readonly type: SELF_ACTION.CONSENT_SET_START;\n}\nexport interface SetConsentSuccessAction extends AppAction {\n  readonly payload: Consent;\n  readonly type: SELF_ACTION.CONSENT_SET_SUCCESS;\n}\nexport interface SetConsentFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.CONSENT_SET_FAILED;\n}\n\nexport interface SetSelfEmailStartAction extends AppAction {\n  readonly type: SELF_ACTION.SELF_SET_EMAIL_START;\n}\nexport interface SetSelfEmailSuccessAction extends AppAction {\n  payload: string;\n  readonly type: SELF_ACTION.SELF_SET_EMAIL_SUCCESS;\n}\nexport interface SetSelfEmailFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.SELF_SET_EMAIL_FAILED;\n}\n\nexport interface SetSelfPasswordStartAction extends AppAction {\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_START;\n}\nexport interface SetSelfPasswordSuccessAction extends AppAction {\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_SUCCESS;\n}\nexport interface SetSelfPasswordFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: SELF_ACTION.SELF_SET_PASSWORD_FAILED;\n}\n\nexport class SelfActionCreator {\n  static startSetHandle = (): SetHandleStartAction => ({\n    type: SELF_ACTION.HANDLE_SET_START,\n  });\n  static successfulSetHandle = (selfUser: Self): SetHandleSuccessAction => ({\n    payload: selfUser,\n    type: SELF_ACTION.HANDLE_SET_SUCCESS,\n  });\n  static failedSetHandle = (error: Error): SetHandleFailedAction => ({\n    error,\n    type: SELF_ACTION.HANDLE_SET_FAILED,\n  });\n\n  static startSetPasswordState = (): SetPasswordStateStartAction => ({\n    type: SELF_ACTION.SELF_SET_PASSWORD_STATE_START,\n  });\n  static successfulSetPasswordState = ({hasPassword}: {hasPassword: boolean}): SetPasswordStateSuccessAction => ({\n    payload: hasPassword,\n    type: SELF_ACTION.SELF_SET_PASSWORD_STATE_SUCCESS,\n  });\n  static failedSetPasswordState = (error: Error): SetPasswordStateFailedAction => ({\n    error,\n    type: SELF_ACTION.SELF_SET_PASSWORD_STATE_FAILED,\n  });\n\n  static startFetchSelf = (): FetchSelfStartAction => ({\n    type: SELF_ACTION.SELF_FETCH_START,\n  });\n  static successfulFetchSelf = (selfUser: Self): FetchSelfSuccessAction => ({\n    payload: selfUser,\n    type: SELF_ACTION.SELF_FETCH_SUCCESS,\n  });\n  static failedFetchSelf = (error: Error): FetchSelfFailedAction => ({\n    error,\n    type: SELF_ACTION.SELF_FETCH_FAILED,\n  });\n\n  static startGetConsents = (): GetConsentsStartAction => ({\n    type: SELF_ACTION.CONSENT_GET_START,\n  });\n  static successfulGetConsents = (consents: Consent[]): GetConsentsSuccessAction => ({\n    payload: consents,\n    type: SELF_ACTION.CONSENT_GET_SUCCESS,\n  });\n  static failedGetConsents = (error: Error): GetConsentsFailedAction => ({\n    error,\n    type: SELF_ACTION.CONSENT_GET_FAILED,\n  });\n\n  static startSetConsent = (): SetConsentStartAction => ({\n    type: SELF_ACTION.CONSENT_SET_START,\n  });\n  static successfulSetConsent = (consent: Consent): SetConsentSuccessAction => ({\n    payload: consent,\n    type: SELF_ACTION.CONSENT_SET_SUCCESS,\n  });\n  static failedSetConsent = (error: Error): SetConsentFailedAction => ({\n    error,\n    type: SELF_ACTION.CONSENT_SET_FAILED,\n  });\n\n  static startSetSelfEmail = (): SetSelfEmailStartAction => ({\n    type: SELF_ACTION.SELF_SET_EMAIL_START,\n  });\n  static successfulSetSelfEmail = (email: string): SetSelfEmailSuccessAction => ({\n    payload: email,\n    type: SELF_ACTION.SELF_SET_EMAIL_SUCCESS,\n  });\n  static failedSetSelfEmail = (error: Error): SetSelfEmailFailedAction => ({\n    error,\n    type: SELF_ACTION.SELF_SET_EMAIL_FAILED,\n  });\n\n  static startSetSelfPassword = (): SetSelfPasswordStartAction => ({\n    type: SELF_ACTION.SELF_SET_PASSWORD_START,\n  });\n  static successfulSetSelfPassword = (): SetSelfPasswordSuccessAction => ({\n    type: SELF_ACTION.SELF_SET_PASSWORD_SUCCESS,\n  });\n  static failedSetSelfPassword = (error: Error): SetSelfPasswordFailedAction => ({\n    error,\n    type: SELF_ACTION.SELF_SET_PASSWORD_FAILED,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {AppAction} from '.';\n\nexport enum USER_ACTION {\n  USER_SEND_ACTIVATION_CODE_FAILED = 'USER_SEND_ACTIVATION_CODE_FAILED',\n  USER_SEND_ACTIVATION_CODE_START = 'USER_SEND_ACTIVATION_CODE_START',\n  USER_SEND_ACTIVATION_CODE_SUCCESS = 'USER_SEND_ACTIVATION_CODE_SUCCESS',\n}\n\nexport type UserActions =\n  | SendActivationCodeStartAction\n  | SendActivationCodeSuccessAction\n  | SendActivationCodeFailedAction;\n\nexport interface SendActivationCodeStartAction extends AppAction {\n  readonly type: USER_ACTION.USER_SEND_ACTIVATION_CODE_START;\n}\nexport interface SendActivationCodeSuccessAction extends AppAction {\n  readonly type: USER_ACTION.USER_SEND_ACTIVATION_CODE_SUCCESS;\n}\nexport interface SendActivationCodeFailedAction extends AppAction {\n  readonly error: Error;\n  readonly type: USER_ACTION.USER_SEND_ACTIVATION_CODE_FAILED;\n}\n\nexport class UserActionCreator {\n  static startSendActivationCode = (): SendActivationCodeStartAction => ({\n    type: USER_ACTION.USER_SEND_ACTIVATION_CODE_START,\n  });\n  static successfulSendActivationCode = (): SendActivationCodeSuccessAction => ({\n    type: USER_ACTION.USER_SEND_ACTIVATION_CODE_SUCCESS,\n  });\n  static failedSendActivationCode = (error: Error): SendActivationCodeFailedAction => ({\n    error,\n    type: USER_ACTION.USER_SEND_ACTIVATION_CODE_FAILED,\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {Config} from '../../../Config';\nimport type {RootState} from '../reducer';\n\nexport const isChecking = (state: RootState) =>\n  state.runtimeState.isCheckingIndexedDb || state.runtimeState.isCheckingCookie;\nexport const hasIndexedDbSupport = (state: RootState) => state.runtimeState.hasIndexedDbSupport;\nexport const hasCookieSupport = (state: RootState) => state.runtimeState.hasCookieSupport;\nexport const isSupportedBrowser = (state: RootState) => state.runtimeState.isSupportedBrowser;\nexport const hasToUseDesktopApplication = (state: RootState) =>\n  Config.getConfig().FEATURE.ENABLE_ENFORCE_DESKTOP_APPLICATION_ONLY && !Runtime.isDesktopApp();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FORWARDED_QUERY_KEYS} from '../route';\n\nexport function getSearchParams(\n  additionalParams: {[query: string]: string} = {},\n  whitelistParams: string[] = FORWARDED_QUERY_KEYS,\n): string {\n  const searchParams = window.location.search\n    .replace(/^\\?/, '')\n    .split('&')\n    .filter(searchParam => !!searchParam)\n    .filter(searchParam => {\n      const paramName = searchParam.split('=')[0];\n      return whitelistParams.includes(paramName);\n    });\n  Object.entries(additionalParams).forEach(([query, value]) => {\n    searchParams.push(`${query}=${value}`);\n  });\n\n  return searchParams.join('&');\n}\n\nexport function pathWithParams(\n  path: string,\n  additionalParams?: {[query: string]: string},\n  whitelistParams: string[] = FORWARDED_QUERY_KEYS,\n): string {\n  const params = getSearchParams(additionalParams, whitelistParams);\n  return `${path}${params.length ? `?${params}` : ''}`;\n}\n\nexport function hasURLParameter(parameterName: string): boolean {\n  return window.location.search\n    .split(/\\?|&/)\n    .map(parameter => parameter.split('=')[0])\n    .includes(parameterName);\n}\n\nexport function openTab(url: string): Window {\n  const newWindow = window.open(url);\n  if (newWindow) {\n    newWindow.opener = null;\n  }\n  return newWindow;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport Cookies from 'js-cookie';\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {RuntimeActionCreator} from './creator/';\n\nimport * as RuntimeSelector from '../../module/selector/RuntimeSelector';\nimport {QUERY_KEY} from '../../route';\nimport {hasURLParameter} from '../../util/urlUtil';\nimport type {ThunkAction} from '../reducer';\n\nexport class RuntimeAction {\n  checkSupportedBrowser = (): ThunkAction<void> => {\n    return (dispatch, getState, {getConfig}) => {\n      const isPwaSupportedBrowser = () => {\n        return Runtime.isMobileOS() || Runtime.isSafari();\n      };\n      const pwaAware = hasURLParameter(QUERY_KEY.PWA_AWARE);\n      const isPwaEnabled = getConfig().URL.MOBILE_BASE && pwaAware && isPwaSupportedBrowser();\n      if (\n        (!RuntimeSelector.hasToUseDesktopApplication(getState()) && Runtime.isWebappSupportedBrowser()) ||\n        isPwaEnabled\n      ) {\n        dispatch(RuntimeActionCreator.confirmSupportedBrowser());\n      }\n    };\n  };\n\n  checkIndexedDbSupport = (): ThunkAction<void> => {\n    return async (dispatch, getState, {actions: {runtimeAction}}) => {\n      dispatch(RuntimeActionCreator.startCheckIndexedDb());\n      try {\n        await runtimeAction.hasIndexedDbSupport();\n        dispatch(RuntimeActionCreator.finishCheckIndexedDb(true));\n      } catch (error) {\n        dispatch(RuntimeActionCreator.finishCheckIndexedDb(false));\n      }\n    };\n  };\n\n  checkCookieSupport = (): ThunkAction<void> => {\n    return async (dispatch, getState, {actions: {runtimeAction}}) => {\n      dispatch(RuntimeActionCreator.startCheckCookie());\n      try {\n        await runtimeAction.hasCookieSupport();\n        dispatch(RuntimeActionCreator.finishCheckCookie(true));\n      } catch (error) {\n        dispatch(RuntimeActionCreator.finishCheckCookie(false));\n      }\n    };\n  };\n\n  hasCookieSupport = (): Promise<void> => {\n    const cookieName = 'cookie_supported';\n\n    return new Promise((resolve, reject) => {\n      switch (navigator.cookieEnabled) {\n        case true:\n          return resolve();\n        case false:\n          return reject(new Error());\n        default:\n          Cookies.set(cookieName, 'yes');\n          if (Cookies.get(cookieName)) {\n            Cookies.remove(cookieName);\n            return resolve();\n          }\n          return reject(new Error());\n      }\n    });\n  };\n\n  hasIndexedDbSupport = (): Promise<void> => {\n    let supportIndexedDb;\n    try {\n      supportIndexedDb = !!window.indexedDB;\n    } catch (error) {\n      supportIndexedDb = false;\n    }\n    if (!supportIndexedDb) {\n      return Promise.reject(new Error('IndexedDB not supported'));\n    }\n\n    if (Runtime.isFirefox()) {\n      let dbOpenRequest: IDBOpenDBRequest;\n\n      try {\n        dbOpenRequest = window.indexedDB.open('test');\n      } catch (error) {\n        return Promise.reject(new Error('Error initializing IndexedDB'));\n      }\n\n      return new Promise((resolve, reject) => {\n        const connectionTimeout = setTimeout(\n          () => reject(new Error('Error opening IndexedDB (response timeout)')),\n          10000,\n        );\n        dbOpenRequest.onerror = event => {\n          clearTimeout(connectionTimeout);\n          if (dbOpenRequest.error) {\n            event.preventDefault();\n            return reject(new Error('Error opening IndexedDB'));\n          }\n          return undefined;\n        };\n        dbOpenRequest.onsuccess = event => {\n          clearTimeout(connectionTimeout);\n          resolve();\n        };\n      });\n    }\n\n    return Promise.resolve();\n  };\n}\n\nexport const runtimeAction = new RuntimeAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {TeamData} from '@wireapp/api-client/lib/team/';\n\nimport type {RootState} from '../reducer';\nimport type {RegistrationDataState} from '../reducer/authReducer';\n\nexport const REGISTER_FLOW = {\n  GENERIC_INVITATION: 'REGISTER_FLOW_GENERIC_INVITATION',\n  PERSONAL: 'REGISTER_FLOW_PERSONAL',\n  TEAM: 'REGISTER_FLOW_TEAM',\n};\n\nconst unsetRegistrationData: RegistrationDataState = {\n  accent_id: 0,\n  assets: [],\n  email: undefined,\n  email_code: undefined,\n  invitation_code: undefined,\n  label: undefined,\n  locale: undefined,\n  name: undefined,\n  password: undefined,\n  phone: undefined,\n  phone_code: undefined,\n  team: undefined,\n  termsAccepted: false,\n};\n\nconst unsetTeam: TeamData = {\n  creator: undefined,\n  icon: undefined,\n  id: undefined,\n  name: undefined,\n};\n\nexport const isAuthenticated = (state: RootState) => state.authState.isAuthenticated;\nexport const isFetching = (state: RootState) => state.authState.fetching;\nexport const isSendingTwoFactorCode = (state: RootState) => state.authState.isSendingTwoFactorCode;\nexport const isFetchingSSOSettings = (state: RootState) => state.authState.fetchingSSOSettings;\nexport const getDefaultSSOCode = (state: RootState) => state.authState.ssoSettings?.default_sso_code;\nexport const hasDefaultSSOCode = (state: RootState) => !!state.authState.ssoSettings?.default_sso_code;\nexport const getError = (state: RootState) => state.authState.error;\nexport const getLoginData = (state: RootState) => state.authState.loginData;\nexport const getCurrentFlow = (state: RootState) => state.authState.currentFlow;\nexport const getEntropy = (state: RootState) => state.authState.entropy;\nexport const getAccount = (state: RootState): RegistrationDataState => state.authState.account || unsetRegistrationData;\nexport const getAccountTeam = (state: RootState) => getAccount(state).team || unsetTeam;\nexport const getAccountTeamName = (state: RootState) => getAccountTeam(state).name;\n\nexport const isGenericInvitationFlow = (state: RootState) => getCurrentFlow(state) === REGISTER_FLOW.GENERIC_INVITATION;\nexport const isPersonalFlow = (state: RootState) => getCurrentFlow(state) === REGISTER_FLOW.PERSONAL;\nexport const isTeamFlow = (state: RootState) => getCurrentFlow(state) === REGISTER_FLOW.TEAM;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {SSOSettings} from '@wireapp/api-client/lib/account/SSOSettings';\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {ClientType} from '@wireapp/api-client/lib/client/';\nimport type {TeamData} from '@wireapp/api-client/lib/team/';\nimport type {UserAsset} from '@wireapp/api-client/lib/user/';\n\nimport {Config} from '../../../Config';\nimport {AUTH_ACTION, AppActions, USER_ACTION} from '../action/creator/';\nimport {REGISTER_FLOW} from '../selector/AuthSelector';\n\nexport interface RegistrationDataState {\n  accent_id: number;\n  assets: UserAsset[];\n  email: string;\n  email_code: string;\n  invitation_code: string;\n  label: string;\n  locale: string;\n  name: string;\n  password: string;\n  phone: string;\n  phone_code: string;\n  team: TeamData;\n  termsAccepted: boolean;\n}\n\nexport type LoginDataState = Pick<LoginData, 'clientType' | 'phone'>;\n\nexport type AuthState = {\n  readonly account: RegistrationDataState;\n  readonly currentFlow: string;\n  readonly entropy?: Uint8Array;\n  readonly error: Error;\n  readonly fetched: boolean;\n  readonly fetching: boolean;\n  readonly fetchingSSOSettings: boolean;\n  readonly isAuthenticated: boolean;\n  readonly isSendingTwoFactorCode: boolean;\n  readonly loginData: LoginDataState;\n  readonly ssoSettings?: SSOSettings;\n};\n\nexport const initialAuthState: AuthState = {\n  account: {\n    accent_id: null,\n    assets: null,\n    email: null,\n    email_code: null,\n    invitation_code: null,\n    label: null,\n    locale: null,\n    name: null,\n    password: null,\n    phone: null,\n    phone_code: null,\n    team: null,\n    termsAccepted: false,\n  },\n  currentFlow: null,\n  entropy: null,\n  error: null,\n  fetched: false,\n  fetching: false,\n  fetchingSSOSettings: true,\n  isAuthenticated: false,\n  isSendingTwoFactorCode: false,\n  loginData: {\n    clientType: Config.getConfig().FEATURE.DEFAULT_LOGIN_TEMPORARY_CLIENT ? ClientType.TEMPORARY : ClientType.PERMANENT,\n  },\n  ssoSettings: {\n    default_sso_code: undefined,\n  },\n};\n\nexport function authReducer(state: AuthState = initialAuthState, action: AppActions): AuthState {\n  switch (action.type) {\n    case AUTH_ACTION.LOGIN_START:\n    case AUTH_ACTION.REGISTER_JOIN_START:\n    case AUTH_ACTION.REGISTER_PERSONAL_START:\n    case AUTH_ACTION.REGISTER_TEAM_START:\n    case USER_ACTION.USER_SEND_ACTIVATION_CODE_START: {\n      return {\n        ...state,\n        error: null,\n        fetching: true,\n        isAuthenticated: false,\n      };\n    }\n    case AUTH_ACTION.SEND_TWO_FACTOR_CODE_START: {\n      return {\n        ...state,\n        isSendingTwoFactorCode: true,\n      };\n    }\n    case AUTH_ACTION.SEND_TWO_FACTOR_CODE_SUCCESS:\n    case AUTH_ACTION.SEND_TWO_FACTOR_CODE_FAILED: {\n      return {\n        ...state,\n        isSendingTwoFactorCode: false,\n      };\n    }\n    case AUTH_ACTION.REFRESH_START: {\n      return {\n        ...state,\n        error: null,\n        fetching: true,\n      };\n    }\n    case AUTH_ACTION.REFRESH_FAILED: {\n      return {\n        ...state,\n        fetching: false,\n        isAuthenticated: false,\n      };\n    }\n    case AUTH_ACTION.LOGIN_FAILED:\n    case AUTH_ACTION.REGISTER_JOIN_FAILED:\n    case AUTH_ACTION.REGISTER_PERSONAL_FAILED:\n    case AUTH_ACTION.REGISTER_TEAM_FAILED:\n    case USER_ACTION.USER_SEND_ACTIVATION_CODE_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n        isAuthenticated: false,\n      };\n    }\n    case AUTH_ACTION.LOGIN_SUCCESS:\n    case AUTH_ACTION.REFRESH_SUCCESS:\n    case AUTH_ACTION.REGISTER_JOIN_SUCCESS:\n    case AUTH_ACTION.REGISTER_PERSONAL_SUCCESS:\n    case AUTH_ACTION.REGISTER_TEAM_SUCCESS: {\n      return {\n        ...state,\n        account: {...initialAuthState.account},\n        error: null,\n        fetched: true,\n        fetching: false,\n        isAuthenticated: true,\n      };\n    }\n    case AUTH_ACTION.GET_SSO_SETTINGS_START: {\n      return {\n        ...state,\n        fetchingSSOSettings: true,\n      };\n    }\n    case AUTH_ACTION.GET_SSO_SETTINGS_SUCCESS: {\n      return {\n        ...state,\n        fetchingSSOSettings: false,\n        ssoSettings: action.payload,\n      };\n    }\n    case AUTH_ACTION.GET_SSO_SETTINGS_FAILED: {\n      return {\n        ...state,\n        fetchingSSOSettings: false,\n      };\n    }\n    case AUTH_ACTION.REGISTER_PUSH_ACCOUNT_DATA: {\n      return {...state, account: {...state.account, ...action.payload}, error: null};\n    }\n    case AUTH_ACTION.REGISTER_PUSH_ENTROPY_DATA: {\n      return {...state, entropy: action.payload, error: null};\n    }\n    case AUTH_ACTION.REGISTER_RESET_ACCOUNT_DATA: {\n      return {...state, account: {...initialAuthState.account}, error: null};\n    }\n    case AUTH_ACTION.PUSH_LOGIN_DATA: {\n      return {...state, error: null, loginData: {...state.loginData, ...action.payload}};\n    }\n    case AUTH_ACTION.RESET_LOGIN_DATA: {\n      return {...state, error: null, loginData: {...initialAuthState.loginData}};\n    }\n    case AUTH_ACTION.LOGOUT_SUCCESS: {\n      return {...initialAuthState, fetchingSSOSettings: false};\n    }\n    case AUTH_ACTION.SILENT_LOGOUT_SUCCESS: {\n      return {\n        ...state,\n        error: null,\n        isAuthenticated: false,\n      };\n    }\n    case AUTH_ACTION.AUTH_RESET_ERROR: {\n      return {...state, error: null};\n    }\n    case AUTH_ACTION.ENTER_TEAM_CREATION_FLOW: {\n      return {...state, currentFlow: REGISTER_FLOW.TEAM};\n    }\n    case AUTH_ACTION.ENTER_PERSONAL_CREATION_FLOW: {\n      return {...state, currentFlow: REGISTER_FLOW.PERSONAL, account: {...initialAuthState.account}};\n    }\n    case AUTH_ACTION.ENTER_GENERIC_INVITATION_FLOW: {\n      return {...state, currentFlow: REGISTER_FLOW.GENERIC_INVITATION};\n    }\n    case USER_ACTION.USER_SEND_ACTIVATION_CODE_SUCCESS: {\n      return {\n        ...state,\n        fetching: false,\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {RegisteredClient} from '@wireapp/api-client/lib/client/';\n\nimport {AUTH_ACTION, AppActions, CLIENT_ACTION} from '../action/creator/';\n\nexport interface ClientState {\n  clients: RegisteredClient[] | null;\n  currentClient: RegisteredClient | null;\n  error: Error | null;\n  fetching: boolean;\n  isNewClient: boolean;\n}\n\nexport const initialClientState: ClientState = {\n  clients: null,\n  currentClient: null,\n  error: null,\n  fetching: false,\n  isNewClient: false,\n};\n\nexport function clientReducer(state: ClientState = initialClientState, action: AppActions): ClientState {\n  switch (action.type) {\n    case CLIENT_ACTION.CLIENT_INIT_SUCCESS: {\n      return {\n        ...state,\n        currentClient: action.payload.client,\n        isNewClient: action.payload.isNew,\n      };\n    }\n    case CLIENT_ACTION.CLIENTS_FETCH_START: {\n      return {\n        ...state,\n        fetching: true,\n      };\n    }\n    case CLIENT_ACTION.CLIENTS_FETCH_SUCCESS: {\n      return {\n        ...state,\n        clients: action.payload,\n        error: null,\n        fetching: false,\n      };\n    }\n    case CLIENT_ACTION.CLIENTS_FETCH_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n      };\n    }\n    case CLIENT_ACTION.CLIENT_REMOVE_START: {\n      return {\n        ...state,\n        fetching: true,\n      };\n    }\n    case CLIENT_ACTION.CLIENT_REMOVE_SUCCESS: {\n      return {\n        ...state,\n        clients: [...(state.clients ?? []).filter(client => client.id !== action.payload)],\n        error: null,\n        fetching: false,\n      };\n    }\n    case CLIENT_ACTION.CLIENT_REMOVE_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n      };\n    }\n    case CLIENT_ACTION.CLIENT_RESET_ERROR: {\n      return {...state, error: null};\n    }\n    case AUTH_ACTION.LOGOUT_SUCCESS: {\n      return {...initialClientState};\n    }\n    default:\n      return state;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AppActions, CONVERSATION_ACTION} from '../action/creator/';\n\nexport interface ConversationState {\n  error: Error & {label?: string};\n  fetched: boolean;\n  fetching: boolean;\n}\n\nexport const initialConversationState: ConversationState = {\n  error: null,\n  fetched: false,\n  fetching: false,\n};\n\nexport function conversationReducer(\n  state: ConversationState = initialConversationState,\n  action: AppActions,\n): ConversationState {\n  switch (action.type) {\n    case CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_START:\n    case CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_START: {\n      return {\n        ...state,\n        error: null,\n        fetching: true,\n      };\n    }\n    case CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_FAILED:\n    case CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n      };\n    }\n    case CONVERSATION_ACTION.CONVERSATION_CODE_CHECK_SUCCESS:\n    case CONVERSATION_ACTION.CONVERSATION_CODE_JOIN_SUCCESS: {\n      return {\n        ...state,\n        fetching: false,\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {TeamInvitation} from '@wireapp/api-client/lib/team/';\n\nimport {INVITATION_ACTION, InvitationActions} from '../action/creator/';\n\nexport interface InvitationState {\n  error: Error;\n  fetching: boolean;\n  invites: TeamInvitation[];\n}\n\nexport const initialInvitationState: InvitationState = {\n  error: null,\n  fetching: false,\n  invites: [],\n};\n\nexport function invitationReducer(\n  state: InvitationState = initialInvitationState,\n  action: InvitationActions,\n): InvitationState {\n  switch (action.type) {\n    case INVITATION_ACTION.INVITE_ADD_START: {\n      return {\n        ...state,\n        fetching: true,\n      };\n    }\n    case INVITATION_ACTION.INVITE_ADD_SUCCESS: {\n      return {\n        error: null,\n        fetching: false,\n        invites: [...state.invites, action.payload.invite],\n      };\n    }\n    case INVITATION_ACTION.INVITE_ADD_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n      };\n    }\n    case INVITATION_ACTION.INVITE_RESET_ERROR: {\n      return {...state, error: null};\n    }\n    default:\n      return state;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {currentLanguage, findLanguage, mapLanguage} from '../../localeConfig';\nimport {AppActions, LANGUAGE_ACTION} from '../action/creator/';\n\nexport interface LanguageState {\n  language: string;\n}\n\nexport const initialLanguageState: LanguageState = {\n  language: mapLanguage(currentLanguage()),\n};\n\nexport function languageReducer(state: LanguageState = initialLanguageState, action: AppActions): LanguageState {\n  switch (action.type) {\n    case LANGUAGE_ACTION.SWITCH_LANGUAGE_SUCCESS:\n      return {\n        language: findLanguage(action.payload) || state.language,\n      };\n    default:\n      return state;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AppActions, RUNTIME_ACTION} from '../action/creator/';\n\nexport interface RuntimeState {\n  hasCookieSupport: boolean;\n  hasIndexedDbSupport: boolean;\n  isCheckingCookie: boolean;\n  isCheckingIndexedDb: boolean;\n  isSupportedBrowser: boolean;\n}\n\nexport const initialRuntimeState: RuntimeState = {\n  hasCookieSupport: false,\n  hasIndexedDbSupport: false,\n  isCheckingCookie: false,\n  isCheckingIndexedDb: false,\n  isSupportedBrowser: false,\n};\n\nexport function runtimeReducer(state: RuntimeState = initialRuntimeState, action: AppActions): RuntimeState {\n  switch (action.type) {\n    case RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_START:\n      return {\n        ...state,\n        isCheckingIndexedDb: true,\n      };\n    case RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_START:\n      return {\n        ...state,\n        isCheckingCookie: true,\n      };\n    case RUNTIME_ACTION.RUNTIME_CHECK_INDEXEDDB_FINISH:\n      return {\n        ...state,\n        hasIndexedDbSupport: action.payload,\n        isCheckingIndexedDb: false,\n      };\n    case RUNTIME_ACTION.RUNTIME_CHECK_COOKIE_FINISH:\n      return {\n        ...state,\n        hasCookieSupport: action.payload,\n        isCheckingCookie: false,\n      };\n    case RUNTIME_ACTION.RUNTIME_CONFIRM_SUPPORTED_BROWSER:\n      return {\n        ...state,\n        isSupportedBrowser: true,\n      };\n    default:\n      return state;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {Self} from '@wireapp/api-client/lib/self/';\n\nimport {AppActions, SELF_ACTION} from '../action/creator/';\n\nexport interface SelfState {\n  consents: {[key: number]: number};\n  error: Error;\n  fetched: boolean;\n  fetching: boolean;\n  hasPassword: boolean;\n  self: Self;\n}\n\nexport const initialSelfState: SelfState = {\n  consents: {},\n  error: null,\n  fetched: false,\n  fetching: false,\n  hasPassword: false,\n  self: {assets: [], id: null, locale: null, name: null, team: null},\n};\n\nexport function selfReducer(state: SelfState = initialSelfState, action: AppActions): SelfState {\n  switch (action.type) {\n    case SELF_ACTION.CONSENT_GET_START:\n    case SELF_ACTION.HANDLE_SET_START:\n    case SELF_ACTION.SELF_SET_PASSWORD_STATE_START:\n    case SELF_ACTION.SELF_FETCH_START: {\n      return {\n        ...state,\n        fetching: true,\n      };\n    }\n    case SELF_ACTION.CONSENT_GET_FAILED:\n    case SELF_ACTION.HANDLE_SET_FAILED:\n    case SELF_ACTION.SELF_FETCH_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        fetching: false,\n      };\n    }\n    case SELF_ACTION.HANDLE_SET_SUCCESS:\n    case SELF_ACTION.SELF_FETCH_SUCCESS: {\n      return {\n        ...state,\n        error: null,\n        fetched: true,\n        fetching: false,\n        self: action.payload,\n      };\n    }\n    case SELF_ACTION.CONSENT_GET_SUCCESS: {\n      return {\n        ...state,\n        consents: action.payload.reduce<Record<number, number>>((consentAccumulator, consent) => {\n          consentAccumulator[consent.type] = consent.value;\n          return consentAccumulator;\n        }, {}),\n        error: null,\n        fetched: true,\n        fetching: false,\n      };\n    }\n    case SELF_ACTION.SELF_SET_PASSWORD_STATE_SUCCESS: {\n      return {\n        ...state,\n        hasPassword: action.payload,\n      };\n    }\n    case SELF_ACTION.SELF_SET_PASSWORD_STATE_FAILED: {\n      return {\n        ...state,\n        error: action.error,\n        hasPassword: false,\n      };\n    }\n    case SELF_ACTION.CONSENT_SET_SUCCESS: {\n      return {\n        ...state,\n        consents: {...state.consents, [action.payload.type]: action.payload.value},\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ActionCreatorsMapObject, AnyAction, Dispatch, bindActionCreators as bindActionCreatorsRedux} from 'redux';\nimport type {ThunkAction as ReduxThunkAction, ThunkDispatch as ReduxThunkDispatch} from 'redux-thunk';\n\nimport type {APIClient} from '@wireapp/api-client';\nimport type {Account} from '@wireapp/core';\n\nimport {AuthState, authReducer, initialAuthState} from './authReducer';\nimport {ClientState, clientReducer, initialClientState} from './clientReducer';\nimport {ConversationState, conversationReducer, initialConversationState} from './conversationReducer';\nimport {InvitationState, initialInvitationState, invitationReducer} from './inviteReducer';\nimport {LanguageState, initialLanguageState, languageReducer} from './languageReducer';\nimport {RuntimeState, initialRuntimeState, runtimeReducer} from './runtimeReducer';\nimport {SelfState, initialSelfState, selfReducer} from './selfReducer';\n\nimport type {Configuration} from '../../../Config';\nimport type {ActionRoot} from '../action';\n\nexport type Api = {\n  actions: ActionRoot;\n  apiClient: APIClient;\n  core: Account;\n  getConfig: () => Configuration;\n  localStorage: Storage;\n};\n\nexport interface RootState {\n  authState: AuthState;\n  clientState: ClientState;\n  conversationState: ConversationState;\n  inviteState: InvitationState;\n  languageState: LanguageState;\n  runtimeState: RuntimeState;\n  selfState: SelfState;\n}\n\nexport const initialRootState: RootState = {\n  authState: initialAuthState,\n  clientState: initialClientState,\n  conversationState: initialConversationState,\n  inviteState: initialInvitationState,\n  languageState: initialLanguageState,\n  runtimeState: initialRuntimeState,\n  selfState: initialSelfState,\n};\n\nexport type ThunkAction<T = Promise<void>> = ReduxThunkAction<T, RootState, Api, AnyAction>;\nexport type ThunkDispatch = ReduxThunkDispatch<RootState, Api, AnyAction>;\n\nexport type BindActionCreators = <M extends ActionCreatorsMapObject<any>>(\n  actionCreators: M,\n  dispatch: Dispatch,\n) => {\n  [N in keyof M]: ReturnType<M[N]> extends ReduxThunkAction<any, any, any, any>\n    ? (...args: Parameters<M[N]>) => ReturnType<ReturnType<M[N]>>\n    : M[N];\n};\n\nexport const bindActionCreators: BindActionCreators = bindActionCreatorsRedux;\n\nexport const reducers = {\n  authState: authReducer,\n  clientState: clientReducer,\n  conversationState: conversationReducer,\n  inviteState: invitationReducer,\n  languageState: languageReducer,\n  runtimeState: runtimeReducer,\n  selfState: selfReducer,\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Store, applyMiddleware, combineReducers, createStore} from 'redux';\nimport {composeWithDevTools} from 'redux-devtools-extension/developmentOnly';\nimport thunk from 'redux-thunk';\n\nimport {LOGGER_NAMESPACE} from 'Util/Logger';\n\nimport {runtimeAction} from './module/action/RuntimeAction';\nimport {RootState, ThunkDispatch, reducers} from './module/reducer';\n\nconst reduxLogdown = require('redux-logdown');\n\nconst configureStore = (thunkArguments: object = {}) => {\n  const store: Store<RootState> = createStore(combineReducers(reducers), createMiddleware(thunkArguments));\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (module.hot) {\n      module.hot.accept('./module/reducer/index.ts', () => {\n        store.replaceReducer(combineReducers(require('./module/reducer/index.ts').default) as any);\n      });\n    }\n  }\n\n  const dispatch: ThunkDispatch = store.dispatch;\n  dispatch(runtimeAction.checkIndexedDbSupport());\n  dispatch(runtimeAction.checkCookieSupport());\n  dispatch(runtimeAction.checkSupportedBrowser());\n\n  return store;\n};\n\nconst createLoggerMiddleware = () => reduxLogdown(LOGGER_NAMESPACE, {diff: true});\n\nconst createMiddleware = (thunkArguments: object) => {\n  const middlewares = [thunk.withExtraArgument(thunkArguments), createLoggerMiddleware()];\n\n  // Note: Redux DevTools will only be applied when NODE_ENV is NOT production\n  // https://github.com/zalmoxisus/redux-devtools-extension/blob/master/npm-package/developmentOnly.js\n  return composeWithDevTools(applyMiddleware(...middlewares));\n};\n\nexport {configureStore};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport class BackendError extends Error {\n  public code: number;\n  public label: string;\n\n  constructor(params: {code: number; label?: string; message?: string}) {\n    super();\n    this.name = this.constructor.name;\n    this.stack = new Error().stack;\n    this.code = params.code;\n    this.label = params.label;\n    this.message = params.message;\n  }\n\n  static AUTH_ERRORS = {\n    BLACKLISTED_EMAIL: 'blacklisted-email',\n    BLACKLISTED_PHONE: 'blacklisted-phone',\n    CODE_AUTHENTICATION_FAILED: 'code-authentication-failed',\n    CODE_AUTHENTICATION_REQUIRED: 'code-authentication-required',\n    DOMAIN_BLOCKED_FOR_REGISTRATION: 'domain-blocked-for-registration',\n    INVALID_CODE: 'invalid-code',\n    INVALID_CREDENTIALS: 'invalid-credentials',\n    INVALID_EMAIL: 'invalid-email',\n    INVALID_INVITATION_CODE: 'invalid-invitation-code',\n    INVALID_PHONE: 'invalid-phone',\n    KEY_EXISTS: 'key-exists',\n    MISSING_AUTH: 'missing-auth',\n    PASSWORD_EXISTS: 'password-exists',\n    PENDING_ACTIVATION: 'pending-activation',\n    PENDING_LOGIN: 'pending-login',\n    SUSPENDED: 'suspended',\n    TOO_MANY_LOGINS: 'client-error',\n  };\n\n  static CLIENT_ERRORS = {\n    TOO_MANY_CLIENTS: 'too-many-clients',\n  };\n\n  static CONVERSATION_ERRORS = {\n    CONVERSATION_CODE_NOT_FOUND: 'no-conversation-code',\n    CONVERSATION_NOT_FOUND: 'no-conversation',\n    CONVERSATION_TOO_MANY_MEMBERS: 'too-many-members',\n  };\n\n  static GENERAL_ERRORS = {\n    ACCESS_DENIED: 'access-denied',\n    BAD_REQUEST: 'bad-request',\n    INVALID_OPERATION: 'invalid-op',\n    INVALID_PAYLOAD: 'invalid-payload',\n    NOT_FOUND: 'not-found',\n    OPERATION_DENIED: 'operation-denied',\n    TOO_MANY_REQUESTS: 'too-many-requests', // Synthetic error label\n    UNAUTHORIZED: 'unauthorized',\n  };\n\n  static HANDLE_ERRORS = {\n    HANDLE_EXISTS: 'handle-exists',\n    HANDLE_TOO_SHORT: 'handle-too-short', // Synthetic error label\n    INVALID_HANDLE: 'invalid-handle',\n  };\n\n  static TEAM_ERRORS = {\n    NO_OTHER_OWNER: 'no-other-owner',\n    NO_TEAM: 'no-team',\n    NO_TEAM_MEMBER: 'no-team-member',\n    TOO_MANY_MEMBERS: 'too-many-team-members',\n  };\n\n  static TEAM_INVITE_ERRORS = {\n    ALREADY_INVITED: 'already-invited', // Synthetic error label\n    EMAIL_EXISTS: 'email-exists',\n  };\n\n  static PAYMENT_ERRORS = {\n    EXPIRED_CARD: 'expired_card',\n  };\n\n  static SSO_ERRORS = {\n    SSO_FORBIDDEN: 'forbidden',\n    SSO_GENERIC_ERROR: 'generic-sso-error', // Synthetic error label\n    SSO_INSUFFICIENT_PERMISSIONS: 'insufficient-permissions',\n    SSO_INVALID_FAILURE_REDIRECT: 'bad-failure-redirect',\n    SSO_INVALID_SUCCESS_REDIRECT: 'bad-success-redirect',\n    SSO_INVALID_UPSTREAM: 'bad-upstream',\n    SSO_INVALID_USERNAME: 'bad-username',\n    SSO_NOT_FOUND: 'not-found',\n    SSO_NO_MATCHING_AUTH: 'no-matching-auth-req',\n    SSO_SERVER_ERROR: 'server-error',\n    SSO_UNSUPPORTED_SAML: 'server-error-unsupported-saml',\n    SSO_USER_CANCELLED_ERROR: 'user-cancelled-sso-error', // Synthetic error label\n  };\n\n  static LABEL = {\n    ...BackendError.AUTH_ERRORS,\n    ...BackendError.CONVERSATION_ERRORS,\n    ...BackendError.GENERAL_ERRORS,\n    ...BackendError.CLIENT_ERRORS,\n    ...BackendError.HANDLE_ERRORS,\n    ...BackendError.TEAM_ERRORS,\n    ...BackendError.TEAM_INVITE_ERRORS,\n    ...BackendError.PAYMENT_ERRORS,\n    ...BackendError.SSO_ERRORS,\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport class LabeledError extends Error {\n  public label: string;\n\n  constructor(label: string, error: Error);\n  constructor(label: string, message: string);\n  constructor(label: string, messageOrError: string | Error) {\n    super();\n    this.label = label;\n\n    if (typeof messageOrError === 'string') {\n      this.name = this.constructor.name;\n      this.message = messageOrError;\n    } else {\n      this.name = messageOrError.name;\n      this.message = messageOrError.message;\n      this.stack = messageOrError.stack;\n    }\n  }\n\n  static GENERAL_ERRORS = {\n    LOW_DISK_SPACE: 'low-disk-space',\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {LocalStorageActionCreator} from './creator/';\n\nimport type {ThunkAction} from '../reducer';\n\nexport const LocalStorageKey = {\n  AUTH: {\n    COOKIE_LABEL: '__amplify__z.storage.StorageKey.AUTH.COOKIE_LABEL',\n    LOGIN_CONVERSATION_KEY: 'LOGIN_CONVERSATION_KEY',\n    PERSIST: '__amplify__z.storage.StorageKey.AUTH.PERSIST',\n  },\n};\n\nexport class LocalStorageAction {\n  setLocalStorage = (key: string, value: any): ThunkAction => {\n    return async (dispatch, getState, {localStorage}) => {\n      dispatch(LocalStorageActionCreator.startLocalStorageSet());\n      try {\n        localStorage.setItem(key, JSON.stringify({data: value}));\n        dispatch(LocalStorageActionCreator.successfulLocalStorageSet(key, value));\n      } catch (error) {\n        dispatch(LocalStorageActionCreator.failedLocalStorageSet(error));\n        throw error;\n      }\n    };\n  };\n\n  getLocalStorage = (key: string): ThunkAction<Promise<any>> => {\n    return async (dispatch, getState, {localStorage}) => {\n      dispatch(LocalStorageActionCreator.startLocalStorageGet());\n      let data: string | boolean | number;\n      try {\n        data = JSON.parse(localStorage.getItem(key) ?? '{}').data;\n        dispatch(LocalStorageActionCreator.successfulLocalStorageGet(key, data));\n        return data;\n      } catch (error) {\n        dispatch(LocalStorageActionCreator.failedLocalStorageGet(error));\n        throw error;\n      }\n    };\n  };\n\n  deleteLocalStorage = (key: string): ThunkAction => {\n    return async (dispatch, getState, {localStorage}) => {\n      dispatch(LocalStorageActionCreator.startLocalStorageDelete());\n      try {\n        localStorage.removeItem(key);\n        dispatch(LocalStorageActionCreator.successfulLocalStorageDelete(key));\n      } catch (error) {\n        dispatch(LocalStorageActionCreator.failedLocalStorageDelete(error));\n        throw error;\n      }\n    };\n  };\n}\n\nexport const localStorageAction = new LocalStorageAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {DomainData} from '@wireapp/api-client/lib/account/DomainData';\nimport type {LoginData, RegisterData, SendLoginCode} from '@wireapp/api-client/lib/auth/';\nimport {VerificationActionType} from '@wireapp/api-client/lib/auth/VerificationActionType';\nimport {ClientType} from '@wireapp/api-client/lib/client/';\nimport {LowDiskSpaceError} from '@wireapp/store-engine/lib/engine/error';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\n\nimport type {CRUDEngine} from '@wireapp/store-engine';\nimport {SQLeetEngine} from '@wireapp/store-engine-sqleet';\n\nimport {isTemporaryClientAndNonPersistent} from 'Util/util';\n\nimport {BackendError} from './BackendError';\nimport {AuthActionCreator} from './creator/';\nimport {LabeledError} from './LabeledError';\nimport {LocalStorageAction, LocalStorageKey} from './LocalStorageAction';\n\nimport {currentCurrency, currentLanguage} from '../../localeConfig';\nimport type {Api, RootState, ThunkAction, ThunkDispatch} from '../reducer';\nimport type {LoginDataState, RegistrationDataState} from '../reducer/authReducer';\n\ntype LoginLifecycleFunction = (dispatch: ThunkDispatch, getState: () => RootState, global: Api) => Promise<void>;\n\nexport class AuthAction {\n  doFlushDatabase = (): ThunkAction => {\n    return async (dispatch, getState, {core}) => {\n      const storeEngine: CRUDEngine = (core as any).storeEngine;\n      if (storeEngine instanceof SQLeetEngine) {\n        await (core as any).storeEngine.save();\n      }\n    };\n  };\n\n  doLogin = (loginData: LoginData, getEntropy?: () => Promise<Uint8Array>): ThunkAction => {\n    const onBeforeLogin: LoginLifecycleFunction = async (dispatch, getState, {actions: {authAction}}) =>\n      dispatch(authAction.doSilentLogout());\n    return this.doLoginPlain(loginData, onBeforeLogin, undefined, getEntropy);\n  };\n\n  doLoginAndJoin = (\n    loginData: LoginData,\n    key: string,\n    code: string,\n    uri?: string,\n    getEntropy?: () => Promise<Uint8Array>,\n  ): ThunkAction => {\n    const onBeforeLogin: LoginLifecycleFunction = async (dispatch, getState, {actions: {authAction}}) =>\n      dispatch(authAction.doSilentLogout());\n    const onAfterLogin: LoginLifecycleFunction = async (\n      dispatch,\n      getState,\n      {actions: {localStorageAction, conversationAction}},\n    ) => {\n      const conversation = await dispatch(conversationAction.doJoinConversationByCode(key, code, uri));\n      const domain = conversation?.qualified_conversation?.domain;\n      return (\n        conversation &&\n        (await dispatch(\n          localStorageAction.setLocalStorage(LocalStorageKey.AUTH.LOGIN_CONVERSATION_KEY, {\n            conversation: conversation.conversation,\n            domain,\n          }),\n        ))\n      );\n    };\n\n    return this.doLoginPlain(loginData, onBeforeLogin, onAfterLogin, getEntropy);\n  };\n\n  doLoginPlain = (\n    loginData: LoginData,\n    onBeforeLogin: LoginLifecycleFunction = async () => {},\n    onAfterLogin: LoginLifecycleFunction = async () => {},\n    getEntropy?: () => Promise<Uint8Array>,\n  ): ThunkAction => {\n    return async (dispatch, getState, global) => {\n      const {\n        core,\n        actions: {clientAction, selfAction, localStorageAction},\n      } = global;\n      dispatch(AuthActionCreator.startLogin());\n      try {\n        await onBeforeLogin(dispatch, getState, global);\n        await core.login(loginData);\n        await this.persistClientData(loginData.clientType, dispatch, localStorageAction);\n        await dispatch(selfAction.fetchSelf());\n        let entropyData: Uint8Array | undefined = undefined;\n        if (getEntropy) {\n          const existingClient = await core.service!.client.loadClient();\n          entropyData = existingClient ? undefined : await getEntropy();\n        }\n        await onAfterLogin(dispatch, getState, global);\n        await dispatch(\n          clientAction.doInitializeClient(\n            loginData.clientType,\n            loginData.password ? String(loginData.password) : undefined,\n            loginData.verificationCode,\n            entropyData,\n          ),\n        );\n        dispatch(AuthActionCreator.successfulLogin());\n      } catch (error) {\n        if (error.label === BackendError.LABEL.TOO_MANY_CLIENTS) {\n          dispatch(AuthActionCreator.successfulLogin());\n        } else {\n          if (error instanceof LowDiskSpaceError) {\n            error = new LabeledError(LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE, error);\n          }\n          dispatch(AuthActionCreator.failedLogin(error));\n        }\n        throw error;\n      }\n    };\n  };\n\n  doSendPhoneLoginCode = (loginRequest: Omit<SendLoginCode, 'voice_call'>): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(AuthActionCreator.startSendPhoneLoginCode());\n      try {\n        const {expires_in} = await apiClient.api.auth.postLoginSend(loginRequest);\n        dispatch(AuthActionCreator.successfulSendPhoneLoginCode(expires_in));\n      } catch (error) {\n        dispatch(AuthActionCreator.failedSendPhoneLoginCode(error));\n        throw error;\n      }\n    };\n  };\n\n  doSendTwoFactorLoginCode = (email: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(AuthActionCreator.startSendTwoFactorCode());\n      try {\n        await apiClient.api.user.postVerificationCode(email, VerificationActionType.LOGIN);\n        dispatch(AuthActionCreator.successfulSendTwoFactorCode());\n      } catch (error) {\n        dispatch(AuthActionCreator.failedSendTwoFactorCode(error));\n        throw error;\n      }\n    };\n  };\n\n  doFinalizeSSOLogin = ({clientType}: {clientType: ClientType}): ThunkAction => {\n    return async (dispatch, getState, {getConfig, core, actions: {clientAction, selfAction, localStorageAction}}) => {\n      dispatch(AuthActionCreator.startLogin());\n      try {\n        await core.init(clientType);\n        await this.persistClientData(clientType, dispatch, localStorageAction);\n        await dispatch(selfAction.fetchSelf());\n        await dispatch(clientAction.doInitializeClient(clientType));\n        dispatch(AuthActionCreator.successfulLogin());\n      } catch (error) {\n        if (error.label === BackendError.LABEL.TOO_MANY_CLIENTS) {\n          dispatch(AuthActionCreator.successfulLogin());\n        } else {\n          dispatch(AuthActionCreator.failedLogin(error));\n        }\n        throw error;\n      }\n    };\n  };\n\n  validateSSOCode = (code: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      const mapError = (error: any) => {\n        const statusCode = error?.response?.status;\n        if (statusCode === HTTP_STATUS.NOT_FOUND) {\n          return new BackendError({code: HTTP_STATUS.NOT_FOUND, label: BackendError.SSO_ERRORS.SSO_NOT_FOUND});\n        }\n        if (statusCode >= HTTP_STATUS.INTERNAL_SERVER_ERROR) {\n          return new BackendError({\n            code: HTTP_STATUS.INTERNAL_SERVER_ERROR,\n            label: BackendError.SSO_ERRORS.SSO_SERVER_ERROR,\n          });\n        }\n        return new BackendError({\n          code: HTTP_STATUS.INTERNAL_SERVER_ERROR,\n          label: BackendError.SSO_ERRORS.SSO_GENERIC_ERROR,\n        });\n      };\n\n      try {\n        return await apiClient.api.auth.headInitiateLogin(code);\n      } catch (error) {\n        const mappedError = mapError(error);\n        dispatch(AuthActionCreator.failedLogin(mappedError));\n        throw mappedError;\n      }\n    };\n  };\n\n  private persistClientData = (\n    clientType: ClientType,\n    dispatch: ThunkDispatch,\n    localStorageAction: LocalStorageAction,\n  ): Promise<void> => {\n    if (clientType === ClientType.NONE) {\n      return Promise.resolve();\n    }\n    const persist = clientType === ClientType.PERMANENT;\n    return dispatch(localStorageAction.setLocalStorage(LocalStorageKey.AUTH.PERSIST, persist));\n  };\n\n  pushAccountRegistrationData = (registration: Partial<RegistrationDataState>): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.pushAccountRegistrationData(registration));\n    };\n  };\n\n  pushLoginData = (loginData: Partial<LoginDataState>): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.pushLoginData(loginData));\n    };\n  };\n\n  pushEntropyData = (entropy: Uint8Array): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.pushEntropyData(entropy));\n    };\n  };\n\n  doRegisterTeam = (registration: RegisterData): ThunkAction => {\n    return async (dispatch, getState, {getConfig, core, actions: {clientAction, selfAction, localStorageAction}}) => {\n      const clientType = ClientType.PERMANENT;\n      registration.locale = currentLanguage();\n      registration.name = registration.name.trim();\n      registration.email = registration.email.trim();\n      registration.team.icon = 'default';\n      registration.team.currency = currentCurrency();\n      registration.team.name = registration.team.name.trim();\n\n      dispatch(AuthActionCreator.startRegisterTeam());\n      try {\n        await dispatch(this.doSilentLogout());\n        await core.register(registration, clientType);\n        await this.persistClientData(clientType, dispatch, localStorageAction);\n        await dispatch(selfAction.fetchSelf());\n        await dispatch(clientAction.doInitializeClient(clientType));\n        dispatch(AuthActionCreator.successfulRegisterTeam(registration));\n      } catch (error) {\n        dispatch(AuthActionCreator.failedRegisterTeam(error));\n        throw error;\n      }\n    };\n  };\n\n  doRegisterPersonal = (registration: RegisterData, entropyData: Uint8Array): ThunkAction => {\n    return async (\n      dispatch,\n      getState,\n      {getConfig, core, actions: {authAction, clientAction, selfAction, localStorageAction}},\n    ) => {\n      const clientType = ClientType.PERMANENT;\n      registration.locale = currentLanguage();\n      registration.name = registration.name.trim();\n      registration.email = registration.email.trim();\n\n      dispatch(AuthActionCreator.startRegisterPersonal());\n      try {\n        await dispatch(authAction.doSilentLogout());\n        await core.register(registration, clientType);\n        await this.persistClientData(clientType, dispatch, localStorageAction);\n        await dispatch(selfAction.fetchSelf());\n        await dispatch(clientAction.doInitializeClient(clientType, undefined, undefined, entropyData));\n        dispatch(AuthActionCreator.successfulRegisterPersonal(registration));\n      } catch (error) {\n        dispatch(AuthActionCreator.failedRegisterPersonal(error));\n        throw error;\n      }\n    };\n  };\n\n  doRegisterWireless = (\n    registrationData: RegisterData,\n    options = {shouldInitializeClient: true},\n    entropyData?: Uint8Array,\n  ): ThunkAction => {\n    return async (\n      dispatch,\n      getState,\n      {getConfig, core, actions: {authAction, clientAction, selfAction, localStorageAction}},\n    ) => {\n      const clientType = options.shouldInitializeClient ? ClientType.TEMPORARY : ClientType.NONE;\n      registrationData.locale = currentLanguage();\n      registrationData.name = registrationData.name.trim();\n\n      dispatch(AuthActionCreator.startRegisterWireless());\n      try {\n        await dispatch(authAction.doSilentLogout());\n        await core.register(registrationData, clientType);\n        await this.persistClientData(clientType, dispatch, localStorageAction);\n        await dispatch(selfAction.fetchSelf());\n        await (clientType !== ClientType.NONE &&\n          dispatch(clientAction.doInitializeClient(clientType, undefined, undefined, entropyData)));\n        await dispatch(authAction.doFlushDatabase());\n        dispatch(AuthActionCreator.successfulRegisterWireless(registrationData));\n      } catch (error) {\n        dispatch(AuthActionCreator.failedRegisterWireless(error));\n        throw error;\n      }\n    };\n  };\n\n  doInit = (options = {isImmediateLogin: false, shouldValidateLocalClient: false}): ThunkAction => {\n    return async (dispatch, getState, {core, actions: {authAction, selfAction, localStorageAction}}) => {\n      dispatch(AuthActionCreator.startRefresh());\n      try {\n        if (options.isImmediateLogin) {\n          await dispatch(localStorageAction.setLocalStorage(LocalStorageKey.AUTH.PERSIST, true));\n        }\n\n        const persist = await dispatch(localStorageAction.getLocalStorage(LocalStorageKey.AUTH.PERSIST));\n        if (persist === undefined) {\n          throw new Error(`Could not find value for '${LocalStorageKey.AUTH.PERSIST}'`);\n        }\n        const clientType = persist ? ClientType.PERMANENT : ClientType.TEMPORARY;\n\n        await core.init(clientType);\n        await this.persistClientData(clientType, dispatch, localStorageAction);\n\n        await dispatch(selfAction.fetchSelf());\n        dispatch(AuthActionCreator.successfulRefresh());\n      } catch (error) {\n        const doLogout = options.shouldValidateLocalClient ? dispatch(authAction.doLogout()) : Promise.resolve();\n        const deleteClientType = options.isImmediateLogin\n          ? dispatch(localStorageAction.deleteLocalStorage(LocalStorageKey.AUTH.PERSIST))\n          : Promise.resolve();\n        await Promise.all([doLogout, deleteClientType]);\n        dispatch(AuthActionCreator.failedRefresh(error));\n      }\n    };\n  };\n\n  doGetDomainInfo = (domain: string): ThunkAction<Promise<DomainData>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      return apiClient.api.account.getDomain(domain);\n    };\n  };\n\n  doGetSSOSettings = (): ThunkAction<Promise<void>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(AuthActionCreator.startGetSSOSettings());\n      try {\n        const ssoSettings = await apiClient.api.account.getSSOSettings();\n        dispatch(AuthActionCreator.successfulGetSSOSettings(ssoSettings));\n      } catch (error) {\n        dispatch(AuthActionCreator.failedGetSSOSettings(error));\n      }\n    };\n  };\n\n  doLogout = (): ThunkAction => {\n    return async (dispatch, getState, {getConfig, core, actions: {localStorageAction}}) => {\n      try {\n        await core.logout();\n        if (isTemporaryClientAndNonPersistent(false)) {\n          /**\n           * WEBAPP-6804: Our current implementation of \"websql\" has the drawback that a mounted database can only get unmounted by refreshing the page.\n           * @see https://github.com/wireapp/websql/blob/v0.0.15/packages/worker/src/Database.ts#L142-L145\n           */\n          window.location.reload();\n        }\n        dispatch(AuthActionCreator.successfulLogout());\n      } catch (error) {\n        dispatch(AuthActionCreator.failedLogout(error));\n      }\n    };\n  };\n\n  doSilentLogout = (): ThunkAction => {\n    return async (dispatch, getState, {getConfig, core, actions: {localStorageAction}}) => {\n      try {\n        await core.logout();\n        dispatch(AuthActionCreator.successfulSilentLogout());\n      } catch (error) {\n        dispatch(AuthActionCreator.failedLogout(error));\n      }\n    };\n  };\n\n  enterPersonalCreationFlow = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.enterPersonalCreationFlow());\n    };\n  };\n\n  enterTeamCreationFlow = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.enterTeamCreationFlow());\n    };\n  };\n\n  enterGenericInviteCreationFlow = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.enterGenericInviteCreationFlow());\n    };\n  };\n\n  resetAuthError = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(AuthActionCreator.resetError());\n    };\n  };\n}\n\nexport const authAction = new AuthAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport const UUID_REGEX = '[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}';\n\nexport function capitalize(text: string): string {\n  return text.charAt(0).toUpperCase() + text.slice(1);\n}\n\nexport function isUUID(string: string): boolean {\n  return new RegExp(`^${UUID_REGEX}$`, 'i').test(string);\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientClassification, ClientType, RegisteredClient} from '@wireapp/api-client/lib/client/';\nimport {ClientInfo} from '@wireapp/core/lib/client/';\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {ClientActionCreator} from './creator/';\n\nimport * as StringUtil from '../../util/stringUtil';\nimport type {ThunkAction} from '../reducer';\n\nexport class ClientAction {\n  doGetAllClients = (): ThunkAction<Promise<RegisteredClient[]>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(ClientActionCreator.startGetAllClients());\n      try {\n        const clients = await apiClient.api.client.getClients();\n        dispatch(ClientActionCreator.successfulGetAllClients(clients));\n        return clients;\n      } catch (error) {\n        dispatch(ClientActionCreator.failedGetAllClients(error));\n        throw error;\n      }\n    };\n  };\n\n  doRemoveClient = (clientId: string, password?: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(ClientActionCreator.startRemoveClient());\n      try {\n        await apiClient.api.client.deleteClient(clientId, password);\n        dispatch(ClientActionCreator.successfulRemoveClient(clientId));\n      } catch (error) {\n        dispatch(ClientActionCreator.failedRemoveClient(error));\n        throw error;\n      }\n    };\n  };\n\n  doInitializeClient = (\n    clientType: ClientType,\n    password?: string,\n    verificationCode?: string,\n    entropyData?: Uint8Array,\n  ): ThunkAction => {\n    return async (dispatch, getState, {core, actions: {clientAction}}) => {\n      const localClient = await core.initClient();\n      const creationStatus = localClient\n        ? {isNew: false, client: localClient}\n        : {\n            isNew: true,\n            client: await core.registerClient(\n              {clientType, password, verificationCode},\n              clientAction.generateClientPayload(clientType),\n              entropyData,\n            ),\n          };\n\n      dispatch(ClientActionCreator.successfulInitializeClient(creationStatus));\n    };\n  };\n\n  generateClientPayload = (clientType: ClientType): ClientInfo | undefined => {\n    if (clientType === ClientType.NONE) {\n      return undefined;\n    }\n    const deviceLabel = `${Runtime.getOS()}${Runtime.getOS().version ? ` ${Runtime.getOS().version}` : ''}`;\n    let deviceModel = StringUtil.capitalize(Runtime.getBrowserName());\n\n    if (Runtime.isDesktopApp()) {\n      if (Runtime.isMacOS()) {\n        deviceModel = 'Wire macOS';\n      } else if (Runtime.isWindows()) {\n        deviceModel = 'Wire Windows';\n      } else {\n        deviceModel = 'Wire Linux';\n      }\n    } else if (clientType === ClientType.TEMPORARY) {\n      deviceModel = `${deviceModel} (Temporary)`;\n    }\n\n    return {\n      classification: ClientClassification.DESKTOP,\n      cookieLabel: undefined,\n      label: deviceLabel,\n      model: deviceModel,\n    };\n  };\n\n  resetClientError = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(ClientActionCreator.resetError());\n    };\n  };\n}\n\nexport const clientAction = new ClientAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ConversationEvent} from '@wireapp/api-client/lib/event/';\n\nimport {ConversationActionCreator} from './creator/';\n\nimport type {ThunkAction} from '../reducer';\n\nexport class ConversationAction {\n  doCheckConversationCode = (key: string, code: string, uri?: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(ConversationActionCreator.startConversationCodeCheck());\n      try {\n        await apiClient.api.conversation.postConversationCodeCheck({code, key, uri});\n        dispatch(ConversationActionCreator.successfulConversationCodeCheck());\n      } catch (error) {\n        dispatch(ConversationActionCreator.failedConversationCodeCheck(error));\n        throw error;\n      }\n    };\n  };\n\n  doJoinConversationByCode = (key: string, code: string, uri?: string): ThunkAction<Promise<ConversationEvent>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(ConversationActionCreator.startJoinConversationByCode());\n      try {\n        const conversationEvent = await apiClient.api.conversation.postJoinByCode({code, key, uri});\n        dispatch(ConversationActionCreator.successfulJoinConversationByCode(conversationEvent));\n        return conversationEvent;\n      } catch (error) {\n        dispatch(ConversationActionCreator.failedJoinConversationByCode(error));\n        throw error;\n      }\n    };\n  };\n}\nexport const conversationAction = new ConversationAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {RootState} from '../reducer';\n\nexport const getInvites = (state: RootState) => state.inviteState.invites;\nexport const getError = (state: RootState) => state.inviteState.error;\nexport const isFetching = (state: RootState) => state.inviteState.fetching;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {RootState} from '../reducer';\n\nexport const getLanguage = (state: RootState) => state.languageState.language;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {Self} from '@wireapp/api-client/lib/self/';\n\nimport {Config} from '../../../Config';\nimport type {RootState} from '../reducer';\n\nconst unsetSelf: Self = {\n  accent_id: undefined,\n  assets: [],\n  expires_at: undefined,\n  handle: undefined,\n  id: undefined,\n  locale: undefined,\n  name: undefined,\n  sso_id: undefined,\n  team: undefined,\n};\n\nexport const getConsents = (state: RootState) => state.selfState.consents || {};\nexport const getSelf = (state: RootState) => state.selfState.self || unsetSelf;\nexport const getSelfError = (state: RootState) => state.selfState.error;\nexport const getSelfHandle = (state: RootState) => getSelf(state).handle;\nexport const getSelfEmail = (state: RootState) => getSelf(state).email;\nexport const getSelfName = (state: RootState) => getSelf(state).name;\nexport const getSelfTeamId = (state: RootState) => getSelf(state).team;\nexport const hasSelfHandle = (state: RootState) => !!getSelfHandle(state);\nexport const hasSelfEmail = (state: RootState) => !!getSelfEmail(state);\nexport const hasSelfPassword = (state: RootState) => !!state.selfState.hasPassword;\nexport const isFetching = (state: RootState) => state.selfState.fetching;\nexport const isSSOUser = (state: RootState) => !!getSelf(state).sso_id;\nexport const isNoPasswordSSO = (state: RootState) => !!getSelf(state).sso_id?.subject;\nexport const isTemporaryGuest = (state: RootState) => !!getSelf(state).expires_at;\nconst getConsent = (state: RootState, consentType: number) => getConsents(state)[consentType];\nexport const hasUnsetConsent = (state: RootState, consentType: number) =>\n  !Config.getConfig().FEATURE.CHECK_CONSENT ? false : getConsent(state, consentType) === undefined;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {NewTeamInvitation} from '@wireapp/api-client/lib/team/';\nimport {Role} from '@wireapp/api-client/lib/team/member/';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\n\nimport {BackendError} from './BackendError';\nimport {InvitationActionCreator} from './creator/';\n\nimport type {ThunkAction} from '../reducer';\nimport * as InviteSelector from '../selector/InviteSelector';\nimport * as languageSelector from '../selector/LanguageSelector';\nimport * as selfSelector from '../selector/SelfSelector';\n\nexport class InvitationAction {\n  invite = (invitation: {email: string}): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(InvitationActionCreator.startAddInvite());\n      const state = getState();\n      const inviteList = InviteSelector.getInvites(state);\n      const invitationEmail = invitation.email?.toLowerCase();\n      const alreadyInvited = inviteList.find(inviteItem => inviteItem.email.toLowerCase() === invitationEmail);\n      if (alreadyInvited) {\n        const error = new BackendError({\n          code: HTTP_STATUS.CONFLICT,\n          label: BackendError.LABEL.ALREADY_INVITED,\n          message: 'This email has already been invited',\n        });\n        dispatch(InvitationActionCreator.failedAddInvite(error));\n        throw error;\n      }\n\n      const newInvite: NewTeamInvitation = {\n        email: invitationEmail,\n        inviter_name: selfSelector.getSelfName(state),\n        locale: languageSelector.getLanguage(state),\n        role: Role.MEMBER,\n      };\n\n      const teamId = selfSelector.getSelfTeamId(state);\n      try {\n        const createdInvite = await apiClient.api.teams.invitation.postInvitation(teamId, newInvite);\n        dispatch(InvitationActionCreator.successfulAddInvite(createdInvite));\n      } catch (error) {\n        dispatch(InvitationActionCreator.failedAddInvite(error));\n        throw error;\n      }\n    };\n  };\n\n  resetInviteErrors = (): ThunkAction => {\n    return async dispatch => {\n      dispatch(InvitationActionCreator.resetError());\n    };\n  };\n}\n\nexport const invitationAction = new InvitationAction();\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ThunkAction} from '../reducer';\n\nexport class NavigationAction {\n  doNavigate = (url: string): ThunkAction<void> => {\n    return () => {\n      return window.location.assign(url);\n    };\n  };\n}\n\nexport const navigationAction = new NavigationAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ThunkAction} from '../reducer';\n\nexport class NotificationAction {\n  setLastEventDate = (lastEventDate: Date): ThunkAction => {\n    return async (dispatch, getState, {core}) => {\n      await core.service.notification.setLastEventDate(lastEventDate);\n    };\n  };\n}\n\nexport const notificationAction = new NotificationAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {USER_EVENT} from '@wireapp/api-client/lib/event/';\n\nimport {getLogger} from 'Util/Logger';\n\nimport type {ThunkAction} from '../../module/reducer';\nimport * as SelfSelector from '../../module/selector/SelfSelector';\n\nconst logger = getLogger('WebSocketAction');\nexport const WebSocketAction = {\n  listen(): ThunkAction {\n    return async (dispatch, getState, {core, actions: {selfAction}}) => {\n      await core.listen({\n        // We just want to get unencrypted backend events, so we use a dry run in order not to store the last notificationId and avoid decrypting events\n        dryRun: true,\n        onEvent: async ({event}) => {\n          try {\n            switch (event.type) {\n              case USER_EVENT.UPDATE: {\n                const isSelfId = event.user.id === SelfSelector.getSelf(getState()).id;\n                if (isSelfId) {\n                  await dispatch(selfAction.fetchSelf());\n                }\n              }\n            }\n          } catch (error) {\n            const message = error instanceof Error ? error.message : error;\n            logger.error(`There was an error with event ID \"${event.type}\": ${message}`, error);\n          }\n        },\n      });\n    };\n  },\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ChangePassword, ConsentType, Self} from '@wireapp/api-client/lib/self/';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\n\nimport {Environment} from 'Util/Environment';\nimport {getLogger} from 'Util/Logger';\n\nimport {SelfActionCreator} from './creator/';\nimport {WebSocketAction} from './WebSocketAction';\n\nimport type {ThunkAction} from '../reducer';\n\nconst logger = getLogger('SelfAction');\n\nexport class SelfAction {\n  fetchSelf = (): ThunkAction<Promise<Self>> => {\n    return async (dispatch, getState, {actions: {selfAction}, apiClient}) => {\n      dispatch(SelfActionCreator.startFetchSelf());\n      try {\n        const selfUser = await apiClient.api.self.getSelf();\n        await dispatch(selfAction.doCheckPasswordState());\n        dispatch(SelfActionCreator.successfulFetchSelf(selfUser));\n        return selfUser;\n      } catch (error) {\n        dispatch(SelfActionCreator.failedFetchSelf(error));\n        throw error;\n      }\n    };\n  };\n\n  setHandle = (handle: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient, actions: {selfAction}}) => {\n      dispatch(SelfActionCreator.startSetHandle());\n      try {\n        await apiClient.api.self.putHandle({handle: handle.trim().toLowerCase()});\n        const selfUser = await dispatch(selfAction.fetchSelf());\n        dispatch(SelfActionCreator.successfulSetHandle(selfUser));\n      } catch (error) {\n        dispatch(SelfActionCreator.failedSetHandle(error));\n        throw error;\n      }\n    };\n  };\n\n  doGetConsents = (): ThunkAction => {\n    return async (dispatch, getState, {apiClient, getConfig}) => {\n      if (!getConfig().FEATURE.CHECK_CONSENT) {\n        logger.warn('Consent check feature is disabled.');\n        return Promise.resolve();\n      }\n      dispatch(SelfActionCreator.startGetConsents());\n      try {\n        const {results} = await apiClient.api.self.getConsents();\n        dispatch(SelfActionCreator.successfulGetConsents(results));\n      } catch (error) {\n        dispatch(SelfActionCreator.failedGetConsents(error));\n        throw error;\n      }\n    };\n  };\n\n  doSetConsent = (consentType: ConsentType, value: number): ThunkAction => {\n    return async (dispatch, getState, {apiClient, getConfig}) => {\n      if (!getConfig().FEATURE.CHECK_CONSENT) {\n        logger.warn('Consent check feature is disabled.');\n        return Promise.resolve();\n      }\n      dispatch(SelfActionCreator.startSetConsent());\n      const consent = {\n        source: `${getConfig().APP_NAME} ${Environment.version(false)}`,\n        type: consentType,\n        value,\n      };\n      try {\n        await apiClient.api.self.putConsent(consent);\n        dispatch(SelfActionCreator.successfulSetConsent(consent));\n      } catch (error) {\n        dispatch(SelfActionCreator.failedSetConsent(error));\n        throw error;\n      }\n    };\n  };\n\n  doSetPassword = (changePassword: ChangePassword): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(SelfActionCreator.startSetSelfPassword());\n      try {\n        await apiClient.api.self.putPassword(changePassword);\n        dispatch(SelfActionCreator.successfulSetSelfPassword());\n      } catch (error) {\n        dispatch(SelfActionCreator.failedSetSelfPassword(error));\n        throw error;\n      }\n    };\n  };\n\n  doSetEmail = (email: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(SelfActionCreator.startSetSelfEmail());\n      try {\n        await apiClient.api.auth.putEmail({email});\n        dispatch(SelfActionCreator.successfulSetSelfEmail(email));\n        // we listen to the websocket after setting the email address. This way we will be warned when the user validates his email\n        dispatch(WebSocketAction.listen());\n      } catch (error) {\n        dispatch(SelfActionCreator.failedSetSelfEmail(error));\n        throw error;\n      }\n    };\n  };\n\n  doCheckPasswordState = (): ThunkAction<Promise<boolean>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(SelfActionCreator.startSetPasswordState());\n      try {\n        await apiClient.api.self.headPassword();\n        dispatch(SelfActionCreator.successfulSetPasswordState({hasPassword: true}));\n        return true;\n      } catch (error) {\n        if (error.response?.status === HTTP_STATUS.NOT_FOUND) {\n          dispatch(SelfActionCreator.successfulSetPasswordState({hasPassword: false}));\n          return false;\n        }\n        dispatch(SelfActionCreator.failedSetPasswordState(error));\n        throw error;\n      }\n    };\n  };\n}\n\nexport const selfAction = new SelfAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {UserActionCreator} from './creator/';\n\nimport {currentLanguage} from '../../localeConfig';\nimport type {ThunkAction} from '../reducer';\n\nexport class UserAction {\n  checkHandles = (handles: string[]): ThunkAction<Promise<string>> => {\n    return async (dispatch, getState, {apiClient}) => {\n      const [availableHandle] = await apiClient.api.user.postHandles({handles, return: 1});\n      return availableHandle;\n    };\n  };\n\n  doSendActivationCode = (email: string): ThunkAction => {\n    return async (dispatch, getState, {apiClient}) => {\n      dispatch(UserActionCreator.startSendActivationCode());\n      try {\n        await apiClient.api.user.postActivationCode({email, locale: currentLanguage()});\n        dispatch(UserActionCreator.successfulSendActivationCode());\n      } catch (error) {\n        dispatch(UserActionCreator.failedSendActivationCode(error));\n        throw error;\n      }\n    };\n  };\n}\n\nexport const userAction = new UserAction();\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport type {ThunkAction} from '../reducer';\n\nclass WrapperChangeEnvironmentEvent extends CustomEvent<{url: string}> {\n  constructor(url: string, options?: EventInit) {\n    super(WebAppEvents.LIFECYCLE.CHANGE_ENVIRONMENT, {\n      ...options,\n      detail: {url},\n    });\n  }\n}\n\nexport class WrapperEventAction {\n  doSendNavigationEvent = (url: string): ThunkAction => {\n    return async () => {\n      const event = new WrapperChangeEnvironmentEvent(url);\n      window.dispatchEvent(event);\n    };\n  };\n}\n\nexport const wrapperEventAction = new WrapperEventAction();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AuthAction, authAction} from './AuthAction';\nimport {ClientAction, clientAction} from './ClientAction';\nimport {ConversationAction, conversationAction} from './ConversationAction';\nimport {InvitationAction, invitationAction} from './InvitationAction';\nimport {LocalStorageAction, localStorageAction} from './LocalStorageAction';\nimport {NavigationAction, navigationAction} from './NavigationAction';\nimport {NotificationAction, notificationAction} from './NotificationAction';\nimport {RuntimeAction, runtimeAction} from './RuntimeAction';\nimport {SelfAction, selfAction} from './SelfAction';\nimport {UserAction, userAction} from './UserAction';\nimport {WrapperEventAction, wrapperEventAction} from './WrapperEventAction';\n\nexport interface ActionRoot {\n  authAction: AuthAction;\n  clientAction: ClientAction;\n  conversationAction: ConversationAction;\n  invitationAction: InvitationAction;\n  localStorageAction: LocalStorageAction;\n  navigationAction: NavigationAction;\n  notificationAction: NotificationAction;\n  runtimeAction: RuntimeAction;\n  selfAction: SelfAction;\n  userAction: UserAction;\n  wrapperEventAction: WrapperEventAction;\n}\n\nexport const actionRoot: ActionRoot = {\n  authAction,\n  clientAction,\n  conversationAction,\n  invitationAction,\n  localStorageAction,\n  navigationAction,\n  notificationAction,\n  runtimeAction,\n  selfAction,\n  userAction,\n  wrapperEventAction,\n};\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","import { __assign } from \"tslib\";\nimport * as React from 'react';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\nimport { invariantIntlContext } from '../utils';\nfunction getDisplayName(Component) {\n    return Component.displayName || Component.name || 'Component';\n}\n// TODO: We should provide initial value here\nvar IntlContext = React.createContext(null);\nvar IntlConsumer = IntlContext.Consumer, IntlProvider = IntlContext.Provider;\nexport var Provider = IntlProvider;\nexport var Context = IntlContext;\nexport default function injectIntl(WrappedComponent, options) {\n    var _a = options || {}, _b = _a.intlPropName, intlPropName = _b === void 0 ? 'intl' : _b, _c = _a.forwardRef, forwardRef = _c === void 0 ? false : _c, _d = _a.enforceContext, enforceContext = _d === void 0 ? true : _d;\n    var WithIntl = function (props) { return (React.createElement(IntlConsumer, null, function (intl) {\n        var _a;\n        if (enforceContext) {\n            invariantIntlContext(intl);\n        }\n        var intlProp = (_a = {}, _a[intlPropName] = intl, _a);\n        return (React.createElement(WrappedComponent, __assign({}, props, intlProp, { ref: forwardRef ? props.forwardedRef : null })));\n    })); };\n    WithIntl.displayName = \"injectIntl(\".concat(getDisplayName(WrappedComponent), \")\");\n    WithIntl.WrappedComponent = WrappedComponent;\n    if (forwardRef) {\n        return hoistNonReactStatics(React.forwardRef(function (props, ref) { return (React.createElement(WithIntl, __assign({}, props, { forwardedRef: ref }))); }), WrappedComponent);\n    }\n    return hoistNonReactStatics(WithIntl, WrappedComponent);\n}\n","/**\n * Cannot do Math.log(x) / Math.log(10) bc if IEEE floating point issue\n * @param x number\n */\nexport function getMagnitude(x) {\n    // Cannot count string length via Number.toString because it may use scientific notation\n    // for very small or very large numbers.\n    return Math.floor(Math.log(x) * Math.LOG10E);\n}\nexport function repeat(s, times) {\n    if (typeof s.repeat === 'function') {\n        return s.repeat(times);\n    }\n    var arr = new Array(times);\n    for (var i = 0; i < arr.length; i++) {\n        arr[i] = s;\n    }\n    return arr.join('');\n}\nexport function setInternalSlot(map, pl, field, value) {\n    if (!map.get(pl)) {\n        map.set(pl, Object.create(null));\n    }\n    var slots = map.get(pl);\n    slots[field] = value;\n}\nexport function setMultiInternalSlots(map, pl, props) {\n    for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\n        var k = _a[_i];\n        setInternalSlot(map, pl, k, props[k]);\n    }\n}\nexport function getInternalSlot(map, pl, field) {\n    return getMultiInternalSlots(map, pl, field)[field];\n}\nexport function getMultiInternalSlots(map, pl) {\n    var fields = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        fields[_i - 2] = arguments[_i];\n    }\n    var slots = map.get(pl);\n    if (!slots) {\n        throw new TypeError(\"\".concat(pl, \" InternalSlot has not been initialized\"));\n    }\n    return fields.reduce(function (all, f) {\n        all[f] = slots[f];\n        return all;\n    }, Object.create(null));\n}\nexport function isLiteralPart(patternPart) {\n    return patternPart.type === 'literal';\n}\n/*\n  17 ECMAScript Standard Built-in Objects:\n    Every built-in Function object, including constructors, that is not\n    identified as an anonymous function has a name property whose value\n    is a String.\n\n    Unless otherwise specified, the name property of a built-in Function\n    object, if it exists, has the attributes { [[Writable]]: false,\n    [[Enumerable]]: false, [[Configurable]]: true }.\n*/\nexport function defineProperty(target, name, _a) {\n    var value = _a.value;\n    Object.defineProperty(target, name, {\n        configurable: true,\n        enumerable: false,\n        writable: true,\n        value: value,\n    });\n}\nexport var UNICODE_EXTENSION_SEQUENCE_REGEX = /-u(?:-[0-9a-z]{2,8})+/gi;\nexport function invariant(condition, message, Err) {\n    if (Err === void 0) { Err = Error; }\n    if (!condition) {\n        throw new Err(message);\n    }\n}\n","export var ErrorKind;\n(function (ErrorKind) {\n    /** Argument is unclosed (e.g. `{0`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_CLOSING_BRACE\"] = 1] = \"EXPECT_ARGUMENT_CLOSING_BRACE\";\n    /** Argument is empty (e.g. `{}`). */\n    ErrorKind[ErrorKind[\"EMPTY_ARGUMENT\"] = 2] = \"EMPTY_ARGUMENT\";\n    /** Argument is malformed (e.g. `{foo!}``) */\n    ErrorKind[ErrorKind[\"MALFORMED_ARGUMENT\"] = 3] = \"MALFORMED_ARGUMENT\";\n    /** Expect an argument type (e.g. `{foo,}`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_TYPE\"] = 4] = \"EXPECT_ARGUMENT_TYPE\";\n    /** Unsupported argument type (e.g. `{foo,foo}`) */\n    ErrorKind[ErrorKind[\"INVALID_ARGUMENT_TYPE\"] = 5] = \"INVALID_ARGUMENT_TYPE\";\n    /** Expect an argument style (e.g. `{foo, number, }`) */\n    ErrorKind[ErrorKind[\"EXPECT_ARGUMENT_STYLE\"] = 6] = \"EXPECT_ARGUMENT_STYLE\";\n    /** The number skeleton is invalid. */\n    ErrorKind[ErrorKind[\"INVALID_NUMBER_SKELETON\"] = 7] = \"INVALID_NUMBER_SKELETON\";\n    /** The date time skeleton is invalid. */\n    ErrorKind[ErrorKind[\"INVALID_DATE_TIME_SKELETON\"] = 8] = \"INVALID_DATE_TIME_SKELETON\";\n    /** Exepct a number skeleton following the `::` (e.g. `{foo, number, ::}`) */\n    ErrorKind[ErrorKind[\"EXPECT_NUMBER_SKELETON\"] = 9] = \"EXPECT_NUMBER_SKELETON\";\n    /** Exepct a date time skeleton following the `::` (e.g. `{foo, date, ::}`) */\n    ErrorKind[ErrorKind[\"EXPECT_DATE_TIME_SKELETON\"] = 10] = \"EXPECT_DATE_TIME_SKELETON\";\n    /** Unmatched apostrophes in the argument style (e.g. `{foo, number, 'test`) */\n    ErrorKind[ErrorKind[\"UNCLOSED_QUOTE_IN_ARGUMENT_STYLE\"] = 11] = \"UNCLOSED_QUOTE_IN_ARGUMENT_STYLE\";\n    /** Missing select argument options (e.g. `{foo, select}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_OPTIONS\"] = 12] = \"EXPECT_SELECT_ARGUMENT_OPTIONS\";\n    /** Expecting an offset value in `plural` or `selectordinal` argument (e.g `{foo, plural, offset}`) */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE\"] = 13] = \"EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE\";\n    /** Offset value in `plural` or `selectordinal` is invalid (e.g. `{foo, plural, offset: x}`) */\n    ErrorKind[ErrorKind[\"INVALID_PLURAL_ARGUMENT_OFFSET_VALUE\"] = 14] = \"INVALID_PLURAL_ARGUMENT_OFFSET_VALUE\";\n    /** Expecting a selector in `select` argument (e.g `{foo, select}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_SELECTOR\"] = 15] = \"EXPECT_SELECT_ARGUMENT_SELECTOR\";\n    /** Expecting a selector in `plural` or `selectordinal` argument (e.g `{foo, plural}`) */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_SELECTOR\"] = 16] = \"EXPECT_PLURAL_ARGUMENT_SELECTOR\";\n    /** Expecting a message fragment after the `select` selector (e.g. `{foo, select, apple}`) */\n    ErrorKind[ErrorKind[\"EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\"] = 17] = \"EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\";\n    /**\n     * Expecting a message fragment after the `plural` or `selectordinal` selector\n     * (e.g. `{foo, plural, one}`)\n     */\n    ErrorKind[ErrorKind[\"EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT\"] = 18] = \"EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT\";\n    /** Selector in `plural` or `selectordinal` is malformed (e.g. `{foo, plural, =x {#}}`) */\n    ErrorKind[ErrorKind[\"INVALID_PLURAL_ARGUMENT_SELECTOR\"] = 19] = \"INVALID_PLURAL_ARGUMENT_SELECTOR\";\n    /**\n     * Duplicate selectors in `plural` or `selectordinal` argument.\n     * (e.g. {foo, plural, one {#} one {#}})\n     */\n    ErrorKind[ErrorKind[\"DUPLICATE_PLURAL_ARGUMENT_SELECTOR\"] = 20] = \"DUPLICATE_PLURAL_ARGUMENT_SELECTOR\";\n    /** Duplicate selectors in `select` argument.\n     * (e.g. {foo, select, apple {apple} apple {apple}})\n     */\n    ErrorKind[ErrorKind[\"DUPLICATE_SELECT_ARGUMENT_SELECTOR\"] = 21] = \"DUPLICATE_SELECT_ARGUMENT_SELECTOR\";\n    /** Plural or select argument option must have `other` clause. */\n    ErrorKind[ErrorKind[\"MISSING_OTHER_CLAUSE\"] = 22] = \"MISSING_OTHER_CLAUSE\";\n    /** The tag is malformed. (e.g. `<bold!>foo</bold!>) */\n    ErrorKind[ErrorKind[\"INVALID_TAG\"] = 23] = \"INVALID_TAG\";\n    /** The tag name is invalid. (e.g. `<123>foo</123>`) */\n    ErrorKind[ErrorKind[\"INVALID_TAG_NAME\"] = 25] = \"INVALID_TAG_NAME\";\n    /** The closing tag does not match the opening tag. (e.g. `<bold>foo</italic>`) */\n    ErrorKind[ErrorKind[\"UNMATCHED_CLOSING_TAG\"] = 26] = \"UNMATCHED_CLOSING_TAG\";\n    /** The opening tag has unmatched closing tag. (e.g. `<bold>foo`) */\n    ErrorKind[ErrorKind[\"UNCLOSED_TAG\"] = 27] = \"UNCLOSED_TAG\";\n})(ErrorKind || (ErrorKind = {}));\n","export var TYPE;\n(function (TYPE) {\n    /**\n     * Raw text\n     */\n    TYPE[TYPE[\"literal\"] = 0] = \"literal\";\n    /**\n     * Variable w/o any format, e.g `var` in `this is a {var}`\n     */\n    TYPE[TYPE[\"argument\"] = 1] = \"argument\";\n    /**\n     * Variable w/ number format\n     */\n    TYPE[TYPE[\"number\"] = 2] = \"number\";\n    /**\n     * Variable w/ date format\n     */\n    TYPE[TYPE[\"date\"] = 3] = \"date\";\n    /**\n     * Variable w/ time format\n     */\n    TYPE[TYPE[\"time\"] = 4] = \"time\";\n    /**\n     * Variable w/ select format\n     */\n    TYPE[TYPE[\"select\"] = 5] = \"select\";\n    /**\n     * Variable w/ plural format\n     */\n    TYPE[TYPE[\"plural\"] = 6] = \"plural\";\n    /**\n     * Only possible within plural argument.\n     * This is the `#` symbol that will be substituted with the count.\n     */\n    TYPE[TYPE[\"pound\"] = 7] = \"pound\";\n    /**\n     * XML-like tag\n     */\n    TYPE[TYPE[\"tag\"] = 8] = \"tag\";\n})(TYPE || (TYPE = {}));\nexport var SKELETON_TYPE;\n(function (SKELETON_TYPE) {\n    SKELETON_TYPE[SKELETON_TYPE[\"number\"] = 0] = \"number\";\n    SKELETON_TYPE[SKELETON_TYPE[\"dateTime\"] = 1] = \"dateTime\";\n})(SKELETON_TYPE || (SKELETON_TYPE = {}));\n/**\n * Type Guards\n */\nexport function isLiteralElement(el) {\n    return el.type === TYPE.literal;\n}\nexport function isArgumentElement(el) {\n    return el.type === TYPE.argument;\n}\nexport function isNumberElement(el) {\n    return el.type === TYPE.number;\n}\nexport function isDateElement(el) {\n    return el.type === TYPE.date;\n}\nexport function isTimeElement(el) {\n    return el.type === TYPE.time;\n}\nexport function isSelectElement(el) {\n    return el.type === TYPE.select;\n}\nexport function isPluralElement(el) {\n    return el.type === TYPE.plural;\n}\nexport function isPoundElement(el) {\n    return el.type === TYPE.pound;\n}\nexport function isTagElement(el) {\n    return el.type === TYPE.tag;\n}\nexport function isNumberSkeleton(el) {\n    return !!(el && typeof el === 'object' && el.type === SKELETON_TYPE.number);\n}\nexport function isDateTimeSkeleton(el) {\n    return !!(el && typeof el === 'object' && el.type === SKELETON_TYPE.dateTime);\n}\nexport function createLiteralElement(value) {\n    return {\n        type: TYPE.literal,\n        value: value,\n    };\n}\nexport function createNumberElement(value, style) {\n    return {\n        type: TYPE.number,\n        value: value,\n        style: style,\n    };\n}\n","// @generated from regex-gen.ts\nexport var SPACE_SEPARATOR_REGEX = /[ \\xA0\\u1680\\u2000-\\u200A\\u202F\\u205F\\u3000]/;\nexport var WHITE_SPACE_REGEX = /[\\t-\\r \\x85\\u200E\\u200F\\u2028\\u2029]/;\n","/**\n * https://unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * Credit: https://github.com/caridy/intl-datetimeformat-pattern/blob/master/index.js\n * with some tweaks\n */\nvar DATE_TIME_REGEX = /(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;\n/**\n * Parse Date time skeleton into Intl.DateTimeFormatOptions\n * Ref: https://unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * @public\n * @param skeleton skeleton string\n */\nexport function parseDateTimeSkeleton(skeleton) {\n    var result = {};\n    skeleton.replace(DATE_TIME_REGEX, function (match) {\n        var len = match.length;\n        switch (match[0]) {\n            // Era\n            case 'G':\n                result.era = len === 4 ? 'long' : len === 5 ? 'narrow' : 'short';\n                break;\n            // Year\n            case 'y':\n                result.year = len === 2 ? '2-digit' : 'numeric';\n                break;\n            case 'Y':\n            case 'u':\n            case 'U':\n            case 'r':\n                throw new RangeError('`Y/u/U/r` (year) patterns are not supported, use `y` instead');\n            // Quarter\n            case 'q':\n            case 'Q':\n                throw new RangeError('`q/Q` (quarter) patterns are not supported');\n            // Month\n            case 'M':\n            case 'L':\n                result.month = ['numeric', '2-digit', 'short', 'long', 'narrow'][len - 1];\n                break;\n            // Week\n            case 'w':\n            case 'W':\n                throw new RangeError('`w/W` (week) patterns are not supported');\n            case 'd':\n                result.day = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'D':\n            case 'F':\n            case 'g':\n                throw new RangeError('`D/F/g` (day) patterns are not supported, use `d` instead');\n            // Weekday\n            case 'E':\n                result.weekday = len === 4 ? 'short' : len === 5 ? 'narrow' : 'short';\n                break;\n            case 'e':\n                if (len < 4) {\n                    throw new RangeError('`e..eee` (weekday) patterns are not supported');\n                }\n                result.weekday = ['short', 'long', 'narrow', 'short'][len - 4];\n                break;\n            case 'c':\n                if (len < 4) {\n                    throw new RangeError('`c..ccc` (weekday) patterns are not supported');\n                }\n                result.weekday = ['short', 'long', 'narrow', 'short'][len - 4];\n                break;\n            // Period\n            case 'a': // AM, PM\n                result.hour12 = true;\n                break;\n            case 'b': // am, pm, noon, midnight\n            case 'B': // flexible day periods\n                throw new RangeError('`b/B` (period) patterns are not supported, use `a` instead');\n            // Hour\n            case 'h':\n                result.hourCycle = 'h12';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'H':\n                result.hourCycle = 'h23';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'K':\n                result.hourCycle = 'h11';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'k':\n                result.hourCycle = 'h24';\n                result.hour = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'j':\n            case 'J':\n            case 'C':\n                throw new RangeError('`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead');\n            // Minute\n            case 'm':\n                result.minute = ['numeric', '2-digit'][len - 1];\n                break;\n            // Second\n            case 's':\n                result.second = ['numeric', '2-digit'][len - 1];\n                break;\n            case 'S':\n            case 'A':\n                throw new RangeError('`S/A` (second) patterns are not supported, use `s` instead');\n            // Zone\n            case 'z': // 1..3, 4: specific non-location format\n                result.timeZoneName = len < 4 ? 'short' : 'long';\n                break;\n            case 'Z': // 1..3, 4, 5: The ISO8601 varios formats\n            case 'O': // 1, 4: miliseconds in day short, long\n            case 'v': // 1, 4: generic non-location format\n            case 'V': // 1, 2, 3, 4: time zone ID or city\n            case 'X': // 1, 2, 3, 4: The ISO8601 varios formats\n            case 'x': // 1, 2, 3, 4: The ISO8601 varios formats\n                throw new RangeError('`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead');\n        }\n        return '';\n    });\n    return result;\n}\n","// @generated from regex-gen.ts\nexport var WHITE_SPACE_REGEX = /[\\t-\\r \\x85\\u200E\\u200F\\u2028\\u2029]/i;\n","import { __assign } from \"tslib\";\nimport { WHITE_SPACE_REGEX } from './regex.generated';\nexport function parseNumberSkeletonFromString(skeleton) {\n    if (skeleton.length === 0) {\n        throw new Error('Number skeleton cannot be empty');\n    }\n    // Parse the skeleton\n    var stringTokens = skeleton\n        .split(WHITE_SPACE_REGEX)\n        .filter(function (x) { return x.length > 0; });\n    var tokens = [];\n    for (var _i = 0, stringTokens_1 = stringTokens; _i < stringTokens_1.length; _i++) {\n        var stringToken = stringTokens_1[_i];\n        var stemAndOptions = stringToken.split('/');\n        if (stemAndOptions.length === 0) {\n            throw new Error('Invalid number skeleton');\n        }\n        var stem = stemAndOptions[0], options = stemAndOptions.slice(1);\n        for (var _a = 0, options_1 = options; _a < options_1.length; _a++) {\n            var option = options_1[_a];\n            if (option.length === 0) {\n                throw new Error('Invalid number skeleton');\n            }\n        }\n        tokens.push({ stem: stem, options: options });\n    }\n    return tokens;\n}\nfunction icuUnitToEcma(unit) {\n    return unit.replace(/^(.*?)-/, '');\n}\nvar FRACTION_PRECISION_REGEX = /^\\.(?:(0+)(\\*)?|(#+)|(0+)(#+))$/g;\nvar SIGNIFICANT_PRECISION_REGEX = /^(@+)?(\\+|#+)?[rs]?$/g;\nvar INTEGER_WIDTH_REGEX = /(\\*)(0+)|(#+)(0+)|(0+)/g;\nvar CONCISE_INTEGER_WIDTH_REGEX = /^(0+)$/;\nfunction parseSignificantPrecision(str) {\n    var result = {};\n    if (str[str.length - 1] === 'r') {\n        result.roundingPriority = 'morePrecision';\n    }\n    else if (str[str.length - 1] === 's') {\n        result.roundingPriority = 'lessPrecision';\n    }\n    str.replace(SIGNIFICANT_PRECISION_REGEX, function (_, g1, g2) {\n        // @@@ case\n        if (typeof g2 !== 'string') {\n            result.minimumSignificantDigits = g1.length;\n            result.maximumSignificantDigits = g1.length;\n        }\n        // @@@+ case\n        else if (g2 === '+') {\n            result.minimumSignificantDigits = g1.length;\n        }\n        // .### case\n        else if (g1[0] === '#') {\n            result.maximumSignificantDigits = g1.length;\n        }\n        // .@@## or .@@@ case\n        else {\n            result.minimumSignificantDigits = g1.length;\n            result.maximumSignificantDigits =\n                g1.length + (typeof g2 === 'string' ? g2.length : 0);\n        }\n        return '';\n    });\n    return result;\n}\nfunction parseSign(str) {\n    switch (str) {\n        case 'sign-auto':\n            return {\n                signDisplay: 'auto',\n            };\n        case 'sign-accounting':\n        case '()':\n            return {\n                currencySign: 'accounting',\n            };\n        case 'sign-always':\n        case '+!':\n            return {\n                signDisplay: 'always',\n            };\n        case 'sign-accounting-always':\n        case '()!':\n            return {\n                signDisplay: 'always',\n                currencySign: 'accounting',\n            };\n        case 'sign-except-zero':\n        case '+?':\n            return {\n                signDisplay: 'exceptZero',\n            };\n        case 'sign-accounting-except-zero':\n        case '()?':\n            return {\n                signDisplay: 'exceptZero',\n                currencySign: 'accounting',\n            };\n        case 'sign-never':\n        case '+_':\n            return {\n                signDisplay: 'never',\n            };\n    }\n}\nfunction parseConciseScientificAndEngineeringStem(stem) {\n    // Engineering\n    var result;\n    if (stem[0] === 'E' && stem[1] === 'E') {\n        result = {\n            notation: 'engineering',\n        };\n        stem = stem.slice(2);\n    }\n    else if (stem[0] === 'E') {\n        result = {\n            notation: 'scientific',\n        };\n        stem = stem.slice(1);\n    }\n    if (result) {\n        var signDisplay = stem.slice(0, 2);\n        if (signDisplay === '+!') {\n            result.signDisplay = 'always';\n            stem = stem.slice(2);\n        }\n        else if (signDisplay === '+?') {\n            result.signDisplay = 'exceptZero';\n            stem = stem.slice(2);\n        }\n        if (!CONCISE_INTEGER_WIDTH_REGEX.test(stem)) {\n            throw new Error('Malformed concise eng/scientific notation');\n        }\n        result.minimumIntegerDigits = stem.length;\n    }\n    return result;\n}\nfunction parseNotationOptions(opt) {\n    var result = {};\n    var signOpts = parseSign(opt);\n    if (signOpts) {\n        return signOpts;\n    }\n    return result;\n}\n/**\n * https://github.com/unicode-org/icu/blob/master/docs/userguide/format_parse/numbers/skeletons.md#skeleton-stems-and-options\n */\nexport function parseNumberSkeleton(tokens) {\n    var result = {};\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        switch (token.stem) {\n            case 'percent':\n            case '%':\n                result.style = 'percent';\n                continue;\n            case '%x100':\n                result.style = 'percent';\n                result.scale = 100;\n                continue;\n            case 'currency':\n                result.style = 'currency';\n                result.currency = token.options[0];\n                continue;\n            case 'group-off':\n            case ',_':\n                result.useGrouping = false;\n                continue;\n            case 'precision-integer':\n            case '.':\n                result.maximumFractionDigits = 0;\n                continue;\n            case 'measure-unit':\n            case 'unit':\n                result.style = 'unit';\n                result.unit = icuUnitToEcma(token.options[0]);\n                continue;\n            case 'compact-short':\n            case 'K':\n                result.notation = 'compact';\n                result.compactDisplay = 'short';\n                continue;\n            case 'compact-long':\n            case 'KK':\n                result.notation = 'compact';\n                result.compactDisplay = 'long';\n                continue;\n            case 'scientific':\n                result = __assign(__assign(__assign({}, result), { notation: 'scientific' }), token.options.reduce(function (all, opt) { return (__assign(__assign({}, all), parseNotationOptions(opt))); }, {}));\n                continue;\n            case 'engineering':\n                result = __assign(__assign(__assign({}, result), { notation: 'engineering' }), token.options.reduce(function (all, opt) { return (__assign(__assign({}, all), parseNotationOptions(opt))); }, {}));\n                continue;\n            case 'notation-simple':\n                result.notation = 'standard';\n                continue;\n            // https://github.com/unicode-org/icu/blob/master/icu4c/source/i18n/unicode/unumberformatter.h\n            case 'unit-width-narrow':\n                result.currencyDisplay = 'narrowSymbol';\n                result.unitDisplay = 'narrow';\n                continue;\n            case 'unit-width-short':\n                result.currencyDisplay = 'code';\n                result.unitDisplay = 'short';\n                continue;\n            case 'unit-width-full-name':\n                result.currencyDisplay = 'name';\n                result.unitDisplay = 'long';\n                continue;\n            case 'unit-width-iso-code':\n                result.currencyDisplay = 'symbol';\n                continue;\n            case 'scale':\n                result.scale = parseFloat(token.options[0]);\n                continue;\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#integer-width\n            case 'integer-width':\n                if (token.options.length > 1) {\n                    throw new RangeError('integer-width stems only accept a single optional option');\n                }\n                token.options[0].replace(INTEGER_WIDTH_REGEX, function (_, g1, g2, g3, g4, g5) {\n                    if (g1) {\n                        result.minimumIntegerDigits = g2.length;\n                    }\n                    else if (g3 && g4) {\n                        throw new Error('We currently do not support maximum integer digits');\n                    }\n                    else if (g5) {\n                        throw new Error('We currently do not support exact integer digits');\n                    }\n                    return '';\n                });\n                continue;\n        }\n        // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#integer-width\n        if (CONCISE_INTEGER_WIDTH_REGEX.test(token.stem)) {\n            result.minimumIntegerDigits = token.stem.length;\n            continue;\n        }\n        if (FRACTION_PRECISION_REGEX.test(token.stem)) {\n            // Precision\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#fraction-precision\n            // precision-integer case\n            if (token.options.length > 1) {\n                throw new RangeError('Fraction-precision stems only accept a single optional option');\n            }\n            token.stem.replace(FRACTION_PRECISION_REGEX, function (_, g1, g2, g3, g4, g5) {\n                // .000* case (before ICU67 it was .000+)\n                if (g2 === '*') {\n                    result.minimumFractionDigits = g1.length;\n                }\n                // .### case\n                else if (g3 && g3[0] === '#') {\n                    result.maximumFractionDigits = g3.length;\n                }\n                // .00## case\n                else if (g4 && g5) {\n                    result.minimumFractionDigits = g4.length;\n                    result.maximumFractionDigits = g4.length + g5.length;\n                }\n                else {\n                    result.minimumFractionDigits = g1.length;\n                    result.maximumFractionDigits = g1.length;\n                }\n                return '';\n            });\n            var opt = token.options[0];\n            // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#trailing-zero-display\n            if (opt === 'w') {\n                result = __assign(__assign({}, result), { trailingZeroDisplay: 'stripIfInteger' });\n            }\n            else if (opt) {\n                result = __assign(__assign({}, result), parseSignificantPrecision(opt));\n            }\n            continue;\n        }\n        // https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#significant-digits-precision\n        if (SIGNIFICANT_PRECISION_REGEX.test(token.stem)) {\n            result = __assign(__assign({}, result), parseSignificantPrecision(token.stem));\n            continue;\n        }\n        var signOpts = parseSign(token.stem);\n        if (signOpts) {\n            result = __assign(__assign({}, result), signOpts);\n        }\n        var conciseScientificAndEngineeringOpts = parseConciseScientificAndEngineeringStem(token.stem);\n        if (conciseScientificAndEngineeringOpts) {\n            result = __assign(__assign({}, result), conciseScientificAndEngineeringOpts);\n        }\n    }\n    return result;\n}\n","// @generated from time-data-gen.ts\n// prettier-ignore  \nexport var timeData = {\n    \"AX\": [\n        \"H\"\n    ],\n    \"BQ\": [\n        \"H\"\n    ],\n    \"CP\": [\n        \"H\"\n    ],\n    \"CZ\": [\n        \"H\"\n    ],\n    \"DK\": [\n        \"H\"\n    ],\n    \"FI\": [\n        \"H\"\n    ],\n    \"ID\": [\n        \"H\"\n    ],\n    \"IS\": [\n        \"H\"\n    ],\n    \"ML\": [\n        \"H\"\n    ],\n    \"NE\": [\n        \"H\"\n    ],\n    \"RU\": [\n        \"H\"\n    ],\n    \"SE\": [\n        \"H\"\n    ],\n    \"SJ\": [\n        \"H\"\n    ],\n    \"SK\": [\n        \"H\"\n    ],\n    \"AS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"BT\": [\n        \"h\",\n        \"H\"\n    ],\n    \"DJ\": [\n        \"h\",\n        \"H\"\n    ],\n    \"ER\": [\n        \"h\",\n        \"H\"\n    ],\n    \"GH\": [\n        \"h\",\n        \"H\"\n    ],\n    \"IN\": [\n        \"h\",\n        \"H\"\n    ],\n    \"LS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"PG\": [\n        \"h\",\n        \"H\"\n    ],\n    \"PW\": [\n        \"h\",\n        \"H\"\n    ],\n    \"SO\": [\n        \"h\",\n        \"H\"\n    ],\n    \"TO\": [\n        \"h\",\n        \"H\"\n    ],\n    \"VU\": [\n        \"h\",\n        \"H\"\n    ],\n    \"WS\": [\n        \"h\",\n        \"H\"\n    ],\n    \"001\": [\n        \"H\",\n        \"h\"\n    ],\n    \"AL\": [\n        \"h\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TD\": [\n        \"h\",\n        \"H\",\n        \"hB\"\n    ],\n    \"ca-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"CF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"CM\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"fr-CA\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"gl-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"it-CH\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"it-IT\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"LU\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"NP\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"PF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SC\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SM\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"SN\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"TF\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"VA\": [\n        \"H\",\n        \"h\",\n        \"hB\"\n    ],\n    \"CY\": [\n        \"h\",\n        \"H\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GR\": [\n        \"h\",\n        \"H\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CO\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"DO\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KP\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KR\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"NA\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"PA\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"PR\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"VE\": [\n        \"h\",\n        \"H\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"AC\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"AI\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"BW\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"BZ\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CC\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"CX\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"DG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"FK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GB\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"GI\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IE\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IM\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"IO\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"JE\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"LT\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"MK\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"MN\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"MS\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NF\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NG\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NR\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"NU\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"PN\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"SH\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"SX\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"TA\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"ZA\": [\n        \"H\",\n        \"h\",\n        \"hb\",\n        \"hB\"\n    ],\n    \"af-ZA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"AR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CL\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"CU\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"EA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-BO\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-BR\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-EC\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-ES\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-GQ\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"es-PE\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"GT\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"HN\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"IC\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KG\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"KM\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"LK\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"MA\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"MX\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"NI\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"PY\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"SV\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"UY\": [\n        \"H\",\n        \"h\",\n        \"hB\",\n        \"hb\"\n    ],\n    \"JP\": [\n        \"H\",\n        \"h\",\n        \"K\"\n    ],\n    \"AD\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AM\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AO\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"AW\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BJ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CG\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CI\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"CV\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"DE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"EE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"FR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GA\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GN\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GP\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"GW\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"HR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"IL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"IT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"KZ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MC\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MD\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MQ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"MZ\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"NC\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"NL\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"PM\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"PT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"RE\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"RO\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"SI\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"SR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"ST\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"TG\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"TR\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"WF\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"YT\": [\n        \"H\",\n        \"hB\"\n    ],\n    \"BD\": [\n        \"h\",\n        \"hB\",\n        \"H\"\n    ],\n    \"PK\": [\n        \"h\",\n        \"hB\",\n        \"H\"\n    ],\n    \"AZ\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"BA\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"BG\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"CH\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"GE\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"LI\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"ME\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"RS\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"UA\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"UZ\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"XK\": [\n        \"H\",\n        \"hB\",\n        \"h\"\n    ],\n    \"AG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"AU\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BB\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BS\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"CA\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"DM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"en-001\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"FJ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"FM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GD\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GU\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"GY\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"JM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KI\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KN\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"KY\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"LC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"LR\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MH\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MP\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"MW\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"NZ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SB\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SL\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SS\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"SZ\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"TT\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"UM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"US\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VC\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VG\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"VI\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"ZM\": [\n        \"h\",\n        \"hb\",\n        \"H\",\n        \"hB\"\n    ],\n    \"BO\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"EC\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"ES\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"GQ\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"PE\": [\n        \"H\",\n        \"hB\",\n        \"h\",\n        \"hb\"\n    ],\n    \"AE\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"ar-001\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"BH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"DZ\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"EG\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"EH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"HK\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"IQ\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"JO\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"KW\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"LB\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"LY\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"MO\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"MR\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"OM\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"PH\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"PS\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"QA\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SA\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SD\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"SY\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"TN\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"YE\": [\n        \"h\",\n        \"hB\",\n        \"hb\",\n        \"H\"\n    ],\n    \"AF\": [\n        \"H\",\n        \"hb\",\n        \"hB\",\n        \"h\"\n    ],\n    \"LA\": [\n        \"H\",\n        \"hb\",\n        \"hB\",\n        \"h\"\n    ],\n    \"CN\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"LV\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"TL\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"zu-ZA\": [\n        \"H\",\n        \"hB\",\n        \"hb\",\n        \"h\"\n    ],\n    \"CD\": [\n        \"hB\",\n        \"H\"\n    ],\n    \"IR\": [\n        \"hB\",\n        \"H\"\n    ],\n    \"hi-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"kn-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"ml-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"te-IN\": [\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"KH\": [\n        \"hB\",\n        \"h\",\n        \"H\",\n        \"hb\"\n    ],\n    \"ta-IN\": [\n        \"hB\",\n        \"h\",\n        \"hb\",\n        \"H\"\n    ],\n    \"BN\": [\n        \"hb\",\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"MY\": [\n        \"hb\",\n        \"hB\",\n        \"h\",\n        \"H\"\n    ],\n    \"ET\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"gu-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"mr-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"pa-IN\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"TW\": [\n        \"hB\",\n        \"hb\",\n        \"h\",\n        \"H\"\n    ],\n    \"KE\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"MM\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"TZ\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ],\n    \"UG\": [\n        \"hB\",\n        \"hb\",\n        \"H\",\n        \"h\"\n    ]\n};\n","var _a;\nimport { __assign } from \"tslib\";\nimport { ErrorKind } from './error';\nimport { SKELETON_TYPE, TYPE, } from './types';\nimport { SPACE_SEPARATOR_REGEX } from './regex.generated';\nimport { parseNumberSkeleton, parseNumberSkeletonFromString, parseDateTimeSkeleton, } from '@formatjs/icu-skeleton-parser';\nimport { getBestPattern } from './date-time-pattern-generator';\nvar SPACE_SEPARATOR_START_REGEX = new RegExp(\"^\".concat(SPACE_SEPARATOR_REGEX.source, \"*\"));\nvar SPACE_SEPARATOR_END_REGEX = new RegExp(\"\".concat(SPACE_SEPARATOR_REGEX.source, \"*$\"));\nfunction createLocation(start, end) {\n    return { start: start, end: end };\n}\n// #region Ponyfills\n// Consolidate these variables up top for easier toggling during debugging\nvar hasNativeStartsWith = !!String.prototype.startsWith;\nvar hasNativeFromCodePoint = !!String.fromCodePoint;\nvar hasNativeFromEntries = !!Object.fromEntries;\nvar hasNativeCodePointAt = !!String.prototype.codePointAt;\nvar hasTrimStart = !!String.prototype.trimStart;\nvar hasTrimEnd = !!String.prototype.trimEnd;\nvar hasNativeIsSafeInteger = !!Number.isSafeInteger;\nvar isSafeInteger = hasNativeIsSafeInteger\n    ? Number.isSafeInteger\n    : function (n) {\n        return (typeof n === 'number' &&\n            isFinite(n) &&\n            Math.floor(n) === n &&\n            Math.abs(n) <= 0x1fffffffffffff);\n    };\n// IE11 does not support y and u.\nvar REGEX_SUPPORTS_U_AND_Y = true;\ntry {\n    var re = RE('([^\\\\p{White_Space}\\\\p{Pattern_Syntax}]*)', 'yu');\n    /**\n     * legacy Edge or Xbox One browser\n     * Unicode flag support: supported\n     * Pattern_Syntax support: not supported\n     * See https://github.com/formatjs/formatjs/issues/2822\n     */\n    REGEX_SUPPORTS_U_AND_Y = ((_a = re.exec('a')) === null || _a === void 0 ? void 0 : _a[0]) === 'a';\n}\ncatch (_) {\n    REGEX_SUPPORTS_U_AND_Y = false;\n}\nvar startsWith = hasNativeStartsWith\n    ? // Native\n        function startsWith(s, search, position) {\n            return s.startsWith(search, position);\n        }\n    : // For IE11\n        function startsWith(s, search, position) {\n            return s.slice(position, position + search.length) === search;\n        };\nvar fromCodePoint = hasNativeFromCodePoint\n    ? String.fromCodePoint\n    : // IE11\n        function fromCodePoint() {\n            var codePoints = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                codePoints[_i] = arguments[_i];\n            }\n            var elements = '';\n            var length = codePoints.length;\n            var i = 0;\n            var code;\n            while (length > i) {\n                code = codePoints[i++];\n                if (code > 0x10ffff)\n                    throw RangeError(code + ' is not a valid code point');\n                elements +=\n                    code < 0x10000\n                        ? String.fromCharCode(code)\n                        : String.fromCharCode(((code -= 0x10000) >> 10) + 0xd800, (code % 0x400) + 0xdc00);\n            }\n            return elements;\n        };\nvar fromEntries = \n// native\nhasNativeFromEntries\n    ? Object.fromEntries\n    : // Ponyfill\n        function fromEntries(entries) {\n            var obj = {};\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                var _a = entries_1[_i], k = _a[0], v = _a[1];\n                obj[k] = v;\n            }\n            return obj;\n        };\nvar codePointAt = hasNativeCodePointAt\n    ? // Native\n        function codePointAt(s, index) {\n            return s.codePointAt(index);\n        }\n    : // IE 11\n        function codePointAt(s, index) {\n            var size = s.length;\n            if (index < 0 || index >= size) {\n                return undefined;\n            }\n            var first = s.charCodeAt(index);\n            var second;\n            return first < 0xd800 ||\n                first > 0xdbff ||\n                index + 1 === size ||\n                (second = s.charCodeAt(index + 1)) < 0xdc00 ||\n                second > 0xdfff\n                ? first\n                : ((first - 0xd800) << 10) + (second - 0xdc00) + 0x10000;\n        };\nvar trimStart = hasTrimStart\n    ? // Native\n        function trimStart(s) {\n            return s.trimStart();\n        }\n    : // Ponyfill\n        function trimStart(s) {\n            return s.replace(SPACE_SEPARATOR_START_REGEX, '');\n        };\nvar trimEnd = hasTrimEnd\n    ? // Native\n        function trimEnd(s) {\n            return s.trimEnd();\n        }\n    : // Ponyfill\n        function trimEnd(s) {\n            return s.replace(SPACE_SEPARATOR_END_REGEX, '');\n        };\n// Prevent minifier to translate new RegExp to literal form that might cause syntax error on IE11.\nfunction RE(s, flag) {\n    return new RegExp(s, flag);\n}\n// #endregion\nvar matchIdentifierAtIndex;\nif (REGEX_SUPPORTS_U_AND_Y) {\n    // Native\n    var IDENTIFIER_PREFIX_RE_1 = RE('([^\\\\p{White_Space}\\\\p{Pattern_Syntax}]*)', 'yu');\n    matchIdentifierAtIndex = function matchIdentifierAtIndex(s, index) {\n        var _a;\n        IDENTIFIER_PREFIX_RE_1.lastIndex = index;\n        var match = IDENTIFIER_PREFIX_RE_1.exec(s);\n        return (_a = match[1]) !== null && _a !== void 0 ? _a : '';\n    };\n}\nelse {\n    // IE11\n    matchIdentifierAtIndex = function matchIdentifierAtIndex(s, index) {\n        var match = [];\n        while (true) {\n            var c = codePointAt(s, index);\n            if (c === undefined || _isWhiteSpace(c) || _isPatternSyntax(c)) {\n                break;\n            }\n            match.push(c);\n            index += c >= 0x10000 ? 2 : 1;\n        }\n        return fromCodePoint.apply(void 0, match);\n    };\n}\nvar Parser = /** @class */ (function () {\n    function Parser(message, options) {\n        if (options === void 0) { options = {}; }\n        this.message = message;\n        this.position = { offset: 0, line: 1, column: 1 };\n        this.ignoreTag = !!options.ignoreTag;\n        this.locale = options.locale;\n        this.requiresOtherClause = !!options.requiresOtherClause;\n        this.shouldParseSkeletons = !!options.shouldParseSkeletons;\n    }\n    Parser.prototype.parse = function () {\n        if (this.offset() !== 0) {\n            throw Error('parser can only be used once');\n        }\n        return this.parseMessage(0, '', false);\n    };\n    Parser.prototype.parseMessage = function (nestingLevel, parentArgType, expectingCloseTag) {\n        var elements = [];\n        while (!this.isEOF()) {\n            var char = this.char();\n            if (char === 123 /* `{` */) {\n                var result = this.parseArgument(nestingLevel, expectingCloseTag);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n            else if (char === 125 /* `}` */ && nestingLevel > 0) {\n                break;\n            }\n            else if (char === 35 /* `#` */ &&\n                (parentArgType === 'plural' || parentArgType === 'selectordinal')) {\n                var position = this.clonePosition();\n                this.bump();\n                elements.push({\n                    type: TYPE.pound,\n                    location: createLocation(position, this.clonePosition()),\n                });\n            }\n            else if (char === 60 /* `<` */ &&\n                !this.ignoreTag &&\n                this.peek() === 47 // char code for '/'\n            ) {\n                if (expectingCloseTag) {\n                    break;\n                }\n                else {\n                    return this.error(ErrorKind.UNMATCHED_CLOSING_TAG, createLocation(this.clonePosition(), this.clonePosition()));\n                }\n            }\n            else if (char === 60 /* `<` */ &&\n                !this.ignoreTag &&\n                _isAlpha(this.peek() || 0)) {\n                var result = this.parseTag(nestingLevel, parentArgType);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n            else {\n                var result = this.parseLiteral(nestingLevel, parentArgType);\n                if (result.err) {\n                    return result;\n                }\n                elements.push(result.val);\n            }\n        }\n        return { val: elements, err: null };\n    };\n    /**\n     * A tag name must start with an ASCII lower/upper case letter. The grammar is based on the\n     * [custom element name][] except that a dash is NOT always mandatory and uppercase letters\n     * are accepted:\n     *\n     * ```\n     * tag ::= \"<\" tagName (whitespace)* \"/>\" | \"<\" tagName (whitespace)* \">\" message \"</\" tagName (whitespace)* \">\"\n     * tagName ::= [a-z] (PENChar)*\n     * PENChar ::=\n     *     \"-\" | \".\" | [0-9] | \"_\" | [a-z] | [A-Z] | #xB7 | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x37D] |\n     *     [#x37F-#x1FFF] | [#x200C-#x200D] | [#x203F-#x2040] | [#x2070-#x218F] | [#x2C00-#x2FEF] |\n     *     [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\n     * ```\n     *\n     * [custom element name]: https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n     * NOTE: We're a bit more lax here since HTML technically does not allow uppercase HTML element but we do\n     * since other tag-based engines like React allow it\n     */\n    Parser.prototype.parseTag = function (nestingLevel, parentArgType) {\n        var startPosition = this.clonePosition();\n        this.bump(); // `<`\n        var tagName = this.parseTagName();\n        this.bumpSpace();\n        if (this.bumpIf('/>')) {\n            // Self closing tag\n            return {\n                val: {\n                    type: TYPE.literal,\n                    value: \"<\".concat(tagName, \"/>\"),\n                    location: createLocation(startPosition, this.clonePosition()),\n                },\n                err: null,\n            };\n        }\n        else if (this.bumpIf('>')) {\n            var childrenResult = this.parseMessage(nestingLevel + 1, parentArgType, true);\n            if (childrenResult.err) {\n                return childrenResult;\n            }\n            var children = childrenResult.val;\n            // Expecting a close tag\n            var endTagStartPosition = this.clonePosition();\n            if (this.bumpIf('</')) {\n                if (this.isEOF() || !_isAlpha(this.char())) {\n                    return this.error(ErrorKind.INVALID_TAG, createLocation(endTagStartPosition, this.clonePosition()));\n                }\n                var closingTagNameStartPosition = this.clonePosition();\n                var closingTagName = this.parseTagName();\n                if (tagName !== closingTagName) {\n                    return this.error(ErrorKind.UNMATCHED_CLOSING_TAG, createLocation(closingTagNameStartPosition, this.clonePosition()));\n                }\n                this.bumpSpace();\n                if (!this.bumpIf('>')) {\n                    return this.error(ErrorKind.INVALID_TAG, createLocation(endTagStartPosition, this.clonePosition()));\n                }\n                return {\n                    val: {\n                        type: TYPE.tag,\n                        value: tagName,\n                        children: children,\n                        location: createLocation(startPosition, this.clonePosition()),\n                    },\n                    err: null,\n                };\n            }\n            else {\n                return this.error(ErrorKind.UNCLOSED_TAG, createLocation(startPosition, this.clonePosition()));\n            }\n        }\n        else {\n            return this.error(ErrorKind.INVALID_TAG, createLocation(startPosition, this.clonePosition()));\n        }\n    };\n    /**\n     * This method assumes that the caller has peeked ahead for the first tag character.\n     */\n    Parser.prototype.parseTagName = function () {\n        var startOffset = this.offset();\n        this.bump(); // the first tag name character\n        while (!this.isEOF() && _isPotentialElementNameChar(this.char())) {\n            this.bump();\n        }\n        return this.message.slice(startOffset, this.offset());\n    };\n    Parser.prototype.parseLiteral = function (nestingLevel, parentArgType) {\n        var start = this.clonePosition();\n        var value = '';\n        while (true) {\n            var parseQuoteResult = this.tryParseQuote(parentArgType);\n            if (parseQuoteResult) {\n                value += parseQuoteResult;\n                continue;\n            }\n            var parseUnquotedResult = this.tryParseUnquoted(nestingLevel, parentArgType);\n            if (parseUnquotedResult) {\n                value += parseUnquotedResult;\n                continue;\n            }\n            var parseLeftAngleResult = this.tryParseLeftAngleBracket();\n            if (parseLeftAngleResult) {\n                value += parseLeftAngleResult;\n                continue;\n            }\n            break;\n        }\n        var location = createLocation(start, this.clonePosition());\n        return {\n            val: { type: TYPE.literal, value: value, location: location },\n            err: null,\n        };\n    };\n    Parser.prototype.tryParseLeftAngleBracket = function () {\n        if (!this.isEOF() &&\n            this.char() === 60 /* `<` */ &&\n            (this.ignoreTag ||\n                // If at the opening tag or closing tag position, bail.\n                !_isAlphaOrSlash(this.peek() || 0))) {\n            this.bump(); // `<`\n            return '<';\n        }\n        return null;\n    };\n    /**\n     * Starting with ICU 4.8, an ASCII apostrophe only starts quoted text if it immediately precedes\n     * a character that requires quoting (that is, \"only where needed\"), and works the same in\n     * nested messages as on the top level of the pattern. The new behavior is otherwise compatible.\n     */\n    Parser.prototype.tryParseQuote = function (parentArgType) {\n        if (this.isEOF() || this.char() !== 39 /* `'` */) {\n            return null;\n        }\n        // Parse escaped char following the apostrophe, or early return if there is no escaped char.\n        // Check if is valid escaped character\n        switch (this.peek()) {\n            case 39 /* `'` */:\n                // double quote, should return as a single quote.\n                this.bump();\n                this.bump();\n                return \"'\";\n            // '{', '<', '>', '}'\n            case 123:\n            case 60:\n            case 62:\n            case 125:\n                break;\n            case 35: // '#'\n                if (parentArgType === 'plural' || parentArgType === 'selectordinal') {\n                    break;\n                }\n                return null;\n            default:\n                return null;\n        }\n        this.bump(); // apostrophe\n        var codePoints = [this.char()]; // escaped char\n        this.bump();\n        // read chars until the optional closing apostrophe is found\n        while (!this.isEOF()) {\n            var ch = this.char();\n            if (ch === 39 /* `'` */) {\n                if (this.peek() === 39 /* `'` */) {\n                    codePoints.push(39);\n                    // Bump one more time because we need to skip 2 characters.\n                    this.bump();\n                }\n                else {\n                    // Optional closing apostrophe.\n                    this.bump();\n                    break;\n                }\n            }\n            else {\n                codePoints.push(ch);\n            }\n            this.bump();\n        }\n        return fromCodePoint.apply(void 0, codePoints);\n    };\n    Parser.prototype.tryParseUnquoted = function (nestingLevel, parentArgType) {\n        if (this.isEOF()) {\n            return null;\n        }\n        var ch = this.char();\n        if (ch === 60 /* `<` */ ||\n            ch === 123 /* `{` */ ||\n            (ch === 35 /* `#` */ &&\n                (parentArgType === 'plural' || parentArgType === 'selectordinal')) ||\n            (ch === 125 /* `}` */ && nestingLevel > 0)) {\n            return null;\n        }\n        else {\n            this.bump();\n            return fromCodePoint(ch);\n        }\n    };\n    Parser.prototype.parseArgument = function (nestingLevel, expectingCloseTag) {\n        var openingBracePosition = this.clonePosition();\n        this.bump(); // `{`\n        this.bumpSpace();\n        if (this.isEOF()) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        if (this.char() === 125 /* `}` */) {\n            this.bump();\n            return this.error(ErrorKind.EMPTY_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        // argument name\n        var value = this.parseIdentifierIfPossible().value;\n        if (!value) {\n            return this.error(ErrorKind.MALFORMED_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        this.bumpSpace();\n        if (this.isEOF()) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        switch (this.char()) {\n            // Simple argument: `{name}`\n            case 125 /* `}` */: {\n                this.bump(); // `}`\n                return {\n                    val: {\n                        type: TYPE.argument,\n                        // value does not include the opening and closing braces.\n                        value: value,\n                        location: createLocation(openingBracePosition, this.clonePosition()),\n                    },\n                    err: null,\n                };\n            }\n            // Argument with options: `{name, format, ...}`\n            case 44 /* `,` */: {\n                this.bump(); // `,`\n                this.bumpSpace();\n                if (this.isEOF()) {\n                    return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n                }\n                return this.parseArgumentOptions(nestingLevel, expectingCloseTag, value, openingBracePosition);\n            }\n            default:\n                return this.error(ErrorKind.MALFORMED_ARGUMENT, createLocation(openingBracePosition, this.clonePosition()));\n        }\n    };\n    /**\n     * Advance the parser until the end of the identifier, if it is currently on\n     * an identifier character. Return an empty string otherwise.\n     */\n    Parser.prototype.parseIdentifierIfPossible = function () {\n        var startingPosition = this.clonePosition();\n        var startOffset = this.offset();\n        var value = matchIdentifierAtIndex(this.message, startOffset);\n        var endOffset = startOffset + value.length;\n        this.bumpTo(endOffset);\n        var endPosition = this.clonePosition();\n        var location = createLocation(startingPosition, endPosition);\n        return { value: value, location: location };\n    };\n    Parser.prototype.parseArgumentOptions = function (nestingLevel, expectingCloseTag, value, openingBracePosition) {\n        var _a;\n        // Parse this range:\n        // {name, type, style}\n        //        ^---^\n        var typeStartPosition = this.clonePosition();\n        var argType = this.parseIdentifierIfPossible().value;\n        var typeEndPosition = this.clonePosition();\n        switch (argType) {\n            case '':\n                // Expecting a style string number, date, time, plural, selectordinal, or select.\n                return this.error(ErrorKind.EXPECT_ARGUMENT_TYPE, createLocation(typeStartPosition, typeEndPosition));\n            case 'number':\n            case 'date':\n            case 'time': {\n                // Parse this range:\n                // {name, number, style}\n                //              ^-------^\n                this.bumpSpace();\n                var styleAndLocation = null;\n                if (this.bumpIf(',')) {\n                    this.bumpSpace();\n                    var styleStartPosition = this.clonePosition();\n                    var result = this.parseSimpleArgStyleIfPossible();\n                    if (result.err) {\n                        return result;\n                    }\n                    var style = trimEnd(result.val);\n                    if (style.length === 0) {\n                        return this.error(ErrorKind.EXPECT_ARGUMENT_STYLE, createLocation(this.clonePosition(), this.clonePosition()));\n                    }\n                    var styleLocation = createLocation(styleStartPosition, this.clonePosition());\n                    styleAndLocation = { style: style, styleLocation: styleLocation };\n                }\n                var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n                if (argCloseResult.err) {\n                    return argCloseResult;\n                }\n                var location_1 = createLocation(openingBracePosition, this.clonePosition());\n                // Extract style or skeleton\n                if (styleAndLocation && startsWith(styleAndLocation === null || styleAndLocation === void 0 ? void 0 : styleAndLocation.style, '::', 0)) {\n                    // Skeleton starts with `::`.\n                    var skeleton = trimStart(styleAndLocation.style.slice(2));\n                    if (argType === 'number') {\n                        var result = this.parseNumberSkeletonFromString(skeleton, styleAndLocation.styleLocation);\n                        if (result.err) {\n                            return result;\n                        }\n                        return {\n                            val: { type: TYPE.number, value: value, location: location_1, style: result.val },\n                            err: null,\n                        };\n                    }\n                    else {\n                        if (skeleton.length === 0) {\n                            return this.error(ErrorKind.EXPECT_DATE_TIME_SKELETON, location_1);\n                        }\n                        var dateTimePattern = skeleton;\n                        // Get \"best match\" pattern only if locale is passed, if not, let it\n                        // pass as-is where `parseDateTimeSkeleton()` will throw an error\n                        // for unsupported patterns.\n                        if (this.locale) {\n                            dateTimePattern = getBestPattern(skeleton, this.locale);\n                        }\n                        var style = {\n                            type: SKELETON_TYPE.dateTime,\n                            pattern: dateTimePattern,\n                            location: styleAndLocation.styleLocation,\n                            parsedOptions: this.shouldParseSkeletons\n                                ? parseDateTimeSkeleton(dateTimePattern)\n                                : {},\n                        };\n                        var type = argType === 'date' ? TYPE.date : TYPE.time;\n                        return {\n                            val: { type: type, value: value, location: location_1, style: style },\n                            err: null,\n                        };\n                    }\n                }\n                // Regular style or no style.\n                return {\n                    val: {\n                        type: argType === 'number'\n                            ? TYPE.number\n                            : argType === 'date'\n                                ? TYPE.date\n                                : TYPE.time,\n                        value: value,\n                        location: location_1,\n                        style: (_a = styleAndLocation === null || styleAndLocation === void 0 ? void 0 : styleAndLocation.style) !== null && _a !== void 0 ? _a : null,\n                    },\n                    err: null,\n                };\n            }\n            case 'plural':\n            case 'selectordinal':\n            case 'select': {\n                // Parse this range:\n                // {name, plural, options}\n                //              ^---------^\n                var typeEndPosition_1 = this.clonePosition();\n                this.bumpSpace();\n                if (!this.bumpIf(',')) {\n                    return this.error(ErrorKind.EXPECT_SELECT_ARGUMENT_OPTIONS, createLocation(typeEndPosition_1, __assign({}, typeEndPosition_1)));\n                }\n                this.bumpSpace();\n                // Parse offset:\n                // {name, plural, offset:1, options}\n                //                ^-----^\n                //\n                // or the first option:\n                //\n                // {name, plural, one {...} other {...}}\n                //                ^--^\n                var identifierAndLocation = this.parseIdentifierIfPossible();\n                var pluralOffset = 0;\n                if (argType !== 'select' && identifierAndLocation.value === 'offset') {\n                    if (!this.bumpIf(':')) {\n                        return this.error(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE, createLocation(this.clonePosition(), this.clonePosition()));\n                    }\n                    this.bumpSpace();\n                    var result = this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE, ErrorKind.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);\n                    if (result.err) {\n                        return result;\n                    }\n                    // Parse another identifier for option parsing\n                    this.bumpSpace();\n                    identifierAndLocation = this.parseIdentifierIfPossible();\n                    pluralOffset = result.val;\n                }\n                var optionsResult = this.tryParsePluralOrSelectOptions(nestingLevel, argType, expectingCloseTag, identifierAndLocation);\n                if (optionsResult.err) {\n                    return optionsResult;\n                }\n                var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n                if (argCloseResult.err) {\n                    return argCloseResult;\n                }\n                var location_2 = createLocation(openingBracePosition, this.clonePosition());\n                if (argType === 'select') {\n                    return {\n                        val: {\n                            type: TYPE.select,\n                            value: value,\n                            options: fromEntries(optionsResult.val),\n                            location: location_2,\n                        },\n                        err: null,\n                    };\n                }\n                else {\n                    return {\n                        val: {\n                            type: TYPE.plural,\n                            value: value,\n                            options: fromEntries(optionsResult.val),\n                            offset: pluralOffset,\n                            pluralType: argType === 'plural' ? 'cardinal' : 'ordinal',\n                            location: location_2,\n                        },\n                        err: null,\n                    };\n                }\n            }\n            default:\n                return this.error(ErrorKind.INVALID_ARGUMENT_TYPE, createLocation(typeStartPosition, typeEndPosition));\n        }\n    };\n    Parser.prototype.tryParseArgumentClose = function (openingBracePosition) {\n        // Parse: {value, number, ::currency/GBP }\n        //\n        if (this.isEOF() || this.char() !== 125 /* `}` */) {\n            return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE, createLocation(openingBracePosition, this.clonePosition()));\n        }\n        this.bump(); // `}`\n        return { val: true, err: null };\n    };\n    /**\n     * See: https://github.com/unicode-org/icu/blob/af7ed1f6d2298013dc303628438ec4abe1f16479/icu4c/source/common/messagepattern.cpp#L659\n     */\n    Parser.prototype.parseSimpleArgStyleIfPossible = function () {\n        var nestedBraces = 0;\n        var startPosition = this.clonePosition();\n        while (!this.isEOF()) {\n            var ch = this.char();\n            switch (ch) {\n                case 39 /* `'` */: {\n                    // Treat apostrophe as quoting but include it in the style part.\n                    // Find the end of the quoted literal text.\n                    this.bump();\n                    var apostrophePosition = this.clonePosition();\n                    if (!this.bumpUntil(\"'\")) {\n                        return this.error(ErrorKind.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE, createLocation(apostrophePosition, this.clonePosition()));\n                    }\n                    this.bump();\n                    break;\n                }\n                case 123 /* `{` */: {\n                    nestedBraces += 1;\n                    this.bump();\n                    break;\n                }\n                case 125 /* `}` */: {\n                    if (nestedBraces > 0) {\n                        nestedBraces -= 1;\n                    }\n                    else {\n                        return {\n                            val: this.message.slice(startPosition.offset, this.offset()),\n                            err: null,\n                        };\n                    }\n                    break;\n                }\n                default:\n                    this.bump();\n                    break;\n            }\n        }\n        return {\n            val: this.message.slice(startPosition.offset, this.offset()),\n            err: null,\n        };\n    };\n    Parser.prototype.parseNumberSkeletonFromString = function (skeleton, location) {\n        var tokens = [];\n        try {\n            tokens = parseNumberSkeletonFromString(skeleton);\n        }\n        catch (e) {\n            return this.error(ErrorKind.INVALID_NUMBER_SKELETON, location);\n        }\n        return {\n            val: {\n                type: SKELETON_TYPE.number,\n                tokens: tokens,\n                location: location,\n                parsedOptions: this.shouldParseSkeletons\n                    ? parseNumberSkeleton(tokens)\n                    : {},\n            },\n            err: null,\n        };\n    };\n    /**\n     * @param nesting_level The current nesting level of messages.\n     *     This can be positive when parsing message fragment in select or plural argument options.\n     * @param parent_arg_type The parent argument's type.\n     * @param parsed_first_identifier If provided, this is the first identifier-like selector of\n     *     the argument. It is a by-product of a previous parsing attempt.\n     * @param expecting_close_tag If true, this message is directly or indirectly nested inside\n     *     between a pair of opening and closing tags. The nested message will not parse beyond\n     *     the closing tag boundary.\n     */\n    Parser.prototype.tryParsePluralOrSelectOptions = function (nestingLevel, parentArgType, expectCloseTag, parsedFirstIdentifier) {\n        var _a;\n        var hasOtherClause = false;\n        var options = [];\n        var parsedSelectors = new Set();\n        var selector = parsedFirstIdentifier.value, selectorLocation = parsedFirstIdentifier.location;\n        // Parse:\n        // one {one apple}\n        // ^--^\n        while (true) {\n            if (selector.length === 0) {\n                var startPosition = this.clonePosition();\n                if (parentArgType !== 'select' && this.bumpIf('=')) {\n                    // Try parse `={number}` selector\n                    var result = this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR, ErrorKind.INVALID_PLURAL_ARGUMENT_SELECTOR);\n                    if (result.err) {\n                        return result;\n                    }\n                    selectorLocation = createLocation(startPosition, this.clonePosition());\n                    selector = this.message.slice(startPosition.offset, this.offset());\n                }\n                else {\n                    break;\n                }\n            }\n            // Duplicate selector clauses\n            if (parsedSelectors.has(selector)) {\n                return this.error(parentArgType === 'select'\n                    ? ErrorKind.DUPLICATE_SELECT_ARGUMENT_SELECTOR\n                    : ErrorKind.DUPLICATE_PLURAL_ARGUMENT_SELECTOR, selectorLocation);\n            }\n            if (selector === 'other') {\n                hasOtherClause = true;\n            }\n            // Parse:\n            // one {one apple}\n            //     ^----------^\n            this.bumpSpace();\n            var openingBracePosition = this.clonePosition();\n            if (!this.bumpIf('{')) {\n                return this.error(parentArgType === 'select'\n                    ? ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT\n                    : ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT, createLocation(this.clonePosition(), this.clonePosition()));\n            }\n            var fragmentResult = this.parseMessage(nestingLevel + 1, parentArgType, expectCloseTag);\n            if (fragmentResult.err) {\n                return fragmentResult;\n            }\n            var argCloseResult = this.tryParseArgumentClose(openingBracePosition);\n            if (argCloseResult.err) {\n                return argCloseResult;\n            }\n            options.push([\n                selector,\n                {\n                    value: fragmentResult.val,\n                    location: createLocation(openingBracePosition, this.clonePosition()),\n                },\n            ]);\n            // Keep track of the existing selectors\n            parsedSelectors.add(selector);\n            // Prep next selector clause.\n            this.bumpSpace();\n            (_a = this.parseIdentifierIfPossible(), selector = _a.value, selectorLocation = _a.location);\n        }\n        if (options.length === 0) {\n            return this.error(parentArgType === 'select'\n                ? ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR\n                : ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR, createLocation(this.clonePosition(), this.clonePosition()));\n        }\n        if (this.requiresOtherClause && !hasOtherClause) {\n            return this.error(ErrorKind.MISSING_OTHER_CLAUSE, createLocation(this.clonePosition(), this.clonePosition()));\n        }\n        return { val: options, err: null };\n    };\n    Parser.prototype.tryParseDecimalInteger = function (expectNumberError, invalidNumberError) {\n        var sign = 1;\n        var startingPosition = this.clonePosition();\n        if (this.bumpIf('+')) {\n        }\n        else if (this.bumpIf('-')) {\n            sign = -1;\n        }\n        var hasDigits = false;\n        var decimal = 0;\n        while (!this.isEOF()) {\n            var ch = this.char();\n            if (ch >= 48 /* `0` */ && ch <= 57 /* `9` */) {\n                hasDigits = true;\n                decimal = decimal * 10 + (ch - 48);\n                this.bump();\n            }\n            else {\n                break;\n            }\n        }\n        var location = createLocation(startingPosition, this.clonePosition());\n        if (!hasDigits) {\n            return this.error(expectNumberError, location);\n        }\n        decimal *= sign;\n        if (!isSafeInteger(decimal)) {\n            return this.error(invalidNumberError, location);\n        }\n        return { val: decimal, err: null };\n    };\n    Parser.prototype.offset = function () {\n        return this.position.offset;\n    };\n    Parser.prototype.isEOF = function () {\n        return this.offset() === this.message.length;\n    };\n    Parser.prototype.clonePosition = function () {\n        // This is much faster than `Object.assign` or spread.\n        return {\n            offset: this.position.offset,\n            line: this.position.line,\n            column: this.position.column,\n        };\n    };\n    /**\n     * Return the code point at the current position of the parser.\n     * Throws if the index is out of bound.\n     */\n    Parser.prototype.char = function () {\n        var offset = this.position.offset;\n        if (offset >= this.message.length) {\n            throw Error('out of bound');\n        }\n        var code = codePointAt(this.message, offset);\n        if (code === undefined) {\n            throw Error(\"Offset \".concat(offset, \" is at invalid UTF-16 code unit boundary\"));\n        }\n        return code;\n    };\n    Parser.prototype.error = function (kind, location) {\n        return {\n            val: null,\n            err: {\n                kind: kind,\n                message: this.message,\n                location: location,\n            },\n        };\n    };\n    /** Bump the parser to the next UTF-16 code unit. */\n    Parser.prototype.bump = function () {\n        if (this.isEOF()) {\n            return;\n        }\n        var code = this.char();\n        if (code === 10 /* '\\n' */) {\n            this.position.line += 1;\n            this.position.column = 1;\n            this.position.offset += 1;\n        }\n        else {\n            this.position.column += 1;\n            // 0 ~ 0x10000 -> unicode BMP, otherwise skip the surrogate pair.\n            this.position.offset += code < 0x10000 ? 1 : 2;\n        }\n    };\n    /**\n     * If the substring starting at the current position of the parser has\n     * the given prefix, then bump the parser to the character immediately\n     * following the prefix and return true. Otherwise, don't bump the parser\n     * and return false.\n     */\n    Parser.prototype.bumpIf = function (prefix) {\n        if (startsWith(this.message, prefix, this.offset())) {\n            for (var i = 0; i < prefix.length; i++) {\n                this.bump();\n            }\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Bump the parser until the pattern character is found and return `true`.\n     * Otherwise bump to the end of the file and return `false`.\n     */\n    Parser.prototype.bumpUntil = function (pattern) {\n        var currentOffset = this.offset();\n        var index = this.message.indexOf(pattern, currentOffset);\n        if (index >= 0) {\n            this.bumpTo(index);\n            return true;\n        }\n        else {\n            this.bumpTo(this.message.length);\n            return false;\n        }\n    };\n    /**\n     * Bump the parser to the target offset.\n     * If target offset is beyond the end of the input, bump the parser to the end of the input.\n     */\n    Parser.prototype.bumpTo = function (targetOffset) {\n        if (this.offset() > targetOffset) {\n            throw Error(\"targetOffset \".concat(targetOffset, \" must be greater than or equal to the current offset \").concat(this.offset()));\n        }\n        targetOffset = Math.min(targetOffset, this.message.length);\n        while (true) {\n            var offset = this.offset();\n            if (offset === targetOffset) {\n                break;\n            }\n            if (offset > targetOffset) {\n                throw Error(\"targetOffset \".concat(targetOffset, \" is at invalid UTF-16 code unit boundary\"));\n            }\n            this.bump();\n            if (this.isEOF()) {\n                break;\n            }\n        }\n    };\n    /** advance the parser through all whitespace to the next non-whitespace code unit. */\n    Parser.prototype.bumpSpace = function () {\n        while (!this.isEOF() && _isWhiteSpace(this.char())) {\n            this.bump();\n        }\n    };\n    /**\n     * Peek at the *next* Unicode codepoint in the input without advancing the parser.\n     * If the input has been exhausted, then this returns null.\n     */\n    Parser.prototype.peek = function () {\n        if (this.isEOF()) {\n            return null;\n        }\n        var code = this.char();\n        var offset = this.offset();\n        var nextCode = this.message.charCodeAt(offset + (code >= 0x10000 ? 2 : 1));\n        return nextCode !== null && nextCode !== void 0 ? nextCode : null;\n    };\n    return Parser;\n}());\nexport { Parser };\n/**\n * This check if codepoint is alphabet (lower & uppercase)\n * @param codepoint\n * @returns\n */\nfunction _isAlpha(codepoint) {\n    return ((codepoint >= 97 && codepoint <= 122) ||\n        (codepoint >= 65 && codepoint <= 90));\n}\nfunction _isAlphaOrSlash(codepoint) {\n    return _isAlpha(codepoint) || codepoint === 47; /* '/' */\n}\n/** See `parseTag` function docs. */\nfunction _isPotentialElementNameChar(c) {\n    return (c === 45 /* '-' */ ||\n        c === 46 /* '.' */ ||\n        (c >= 48 && c <= 57) /* 0..9 */ ||\n        c === 95 /* '_' */ ||\n        (c >= 97 && c <= 122) /** a..z */ ||\n        (c >= 65 && c <= 90) /* A..Z */ ||\n        c == 0xb7 ||\n        (c >= 0xc0 && c <= 0xd6) ||\n        (c >= 0xd8 && c <= 0xf6) ||\n        (c >= 0xf8 && c <= 0x37d) ||\n        (c >= 0x37f && c <= 0x1fff) ||\n        (c >= 0x200c && c <= 0x200d) ||\n        (c >= 0x203f && c <= 0x2040) ||\n        (c >= 0x2070 && c <= 0x218f) ||\n        (c >= 0x2c00 && c <= 0x2fef) ||\n        (c >= 0x3001 && c <= 0xd7ff) ||\n        (c >= 0xf900 && c <= 0xfdcf) ||\n        (c >= 0xfdf0 && c <= 0xfffd) ||\n        (c >= 0x10000 && c <= 0xeffff));\n}\n/**\n * Code point equivalent of regex `\\p{White_Space}`.\n * From: https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt\n */\nfunction _isWhiteSpace(c) {\n    return ((c >= 0x0009 && c <= 0x000d) ||\n        c === 0x0020 ||\n        c === 0x0085 ||\n        (c >= 0x200e && c <= 0x200f) ||\n        c === 0x2028 ||\n        c === 0x2029);\n}\n/**\n * Code point equivalent of regex `\\p{Pattern_Syntax}`.\n * See https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt\n */\nfunction _isPatternSyntax(c) {\n    return ((c >= 0x0021 && c <= 0x0023) ||\n        c === 0x0024 ||\n        (c >= 0x0025 && c <= 0x0027) ||\n        c === 0x0028 ||\n        c === 0x0029 ||\n        c === 0x002a ||\n        c === 0x002b ||\n        c === 0x002c ||\n        c === 0x002d ||\n        (c >= 0x002e && c <= 0x002f) ||\n        (c >= 0x003a && c <= 0x003b) ||\n        (c >= 0x003c && c <= 0x003e) ||\n        (c >= 0x003f && c <= 0x0040) ||\n        c === 0x005b ||\n        c === 0x005c ||\n        c === 0x005d ||\n        c === 0x005e ||\n        c === 0x0060 ||\n        c === 0x007b ||\n        c === 0x007c ||\n        c === 0x007d ||\n        c === 0x007e ||\n        c === 0x00a1 ||\n        (c >= 0x00a2 && c <= 0x00a5) ||\n        c === 0x00a6 ||\n        c === 0x00a7 ||\n        c === 0x00a9 ||\n        c === 0x00ab ||\n        c === 0x00ac ||\n        c === 0x00ae ||\n        c === 0x00b0 ||\n        c === 0x00b1 ||\n        c === 0x00b6 ||\n        c === 0x00bb ||\n        c === 0x00bf ||\n        c === 0x00d7 ||\n        c === 0x00f7 ||\n        (c >= 0x2010 && c <= 0x2015) ||\n        (c >= 0x2016 && c <= 0x2017) ||\n        c === 0x2018 ||\n        c === 0x2019 ||\n        c === 0x201a ||\n        (c >= 0x201b && c <= 0x201c) ||\n        c === 0x201d ||\n        c === 0x201e ||\n        c === 0x201f ||\n        (c >= 0x2020 && c <= 0x2027) ||\n        (c >= 0x2030 && c <= 0x2038) ||\n        c === 0x2039 ||\n        c === 0x203a ||\n        (c >= 0x203b && c <= 0x203e) ||\n        (c >= 0x2041 && c <= 0x2043) ||\n        c === 0x2044 ||\n        c === 0x2045 ||\n        c === 0x2046 ||\n        (c >= 0x2047 && c <= 0x2051) ||\n        c === 0x2052 ||\n        c === 0x2053 ||\n        (c >= 0x2055 && c <= 0x205e) ||\n        (c >= 0x2190 && c <= 0x2194) ||\n        (c >= 0x2195 && c <= 0x2199) ||\n        (c >= 0x219a && c <= 0x219b) ||\n        (c >= 0x219c && c <= 0x219f) ||\n        c === 0x21a0 ||\n        (c >= 0x21a1 && c <= 0x21a2) ||\n        c === 0x21a3 ||\n        (c >= 0x21a4 && c <= 0x21a5) ||\n        c === 0x21a6 ||\n        (c >= 0x21a7 && c <= 0x21ad) ||\n        c === 0x21ae ||\n        (c >= 0x21af && c <= 0x21cd) ||\n        (c >= 0x21ce && c <= 0x21cf) ||\n        (c >= 0x21d0 && c <= 0x21d1) ||\n        c === 0x21d2 ||\n        c === 0x21d3 ||\n        c === 0x21d4 ||\n        (c >= 0x21d5 && c <= 0x21f3) ||\n        (c >= 0x21f4 && c <= 0x22ff) ||\n        (c >= 0x2300 && c <= 0x2307) ||\n        c === 0x2308 ||\n        c === 0x2309 ||\n        c === 0x230a ||\n        c === 0x230b ||\n        (c >= 0x230c && c <= 0x231f) ||\n        (c >= 0x2320 && c <= 0x2321) ||\n        (c >= 0x2322 && c <= 0x2328) ||\n        c === 0x2329 ||\n        c === 0x232a ||\n        (c >= 0x232b && c <= 0x237b) ||\n        c === 0x237c ||\n        (c >= 0x237d && c <= 0x239a) ||\n        (c >= 0x239b && c <= 0x23b3) ||\n        (c >= 0x23b4 && c <= 0x23db) ||\n        (c >= 0x23dc && c <= 0x23e1) ||\n        (c >= 0x23e2 && c <= 0x2426) ||\n        (c >= 0x2427 && c <= 0x243f) ||\n        (c >= 0x2440 && c <= 0x244a) ||\n        (c >= 0x244b && c <= 0x245f) ||\n        (c >= 0x2500 && c <= 0x25b6) ||\n        c === 0x25b7 ||\n        (c >= 0x25b8 && c <= 0x25c0) ||\n        c === 0x25c1 ||\n        (c >= 0x25c2 && c <= 0x25f7) ||\n        (c >= 0x25f8 && c <= 0x25ff) ||\n        (c >= 0x2600 && c <= 0x266e) ||\n        c === 0x266f ||\n        (c >= 0x2670 && c <= 0x2767) ||\n        c === 0x2768 ||\n        c === 0x2769 ||\n        c === 0x276a ||\n        c === 0x276b ||\n        c === 0x276c ||\n        c === 0x276d ||\n        c === 0x276e ||\n        c === 0x276f ||\n        c === 0x2770 ||\n        c === 0x2771 ||\n        c === 0x2772 ||\n        c === 0x2773 ||\n        c === 0x2774 ||\n        c === 0x2775 ||\n        (c >= 0x2794 && c <= 0x27bf) ||\n        (c >= 0x27c0 && c <= 0x27c4) ||\n        c === 0x27c5 ||\n        c === 0x27c6 ||\n        (c >= 0x27c7 && c <= 0x27e5) ||\n        c === 0x27e6 ||\n        c === 0x27e7 ||\n        c === 0x27e8 ||\n        c === 0x27e9 ||\n        c === 0x27ea ||\n        c === 0x27eb ||\n        c === 0x27ec ||\n        c === 0x27ed ||\n        c === 0x27ee ||\n        c === 0x27ef ||\n        (c >= 0x27f0 && c <= 0x27ff) ||\n        (c >= 0x2800 && c <= 0x28ff) ||\n        (c >= 0x2900 && c <= 0x2982) ||\n        c === 0x2983 ||\n        c === 0x2984 ||\n        c === 0x2985 ||\n        c === 0x2986 ||\n        c === 0x2987 ||\n        c === 0x2988 ||\n        c === 0x2989 ||\n        c === 0x298a ||\n        c === 0x298b ||\n        c === 0x298c ||\n        c === 0x298d ||\n        c === 0x298e ||\n        c === 0x298f ||\n        c === 0x2990 ||\n        c === 0x2991 ||\n        c === 0x2992 ||\n        c === 0x2993 ||\n        c === 0x2994 ||\n        c === 0x2995 ||\n        c === 0x2996 ||\n        c === 0x2997 ||\n        c === 0x2998 ||\n        (c >= 0x2999 && c <= 0x29d7) ||\n        c === 0x29d8 ||\n        c === 0x29d9 ||\n        c === 0x29da ||\n        c === 0x29db ||\n        (c >= 0x29dc && c <= 0x29fb) ||\n        c === 0x29fc ||\n        c === 0x29fd ||\n        (c >= 0x29fe && c <= 0x2aff) ||\n        (c >= 0x2b00 && c <= 0x2b2f) ||\n        (c >= 0x2b30 && c <= 0x2b44) ||\n        (c >= 0x2b45 && c <= 0x2b46) ||\n        (c >= 0x2b47 && c <= 0x2b4c) ||\n        (c >= 0x2b4d && c <= 0x2b73) ||\n        (c >= 0x2b74 && c <= 0x2b75) ||\n        (c >= 0x2b76 && c <= 0x2b95) ||\n        c === 0x2b96 ||\n        (c >= 0x2b97 && c <= 0x2bff) ||\n        (c >= 0x2e00 && c <= 0x2e01) ||\n        c === 0x2e02 ||\n        c === 0x2e03 ||\n        c === 0x2e04 ||\n        c === 0x2e05 ||\n        (c >= 0x2e06 && c <= 0x2e08) ||\n        c === 0x2e09 ||\n        c === 0x2e0a ||\n        c === 0x2e0b ||\n        c === 0x2e0c ||\n        c === 0x2e0d ||\n        (c >= 0x2e0e && c <= 0x2e16) ||\n        c === 0x2e17 ||\n        (c >= 0x2e18 && c <= 0x2e19) ||\n        c === 0x2e1a ||\n        c === 0x2e1b ||\n        c === 0x2e1c ||\n        c === 0x2e1d ||\n        (c >= 0x2e1e && c <= 0x2e1f) ||\n        c === 0x2e20 ||\n        c === 0x2e21 ||\n        c === 0x2e22 ||\n        c === 0x2e23 ||\n        c === 0x2e24 ||\n        c === 0x2e25 ||\n        c === 0x2e26 ||\n        c === 0x2e27 ||\n        c === 0x2e28 ||\n        c === 0x2e29 ||\n        (c >= 0x2e2a && c <= 0x2e2e) ||\n        c === 0x2e2f ||\n        (c >= 0x2e30 && c <= 0x2e39) ||\n        (c >= 0x2e3a && c <= 0x2e3b) ||\n        (c >= 0x2e3c && c <= 0x2e3f) ||\n        c === 0x2e40 ||\n        c === 0x2e41 ||\n        c === 0x2e42 ||\n        (c >= 0x2e43 && c <= 0x2e4f) ||\n        (c >= 0x2e50 && c <= 0x2e51) ||\n        c === 0x2e52 ||\n        (c >= 0x2e53 && c <= 0x2e7f) ||\n        (c >= 0x3001 && c <= 0x3003) ||\n        c === 0x3008 ||\n        c === 0x3009 ||\n        c === 0x300a ||\n        c === 0x300b ||\n        c === 0x300c ||\n        c === 0x300d ||\n        c === 0x300e ||\n        c === 0x300f ||\n        c === 0x3010 ||\n        c === 0x3011 ||\n        (c >= 0x3012 && c <= 0x3013) ||\n        c === 0x3014 ||\n        c === 0x3015 ||\n        c === 0x3016 ||\n        c === 0x3017 ||\n        c === 0x3018 ||\n        c === 0x3019 ||\n        c === 0x301a ||\n        c === 0x301b ||\n        c === 0x301c ||\n        c === 0x301d ||\n        (c >= 0x301e && c <= 0x301f) ||\n        c === 0x3020 ||\n        c === 0x3030 ||\n        c === 0xfd3e ||\n        c === 0xfd3f ||\n        (c >= 0xfe45 && c <= 0xfe46));\n}\n","import { timeData } from './time-data.generated';\n/**\n * Returns the best matching date time pattern if a date time skeleton\n * pattern is provided with a locale. Follows the Unicode specification:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#table-mapping-requested-time-skeletons-to-patterns\n * @param skeleton date time skeleton pattern that possibly includes j, J or C\n * @param locale\n */\nexport function getBestPattern(skeleton, locale) {\n    var skeletonCopy = '';\n    for (var patternPos = 0; patternPos < skeleton.length; patternPos++) {\n        var patternChar = skeleton.charAt(patternPos);\n        if (patternChar === 'j') {\n            var extraLength = 0;\n            while (patternPos + 1 < skeleton.length &&\n                skeleton.charAt(patternPos + 1) === patternChar) {\n                extraLength++;\n                patternPos++;\n            }\n            var hourLen = 1 + (extraLength & 1);\n            var dayPeriodLen = extraLength < 2 ? 1 : 3 + (extraLength >> 1);\n            var dayPeriodChar = 'a';\n            var hourChar = getDefaultHourSymbolFromLocale(locale);\n            if (hourChar == 'H' || hourChar == 'k') {\n                dayPeriodLen = 0;\n            }\n            while (dayPeriodLen-- > 0) {\n                skeletonCopy += dayPeriodChar;\n            }\n            while (hourLen-- > 0) {\n                skeletonCopy = hourChar + skeletonCopy;\n            }\n        }\n        else if (patternChar === 'J') {\n            skeletonCopy += 'H';\n        }\n        else {\n            skeletonCopy += patternChar;\n        }\n    }\n    return skeletonCopy;\n}\n/**\n * Maps the [hour cycle type](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Locale/hourCycle)\n * of the given `locale` to the corresponding time pattern.\n * @param locale\n */\nfunction getDefaultHourSymbolFromLocale(locale) {\n    var hourCycle = locale.hourCycle;\n    if (hourCycle === undefined &&\n        // @ts-ignore hourCycle(s) is not identified yet\n        locale.hourCycles &&\n        // @ts-ignore\n        locale.hourCycles.length) {\n        // @ts-ignore\n        hourCycle = locale.hourCycles[0];\n    }\n    if (hourCycle) {\n        switch (hourCycle) {\n            case 'h24':\n                return 'k';\n            case 'h23':\n                return 'H';\n            case 'h12':\n                return 'h';\n            case 'h11':\n                return 'K';\n            default:\n                throw new Error('Invalid hourCycle');\n        }\n    }\n    // TODO: Once hourCycle is fully supported remove the following with data generation\n    var languageTag = locale.language;\n    var regionTag;\n    if (languageTag !== 'root') {\n        regionTag = locale.maximize().region;\n    }\n    var hourCycles = timeData[regionTag || ''] ||\n        timeData[languageTag || ''] ||\n        timeData[\"\".concat(languageTag, \"-001\")] ||\n        timeData['001'];\n    return hourCycles[0];\n}\n","import { __assign } from \"tslib\";\nimport { ErrorKind } from './error';\nimport { Parser } from './parser';\nimport { isDateElement, isDateTimeSkeleton, isNumberElement, isNumberSkeleton, isPluralElement, isSelectElement, isTagElement, isTimeElement, } from './types';\nfunction pruneLocation(els) {\n    els.forEach(function (el) {\n        delete el.location;\n        if (isSelectElement(el) || isPluralElement(el)) {\n            for (var k in el.options) {\n                delete el.options[k].location;\n                pruneLocation(el.options[k].value);\n            }\n        }\n        else if (isNumberElement(el) && isNumberSkeleton(el.style)) {\n            delete el.style.location;\n        }\n        else if ((isDateElement(el) || isTimeElement(el)) &&\n            isDateTimeSkeleton(el.style)) {\n            delete el.style.location;\n        }\n        else if (isTagElement(el)) {\n            pruneLocation(el.children);\n        }\n    });\n}\nexport function parse(message, opts) {\n    if (opts === void 0) { opts = {}; }\n    opts = __assign({ shouldParseSkeletons: true, requiresOtherClause: true }, opts);\n    var result = new Parser(message, opts).parse();\n    if (result.err) {\n        var error = SyntaxError(ErrorKind[result.err.kind]);\n        // @ts-expect-error Assign to error object\n        error.location = result.err.location;\n        // @ts-expect-error Assign to error object\n        error.originalMessage = result.err.message;\n        throw error;\n    }\n    if (!(opts === null || opts === void 0 ? void 0 : opts.captureLocation)) {\n        pruneLocation(result.val);\n    }\n    return result.val;\n}\nexport * from './types';\n// only for testing\nexport var _Parser = Parser;\n","//\n// Main\n//\nexport default function memoize(fn, options) {\n    var cache = options && options.cache ? options.cache : cacheDefault;\n    var serializer = options && options.serializer ? options.serializer : serializerDefault;\n    var strategy = options && options.strategy ? options.strategy : strategyDefault;\n    return strategy(fn, {\n        cache: cache,\n        serializer: serializer,\n    });\n}\n//\n// Strategy\n//\nfunction isPrimitive(value) {\n    return (value == null || typeof value === 'number' || typeof value === 'boolean'); // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\nfunction monadic(fn, cache, serializer, arg) {\n    var cacheKey = isPrimitive(arg) ? arg : serializer(arg);\n    var computedValue = cache.get(cacheKey);\n    if (typeof computedValue === 'undefined') {\n        computedValue = fn.call(this, arg);\n        cache.set(cacheKey, computedValue);\n    }\n    return computedValue;\n}\nfunction variadic(fn, cache, serializer) {\n    var args = Array.prototype.slice.call(arguments, 3);\n    var cacheKey = serializer(args);\n    var computedValue = cache.get(cacheKey);\n    if (typeof computedValue === 'undefined') {\n        computedValue = fn.apply(this, args);\n        cache.set(cacheKey, computedValue);\n    }\n    return computedValue;\n}\nfunction assemble(fn, context, strategy, cache, serialize) {\n    return strategy.bind(context, fn, cache, serialize);\n}\nfunction strategyDefault(fn, options) {\n    var strategy = fn.length === 1 ? monadic : variadic;\n    return assemble(fn, this, strategy, options.cache.create(), options.serializer);\n}\nfunction strategyVariadic(fn, options) {\n    return assemble(fn, this, variadic, options.cache.create(), options.serializer);\n}\nfunction strategyMonadic(fn, options) {\n    return assemble(fn, this, monadic, options.cache.create(), options.serializer);\n}\n//\n// Serializer\n//\nvar serializerDefault = function () {\n    return JSON.stringify(arguments);\n};\n//\n// Cache\n//\nfunction ObjectWithoutPrototypeCache() {\n    this.cache = Object.create(null);\n}\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n    return this.cache[key];\n};\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n    this.cache[key] = value;\n};\nvar cacheDefault = {\n    create: function create() {\n        // @ts-ignore\n        return new ObjectWithoutPrototypeCache();\n    },\n};\nexport var strategies = {\n    variadic: strategyVariadic,\n    monadic: strategyMonadic,\n};\n","import { __extends } from \"tslib\";\nexport var ErrorCode;\n(function (ErrorCode) {\n    // When we have a placeholder but no value to format\n    ErrorCode[\"MISSING_VALUE\"] = \"MISSING_VALUE\";\n    // When value supplied is invalid\n    ErrorCode[\"INVALID_VALUE\"] = \"INVALID_VALUE\";\n    // When we need specific Intl API but it's not available\n    ErrorCode[\"MISSING_INTL_API\"] = \"MISSING_INTL_API\";\n})(ErrorCode || (ErrorCode = {}));\nvar FormatError = /** @class */ (function (_super) {\n    __extends(FormatError, _super);\n    function FormatError(msg, code, originalMessage) {\n        var _this = _super.call(this, msg) || this;\n        _this.code = code;\n        _this.originalMessage = originalMessage;\n        return _this;\n    }\n    FormatError.prototype.toString = function () {\n        return \"[formatjs Error: \".concat(this.code, \"] \").concat(this.message);\n    };\n    return FormatError;\n}(Error));\nexport { FormatError };\nvar InvalidValueError = /** @class */ (function (_super) {\n    __extends(InvalidValueError, _super);\n    function InvalidValueError(variableId, value, options, originalMessage) {\n        return _super.call(this, \"Invalid values for \\\"\".concat(variableId, \"\\\": \\\"\").concat(value, \"\\\". Options are \\\"\").concat(Object.keys(options).join('\", \"'), \"\\\"\"), ErrorCode.INVALID_VALUE, originalMessage) || this;\n    }\n    return InvalidValueError;\n}(FormatError));\nexport { InvalidValueError };\nvar InvalidValueTypeError = /** @class */ (function (_super) {\n    __extends(InvalidValueTypeError, _super);\n    function InvalidValueTypeError(value, type, originalMessage) {\n        return _super.call(this, \"Value for \\\"\".concat(value, \"\\\" must be of type \").concat(type), ErrorCode.INVALID_VALUE, originalMessage) || this;\n    }\n    return InvalidValueTypeError;\n}(FormatError));\nexport { InvalidValueTypeError };\nvar MissingValueError = /** @class */ (function (_super) {\n    __extends(MissingValueError, _super);\n    function MissingValueError(variableId, originalMessage) {\n        return _super.call(this, \"The intl string context variable \\\"\".concat(variableId, \"\\\" was not provided to the string \\\"\").concat(originalMessage, \"\\\"\"), ErrorCode.MISSING_VALUE, originalMessage) || this;\n    }\n    return MissingValueError;\n}(FormatError));\nexport { MissingValueError };\n","import { isArgumentElement, isDateElement, isDateTimeSkeleton, isLiteralElement, isNumberElement, isNumberSkeleton, isPluralElement, isPoundElement, isSelectElement, isTimeElement, isTagElement, } from '@formatjs/icu-messageformat-parser';\nimport { MissingValueError, InvalidValueError, ErrorCode, FormatError, InvalidValueTypeError, } from './error';\nexport var PART_TYPE;\n(function (PART_TYPE) {\n    PART_TYPE[PART_TYPE[\"literal\"] = 0] = \"literal\";\n    PART_TYPE[PART_TYPE[\"object\"] = 1] = \"object\";\n})(PART_TYPE || (PART_TYPE = {}));\nfunction mergeLiteral(parts) {\n    if (parts.length < 2) {\n        return parts;\n    }\n    return parts.reduce(function (all, part) {\n        var lastPart = all[all.length - 1];\n        if (!lastPart ||\n            lastPart.type !== PART_TYPE.literal ||\n            part.type !== PART_TYPE.literal) {\n            all.push(part);\n        }\n        else {\n            lastPart.value += part.value;\n        }\n        return all;\n    }, []);\n}\nexport function isFormatXMLElementFn(el) {\n    return typeof el === 'function';\n}\n// TODO(skeleton): add skeleton support\nexport function formatToParts(els, locales, formatters, formats, values, currentPluralValue, \n// For debugging\noriginalMessage) {\n    // Hot path for straight simple msg translations\n    if (els.length === 1 && isLiteralElement(els[0])) {\n        return [\n            {\n                type: PART_TYPE.literal,\n                value: els[0].value,\n            },\n        ];\n    }\n    var result = [];\n    for (var _i = 0, els_1 = els; _i < els_1.length; _i++) {\n        var el = els_1[_i];\n        // Exit early for string parts.\n        if (isLiteralElement(el)) {\n            result.push({\n                type: PART_TYPE.literal,\n                value: el.value,\n            });\n            continue;\n        }\n        // TODO: should this part be literal type?\n        // Replace `#` in plural rules with the actual numeric value.\n        if (isPoundElement(el)) {\n            if (typeof currentPluralValue === 'number') {\n                result.push({\n                    type: PART_TYPE.literal,\n                    value: formatters.getNumberFormat(locales).format(currentPluralValue),\n                });\n            }\n            continue;\n        }\n        var varName = el.value;\n        // Enforce that all required values are provided by the caller.\n        if (!(values && varName in values)) {\n            throw new MissingValueError(varName, originalMessage);\n        }\n        var value = values[varName];\n        if (isArgumentElement(el)) {\n            if (!value || typeof value === 'string' || typeof value === 'number') {\n                value =\n                    typeof value === 'string' || typeof value === 'number'\n                        ? String(value)\n                        : '';\n            }\n            result.push({\n                type: typeof value === 'string' ? PART_TYPE.literal : PART_TYPE.object,\n                value: value,\n            });\n            continue;\n        }\n        // Recursively format plural and select parts' option — which can be a\n        // nested pattern structure. The choosing of the option to use is\n        // abstracted-by and delegated-to the part helper object.\n        if (isDateElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.date[el.style]\n                : isDateTimeSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : undefined;\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getDateTimeFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isTimeElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.time[el.style]\n                : isDateTimeSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : formats.time.medium;\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getDateTimeFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isNumberElement(el)) {\n            var style = typeof el.style === 'string'\n                ? formats.number[el.style]\n                : isNumberSkeleton(el.style)\n                    ? el.style.parsedOptions\n                    : undefined;\n            if (style && style.scale) {\n                value =\n                    value *\n                        (style.scale || 1);\n            }\n            result.push({\n                type: PART_TYPE.literal,\n                value: formatters\n                    .getNumberFormat(locales, style)\n                    .format(value),\n            });\n            continue;\n        }\n        if (isTagElement(el)) {\n            var children = el.children, value_1 = el.value;\n            var formatFn = values[value_1];\n            if (!isFormatXMLElementFn(formatFn)) {\n                throw new InvalidValueTypeError(value_1, 'function', originalMessage);\n            }\n            var parts = formatToParts(children, locales, formatters, formats, values, currentPluralValue);\n            var chunks = formatFn(parts.map(function (p) { return p.value; }));\n            if (!Array.isArray(chunks)) {\n                chunks = [chunks];\n            }\n            result.push.apply(result, chunks.map(function (c) {\n                return {\n                    type: typeof c === 'string' ? PART_TYPE.literal : PART_TYPE.object,\n                    value: c,\n                };\n            }));\n        }\n        if (isSelectElement(el)) {\n            var opt = el.options[value] || el.options.other;\n            if (!opt) {\n                throw new InvalidValueError(el.value, value, Object.keys(el.options), originalMessage);\n            }\n            result.push.apply(result, formatToParts(opt.value, locales, formatters, formats, values));\n            continue;\n        }\n        if (isPluralElement(el)) {\n            var opt = el.options[\"=\".concat(value)];\n            if (!opt) {\n                if (!Intl.PluralRules) {\n                    throw new FormatError(\"Intl.PluralRules is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-pluralrules\\\"\\n\", ErrorCode.MISSING_INTL_API, originalMessage);\n                }\n                var rule = formatters\n                    .getPluralRules(locales, { type: el.pluralType })\n                    .select(value - (el.offset || 0));\n                opt = el.options[rule] || el.options.other;\n            }\n            if (!opt) {\n                throw new InvalidValueError(el.value, value, Object.keys(el.options), originalMessage);\n            }\n            result.push.apply(result, formatToParts(opt.value, locales, formatters, formats, values, value - (el.offset || 0)));\n            continue;\n        }\n    }\n    return mergeLiteral(result);\n}\n","/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\nimport { __assign, __spreadArray } from \"tslib\";\nimport { parse } from '@formatjs/icu-messageformat-parser';\nimport memoize, { strategies } from '@formatjs/fast-memoize';\nimport { formatToParts, PART_TYPE, } from './formatters';\n// -- MessageFormat --------------------------------------------------------\nfunction mergeConfig(c1, c2) {\n    if (!c2) {\n        return c1;\n    }\n    return __assign(__assign(__assign({}, (c1 || {})), (c2 || {})), Object.keys(c1).reduce(function (all, k) {\n        all[k] = __assign(__assign({}, c1[k]), (c2[k] || {}));\n        return all;\n    }, {}));\n}\nfunction mergeConfigs(defaultConfig, configs) {\n    if (!configs) {\n        return defaultConfig;\n    }\n    return Object.keys(defaultConfig).reduce(function (all, k) {\n        all[k] = mergeConfig(defaultConfig[k], configs[k]);\n        return all;\n    }, __assign({}, defaultConfig));\n}\nfunction createFastMemoizeCache(store) {\n    return {\n        create: function () {\n            return {\n                get: function (key) {\n                    return store[key];\n                },\n                set: function (key, value) {\n                    store[key] = value;\n                },\n            };\n        },\n    };\n}\nfunction createDefaultFormatters(cache) {\n    if (cache === void 0) { cache = {\n        number: {},\n        dateTime: {},\n        pluralRules: {},\n    }; }\n    return {\n        getNumberFormat: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.NumberFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.number),\n            strategy: strategies.variadic,\n        }),\n        getDateTimeFormat: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.DateTimeFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.dateTime),\n            strategy: strategies.variadic,\n        }),\n        getPluralRules: memoize(function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new ((_a = Intl.PluralRules).bind.apply(_a, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.pluralRules),\n            strategy: strategies.variadic,\n        }),\n    };\n}\nvar IntlMessageFormat = /** @class */ (function () {\n    function IntlMessageFormat(message, locales, overrideFormats, opts) {\n        if (locales === void 0) { locales = IntlMessageFormat.defaultLocale; }\n        var _this = this;\n        this.formatterCache = {\n            number: {},\n            dateTime: {},\n            pluralRules: {},\n        };\n        this.format = function (values) {\n            var parts = _this.formatToParts(values);\n            // Hot path for straight simple msg translations\n            if (parts.length === 1) {\n                return parts[0].value;\n            }\n            var result = parts.reduce(function (all, part) {\n                if (!all.length ||\n                    part.type !== PART_TYPE.literal ||\n                    typeof all[all.length - 1] !== 'string') {\n                    all.push(part.value);\n                }\n                else {\n                    all[all.length - 1] += part.value;\n                }\n                return all;\n            }, []);\n            if (result.length <= 1) {\n                return result[0] || '';\n            }\n            return result;\n        };\n        this.formatToParts = function (values) {\n            return formatToParts(_this.ast, _this.locales, _this.formatters, _this.formats, values, undefined, _this.message);\n        };\n        this.resolvedOptions = function () {\n            var _a;\n            return ({\n                locale: ((_a = _this.resolvedLocale) === null || _a === void 0 ? void 0 : _a.toString()) ||\n                    Intl.NumberFormat.supportedLocalesOf(_this.locales)[0],\n            });\n        };\n        this.getAst = function () { return _this.ast; };\n        // Defined first because it's used to build the format pattern.\n        this.locales = locales;\n        this.resolvedLocale = IntlMessageFormat.resolveLocale(locales);\n        if (typeof message === 'string') {\n            this.message = message;\n            if (!IntlMessageFormat.__parse) {\n                throw new TypeError('IntlMessageFormat.__parse must be set to process `message` of type `string`');\n            }\n            // Parse string messages into an AST.\n            this.ast = IntlMessageFormat.__parse(message, {\n                ignoreTag: opts === null || opts === void 0 ? void 0 : opts.ignoreTag,\n                locale: this.resolvedLocale,\n            });\n        }\n        else {\n            this.ast = message;\n        }\n        if (!Array.isArray(this.ast)) {\n            throw new TypeError('A message must be provided as a String or AST.');\n        }\n        // Creates a new object with the specified `formats` merged with the default\n        // formats.\n        this.formats = mergeConfigs(IntlMessageFormat.formats, overrideFormats);\n        this.formatters =\n            (opts && opts.formatters) || createDefaultFormatters(this.formatterCache);\n    }\n    Object.defineProperty(IntlMessageFormat, \"defaultLocale\", {\n        get: function () {\n            if (!IntlMessageFormat.memoizedDefaultLocale) {\n                IntlMessageFormat.memoizedDefaultLocale =\n                    new Intl.NumberFormat().resolvedOptions().locale;\n            }\n            return IntlMessageFormat.memoizedDefaultLocale;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    IntlMessageFormat.memoizedDefaultLocale = null;\n    IntlMessageFormat.resolveLocale = function (locales) {\n        if (typeof Intl.Locale === 'undefined') {\n            return;\n        }\n        var supportedLocales = Intl.NumberFormat.supportedLocalesOf(locales);\n        if (supportedLocales.length > 0) {\n            return new Intl.Locale(supportedLocales[0]);\n        }\n        return new Intl.Locale(typeof locales === 'string' ? locales : locales[0]);\n    };\n    IntlMessageFormat.__parse = parse;\n    // Default format options used as the prototype of the `formats` provided to the\n    // constructor. These are used when constructing the internal Intl.NumberFormat\n    // and Intl.DateTimeFormat instances.\n    IntlMessageFormat.formats = {\n        number: {\n            integer: {\n                maximumFractionDigits: 0,\n            },\n            currency: {\n                style: 'currency',\n            },\n            percent: {\n                style: 'percent',\n            },\n        },\n        date: {\n            short: {\n                month: 'numeric',\n                day: 'numeric',\n                year: '2-digit',\n            },\n            medium: {\n                month: 'short',\n                day: 'numeric',\n                year: 'numeric',\n            },\n            long: {\n                month: 'long',\n                day: 'numeric',\n                year: 'numeric',\n            },\n            full: {\n                weekday: 'long',\n                month: 'long',\n                day: 'numeric',\n                year: 'numeric',\n            },\n        },\n        time: {\n            short: {\n                hour: 'numeric',\n                minute: 'numeric',\n            },\n            medium: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n            },\n            long: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n                timeZoneName: 'short',\n            },\n            full: {\n                hour: 'numeric',\n                minute: 'numeric',\n                second: 'numeric',\n                timeZoneName: 'short',\n            },\n        },\n    };\n    return IntlMessageFormat;\n}());\nexport { IntlMessageFormat };\n","import { __extends } from \"tslib\";\nexport var IntlErrorCode;\n(function (IntlErrorCode) {\n    IntlErrorCode[\"FORMAT_ERROR\"] = \"FORMAT_ERROR\";\n    IntlErrorCode[\"UNSUPPORTED_FORMATTER\"] = \"UNSUPPORTED_FORMATTER\";\n    IntlErrorCode[\"INVALID_CONFIG\"] = \"INVALID_CONFIG\";\n    IntlErrorCode[\"MISSING_DATA\"] = \"MISSING_DATA\";\n    IntlErrorCode[\"MISSING_TRANSLATION\"] = \"MISSING_TRANSLATION\";\n})(IntlErrorCode || (IntlErrorCode = {}));\nvar IntlError = /** @class */ (function (_super) {\n    __extends(IntlError, _super);\n    function IntlError(code, message, exception) {\n        var _this = this;\n        var err = exception\n            ? exception instanceof Error\n                ? exception\n                : new Error(String(exception))\n            : undefined;\n        _this = _super.call(this, \"[@formatjs/intl Error \".concat(code, \"] \").concat(message, \"\\n\").concat(err ? \"\\n\".concat(err.message, \"\\n\").concat(err.stack) : '')) || this;\n        _this.code = code;\n        // @ts-ignore just so we don't need to declare dep on @types/node\n        if (typeof Error.captureStackTrace === 'function') {\n            // @ts-ignore just so we don't need to declare dep on @types/node\n            Error.captureStackTrace(_this, IntlError);\n        }\n        return _this;\n    }\n    return IntlError;\n}(Error));\nexport { IntlError };\nvar UnsupportedFormatterError = /** @class */ (function (_super) {\n    __extends(UnsupportedFormatterError, _super);\n    function UnsupportedFormatterError(message, exception) {\n        return _super.call(this, IntlErrorCode.UNSUPPORTED_FORMATTER, message, exception) || this;\n    }\n    return UnsupportedFormatterError;\n}(IntlError));\nexport { UnsupportedFormatterError };\nvar InvalidConfigError = /** @class */ (function (_super) {\n    __extends(InvalidConfigError, _super);\n    function InvalidConfigError(message, exception) {\n        return _super.call(this, IntlErrorCode.INVALID_CONFIG, message, exception) || this;\n    }\n    return InvalidConfigError;\n}(IntlError));\nexport { InvalidConfigError };\nvar MissingDataError = /** @class */ (function (_super) {\n    __extends(MissingDataError, _super);\n    function MissingDataError(message, exception) {\n        return _super.call(this, IntlErrorCode.MISSING_DATA, message, exception) || this;\n    }\n    return MissingDataError;\n}(IntlError));\nexport { MissingDataError };\nvar IntlFormatError = /** @class */ (function (_super) {\n    __extends(IntlFormatError, _super);\n    function IntlFormatError(message, locale, exception) {\n        return _super.call(this, IntlErrorCode.FORMAT_ERROR, \"\".concat(message, \"\\nLocale: \").concat(locale, \"\\n\"), exception) || this;\n    }\n    return IntlFormatError;\n}(IntlError));\nexport { IntlFormatError };\nvar MessageFormatError = /** @class */ (function (_super) {\n    __extends(MessageFormatError, _super);\n    function MessageFormatError(message, locale, descriptor, exception) {\n        var _this = _super.call(this, \"\".concat(message, \"\\nMessageID: \").concat(descriptor === null || descriptor === void 0 ? void 0 : descriptor.id, \"\\nDefault Message: \").concat(descriptor === null || descriptor === void 0 ? void 0 : descriptor.defaultMessage, \"\\nDescription: \").concat(descriptor === null || descriptor === void 0 ? void 0 : descriptor.description, \"\\n\"), locale, exception) || this;\n        _this.descriptor = descriptor;\n        return _this;\n    }\n    return MessageFormatError;\n}(IntlFormatError));\nexport { MessageFormatError };\nvar MissingTranslationError = /** @class */ (function (_super) {\n    __extends(MissingTranslationError, _super);\n    function MissingTranslationError(descriptor, locale) {\n        var _this = _super.call(this, IntlErrorCode.MISSING_TRANSLATION, \"Missing message: \\\"\".concat(descriptor.id, \"\\\" for locale \\\"\").concat(locale, \"\\\", using \").concat(descriptor.defaultMessage\n            ? \"default message (\".concat(typeof descriptor.defaultMessage === 'string'\n                ? descriptor.defaultMessage\n                : descriptor.defaultMessage\n                    .map(function (e) { var _a; return (_a = e.value) !== null && _a !== void 0 ? _a : JSON.stringify(e); })\n                    .join(), \")\")\n            : 'id', \" as fallback.\")) || this;\n        _this.descriptor = descriptor;\n        return _this;\n    }\n    return MissingTranslationError;\n}(IntlError));\nexport { MissingTranslationError };\n","import { __assign, __spreadArray } from \"tslib\";\nimport { IntlMessageFormat } from 'intl-messageformat';\nimport memoize, { strategies } from '@formatjs/fast-memoize';\nimport { UnsupportedFormatterError } from './error';\nexport function filterProps(props, allowlist, defaults) {\n    if (defaults === void 0) { defaults = {}; }\n    return allowlist.reduce(function (filtered, name) {\n        if (name in props) {\n            filtered[name] = props[name];\n        }\n        else if (name in defaults) {\n            filtered[name] = defaults[name];\n        }\n        return filtered;\n    }, {});\n}\nvar defaultErrorHandler = function (error) {\n    // @ts-ignore just so we don't need to declare dep on @types/node\n    if (process.env.NODE_ENV !== 'production') {\n        console.error(error);\n    }\n};\nvar defaultWarnHandler = function (warning) {\n    // @ts-ignore just so we don't need to declare dep on @types/node\n    if (process.env.NODE_ENV !== 'production') {\n        console.warn(warning);\n    }\n};\nexport var DEFAULT_INTL_CONFIG = {\n    formats: {},\n    messages: {},\n    timeZone: undefined,\n    defaultLocale: 'en',\n    defaultFormats: {},\n    fallbackOnEmptyString: true,\n    onError: defaultErrorHandler,\n    onWarn: defaultWarnHandler,\n};\nexport function createIntlCache() {\n    return {\n        dateTime: {},\n        number: {},\n        message: {},\n        relativeTime: {},\n        pluralRules: {},\n        list: {},\n        displayNames: {},\n    };\n}\nfunction createFastMemoizeCache(store) {\n    return {\n        create: function () {\n            return {\n                get: function (key) {\n                    return store[key];\n                },\n                set: function (key, value) {\n                    store[key] = value;\n                },\n            };\n        },\n    };\n}\n/**\n * Create intl formatters and populate cache\n * @param cache explicit cache to prevent leaking memory\n */\nexport function createFormatters(cache) {\n    if (cache === void 0) { cache = createIntlCache(); }\n    var RelativeTimeFormat = Intl.RelativeTimeFormat;\n    var ListFormat = Intl.ListFormat;\n    var DisplayNames = Intl.DisplayNames;\n    var getDateTimeFormat = memoize(function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return new ((_a = Intl.DateTimeFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n    }, {\n        cache: createFastMemoizeCache(cache.dateTime),\n        strategy: strategies.variadic,\n    });\n    var getNumberFormat = memoize(function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return new ((_a = Intl.NumberFormat).bind.apply(_a, __spreadArray([void 0], args, false)))();\n    }, {\n        cache: createFastMemoizeCache(cache.number),\n        strategy: strategies.variadic,\n    });\n    var getPluralRules = memoize(function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return new ((_a = Intl.PluralRules).bind.apply(_a, __spreadArray([void 0], args, false)))();\n    }, {\n        cache: createFastMemoizeCache(cache.pluralRules),\n        strategy: strategies.variadic,\n    });\n    return {\n        getDateTimeFormat: getDateTimeFormat,\n        getNumberFormat: getNumberFormat,\n        getMessageFormat: memoize(function (message, locales, overrideFormats, opts) {\n            return new IntlMessageFormat(message, locales, overrideFormats, __assign({ formatters: {\n                    getNumberFormat: getNumberFormat,\n                    getDateTimeFormat: getDateTimeFormat,\n                    getPluralRules: getPluralRules,\n                } }, (opts || {})));\n        }, {\n            cache: createFastMemoizeCache(cache.message),\n            strategy: strategies.variadic,\n        }),\n        getRelativeTimeFormat: memoize(function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new (RelativeTimeFormat.bind.apply(RelativeTimeFormat, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.relativeTime),\n            strategy: strategies.variadic,\n        }),\n        getPluralRules: getPluralRules,\n        getListFormat: memoize(function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new (ListFormat.bind.apply(ListFormat, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.list),\n            strategy: strategies.variadic,\n        }),\n        getDisplayNames: memoize(function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return new (DisplayNames.bind.apply(DisplayNames, __spreadArray([void 0], args, false)))();\n        }, {\n            cache: createFastMemoizeCache(cache.displayNames),\n            strategy: strategies.variadic,\n        }),\n    };\n}\nexport function getNamedFormat(formats, type, name, onError) {\n    var formatType = formats && formats[type];\n    var format;\n    if (formatType) {\n        format = formatType[name];\n    }\n    if (format) {\n        return format;\n    }\n    onError(new UnsupportedFormatterError(\"No \".concat(type, \" format named: \").concat(name)));\n}\n","import { __assign } from \"tslib\";\nimport * as React from 'react';\nimport { invariant } from '@formatjs/ecma402-abstract';\nimport { DEFAULT_INTL_CONFIG as CORE_DEFAULT_INTL_CONFIG } from '@formatjs/intl';\nexport function invariantIntlContext(intl) {\n    invariant(intl, '[React Intl] Could not find required `intl` object. ' +\n        '<IntlProvider> needs to exist in the component ancestry.');\n}\nexport var DEFAULT_INTL_CONFIG = __assign(__assign({}, CORE_DEFAULT_INTL_CONFIG), { textComponent: React.Fragment });\n/**\n * Takes a `formatXMLElementFn`, and composes it in function, which passes\n * argument `parts` through, assigning unique key to each part, to prevent\n * \"Each child in a list should have a unique \"key\"\" React error.\n * @param formatXMLElementFn\n */\nexport function assignUniqueKeysToParts(formatXMLElementFn) {\n    return function (parts) {\n        // eslint-disable-next-line prefer-rest-params\n        return formatXMLElementFn(React.Children.toArray(parts));\n    };\n}\nexport function shallowEqual(objA, objB) {\n    if (objA === objB) {\n        return true;\n    }\n    if (!objA || !objB) {\n        return false;\n    }\n    var aKeys = Object.keys(objA);\n    var bKeys = Object.keys(objB);\n    var len = aKeys.length;\n    if (bKeys.length !== len) {\n        return false;\n    }\n    for (var i = 0; i < len; i++) {\n        var key = aKeys[i];\n        if (objA[key] !== objB[key] ||\n            !Object.prototype.hasOwnProperty.call(objB, key)) {\n            return false;\n        }\n    }\n    return true;\n}\n","import { __assign } from \"tslib\";\nimport { invariant } from '@formatjs/ecma402-abstract';\nimport { IntlMessageFormat, } from 'intl-messageformat';\nimport { MissingTranslationError, MessageFormatError } from './error';\nimport { TYPE } from '@formatjs/icu-messageformat-parser';\nfunction setTimeZoneInOptions(opts, timeZone) {\n    return Object.keys(opts).reduce(function (all, k) {\n        all[k] = __assign({ timeZone: timeZone }, opts[k]);\n        return all;\n    }, {});\n}\nfunction deepMergeOptions(opts1, opts2) {\n    var keys = Object.keys(__assign(__assign({}, opts1), opts2));\n    return keys.reduce(function (all, k) {\n        all[k] = __assign(__assign({}, (opts1[k] || {})), (opts2[k] || {}));\n        return all;\n    }, {});\n}\nfunction deepMergeFormatsAndSetTimeZone(f1, timeZone) {\n    if (!timeZone) {\n        return f1;\n    }\n    var mfFormats = IntlMessageFormat.formats;\n    return __assign(__assign(__assign({}, mfFormats), f1), { date: deepMergeOptions(setTimeZoneInOptions(mfFormats.date, timeZone), setTimeZoneInOptions(f1.date || {}, timeZone)), time: deepMergeOptions(setTimeZoneInOptions(mfFormats.time, timeZone), setTimeZoneInOptions(f1.time || {}, timeZone)) });\n}\nexport var formatMessage = function (_a, state, messageDescriptor, values, opts) {\n    var locale = _a.locale, formats = _a.formats, messages = _a.messages, defaultLocale = _a.defaultLocale, defaultFormats = _a.defaultFormats, fallbackOnEmptyString = _a.fallbackOnEmptyString, onError = _a.onError, timeZone = _a.timeZone, defaultRichTextElements = _a.defaultRichTextElements;\n    if (messageDescriptor === void 0) { messageDescriptor = { id: '' }; }\n    var msgId = messageDescriptor.id, defaultMessage = messageDescriptor.defaultMessage;\n    // `id` is a required field of a Message Descriptor.\n    invariant(!!msgId, \"[@formatjs/intl] An `id` must be provided to format a message. You can either:\\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\\nto autofix this issue\");\n    var id = String(msgId);\n    var message = \n    // In case messages is Object.create(null)\n    // e.g import('foo.json') from webpack)\n    // See https://github.com/formatjs/formatjs/issues/1914\n    messages &&\n        Object.prototype.hasOwnProperty.call(messages, id) &&\n        messages[id];\n    // IMPORTANT: Hot path if `message` is AST with a single literal node\n    if (Array.isArray(message) &&\n        message.length === 1 &&\n        message[0].type === TYPE.literal) {\n        return message[0].value;\n    }\n    // IMPORTANT: Hot path straight lookup for performance\n    if (!values &&\n        message &&\n        typeof message === 'string' &&\n        !defaultRichTextElements) {\n        return message.replace(/'\\{(.*?)\\}'/gi, \"{$1}\");\n    }\n    values = __assign(__assign({}, defaultRichTextElements), (values || {}));\n    formats = deepMergeFormatsAndSetTimeZone(formats, timeZone);\n    defaultFormats = deepMergeFormatsAndSetTimeZone(defaultFormats, timeZone);\n    if (!message) {\n        if (fallbackOnEmptyString === false && message === '') {\n            return message;\n        }\n        if (!defaultMessage ||\n            (locale && locale.toLowerCase() !== defaultLocale.toLowerCase())) {\n            // This prevents warnings from littering the console in development\n            // when no `messages` are passed into the <IntlProvider> for the\n            // default locale.\n            onError(new MissingTranslationError(messageDescriptor, locale));\n        }\n        if (defaultMessage) {\n            try {\n                var formatter = state.getMessageFormat(defaultMessage, defaultLocale, defaultFormats, opts);\n                return formatter.format(values);\n            }\n            catch (e) {\n                onError(new MessageFormatError(\"Error formatting default message for: \\\"\".concat(id, \"\\\", rendering default message verbatim\"), locale, messageDescriptor, e));\n                return typeof defaultMessage === 'string' ? defaultMessage : id;\n            }\n        }\n        return id;\n    }\n    // We have the translated message\n    try {\n        var formatter = state.getMessageFormat(message, locale, formats, __assign({ formatters: state }, (opts || {})));\n        return formatter.format(values);\n    }\n    catch (e) {\n        onError(new MessageFormatError(\"Error formatting message: \\\"\".concat(id, \"\\\", using \").concat(defaultMessage ? 'default message' : 'id', \" as fallback.\"), locale, messageDescriptor, e));\n    }\n    if (defaultMessage) {\n        try {\n            var formatter = state.getMessageFormat(defaultMessage, defaultLocale, defaultFormats, opts);\n            return formatter.format(values);\n        }\n        catch (e) {\n            onError(new MessageFormatError(\"Error formatting the default message for: \\\"\".concat(id, \"\\\", rendering message verbatim\"), locale, messageDescriptor, e));\n        }\n    }\n    if (typeof message === 'string') {\n        return message;\n    }\n    if (typeof defaultMessage === 'string') {\n        return defaultMessage;\n    }\n    return id;\n};\n","import { getNamedFormat, filterProps } from './utils';\nimport { IntlError, IntlErrorCode } from './error';\nvar NUMBER_FORMAT_OPTIONS = [\n    'style',\n    'currency',\n    'currencyDisplay',\n    'unit',\n    'unitDisplay',\n    'useGrouping',\n    'minimumIntegerDigits',\n    'minimumFractionDigits',\n    'maximumFractionDigits',\n    'minimumSignificantDigits',\n    'maximumSignificantDigits',\n    // ES2020 NumberFormat\n    'compactDisplay',\n    'currencyDisplay',\n    'currencySign',\n    'notation',\n    'signDisplay',\n    'unit',\n    'unitDisplay',\n    'numberingSystem',\n];\nexport function getFormatter(_a, getNumberFormat, options) {\n    var locale = _a.locale, formats = _a.formats, onError = _a.onError;\n    if (options === void 0) { options = {}; }\n    var format = options.format;\n    var defaults = ((format &&\n        getNamedFormat(formats, 'number', format, onError)) ||\n        {});\n    var filteredOptions = filterProps(options, NUMBER_FORMAT_OPTIONS, defaults);\n    return getNumberFormat(locale, filteredOptions);\n}\nexport function formatNumber(config, getNumberFormat, value, options) {\n    if (options === void 0) { options = {}; }\n    try {\n        return getFormatter(config, getNumberFormat, options).format(value);\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting number.', e));\n    }\n    return String(value);\n}\nexport function formatNumberToParts(config, getNumberFormat, value, options) {\n    if (options === void 0) { options = {}; }\n    try {\n        return getFormatter(config, getNumberFormat, options).formatToParts(value);\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting number.', e));\n    }\n    return [];\n}\n","import { getNamedFormat, filterProps } from './utils';\nimport { FormatError, ErrorCode } from 'intl-messageformat';\nimport { IntlFormatError } from './error';\nvar RELATIVE_TIME_FORMAT_OPTIONS = ['numeric', 'style'];\nfunction getFormatter(_a, getRelativeTimeFormat, options) {\n    var locale = _a.locale, formats = _a.formats, onError = _a.onError;\n    if (options === void 0) { options = {}; }\n    var format = options.format;\n    var defaults = (!!format && getNamedFormat(formats, 'relative', format, onError)) || {};\n    var filteredOptions = filterProps(options, RELATIVE_TIME_FORMAT_OPTIONS, defaults);\n    return getRelativeTimeFormat(locale, filteredOptions);\n}\nexport function formatRelativeTime(config, getRelativeTimeFormat, value, unit, options) {\n    if (options === void 0) { options = {}; }\n    if (!unit) {\n        unit = 'second';\n    }\n    var RelativeTimeFormat = Intl.RelativeTimeFormat;\n    if (!RelativeTimeFormat) {\n        config.onError(new FormatError(\"Intl.RelativeTimeFormat is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-relativetimeformat\\\"\\n\", ErrorCode.MISSING_INTL_API));\n    }\n    try {\n        return getFormatter(config, getRelativeTimeFormat, options).format(value, unit);\n    }\n    catch (e) {\n        config.onError(new IntlFormatError('Error formatting relative time.', config.locale, e));\n    }\n    return String(value);\n}\n","import { __assign } from \"tslib\";\nimport { filterProps, getNamedFormat } from './utils';\nimport { IntlError, IntlErrorCode } from './error';\nvar DATE_TIME_FORMAT_OPTIONS = [\n    'formatMatcher',\n    'timeZone',\n    'hour12',\n    'weekday',\n    'era',\n    'year',\n    'month',\n    'day',\n    'hour',\n    'minute',\n    'second',\n    'timeZoneName',\n    'hourCycle',\n    'dateStyle',\n    'timeStyle',\n    'calendar',\n    // 'dayPeriod',\n    'numberingSystem',\n    'fractionalSecondDigits',\n];\nexport function getFormatter(_a, type, getDateTimeFormat, options) {\n    var locale = _a.locale, formats = _a.formats, onError = _a.onError, timeZone = _a.timeZone;\n    if (options === void 0) { options = {}; }\n    var format = options.format;\n    var defaults = __assign(__assign({}, (timeZone && { timeZone: timeZone })), (format && getNamedFormat(formats, type, format, onError)));\n    var filteredOptions = filterProps(options, DATE_TIME_FORMAT_OPTIONS, defaults);\n    if (type === 'time' &&\n        !filteredOptions.hour &&\n        !filteredOptions.minute &&\n        !filteredOptions.second &&\n        !filteredOptions.timeStyle &&\n        !filteredOptions.dateStyle) {\n        // Add default formatting options if hour, minute, or second isn't defined.\n        filteredOptions = __assign(__assign({}, filteredOptions), { hour: 'numeric', minute: 'numeric' });\n    }\n    return getDateTimeFormat(locale, filteredOptions);\n}\nexport function formatDate(config, getDateTimeFormat) {\n    var _a = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        _a[_i - 2] = arguments[_i];\n    }\n    var value = _a[0], _b = _a[1], options = _b === void 0 ? {} : _b;\n    var date = typeof value === 'string' ? new Date(value || 0) : value;\n    try {\n        return getFormatter(config, 'date', getDateTimeFormat, options).format(date);\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting date.', e));\n    }\n    return String(date);\n}\nexport function formatTime(config, getDateTimeFormat) {\n    var _a = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        _a[_i - 2] = arguments[_i];\n    }\n    var value = _a[0], _b = _a[1], options = _b === void 0 ? {} : _b;\n    var date = typeof value === 'string' ? new Date(value || 0) : value;\n    try {\n        return getFormatter(config, 'time', getDateTimeFormat, options).format(date);\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting time.', e));\n    }\n    return String(date);\n}\nexport function formatDateTimeRange(config, getDateTimeFormat) {\n    var _a = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        _a[_i - 2] = arguments[_i];\n    }\n    var from = _a[0], to = _a[1], _b = _a[2], options = _b === void 0 ? {} : _b;\n    var timeZone = config.timeZone, locale = config.locale, onError = config.onError;\n    var filteredOptions = filterProps(options, DATE_TIME_FORMAT_OPTIONS, timeZone ? { timeZone: timeZone } : {});\n    try {\n        return getDateTimeFormat(locale, filteredOptions).formatRange(from, to);\n    }\n    catch (e) {\n        onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting date time range.', e));\n    }\n    return String(from);\n}\nexport function formatDateToParts(config, getDateTimeFormat) {\n    var _a = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        _a[_i - 2] = arguments[_i];\n    }\n    var value = _a[0], _b = _a[1], options = _b === void 0 ? {} : _b;\n    var date = typeof value === 'string' ? new Date(value || 0) : value;\n    try {\n        return getFormatter(config, 'date', getDateTimeFormat, options).formatToParts(date); // TODO: remove this when https://github.com/microsoft/TypeScript/pull/50402 is merged\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting date.', e));\n    }\n    return [];\n}\nexport function formatTimeToParts(config, getDateTimeFormat) {\n    var _a = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        _a[_i - 2] = arguments[_i];\n    }\n    var value = _a[0], _b = _a[1], options = _b === void 0 ? {} : _b;\n    var date = typeof value === 'string' ? new Date(value || 0) : value;\n    try {\n        return getFormatter(config, 'time', getDateTimeFormat, options).formatToParts(date); // TODO: remove this when https://github.com/microsoft/TypeScript/pull/50402 is merged\n    }\n    catch (e) {\n        config.onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting time.', e));\n    }\n    return [];\n}\n","import { filterProps } from './utils';\nimport { IntlFormatError } from './error';\nimport { ErrorCode, FormatError } from 'intl-messageformat';\nvar PLURAL_FORMAT_OPTIONS = ['type'];\nexport function formatPlural(_a, getPluralRules, value, options) {\n    var locale = _a.locale, onError = _a.onError;\n    if (options === void 0) { options = {}; }\n    if (!Intl.PluralRules) {\n        onError(new FormatError(\"Intl.PluralRules is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-pluralrules\\\"\\n\", ErrorCode.MISSING_INTL_API));\n    }\n    var filteredOptions = filterProps(options, PLURAL_FORMAT_OPTIONS);\n    try {\n        return getPluralRules(locale, filteredOptions).select(value);\n    }\n    catch (e) {\n        onError(new IntlFormatError('Error formatting plural.', locale, e));\n    }\n    return 'other';\n}\n","import { __assign } from \"tslib\";\nimport { filterProps } from './utils';\nimport { FormatError, ErrorCode } from 'intl-messageformat';\nimport { IntlError, IntlErrorCode } from './error';\nvar LIST_FORMAT_OPTIONS = [\n    'type',\n    'style',\n];\nvar now = Date.now();\nfunction generateToken(i) {\n    return \"\".concat(now, \"_\").concat(i, \"_\").concat(now);\n}\nexport function formatList(opts, getListFormat, values, options) {\n    if (options === void 0) { options = {}; }\n    var results = formatListToParts(opts, getListFormat, values, options).reduce(function (all, el) {\n        var val = el.value;\n        if (typeof val !== 'string') {\n            all.push(val);\n        }\n        else if (typeof all[all.length - 1] === 'string') {\n            all[all.length - 1] += val;\n        }\n        else {\n            all.push(val);\n        }\n        return all;\n    }, []);\n    return results.length === 1 ? results[0] : results.length === 0 ? '' : results;\n}\nexport function formatListToParts(_a, getListFormat, values, options) {\n    var locale = _a.locale, onError = _a.onError;\n    if (options === void 0) { options = {}; }\n    var ListFormat = Intl.ListFormat;\n    if (!ListFormat) {\n        onError(new FormatError(\"Intl.ListFormat is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-listformat\\\"\\n\", ErrorCode.MISSING_INTL_API));\n    }\n    var filteredOptions = filterProps(options, LIST_FORMAT_OPTIONS);\n    try {\n        var richValues_1 = {};\n        var serializedValues = values.map(function (v, i) {\n            if (typeof v === 'object') {\n                var id = generateToken(i);\n                richValues_1[id] = v;\n                return id;\n            }\n            return String(v);\n        });\n        return getListFormat(locale, filteredOptions)\n            .formatToParts(serializedValues)\n            .map(function (part) {\n            return part.type === 'literal'\n                ? part\n                : __assign(__assign({}, part), { value: richValues_1[part.value] || part.value });\n        });\n    }\n    catch (e) {\n        onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting list.', e));\n    }\n    // @ts-ignore\n    return values;\n}\n","import { filterProps } from './utils';\nimport { FormatError, ErrorCode } from 'intl-messageformat';\nimport { IntlErrorCode, IntlError } from './error';\nvar DISPLAY_NAMES_OPTONS = [\n    'style',\n    'type',\n    'fallback',\n    'languageDisplay',\n];\nexport function formatDisplayName(_a, getDisplayNames, value, options) {\n    var locale = _a.locale, onError = _a.onError;\n    var DisplayNames = Intl.DisplayNames;\n    if (!DisplayNames) {\n        onError(new FormatError(\"Intl.DisplayNames is not available in this environment.\\nTry polyfilling it using \\\"@formatjs/intl-displaynames\\\"\\n\", ErrorCode.MISSING_INTL_API));\n    }\n    var filteredOptions = filterProps(options, DISPLAY_NAMES_OPTONS);\n    try {\n        return getDisplayNames(locale, filteredOptions).of(value);\n    }\n    catch (e) {\n        onError(new IntlError(IntlErrorCode.FORMAT_ERROR, 'Error formatting display name.', e));\n    }\n}\n","import { __assign } from \"tslib\";\nimport { createFormatters, DEFAULT_INTL_CONFIG } from './utils';\nimport { InvalidConfigError, MissingDataError } from './error';\nimport { formatNumber, formatNumberToParts } from './number';\nimport { formatRelativeTime } from './relativeTime';\nimport { formatDate, formatDateToParts, formatTime, formatTimeToParts, formatDateTimeRange, } from './dateTime';\nimport { formatPlural } from './plural';\nimport { formatMessage } from './message';\nimport { formatList, formatListToParts } from './list';\nimport { formatDisplayName } from './displayName';\nfunction messagesContainString(messages) {\n    var firstMessage = messages ? messages[Object.keys(messages)[0]] : undefined;\n    return typeof firstMessage === 'string';\n}\nfunction verifyConfigMessages(config) {\n    if (config.onWarn &&\n        config.defaultRichTextElements &&\n        messagesContainString(config.messages || {})) {\n        config.onWarn(\"[@formatjs/intl] \\\"defaultRichTextElements\\\" was specified but \\\"message\\\" was not pre-compiled. \\nPlease consider using \\\"@formatjs/cli\\\" to pre-compile your messages for performance.\\nFor more details see https://formatjs.io/docs/getting-started/message-distribution\");\n    }\n}\n/**\n * Create intl object\n * @param config intl config\n * @param cache cache for formatter instances to prevent memory leak\n */\nexport function createIntl(config, cache) {\n    var formatters = createFormatters(cache);\n    var resolvedConfig = __assign(__assign({}, DEFAULT_INTL_CONFIG), config);\n    var locale = resolvedConfig.locale, defaultLocale = resolvedConfig.defaultLocale, onError = resolvedConfig.onError;\n    if (!locale) {\n        if (onError) {\n            onError(new InvalidConfigError(\"\\\"locale\\\" was not configured, using \\\"\".concat(defaultLocale, \"\\\" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details\")));\n        }\n        // Since there's no registered locale data for `locale`, this will\n        // fallback to the `defaultLocale` to make sure things can render.\n        // The `messages` are overridden to the `defaultProps` empty object\n        // to maintain referential equality across re-renders. It's assumed\n        // each <FormattedMessage> contains a `defaultMessage` prop.\n        resolvedConfig.locale = resolvedConfig.defaultLocale || 'en';\n    }\n    else if (!Intl.NumberFormat.supportedLocalesOf(locale).length && onError) {\n        onError(new MissingDataError(\"Missing locale data for locale: \\\"\".concat(locale, \"\\\" in Intl.NumberFormat. Using default locale: \\\"\").concat(defaultLocale, \"\\\" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details\")));\n    }\n    else if (!Intl.DateTimeFormat.supportedLocalesOf(locale).length &&\n        onError) {\n        onError(new MissingDataError(\"Missing locale data for locale: \\\"\".concat(locale, \"\\\" in Intl.DateTimeFormat. Using default locale: \\\"\").concat(defaultLocale, \"\\\" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details\")));\n    }\n    verifyConfigMessages(resolvedConfig);\n    return __assign(__assign({}, resolvedConfig), { formatters: formatters, formatNumber: formatNumber.bind(null, resolvedConfig, formatters.getNumberFormat), formatNumberToParts: formatNumberToParts.bind(null, resolvedConfig, formatters.getNumberFormat), formatRelativeTime: formatRelativeTime.bind(null, resolvedConfig, formatters.getRelativeTimeFormat), formatDate: formatDate.bind(null, resolvedConfig, formatters.getDateTimeFormat), formatDateToParts: formatDateToParts.bind(null, resolvedConfig, formatters.getDateTimeFormat), formatTime: formatTime.bind(null, resolvedConfig, formatters.getDateTimeFormat), formatDateTimeRange: formatDateTimeRange.bind(null, resolvedConfig, formatters.getDateTimeFormat), formatTimeToParts: formatTimeToParts.bind(null, resolvedConfig, formatters.getDateTimeFormat), formatPlural: formatPlural.bind(null, resolvedConfig, formatters.getPluralRules), \n        // @ts-expect-error TODO: will get to this later\n        formatMessage: formatMessage.bind(null, resolvedConfig, formatters), \n        // @ts-expect-error TODO: will get to this later\n        $t: formatMessage.bind(null, resolvedConfig, formatters), formatList: formatList.bind(null, resolvedConfig, formatters.getListFormat), formatListToParts: formatListToParts.bind(null, resolvedConfig, formatters.getListFormat), formatDisplayName: formatDisplayName.bind(null, resolvedConfig, formatters.getDisplayNames) });\n}\n","/*\n * Copyright 2015, Yahoo Inc.\n * Copyrights licensed under the New BSD License.\n * See the accompanying LICENSE file for terms.\n */\nimport { __assign, __extends, __rest, __spreadArray } from \"tslib\";\nimport * as React from 'react';\nimport { Provider } from './injectIntl';\nimport { DEFAULT_INTL_CONFIG, invariantIntlContext, assignUniqueKeysToParts, shallowEqual, } from '../utils';\nimport { formatMessage as coreFormatMessage, createIntl as coreCreateIntl, createIntlCache, } from '@formatjs/intl';\nimport { isFormatXMLElementFn, } from 'intl-messageformat';\nfunction processIntlConfig(config) {\n    return {\n        locale: config.locale,\n        timeZone: config.timeZone,\n        fallbackOnEmptyString: config.fallbackOnEmptyString,\n        formats: config.formats,\n        textComponent: config.textComponent,\n        messages: config.messages,\n        defaultLocale: config.defaultLocale,\n        defaultFormats: config.defaultFormats,\n        onError: config.onError,\n        onWarn: config.onWarn,\n        wrapRichTextChunksInFragment: config.wrapRichTextChunksInFragment,\n        defaultRichTextElements: config.defaultRichTextElements,\n    };\n}\nfunction assignUniqueKeysToFormatXMLElementFnArgument(values) {\n    if (!values) {\n        return values;\n    }\n    return Object.keys(values).reduce(function (acc, k) {\n        var v = values[k];\n        acc[k] = isFormatXMLElementFn(v)\n            ? assignUniqueKeysToParts(v)\n            : v;\n        return acc;\n    }, {});\n}\nvar formatMessage = function (config, formatters, descriptor, rawValues) {\n    var rest = [];\n    for (var _i = 4; _i < arguments.length; _i++) {\n        rest[_i - 4] = arguments[_i];\n    }\n    var values = assignUniqueKeysToFormatXMLElementFnArgument(rawValues);\n    var chunks = coreFormatMessage.apply(void 0, __spreadArray([config,\n        formatters,\n        descriptor,\n        values], rest, false));\n    if (Array.isArray(chunks)) {\n        return React.Children.toArray(chunks);\n    }\n    return chunks;\n};\n/**\n * Create intl object\n * @param config intl config\n * @param cache cache for formatter instances to prevent memory leak\n */\nexport var createIntl = function (_a, cache) {\n    var rawDefaultRichTextElements = _a.defaultRichTextElements, config = __rest(_a, [\"defaultRichTextElements\"]);\n    var defaultRichTextElements = assignUniqueKeysToFormatXMLElementFnArgument(rawDefaultRichTextElements);\n    var coreIntl = coreCreateIntl(__assign(__assign(__assign({}, DEFAULT_INTL_CONFIG), config), { defaultRichTextElements: defaultRichTextElements }), cache);\n    var resolvedConfig = {\n        locale: coreIntl.locale,\n        timeZone: coreIntl.timeZone,\n        fallbackOnEmptyString: coreIntl.fallbackOnEmptyString,\n        formats: coreIntl.formats,\n        defaultLocale: coreIntl.defaultLocale,\n        defaultFormats: coreIntl.defaultFormats,\n        messages: coreIntl.messages,\n        onError: coreIntl.onError,\n        defaultRichTextElements: defaultRichTextElements,\n    };\n    return __assign(__assign({}, coreIntl), { \n        // @ts-expect-error fix this\n        formatMessage: formatMessage.bind(null, resolvedConfig, coreIntl.formatters), \n        // @ts-expect-error fix this\n        $t: formatMessage.bind(null, resolvedConfig, coreIntl.formatters) });\n};\nvar IntlProvider = /** @class */ (function (_super) {\n    __extends(IntlProvider, _super);\n    function IntlProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.cache = createIntlCache();\n        _this.state = {\n            cache: _this.cache,\n            intl: createIntl(processIntlConfig(_this.props), _this.cache),\n            prevConfig: processIntlConfig(_this.props),\n        };\n        return _this;\n    }\n    IntlProvider.getDerivedStateFromProps = function (props, _a) {\n        var prevConfig = _a.prevConfig, cache = _a.cache;\n        var config = processIntlConfig(props);\n        if (!shallowEqual(prevConfig, config)) {\n            return {\n                intl: createIntl(config, cache),\n                prevConfig: config,\n            };\n        }\n        return null;\n    };\n    IntlProvider.prototype.render = function () {\n        invariantIntlContext(this.state.intl);\n        return React.createElement(Provider, { value: this.state.intl }, this.props.children);\n    };\n    IntlProvider.displayName = 'IntlProvider';\n    IntlProvider.defaultProps = DEFAULT_INTL_CONFIG;\n    return IntlProvider;\n}(React.PureComponent));\nexport default IntlProvider;\n","/**\n * @remix-run/router v1.2.1\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\n////////////////////////////////////////////////////////////////////////////////\n//#region Types and Constants\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Actions represent the type of change to a location value.\n */\nvar Action;\n\n(function (Action) {\n  /**\n   * A POP indicates a change to an arbitrary index in the history stack, such\n   * as a back or forward navigation. It does not describe the direction of the\n   * navigation, only that the current index changed.\n   *\n   * Note: This is the default action for newly created history objects.\n   */\n  Action[\"Pop\"] = \"POP\";\n  /**\n   * A PUSH indicates a new entry being added to the history stack, such as when\n   * a link is clicked and a new page loads. When this happens, all subsequent\n   * entries in the stack are lost.\n   */\n\n  Action[\"Push\"] = \"PUSH\";\n  /**\n   * A REPLACE indicates the entry at the current index in the history stack\n   * being replaced by a new one.\n   */\n\n  Action[\"Replace\"] = \"REPLACE\";\n})(Action || (Action = {}));\n\nconst PopStateEventType = \"popstate\";\n/**\n * Memory history stores the current location in memory. It is designed for use\n * in stateful non-browser environments like tests and React Native.\n */\n\nfunction createMemoryHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  let {\n    initialEntries = [\"/\"],\n    initialIndex,\n    v5Compat = false\n  } = options;\n  let entries; // Declare so we can access from createMemoryLocation\n\n  entries = initialEntries.map((entry, index) => createMemoryLocation(entry, typeof entry === \"string\" ? null : entry.state, index === 0 ? \"default\" : undefined));\n  let index = clampIndex(initialIndex == null ? entries.length - 1 : initialIndex);\n  let action = Action.Pop;\n  let listener = null;\n\n  function clampIndex(n) {\n    return Math.min(Math.max(n, 0), entries.length - 1);\n  }\n\n  function getCurrentLocation() {\n    return entries[index];\n  }\n\n  function createMemoryLocation(to, state, key) {\n    if (state === void 0) {\n      state = null;\n    }\n\n    let location = createLocation(entries ? getCurrentLocation().pathname : \"/\", to, state, key);\n    warning$1(location.pathname.charAt(0) === \"/\", \"relative pathnames are not supported in memory history: \" + JSON.stringify(to));\n    return location;\n  }\n\n  let history = {\n    get index() {\n      return index;\n    },\n\n    get action() {\n      return action;\n    },\n\n    get location() {\n      return getCurrentLocation();\n    },\n\n    createHref(to) {\n      return typeof to === \"string\" ? to : createPath(to);\n    },\n\n    encodeLocation(to) {\n      let path = typeof to === \"string\" ? parsePath(to) : to;\n      return {\n        pathname: path.pathname || \"\",\n        search: path.search || \"\",\n        hash: path.hash || \"\"\n      };\n    },\n\n    push(to, state) {\n      action = Action.Push;\n      let nextLocation = createMemoryLocation(to, state);\n      index += 1;\n      entries.splice(index, entries.length, nextLocation);\n\n      if (v5Compat && listener) {\n        listener({\n          action,\n          location: nextLocation\n        });\n      }\n    },\n\n    replace(to, state) {\n      action = Action.Replace;\n      let nextLocation = createMemoryLocation(to, state);\n      entries[index] = nextLocation;\n\n      if (v5Compat && listener) {\n        listener({\n          action,\n          location: nextLocation\n        });\n      }\n    },\n\n    go(delta) {\n      action = Action.Pop;\n      index = clampIndex(index + delta);\n\n      if (listener) {\n        listener({\n          action,\n          location: getCurrentLocation()\n        });\n      }\n    },\n\n    listen(fn) {\n      listener = fn;\n      return () => {\n        listener = null;\n      };\n    }\n\n  };\n  return history;\n}\n/**\n * Browser history stores the location in regular URLs. This is the standard for\n * most web apps, but it requires some configuration on the server to ensure you\n * serve the same app at multiple URLs.\n *\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#createbrowserhistory\n */\n\nfunction createBrowserHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  function createBrowserLocation(window, globalHistory) {\n    let {\n      pathname,\n      search,\n      hash\n    } = window.location;\n    return createLocation(\"\", {\n      pathname,\n      search,\n      hash\n    }, // state defaults to `null` because `window.history.state` does\n    globalHistory.state && globalHistory.state.usr || null, globalHistory.state && globalHistory.state.key || \"default\");\n  }\n\n  function createBrowserHref(window, to) {\n    return typeof to === \"string\" ? to : createPath(to);\n  }\n\n  return getUrlBasedHistory(createBrowserLocation, createBrowserHref, null, options);\n}\n/**\n * Hash history stores the location in window.location.hash. This makes it ideal\n * for situations where you don't want to send the location to the server for\n * some reason, either because you do cannot configure it or the URL space is\n * reserved for something else.\n *\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#createhashhistory\n */\n\nfunction createHashHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  function createHashLocation(window, globalHistory) {\n    let {\n      pathname = \"/\",\n      search = \"\",\n      hash = \"\"\n    } = parsePath(window.location.hash.substr(1));\n    return createLocation(\"\", {\n      pathname,\n      search,\n      hash\n    }, // state defaults to `null` because `window.history.state` does\n    globalHistory.state && globalHistory.state.usr || null, globalHistory.state && globalHistory.state.key || \"default\");\n  }\n\n  function createHashHref(window, to) {\n    let base = window.document.querySelector(\"base\");\n    let href = \"\";\n\n    if (base && base.getAttribute(\"href\")) {\n      let url = window.location.href;\n      let hashIndex = url.indexOf(\"#\");\n      href = hashIndex === -1 ? url : url.slice(0, hashIndex);\n    }\n\n    return href + \"#\" + (typeof to === \"string\" ? to : createPath(to));\n  }\n\n  function validateHashLocation(location, to) {\n    warning$1(location.pathname.charAt(0) === \"/\", \"relative pathnames are not supported in hash history.push(\" + JSON.stringify(to) + \")\");\n  }\n\n  return getUrlBasedHistory(createHashLocation, createHashHref, validateHashLocation, options);\n}\nfunction invariant(value, message) {\n  if (value === false || value === null || typeof value === \"undefined\") {\n    throw new Error(message);\n  }\n}\n\nfunction warning$1(cond, message) {\n  if (!cond) {\n    // eslint-disable-next-line no-console\n    if (typeof console !== \"undefined\") console.warn(message);\n\n    try {\n      // Welcome to debugging history!\n      //\n      // This error is thrown as a convenience so you can more easily\n      // find the source for a warning that appears in the console by\n      // enabling \"pause on exceptions\" in your JavaScript debugger.\n      throw new Error(message); // eslint-disable-next-line no-empty\n    } catch (e) {}\n  }\n}\n\nfunction createKey() {\n  return Math.random().toString(36).substr(2, 8);\n}\n/**\n * For browser-based histories, we combine the state and key into an object\n */\n\n\nfunction getHistoryState(location) {\n  return {\n    usr: location.state,\n    key: location.key\n  };\n}\n/**\n * Creates a Location object with a unique key from the given Path\n */\n\n\nfunction createLocation(current, to, state, key) {\n  if (state === void 0) {\n    state = null;\n  }\n\n  let location = _extends({\n    pathname: typeof current === \"string\" ? current : current.pathname,\n    search: \"\",\n    hash: \"\"\n  }, typeof to === \"string\" ? parsePath(to) : to, {\n    state,\n    // TODO: This could be cleaned up.  push/replace should probably just take\n    // full Locations now and avoid the need to run through this flow at all\n    // But that's a pretty big refactor to the current test suite so going to\n    // keep as is for the time being and just let any incoming keys take precedence\n    key: to && to.key || key || createKey()\n  });\n\n  return location;\n}\n/**\n * Creates a string URL path from the given pathname, search, and hash components.\n */\n\nfunction createPath(_ref) {\n  let {\n    pathname = \"/\",\n    search = \"\",\n    hash = \"\"\n  } = _ref;\n  if (search && search !== \"?\") pathname += search.charAt(0) === \"?\" ? search : \"?\" + search;\n  if (hash && hash !== \"#\") pathname += hash.charAt(0) === \"#\" ? hash : \"#\" + hash;\n  return pathname;\n}\n/**\n * Parses a string URL path into its separate pathname, search, and hash components.\n */\n\nfunction parsePath(path) {\n  let parsedPath = {};\n\n  if (path) {\n    let hashIndex = path.indexOf(\"#\");\n\n    if (hashIndex >= 0) {\n      parsedPath.hash = path.substr(hashIndex);\n      path = path.substr(0, hashIndex);\n    }\n\n    let searchIndex = path.indexOf(\"?\");\n\n    if (searchIndex >= 0) {\n      parsedPath.search = path.substr(searchIndex);\n      path = path.substr(0, searchIndex);\n    }\n\n    if (path) {\n      parsedPath.pathname = path;\n    }\n  }\n\n  return parsedPath;\n}\nfunction createClientSideURL(location) {\n  // window.location.origin is \"null\" (the literal string value) in Firefox\n  // under certain conditions, notably when serving from a local HTML file\n  // See https://bugzilla.mozilla.org/show_bug.cgi?id=878297\n  let base = typeof window !== \"undefined\" && typeof window.location !== \"undefined\" && window.location.origin !== \"null\" ? window.location.origin : window.location.href;\n  let href = typeof location === \"string\" ? location : createPath(location);\n  invariant(base, \"No window.location.(origin|href) available to create URL for href: \" + href);\n  return new URL(href, base);\n}\n\nfunction getUrlBasedHistory(getLocation, createHref, validateLocation, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  let {\n    window = document.defaultView,\n    v5Compat = false\n  } = options;\n  let globalHistory = window.history;\n  let action = Action.Pop;\n  let listener = null;\n\n  function handlePop() {\n    action = Action.Pop;\n\n    if (listener) {\n      listener({\n        action,\n        location: history.location\n      });\n    }\n  }\n\n  function push(to, state) {\n    action = Action.Push;\n    let location = createLocation(history.location, to, state);\n    if (validateLocation) validateLocation(location, to);\n    let historyState = getHistoryState(location);\n    let url = history.createHref(location); // try...catch because iOS limits us to 100 pushState calls :/\n\n    try {\n      globalHistory.pushState(historyState, \"\", url);\n    } catch (error) {\n      // They are going to lose state here, but there is no real\n      // way to warn them about it since the page will refresh...\n      window.location.assign(url);\n    }\n\n    if (v5Compat && listener) {\n      listener({\n        action,\n        location: history.location\n      });\n    }\n  }\n\n  function replace(to, state) {\n    action = Action.Replace;\n    let location = createLocation(history.location, to, state);\n    if (validateLocation) validateLocation(location, to);\n    let historyState = getHistoryState(location);\n    let url = history.createHref(location);\n    globalHistory.replaceState(historyState, \"\", url);\n\n    if (v5Compat && listener) {\n      listener({\n        action,\n        location: history.location\n      });\n    }\n  }\n\n  let history = {\n    get action() {\n      return action;\n    },\n\n    get location() {\n      return getLocation(window, globalHistory);\n    },\n\n    listen(fn) {\n      if (listener) {\n        throw new Error(\"A history only accepts one active listener\");\n      }\n\n      window.addEventListener(PopStateEventType, handlePop);\n      listener = fn;\n      return () => {\n        window.removeEventListener(PopStateEventType, handlePop);\n        listener = null;\n      };\n    },\n\n    createHref(to) {\n      return createHref(window, to);\n    },\n\n    encodeLocation(to) {\n      // Encode a Location the same way window.location would\n      let url = createClientSideURL(typeof to === \"string\" ? to : createPath(to));\n      return {\n        pathname: url.pathname,\n        search: url.search,\n        hash: url.hash\n      };\n    },\n\n    push,\n    replace,\n\n    go(n) {\n      return globalHistory.go(n);\n    }\n\n  };\n  return history;\n} //#endregion\n\nvar ResultType;\n\n(function (ResultType) {\n  ResultType[\"data\"] = \"data\";\n  ResultType[\"deferred\"] = \"deferred\";\n  ResultType[\"redirect\"] = \"redirect\";\n  ResultType[\"error\"] = \"error\";\n})(ResultType || (ResultType = {}));\n\nfunction isIndexRoute(route) {\n  return route.index === true;\n} // Walk the route tree generating unique IDs where necessary so we are working\n// solely with AgnosticDataRouteObject's within the Router\n\n\nfunction convertRoutesToDataRoutes(routes, parentPath, allIds) {\n  if (parentPath === void 0) {\n    parentPath = [];\n  }\n\n  if (allIds === void 0) {\n    allIds = new Set();\n  }\n\n  return routes.map((route, index) => {\n    let treePath = [...parentPath, index];\n    let id = typeof route.id === \"string\" ? route.id : treePath.join(\"-\");\n    invariant(route.index !== true || !route.children, \"Cannot specify children on an index route\");\n    invariant(!allIds.has(id), \"Found a route id collision on id \\\"\" + id + \"\\\".  Route \" + \"id's must be globally unique within Data Router usages\");\n    allIds.add(id);\n\n    if (isIndexRoute(route)) {\n      let indexRoute = _extends({}, route, {\n        id\n      });\n\n      return indexRoute;\n    } else {\n      let pathOrLayoutRoute = _extends({}, route, {\n        id,\n        children: route.children ? convertRoutesToDataRoutes(route.children, treePath, allIds) : undefined\n      });\n\n      return pathOrLayoutRoute;\n    }\n  });\n}\n/**\n * Matches the given routes to a location and returns the match data.\n *\n * @see https://reactrouter.com/utils/match-routes\n */\n\nfunction matchRoutes(routes, locationArg, basename) {\n  if (basename === void 0) {\n    basename = \"/\";\n  }\n\n  let location = typeof locationArg === \"string\" ? parsePath(locationArg) : locationArg;\n  let pathname = stripBasename(location.pathname || \"/\", basename);\n\n  if (pathname == null) {\n    return null;\n  }\n\n  let branches = flattenRoutes(routes);\n  rankRouteBranches(branches);\n  let matches = null;\n\n  for (let i = 0; matches == null && i < branches.length; ++i) {\n    matches = matchRouteBranch(branches[i], // Incoming pathnames are generally encoded from either window.location\n    // or from router.navigate, but we want to match against the unencoded\n    // paths in the route definitions.  Memory router locations won't be\n    // encoded here but there also shouldn't be anything to decode so this\n    // should be a safe operation.  This avoids needing matchRoutes to be\n    // history-aware.\n    safelyDecodeURI(pathname));\n  }\n\n  return matches;\n}\n\nfunction flattenRoutes(routes, branches, parentsMeta, parentPath) {\n  if (branches === void 0) {\n    branches = [];\n  }\n\n  if (parentsMeta === void 0) {\n    parentsMeta = [];\n  }\n\n  if (parentPath === void 0) {\n    parentPath = \"\";\n  }\n\n  let flattenRoute = (route, index, relativePath) => {\n    let meta = {\n      relativePath: relativePath === undefined ? route.path || \"\" : relativePath,\n      caseSensitive: route.caseSensitive === true,\n      childrenIndex: index,\n      route\n    };\n\n    if (meta.relativePath.startsWith(\"/\")) {\n      invariant(meta.relativePath.startsWith(parentPath), \"Absolute route path \\\"\" + meta.relativePath + \"\\\" nested under path \" + (\"\\\"\" + parentPath + \"\\\" is not valid. An absolute child route path \") + \"must start with the combined path of all its parent routes.\");\n      meta.relativePath = meta.relativePath.slice(parentPath.length);\n    }\n\n    let path = joinPaths([parentPath, meta.relativePath]);\n    let routesMeta = parentsMeta.concat(meta); // Add the children before adding this route to the array so we traverse the\n    // route tree depth-first and child routes appear before their parents in\n    // the \"flattened\" version.\n\n    if (route.children && route.children.length > 0) {\n      invariant( // Our types know better, but runtime JS may not!\n      // @ts-expect-error\n      route.index !== true, \"Index routes must not have child routes. Please remove \" + (\"all child routes from route path \\\"\" + path + \"\\\".\"));\n      flattenRoutes(route.children, branches, routesMeta, path);\n    } // Routes without a path shouldn't ever match by themselves unless they are\n    // index routes, so don't add them to the list of possible branches.\n\n\n    if (route.path == null && !route.index) {\n      return;\n    }\n\n    branches.push({\n      path,\n      score: computeScore(path, route.index),\n      routesMeta\n    });\n  };\n\n  routes.forEach((route, index) => {\n    var _route$path;\n\n    // coarse-grain check for optional params\n    if (route.path === \"\" || !((_route$path = route.path) != null && _route$path.includes(\"?\"))) {\n      flattenRoute(route, index);\n    } else {\n      for (let exploded of explodeOptionalSegments(route.path)) {\n        flattenRoute(route, index, exploded);\n      }\n    }\n  });\n  return branches;\n}\n/**\n * Computes all combinations of optional path segments for a given path,\n * excluding combinations that are ambiguous and of lower priority.\n *\n * For example, `/one/:two?/three/:four?/:five?` explodes to:\n * - `/one/three`\n * - `/one/:two/three`\n * - `/one/three/:four`\n * - `/one/three/:five`\n * - `/one/:two/three/:four`\n * - `/one/:two/three/:five`\n * - `/one/three/:four/:five`\n * - `/one/:two/three/:four/:five`\n */\n\n\nfunction explodeOptionalSegments(path) {\n  let segments = path.split(\"/\");\n  if (segments.length === 0) return [];\n  let [first, ...rest] = segments; // Optional path segments are denoted by a trailing `?`\n\n  let isOptional = first.endsWith(\"?\"); // Compute the corresponding required segment: `foo?` -> `foo`\n\n  let required = first.replace(/\\?$/, \"\");\n\n  if (rest.length === 0) {\n    // Intepret empty string as omitting an optional segment\n    // `[\"one\", \"\", \"three\"]` corresponds to omitting `:two` from `/one/:two?/three` -> `/one/three`\n    return isOptional ? [required, \"\"] : [required];\n  }\n\n  let restExploded = explodeOptionalSegments(rest.join(\"/\"));\n  let result = []; // All child paths with the prefix.  Do this for all children before the\n  // optional version for all children so we get consistent ordering where the\n  // parent optional aspect is preferred as required.  Otherwise, we can get\n  // child sections interspersed where deeper optional segments are higher than\n  // parent optional segments, where for example, /:two would explodes _earlier_\n  // then /:one.  By always including the parent as required _for all children_\n  // first, we avoid this issue\n\n  result.push(...restExploded.map(subpath => subpath === \"\" ? required : [required, subpath].join(\"/\"))); // Then if this is an optional value, add all child versions without\n\n  if (isOptional) {\n    result.push(...restExploded);\n  } // for absolute paths, ensure `/` instead of empty segment\n\n\n  return result.map(exploded => path.startsWith(\"/\") && exploded === \"\" ? \"/\" : exploded);\n}\n\nfunction rankRouteBranches(branches) {\n  branches.sort((a, b) => a.score !== b.score ? b.score - a.score // Higher score first\n  : compareIndexes(a.routesMeta.map(meta => meta.childrenIndex), b.routesMeta.map(meta => meta.childrenIndex)));\n}\n\nconst paramRe = /^:\\w+$/;\nconst dynamicSegmentValue = 3;\nconst indexRouteValue = 2;\nconst emptySegmentValue = 1;\nconst staticSegmentValue = 10;\nconst splatPenalty = -2;\n\nconst isSplat = s => s === \"*\";\n\nfunction computeScore(path, index) {\n  let segments = path.split(\"/\");\n  let initialScore = segments.length;\n\n  if (segments.some(isSplat)) {\n    initialScore += splatPenalty;\n  }\n\n  if (index) {\n    initialScore += indexRouteValue;\n  }\n\n  return segments.filter(s => !isSplat(s)).reduce((score, segment) => score + (paramRe.test(segment) ? dynamicSegmentValue : segment === \"\" ? emptySegmentValue : staticSegmentValue), initialScore);\n}\n\nfunction compareIndexes(a, b) {\n  let siblings = a.length === b.length && a.slice(0, -1).every((n, i) => n === b[i]);\n  return siblings ? // If two routes are siblings, we should try to match the earlier sibling\n  // first. This allows people to have fine-grained control over the matching\n  // behavior by simply putting routes with identical paths in the order they\n  // want them tried.\n  a[a.length - 1] - b[b.length - 1] : // Otherwise, it doesn't really make sense to rank non-siblings by index,\n  // so they sort equally.\n  0;\n}\n\nfunction matchRouteBranch(branch, pathname) {\n  let {\n    routesMeta\n  } = branch;\n  let matchedParams = {};\n  let matchedPathname = \"/\";\n  let matches = [];\n\n  for (let i = 0; i < routesMeta.length; ++i) {\n    let meta = routesMeta[i];\n    let end = i === routesMeta.length - 1;\n    let remainingPathname = matchedPathname === \"/\" ? pathname : pathname.slice(matchedPathname.length) || \"/\";\n    let match = matchPath({\n      path: meta.relativePath,\n      caseSensitive: meta.caseSensitive,\n      end\n    }, remainingPathname);\n    if (!match) return null;\n    Object.assign(matchedParams, match.params);\n    let route = meta.route;\n    matches.push({\n      // TODO: Can this as be avoided?\n      params: matchedParams,\n      pathname: joinPaths([matchedPathname, match.pathname]),\n      pathnameBase: normalizePathname(joinPaths([matchedPathname, match.pathnameBase])),\n      route\n    });\n\n    if (match.pathnameBase !== \"/\") {\n      matchedPathname = joinPaths([matchedPathname, match.pathnameBase]);\n    }\n  }\n\n  return matches;\n}\n/**\n * Returns a path with params interpolated.\n *\n * @see https://reactrouter.com/utils/generate-path\n */\n\n\nfunction generatePath(originalPath, params) {\n  if (params === void 0) {\n    params = {};\n  }\n\n  let path = originalPath;\n\n  if (path.endsWith(\"*\") && path !== \"*\" && !path.endsWith(\"/*\")) {\n    warning(false, \"Route path \\\"\" + path + \"\\\" will be treated as if it were \" + (\"\\\"\" + path.replace(/\\*$/, \"/*\") + \"\\\" because the `*` character must \") + \"always follow a `/` in the pattern. To get rid of this warning, \" + (\"please change the route path to \\\"\" + path.replace(/\\*$/, \"/*\") + \"\\\".\"));\n    path = path.replace(/\\*$/, \"/*\");\n  }\n\n  return path.replace(/^:(\\w+)/g, (_, key) => {\n    invariant(params[key] != null, \"Missing \\\":\" + key + \"\\\" param\");\n    return params[key];\n  }).replace(/\\/:(\\w+)/g, (_, key) => {\n    invariant(params[key] != null, \"Missing \\\":\" + key + \"\\\" param\");\n    return \"/\" + params[key];\n  }).replace(/(\\/?)\\*/, (_, prefix, __, str) => {\n    const star = \"*\";\n\n    if (params[star] == null) {\n      // If no splat was provided, trim the trailing slash _unless_ it's\n      // the entire path\n      return str === \"/*\" ? \"/\" : \"\";\n    } // Apply the splat\n\n\n    return \"\" + prefix + params[star];\n  });\n}\n/**\n * Performs pattern matching on a URL pathname and returns information about\n * the match.\n *\n * @see https://reactrouter.com/utils/match-path\n */\n\nfunction matchPath(pattern, pathname) {\n  if (typeof pattern === \"string\") {\n    pattern = {\n      path: pattern,\n      caseSensitive: false,\n      end: true\n    };\n  }\n\n  let [matcher, paramNames] = compilePath(pattern.path, pattern.caseSensitive, pattern.end);\n  let match = pathname.match(matcher);\n  if (!match) return null;\n  let matchedPathname = match[0];\n  let pathnameBase = matchedPathname.replace(/(.)\\/+$/, \"$1\");\n  let captureGroups = match.slice(1);\n  let params = paramNames.reduce((memo, paramName, index) => {\n    // We need to compute the pathnameBase here using the raw splat value\n    // instead of using params[\"*\"] later because it will be decoded then\n    if (paramName === \"*\") {\n      let splatValue = captureGroups[index] || \"\";\n      pathnameBase = matchedPathname.slice(0, matchedPathname.length - splatValue.length).replace(/(.)\\/+$/, \"$1\");\n    }\n\n    memo[paramName] = safelyDecodeURIComponent(captureGroups[index] || \"\", paramName);\n    return memo;\n  }, {});\n  return {\n    params,\n    pathname: matchedPathname,\n    pathnameBase,\n    pattern\n  };\n}\n\nfunction compilePath(path, caseSensitive, end) {\n  if (caseSensitive === void 0) {\n    caseSensitive = false;\n  }\n\n  if (end === void 0) {\n    end = true;\n  }\n\n  warning(path === \"*\" || !path.endsWith(\"*\") || path.endsWith(\"/*\"), \"Route path \\\"\" + path + \"\\\" will be treated as if it were \" + (\"\\\"\" + path.replace(/\\*$/, \"/*\") + \"\\\" because the `*` character must \") + \"always follow a `/` in the pattern. To get rid of this warning, \" + (\"please change the route path to \\\"\" + path.replace(/\\*$/, \"/*\") + \"\\\".\"));\n  let paramNames = [];\n  let regexpSource = \"^\" + path.replace(/\\/*\\*?$/, \"\") // Ignore trailing / and /*, we'll handle it below\n  .replace(/^\\/*/, \"/\") // Make sure it has a leading /\n  .replace(/[\\\\.*+^$?{}|()[\\]]/g, \"\\\\$&\") // Escape special regex chars\n  .replace(/\\/:(\\w+)/g, (_, paramName) => {\n    paramNames.push(paramName);\n    return \"/([^\\\\/]+)\";\n  });\n\n  if (path.endsWith(\"*\")) {\n    paramNames.push(\"*\");\n    regexpSource += path === \"*\" || path === \"/*\" ? \"(.*)$\" // Already matched the initial /, just match the rest\n    : \"(?:\\\\/(.+)|\\\\/*)$\"; // Don't include the / in params[\"*\"]\n  } else if (end) {\n    // When matching to the end, ignore trailing slashes\n    regexpSource += \"\\\\/*$\";\n  } else if (path !== \"\" && path !== \"/\") {\n    // If our path is non-empty and contains anything beyond an initial slash,\n    // then we have _some_ form of path in our regex so we should expect to\n    // match only if we find the end of this path segment.  Look for an optional\n    // non-captured trailing slash (to match a portion of the URL) or the end\n    // of the path (if we've matched to the end).  We used to do this with a\n    // word boundary but that gives false positives on routes like\n    // /user-preferences since `-` counts as a word boundary.\n    regexpSource += \"(?:(?=\\\\/|$))\";\n  } else ;\n\n  let matcher = new RegExp(regexpSource, caseSensitive ? undefined : \"i\");\n  return [matcher, paramNames];\n}\n\nfunction safelyDecodeURI(value) {\n  try {\n    return decodeURI(value);\n  } catch (error) {\n    warning(false, \"The URL path \\\"\" + value + \"\\\" could not be decoded because it is is a \" + \"malformed URL segment. This is probably due to a bad percent \" + (\"encoding (\" + error + \").\"));\n    return value;\n  }\n}\n\nfunction safelyDecodeURIComponent(value, paramName) {\n  try {\n    return decodeURIComponent(value);\n  } catch (error) {\n    warning(false, \"The value for the URL param \\\"\" + paramName + \"\\\" will not be decoded because\" + (\" the string \\\"\" + value + \"\\\" is a malformed URL segment. This is probably\") + (\" due to a bad percent encoding (\" + error + \").\"));\n    return value;\n  }\n}\n/**\n * @private\n */\n\n\nfunction stripBasename(pathname, basename) {\n  if (basename === \"/\") return pathname;\n\n  if (!pathname.toLowerCase().startsWith(basename.toLowerCase())) {\n    return null;\n  } // We want to leave trailing slash behavior in the user's control, so if they\n  // specify a basename with a trailing slash, we should support it\n\n\n  let startIndex = basename.endsWith(\"/\") ? basename.length - 1 : basename.length;\n  let nextChar = pathname.charAt(startIndex);\n\n  if (nextChar && nextChar !== \"/\") {\n    // pathname does not start with basename/\n    return null;\n  }\n\n  return pathname.slice(startIndex) || \"/\";\n}\n/**\n * @private\n */\n\nfunction warning(cond, message) {\n  if (!cond) {\n    // eslint-disable-next-line no-console\n    if (typeof console !== \"undefined\") console.warn(message);\n\n    try {\n      // Welcome to debugging React Router!\n      //\n      // This error is thrown as a convenience so you can more easily\n      // find the source for a warning that appears in the console by\n      // enabling \"pause on exceptions\" in your JavaScript debugger.\n      throw new Error(message); // eslint-disable-next-line no-empty\n    } catch (e) {}\n  }\n}\n/**\n * Returns a resolved path object relative to the given pathname.\n *\n * @see https://reactrouter.com/utils/resolve-path\n */\n\nfunction resolvePath(to, fromPathname) {\n  if (fromPathname === void 0) {\n    fromPathname = \"/\";\n  }\n\n  let {\n    pathname: toPathname,\n    search = \"\",\n    hash = \"\"\n  } = typeof to === \"string\" ? parsePath(to) : to;\n  let pathname = toPathname ? toPathname.startsWith(\"/\") ? toPathname : resolvePathname(toPathname, fromPathname) : fromPathname;\n  return {\n    pathname,\n    search: normalizeSearch(search),\n    hash: normalizeHash(hash)\n  };\n}\n\nfunction resolvePathname(relativePath, fromPathname) {\n  let segments = fromPathname.replace(/\\/+$/, \"\").split(\"/\");\n  let relativeSegments = relativePath.split(\"/\");\n  relativeSegments.forEach(segment => {\n    if (segment === \"..\") {\n      // Keep the root \"\" segment so the pathname starts at /\n      if (segments.length > 1) segments.pop();\n    } else if (segment !== \".\") {\n      segments.push(segment);\n    }\n  });\n  return segments.length > 1 ? segments.join(\"/\") : \"/\";\n}\n\nfunction getInvalidPathError(char, field, dest, path) {\n  return \"Cannot include a '\" + char + \"' character in a manually specified \" + (\"`to.\" + field + \"` field [\" + JSON.stringify(path) + \"].  Please separate it out to the \") + (\"`to.\" + dest + \"` field. Alternatively you may provide the full path as \") + \"a string in <Link to=\\\"...\\\"> and the router will parse it for you.\";\n}\n/**\n * @private\n *\n * When processing relative navigation we want to ignore ancestor routes that\n * do not contribute to the path, such that index/pathless layout routes don't\n * interfere.\n *\n * For example, when moving a route element into an index route and/or a\n * pathless layout route, relative link behavior contained within should stay\n * the same.  Both of the following examples should link back to the root:\n *\n *   <Route path=\"/\">\n *     <Route path=\"accounts\" element={<Link to=\"..\"}>\n *   </Route>\n *\n *   <Route path=\"/\">\n *     <Route path=\"accounts\">\n *       <Route element={<AccountsLayout />}>       // <-- Does not contribute\n *         <Route index element={<Link to=\"..\"} />  // <-- Does not contribute\n *       </Route\n *     </Route>\n *   </Route>\n */\n\n\nfunction getPathContributingMatches(matches) {\n  return matches.filter((match, index) => index === 0 || match.route.path && match.route.path.length > 0);\n}\n/**\n * @private\n */\n\nfunction resolveTo(toArg, routePathnames, locationPathname, isPathRelative) {\n  if (isPathRelative === void 0) {\n    isPathRelative = false;\n  }\n\n  let to;\n\n  if (typeof toArg === \"string\") {\n    to = parsePath(toArg);\n  } else {\n    to = _extends({}, toArg);\n    invariant(!to.pathname || !to.pathname.includes(\"?\"), getInvalidPathError(\"?\", \"pathname\", \"search\", to));\n    invariant(!to.pathname || !to.pathname.includes(\"#\"), getInvalidPathError(\"#\", \"pathname\", \"hash\", to));\n    invariant(!to.search || !to.search.includes(\"#\"), getInvalidPathError(\"#\", \"search\", \"hash\", to));\n  }\n\n  let isEmptyPath = toArg === \"\" || to.pathname === \"\";\n  let toPathname = isEmptyPath ? \"/\" : to.pathname;\n  let from; // Routing is relative to the current pathname if explicitly requested.\n  //\n  // If a pathname is explicitly provided in `to`, it should be relative to the\n  // route context. This is explained in `Note on `<Link to>` values` in our\n  // migration guide from v5 as a means of disambiguation between `to` values\n  // that begin with `/` and those that do not. However, this is problematic for\n  // `to` values that do not provide a pathname. `to` can simply be a search or\n  // hash string, in which case we should assume that the navigation is relative\n  // to the current location's pathname and *not* the route pathname.\n\n  if (isPathRelative || toPathname == null) {\n    from = locationPathname;\n  } else {\n    let routePathnameIndex = routePathnames.length - 1;\n\n    if (toPathname.startsWith(\"..\")) {\n      let toSegments = toPathname.split(\"/\"); // Each leading .. segment means \"go up one route\" instead of \"go up one\n      // URL segment\".  This is a key difference from how <a href> works and a\n      // major reason we call this a \"to\" value instead of a \"href\".\n\n      while (toSegments[0] === \"..\") {\n        toSegments.shift();\n        routePathnameIndex -= 1;\n      }\n\n      to.pathname = toSegments.join(\"/\");\n    } // If there are more \"..\" segments than parent routes, resolve relative to\n    // the root / URL.\n\n\n    from = routePathnameIndex >= 0 ? routePathnames[routePathnameIndex] : \"/\";\n  }\n\n  let path = resolvePath(to, from); // Ensure the pathname has a trailing slash if the original \"to\" had one\n\n  let hasExplicitTrailingSlash = toPathname && toPathname !== \"/\" && toPathname.endsWith(\"/\"); // Or if this was a link to the current path which has a trailing slash\n\n  let hasCurrentTrailingSlash = (isEmptyPath || toPathname === \".\") && locationPathname.endsWith(\"/\");\n\n  if (!path.pathname.endsWith(\"/\") && (hasExplicitTrailingSlash || hasCurrentTrailingSlash)) {\n    path.pathname += \"/\";\n  }\n\n  return path;\n}\n/**\n * @private\n */\n\nfunction getToPathname(to) {\n  // Empty strings should be treated the same as / paths\n  return to === \"\" || to.pathname === \"\" ? \"/\" : typeof to === \"string\" ? parsePath(to).pathname : to.pathname;\n}\n/**\n * @private\n */\n\nconst joinPaths = paths => paths.join(\"/\").replace(/\\/\\/+/g, \"/\");\n/**\n * @private\n */\n\nconst normalizePathname = pathname => pathname.replace(/\\/+$/, \"\").replace(/^\\/*/, \"/\");\n/**\n * @private\n */\n\nconst normalizeSearch = search => !search || search === \"?\" ? \"\" : search.startsWith(\"?\") ? search : \"?\" + search;\n/**\n * @private\n */\n\nconst normalizeHash = hash => !hash || hash === \"#\" ? \"\" : hash.startsWith(\"#\") ? hash : \"#\" + hash;\n/**\n * This is a shortcut for creating `application/json` responses. Converts `data`\n * to JSON and sets the `Content-Type` header.\n */\n\nconst json = function json(data, init) {\n  if (init === void 0) {\n    init = {};\n  }\n\n  let responseInit = typeof init === \"number\" ? {\n    status: init\n  } : init;\n  let headers = new Headers(responseInit.headers);\n\n  if (!headers.has(\"Content-Type\")) {\n    headers.set(\"Content-Type\", \"application/json; charset=utf-8\");\n  }\n\n  return new Response(JSON.stringify(data), _extends({}, responseInit, {\n    headers\n  }));\n};\nclass AbortedDeferredError extends Error {}\nclass DeferredData {\n  constructor(data) {\n    this.pendingKeys = new Set();\n    this.subscriber = undefined;\n    invariant(data && typeof data === \"object\" && !Array.isArray(data), \"defer() only accepts plain objects\"); // Set up an AbortController + Promise we can race against to exit early\n    // cancellation\n\n    let reject;\n    this.abortPromise = new Promise((_, r) => reject = r);\n    this.controller = new AbortController();\n\n    let onAbort = () => reject(new AbortedDeferredError(\"Deferred data aborted\"));\n\n    this.unlistenAbortSignal = () => this.controller.signal.removeEventListener(\"abort\", onAbort);\n\n    this.controller.signal.addEventListener(\"abort\", onAbort);\n    this.data = Object.entries(data).reduce((acc, _ref) => {\n      let [key, value] = _ref;\n      return Object.assign(acc, {\n        [key]: this.trackPromise(key, value)\n      });\n    }, {});\n  }\n\n  trackPromise(key, value) {\n    if (!(value instanceof Promise)) {\n      return value;\n    }\n\n    this.pendingKeys.add(key); // We store a little wrapper promise that will be extended with\n    // _data/_error props upon resolve/reject\n\n    let promise = Promise.race([value, this.abortPromise]).then(data => this.onSettle(promise, key, null, data), error => this.onSettle(promise, key, error)); // Register rejection listeners to avoid uncaught promise rejections on\n    // errors or aborted deferred values\n\n    promise.catch(() => {});\n    Object.defineProperty(promise, \"_tracked\", {\n      get: () => true\n    });\n    return promise;\n  }\n\n  onSettle(promise, key, error, data) {\n    if (this.controller.signal.aborted && error instanceof AbortedDeferredError) {\n      this.unlistenAbortSignal();\n      Object.defineProperty(promise, \"_error\", {\n        get: () => error\n      });\n      return Promise.reject(error);\n    }\n\n    this.pendingKeys.delete(key);\n\n    if (this.done) {\n      // Nothing left to abort!\n      this.unlistenAbortSignal();\n    }\n\n    const subscriber = this.subscriber;\n\n    if (error) {\n      Object.defineProperty(promise, \"_error\", {\n        get: () => error\n      });\n      subscriber && subscriber(false);\n      return Promise.reject(error);\n    }\n\n    Object.defineProperty(promise, \"_data\", {\n      get: () => data\n    });\n    subscriber && subscriber(false);\n    return data;\n  }\n\n  subscribe(fn) {\n    this.subscriber = fn;\n  }\n\n  cancel() {\n    this.controller.abort();\n    this.pendingKeys.forEach((v, k) => this.pendingKeys.delete(k));\n    let subscriber = this.subscriber;\n    subscriber && subscriber(true);\n  }\n\n  async resolveData(signal) {\n    let aborted = false;\n\n    if (!this.done) {\n      let onAbort = () => this.cancel();\n\n      signal.addEventListener(\"abort\", onAbort);\n      aborted = await new Promise(resolve => {\n        this.subscribe(aborted => {\n          signal.removeEventListener(\"abort\", onAbort);\n\n          if (aborted || this.done) {\n            resolve(aborted);\n          }\n        });\n      });\n    }\n\n    return aborted;\n  }\n\n  get done() {\n    return this.pendingKeys.size === 0;\n  }\n\n  get unwrappedData() {\n    invariant(this.data !== null && this.done, \"Can only unwrap data on initialized and settled deferreds\");\n    return Object.entries(this.data).reduce((acc, _ref2) => {\n      let [key, value] = _ref2;\n      return Object.assign(acc, {\n        [key]: unwrapTrackedPromise(value)\n      });\n    }, {});\n  }\n\n}\n\nfunction isTrackedPromise(value) {\n  return value instanceof Promise && value._tracked === true;\n}\n\nfunction unwrapTrackedPromise(value) {\n  if (!isTrackedPromise(value)) {\n    return value;\n  }\n\n  if (value._error) {\n    throw value._error;\n  }\n\n  return value._data;\n}\n\nfunction defer(data) {\n  return new DeferredData(data);\n}\n/**\n * A redirect response. Sets the status code and the `Location` header.\n * Defaults to \"302 Found\".\n */\n\nconst redirect = function redirect(url, init) {\n  if (init === void 0) {\n    init = 302;\n  }\n\n  let responseInit = init;\n\n  if (typeof responseInit === \"number\") {\n    responseInit = {\n      status: responseInit\n    };\n  } else if (typeof responseInit.status === \"undefined\") {\n    responseInit.status = 302;\n  }\n\n  let headers = new Headers(responseInit.headers);\n  headers.set(\"Location\", url);\n  return new Response(null, _extends({}, responseInit, {\n    headers\n  }));\n};\n/**\n * @private\n * Utility class we use to hold auto-unwrapped 4xx/5xx Response bodies\n */\n\nclass ErrorResponse {\n  constructor(status, statusText, data, internal) {\n    if (internal === void 0) {\n      internal = false;\n    }\n\n    this.status = status;\n    this.statusText = statusText || \"\";\n    this.internal = internal;\n\n    if (data instanceof Error) {\n      this.data = data.toString();\n      this.error = data;\n    } else {\n      this.data = data;\n    }\n  }\n\n}\n/**\n * Check if the given error is an ErrorResponse generated from a 4xx/5xx\n * Response throw from an action/loader\n */\n\nfunction isRouteErrorResponse(e) {\n  return e instanceof ErrorResponse;\n}\n\nconst validMutationMethodsArr = [\"post\", \"put\", \"patch\", \"delete\"];\nconst validMutationMethods = new Set(validMutationMethodsArr);\nconst validRequestMethodsArr = [\"get\", ...validMutationMethodsArr];\nconst validRequestMethods = new Set(validRequestMethodsArr);\nconst redirectStatusCodes = new Set([301, 302, 303, 307, 308]);\nconst redirectPreserveMethodStatusCodes = new Set([307, 308]);\nconst IDLE_NAVIGATION = {\n  state: \"idle\",\n  location: undefined,\n  formMethod: undefined,\n  formAction: undefined,\n  formEncType: undefined,\n  formData: undefined\n};\nconst IDLE_FETCHER = {\n  state: \"idle\",\n  data: undefined,\n  formMethod: undefined,\n  formAction: undefined,\n  formEncType: undefined,\n  formData: undefined\n};\nconst isBrowser = typeof window !== \"undefined\" && typeof window.document !== \"undefined\" && typeof window.document.createElement !== \"undefined\";\nconst isServer = !isBrowser; //#endregion\n////////////////////////////////////////////////////////////////////////////////\n//#region createRouter\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Create a router and listen to history POP navigations\n */\n\nfunction createRouter(init) {\n  invariant(init.routes.length > 0, \"You must provide a non-empty routes array to createRouter\");\n  let dataRoutes = convertRoutesToDataRoutes(init.routes); // Cleanup function for history\n\n  let unlistenHistory = null; // Externally-provided functions to call on all state changes\n\n  let subscribers = new Set(); // Externally-provided object to hold scroll restoration locations during routing\n\n  let savedScrollPositions = null; // Externally-provided function to get scroll restoration keys\n\n  let getScrollRestorationKey = null; // Externally-provided function to get current scroll position\n\n  let getScrollPosition = null; // One-time flag to control the initial hydration scroll restoration.  Because\n  // we don't get the saved positions from <ScrollRestoration /> until _after_\n  // the initial render, we need to manually trigger a separate updateState to\n  // send along the restoreScrollPosition\n  // Set to true if we have `hydrationData` since we assume we were SSR'd and that\n  // SSR did the initial scroll restoration.\n\n  let initialScrollRestored = init.hydrationData != null;\n  let initialMatches = matchRoutes(dataRoutes, init.history.location, init.basename);\n  let initialErrors = null;\n\n  if (initialMatches == null) {\n    // If we do not match a user-provided-route, fall back to the root\n    // to allow the error boundary to take over\n    let error = getInternalRouterError(404, {\n      pathname: init.history.location.pathname\n    });\n    let {\n      matches,\n      route\n    } = getShortCircuitMatches(dataRoutes);\n    initialMatches = matches;\n    initialErrors = {\n      [route.id]: error\n    };\n  }\n\n  let initialized = !initialMatches.some(m => m.route.loader) || init.hydrationData != null;\n  let router;\n  let state = {\n    historyAction: init.history.action,\n    location: init.history.location,\n    matches: initialMatches,\n    initialized,\n    navigation: IDLE_NAVIGATION,\n    // Don't restore on initial updateState() if we were SSR'd\n    restoreScrollPosition: init.hydrationData != null ? false : null,\n    preventScrollReset: false,\n    revalidation: \"idle\",\n    loaderData: init.hydrationData && init.hydrationData.loaderData || {},\n    actionData: init.hydrationData && init.hydrationData.actionData || null,\n    errors: init.hydrationData && init.hydrationData.errors || initialErrors,\n    fetchers: new Map()\n  }; // -- Stateful internal variables to manage navigations --\n  // Current navigation in progress (to be committed in completeNavigation)\n\n  let pendingAction = Action.Pop; // Should the current navigation prevent the scroll reset if scroll cannot\n  // be restored?\n\n  let pendingPreventScrollReset = false; // AbortController for the active navigation\n\n  let pendingNavigationController; // We use this to avoid touching history in completeNavigation if a\n  // revalidation is entirely uninterrupted\n\n  let isUninterruptedRevalidation = false; // Use this internal flag to force revalidation of all loaders:\n  //  - submissions (completed or interrupted)\n  //  - useRevalidate()\n  //  - X-Remix-Revalidate (from redirect)\n\n  let isRevalidationRequired = false; // Use this internal array to capture routes that require revalidation due\n  // to a cancelled deferred on action submission\n\n  let cancelledDeferredRoutes = []; // Use this internal array to capture fetcher loads that were cancelled by an\n  // action navigation and require revalidation\n\n  let cancelledFetcherLoads = []; // AbortControllers for any in-flight fetchers\n\n  let fetchControllers = new Map(); // Track loads based on the order in which they started\n\n  let incrementingLoadId = 0; // Track the outstanding pending navigation data load to be compared against\n  // the globally incrementing load when a fetcher load lands after a completed\n  // navigation\n\n  let pendingNavigationLoadId = -1; // Fetchers that triggered data reloads as a result of their actions\n\n  let fetchReloadIds = new Map(); // Fetchers that triggered redirect navigations from their actions\n\n  let fetchRedirectIds = new Set(); // Most recent href/match for fetcher.load calls for fetchers\n\n  let fetchLoadMatches = new Map(); // Store DeferredData instances for active route matches.  When a\n  // route loader returns defer() we stick one in here.  Then, when a nested\n  // promise resolves we update loaderData.  If a new navigation starts we\n  // cancel active deferreds for eliminated routes.\n\n  let activeDeferreds = new Map(); // Initialize the router, all side effects should be kicked off from here.\n  // Implemented as a Fluent API for ease of:\n  //   let router = createRouter(init).initialize();\n\n  function initialize() {\n    // If history informs us of a POP navigation, start the navigation but do not update\n    // state.  We'll update our own state once the navigation completes\n    unlistenHistory = init.history.listen(_ref => {\n      let {\n        action: historyAction,\n        location\n      } = _ref;\n      return startNavigation(historyAction, location);\n    }); // Kick off initial data load if needed.  Use Pop to avoid modifying history\n\n    if (!state.initialized) {\n      startNavigation(Action.Pop, state.location);\n    }\n\n    return router;\n  } // Clean up a router and it's side effects\n\n\n  function dispose() {\n    if (unlistenHistory) {\n      unlistenHistory();\n    }\n\n    subscribers.clear();\n    pendingNavigationController && pendingNavigationController.abort();\n    state.fetchers.forEach((_, key) => deleteFetcher(key));\n  } // Subscribe to state updates for the router\n\n\n  function subscribe(fn) {\n    subscribers.add(fn);\n    return () => subscribers.delete(fn);\n  } // Update our state and notify the calling context of the change\n\n\n  function updateState(newState) {\n    state = _extends({}, state, newState);\n    subscribers.forEach(subscriber => subscriber(state));\n  } // Complete a navigation returning the state.navigation back to the IDLE_NAVIGATION\n  // and setting state.[historyAction/location/matches] to the new route.\n  // - Location is a required param\n  // - Navigation will always be set to IDLE_NAVIGATION\n  // - Can pass any other state in newState\n\n\n  function completeNavigation(location, newState) {\n    var _location$state;\n\n    // Deduce if we're in a loading/actionReload state:\n    // - We have committed actionData in the store\n    // - The current navigation was a mutation submission\n    // - We're past the submitting state and into the loading state\n    // - The location being loaded is not the result of a redirect\n    let isActionReload = state.actionData != null && state.navigation.formMethod != null && isMutationMethod(state.navigation.formMethod) && state.navigation.state === \"loading\" && ((_location$state = location.state) == null ? void 0 : _location$state._isRedirect) !== true;\n    let actionData;\n\n    if (newState.actionData) {\n      if (Object.keys(newState.actionData).length > 0) {\n        actionData = newState.actionData;\n      } else {\n        // Empty actionData -> clear prior actionData due to an action error\n        actionData = null;\n      }\n    } else if (isActionReload) {\n      // Keep the current data if we're wrapping up the action reload\n      actionData = state.actionData;\n    } else {\n      // Clear actionData on any other completed navigations\n      actionData = null;\n    } // Always preserve any existing loaderData from re-used routes\n\n\n    let loaderData = newState.loaderData ? mergeLoaderData(state.loaderData, newState.loaderData, newState.matches || [], newState.errors) : state.loaderData;\n    updateState(_extends({}, newState, {\n      actionData,\n      loaderData,\n      historyAction: pendingAction,\n      location,\n      initialized: true,\n      navigation: IDLE_NAVIGATION,\n      revalidation: \"idle\",\n      // Don't restore on submission navigations\n      restoreScrollPosition: state.navigation.formData ? false : getSavedScrollPosition(location, newState.matches || state.matches),\n      preventScrollReset: pendingPreventScrollReset\n    }));\n\n    if (isUninterruptedRevalidation) ; else if (pendingAction === Action.Pop) ; else if (pendingAction === Action.Push) {\n      init.history.push(location, location.state);\n    } else if (pendingAction === Action.Replace) {\n      init.history.replace(location, location.state);\n    } // Reset stateful navigation vars\n\n\n    pendingAction = Action.Pop;\n    pendingPreventScrollReset = false;\n    isUninterruptedRevalidation = false;\n    isRevalidationRequired = false;\n    cancelledDeferredRoutes = [];\n    cancelledFetcherLoads = [];\n  } // Trigger a navigation event, which can either be a numerical POP or a PUSH\n  // replace with an optional submission\n\n\n  async function navigate(to, opts) {\n    if (typeof to === \"number\") {\n      init.history.go(to);\n      return;\n    }\n\n    let {\n      path,\n      submission,\n      error\n    } = normalizeNavigateOptions(to, opts);\n    let location = createLocation(state.location, path, opts && opts.state); // When using navigate as a PUSH/REPLACE we aren't reading an already-encoded\n    // URL from window.location, so we need to encode it here so the behavior\n    // remains the same as POP and non-data-router usages.  new URL() does all\n    // the same encoding we'd get from a history.pushState/window.location read\n    // without having to touch history\n\n    location = _extends({}, location, init.history.encodeLocation(location));\n    let userReplace = opts && opts.replace != null ? opts.replace : undefined;\n    let historyAction = Action.Push;\n\n    if (userReplace === true) {\n      historyAction = Action.Replace;\n    } else if (userReplace === false) ; else if (submission != null && isMutationMethod(submission.formMethod) && submission.formAction === state.location.pathname + state.location.search) {\n      // By default on submissions to the current location we REPLACE so that\n      // users don't have to double-click the back button to get to the prior\n      // location.  If the user redirects to a different location from the\n      // action/loader this will be ignored and the redirect will be a PUSH\n      historyAction = Action.Replace;\n    }\n\n    let preventScrollReset = opts && \"preventScrollReset\" in opts ? opts.preventScrollReset === true : undefined;\n    return await startNavigation(historyAction, location, {\n      submission,\n      // Send through the formData serialization error if we have one so we can\n      // render at the right error boundary after we match routes\n      pendingError: error,\n      preventScrollReset,\n      replace: opts && opts.replace\n    });\n  } // Revalidate all current loaders.  If a navigation is in progress or if this\n  // is interrupted by a navigation, allow this to \"succeed\" by calling all\n  // loaders during the next loader round\n\n\n  function revalidate() {\n    interruptActiveLoads();\n    updateState({\n      revalidation: \"loading\"\n    }); // If we're currently submitting an action, we don't need to start a new\n    // navigation, we'll just let the follow up loader execution call all loaders\n\n    if (state.navigation.state === \"submitting\") {\n      return;\n    } // If we're currently in an idle state, start a new navigation for the current\n    // action/location and mark it as uninterrupted, which will skip the history\n    // update in completeNavigation\n\n\n    if (state.navigation.state === \"idle\") {\n      startNavigation(state.historyAction, state.location, {\n        startUninterruptedRevalidation: true\n      });\n      return;\n    } // Otherwise, if we're currently in a loading state, just start a new\n    // navigation to the navigation.location but do not trigger an uninterrupted\n    // revalidation so that history correctly updates once the navigation completes\n\n\n    startNavigation(pendingAction || state.historyAction, state.navigation.location, {\n      overrideNavigation: state.navigation\n    });\n  } // Start a navigation to the given action/location.  Can optionally provide a\n  // overrideNavigation which will override the normalLoad in the case of a redirect\n  // navigation\n\n\n  async function startNavigation(historyAction, location, opts) {\n    // Abort any in-progress navigations and start a new one. Unset any ongoing\n    // uninterrupted revalidations unless told otherwise, since we want this\n    // new navigation to update history normally\n    pendingNavigationController && pendingNavigationController.abort();\n    pendingNavigationController = null;\n    pendingAction = historyAction;\n    isUninterruptedRevalidation = (opts && opts.startUninterruptedRevalidation) === true; // Save the current scroll position every time we start a new navigation,\n    // and track whether we should reset scroll on completion\n\n    saveScrollPosition(state.location, state.matches);\n    pendingPreventScrollReset = (opts && opts.preventScrollReset) === true;\n    let loadingNavigation = opts && opts.overrideNavigation;\n    let matches = matchRoutes(dataRoutes, location, init.basename); // Short circuit with a 404 on the root error boundary if we match nothing\n\n    if (!matches) {\n      let error = getInternalRouterError(404, {\n        pathname: location.pathname\n      });\n      let {\n        matches: notFoundMatches,\n        route\n      } = getShortCircuitMatches(dataRoutes); // Cancel all pending deferred on 404s since we don't keep any routes\n\n      cancelActiveDeferreds();\n      completeNavigation(location, {\n        matches: notFoundMatches,\n        loaderData: {},\n        errors: {\n          [route.id]: error\n        }\n      });\n      return;\n    } // Short circuit if it's only a hash change\n\n\n    if (isHashChangeOnly(state.location, location)) {\n      completeNavigation(location, {\n        matches\n      });\n      return;\n    } // Create a controller/Request for this navigation\n\n\n    pendingNavigationController = new AbortController();\n    let request = createClientSideRequest(location, pendingNavigationController.signal, opts && opts.submission);\n    let pendingActionData;\n    let pendingError;\n\n    if (opts && opts.pendingError) {\n      // If we have a pendingError, it means the user attempted a GET submission\n      // with binary FormData so assign here and skip to handleLoaders.  That\n      // way we handle calling loaders above the boundary etc.  It's not really\n      // different from an actionError in that sense.\n      pendingError = {\n        [findNearestBoundary(matches).route.id]: opts.pendingError\n      };\n    } else if (opts && opts.submission && isMutationMethod(opts.submission.formMethod)) {\n      // Call action if we received an action submission\n      let actionOutput = await handleAction(request, location, opts.submission, matches, {\n        replace: opts.replace\n      });\n\n      if (actionOutput.shortCircuited) {\n        return;\n      }\n\n      pendingActionData = actionOutput.pendingActionData;\n      pendingError = actionOutput.pendingActionError;\n\n      let navigation = _extends({\n        state: \"loading\",\n        location\n      }, opts.submission);\n\n      loadingNavigation = navigation; // Create a GET request for the loaders\n\n      request = new Request(request.url, {\n        signal: request.signal\n      });\n    } // Call loaders\n\n\n    let {\n      shortCircuited,\n      loaderData,\n      errors\n    } = await handleLoaders(request, location, matches, loadingNavigation, opts && opts.submission, opts && opts.replace, pendingActionData, pendingError);\n\n    if (shortCircuited) {\n      return;\n    } // Clean up now that the action/loaders have completed.  Don't clean up if\n    // we short circuited because pendingNavigationController will have already\n    // been assigned to a new controller for the next navigation\n\n\n    pendingNavigationController = null;\n    completeNavigation(location, _extends({\n      matches\n    }, pendingActionData ? {\n      actionData: pendingActionData\n    } : {}, {\n      loaderData,\n      errors\n    }));\n  } // Call the action matched by the leaf route for this navigation and handle\n  // redirects/errors\n\n\n  async function handleAction(request, location, submission, matches, opts) {\n    interruptActiveLoads(); // Put us in a submitting state\n\n    let navigation = _extends({\n      state: \"submitting\",\n      location\n    }, submission);\n\n    updateState({\n      navigation\n    }); // Call our action and get the result\n\n    let result;\n    let actionMatch = getTargetMatch(matches, location);\n\n    if (!actionMatch.route.action) {\n      result = {\n        type: ResultType.error,\n        error: getInternalRouterError(405, {\n          method: request.method,\n          pathname: location.pathname,\n          routeId: actionMatch.route.id\n        })\n      };\n    } else {\n      result = await callLoaderOrAction(\"action\", request, actionMatch, matches, router.basename);\n\n      if (request.signal.aborted) {\n        return {\n          shortCircuited: true\n        };\n      }\n    }\n\n    if (isRedirectResult(result)) {\n      let replace;\n\n      if (opts && opts.replace != null) {\n        replace = opts.replace;\n      } else {\n        // If the user didn't explicity indicate replace behavior, replace if\n        // we redirected to the exact same location we're currently at to avoid\n        // double back-buttons\n        replace = result.location === state.location.pathname + state.location.search;\n      }\n\n      await startRedirectNavigation(state, result, {\n        submission,\n        replace\n      });\n      return {\n        shortCircuited: true\n      };\n    }\n\n    if (isErrorResult(result)) {\n      // Store off the pending error - we use it to determine which loaders\n      // to call and will commit it when we complete the navigation\n      let boundaryMatch = findNearestBoundary(matches, actionMatch.route.id); // By default, all submissions are REPLACE navigations, but if the\n      // action threw an error that'll be rendered in an errorElement, we fall\n      // back to PUSH so that the user can use the back button to get back to\n      // the pre-submission form location to try again\n\n      if ((opts && opts.replace) !== true) {\n        pendingAction = Action.Push;\n      }\n\n      return {\n        // Send back an empty object we can use to clear out any prior actionData\n        pendingActionData: {},\n        pendingActionError: {\n          [boundaryMatch.route.id]: result.error\n        }\n      };\n    }\n\n    if (isDeferredResult(result)) {\n      throw new Error(\"defer() is not supported in actions\");\n    }\n\n    return {\n      pendingActionData: {\n        [actionMatch.route.id]: result.data\n      }\n    };\n  } // Call all applicable loaders for the given matches, handling redirects,\n  // errors, etc.\n\n\n  async function handleLoaders(request, location, matches, overrideNavigation, submission, replace, pendingActionData, pendingError) {\n    // Figure out the right navigation we want to use for data loading\n    let loadingNavigation = overrideNavigation;\n\n    if (!loadingNavigation) {\n      let navigation = _extends({\n        state: \"loading\",\n        location,\n        formMethod: undefined,\n        formAction: undefined,\n        formEncType: undefined,\n        formData: undefined\n      }, submission);\n\n      loadingNavigation = navigation;\n    } // If this was a redirect from an action we don't have a \"submission\" but\n    // we have it on the loading navigation so use that if available\n\n\n    let activeSubmission = submission ? submission : loadingNavigation.formMethod && loadingNavigation.formAction && loadingNavigation.formData && loadingNavigation.formEncType ? {\n      formMethod: loadingNavigation.formMethod,\n      formAction: loadingNavigation.formAction,\n      formData: loadingNavigation.formData,\n      formEncType: loadingNavigation.formEncType\n    } : undefined;\n    let [matchesToLoad, revalidatingFetchers] = getMatchesToLoad(state, matches, activeSubmission, location, isRevalidationRequired, cancelledDeferredRoutes, cancelledFetcherLoads, pendingActionData, pendingError, fetchLoadMatches); // Cancel pending deferreds for no-longer-matched routes or routes we're\n    // about to reload.  Note that if this is an action reload we would have\n    // already cancelled all pending deferreds so this would be a no-op\n\n    cancelActiveDeferreds(routeId => !(matches && matches.some(m => m.route.id === routeId)) || matchesToLoad && matchesToLoad.some(m => m.route.id === routeId)); // Short circuit if we have no loaders to run\n\n    if (matchesToLoad.length === 0 && revalidatingFetchers.length === 0) {\n      completeNavigation(location, _extends({\n        matches,\n        loaderData: {},\n        // Commit pending error if we're short circuiting\n        errors: pendingError || null\n      }, pendingActionData ? {\n        actionData: pendingActionData\n      } : {}));\n      return {\n        shortCircuited: true\n      };\n    } // If this is an uninterrupted revalidation, we remain in our current idle\n    // state.  If not, we need to switch to our loading state and load data,\n    // preserving any new action data or existing action data (in the case of\n    // a revalidation interrupting an actionReload)\n\n\n    if (!isUninterruptedRevalidation) {\n      revalidatingFetchers.forEach(_ref2 => {\n        let [key] = _ref2;\n        let fetcher = state.fetchers.get(key);\n        let revalidatingFetcher = {\n          state: \"loading\",\n          data: fetcher && fetcher.data,\n          formMethod: undefined,\n          formAction: undefined,\n          formEncType: undefined,\n          formData: undefined,\n          \" _hasFetcherDoneAnything \": true\n        };\n        state.fetchers.set(key, revalidatingFetcher);\n      });\n      let actionData = pendingActionData || state.actionData;\n      updateState(_extends({\n        navigation: loadingNavigation\n      }, actionData ? Object.keys(actionData).length === 0 ? {\n        actionData: null\n      } : {\n        actionData\n      } : {}, revalidatingFetchers.length > 0 ? {\n        fetchers: new Map(state.fetchers)\n      } : {}));\n    }\n\n    pendingNavigationLoadId = ++incrementingLoadId;\n    revalidatingFetchers.forEach(_ref3 => {\n      let [key] = _ref3;\n      return fetchControllers.set(key, pendingNavigationController);\n    });\n    let {\n      results,\n      loaderResults,\n      fetcherResults\n    } = await callLoadersAndMaybeResolveData(state.matches, matches, matchesToLoad, revalidatingFetchers, request);\n\n    if (request.signal.aborted) {\n      return {\n        shortCircuited: true\n      };\n    } // Clean up _after_ loaders have completed.  Don't clean up if we short\n    // circuited because fetchControllers would have been aborted and\n    // reassigned to new controllers for the next navigation\n\n\n    revalidatingFetchers.forEach(_ref4 => {\n      let [key] = _ref4;\n      return fetchControllers.delete(key);\n    }); // If any loaders returned a redirect Response, start a new REPLACE navigation\n\n    let redirect = findRedirect(results);\n\n    if (redirect) {\n      await startRedirectNavigation(state, redirect, {\n        replace\n      });\n      return {\n        shortCircuited: true\n      };\n    } // Process and commit output from loaders\n\n\n    let {\n      loaderData,\n      errors\n    } = processLoaderData(state, matches, matchesToLoad, loaderResults, pendingError, revalidatingFetchers, fetcherResults, activeDeferreds); // Wire up subscribers to update loaderData as promises settle\n\n    activeDeferreds.forEach((deferredData, routeId) => {\n      deferredData.subscribe(aborted => {\n        // Note: No need to updateState here since the TrackedPromise on\n        // loaderData is stable across resolve/reject\n        // Remove this instance if we were aborted or if promises have settled\n        if (aborted || deferredData.done) {\n          activeDeferreds.delete(routeId);\n        }\n      });\n    });\n    markFetchRedirectsDone();\n    let didAbortFetchLoads = abortStaleFetchLoads(pendingNavigationLoadId);\n    return _extends({\n      loaderData,\n      errors\n    }, didAbortFetchLoads || revalidatingFetchers.length > 0 ? {\n      fetchers: new Map(state.fetchers)\n    } : {});\n  }\n\n  function getFetcher(key) {\n    return state.fetchers.get(key) || IDLE_FETCHER;\n  } // Trigger a fetcher load/submit for the given fetcher key\n\n\n  function fetch(key, routeId, href, opts) {\n    if (isServer) {\n      throw new Error(\"router.fetch() was called during the server render, but it shouldn't be. \" + \"You are likely calling a useFetcher() method in the body of your component. \" + \"Try moving it to a useEffect or a callback.\");\n    }\n\n    if (fetchControllers.has(key)) abortFetcher(key);\n    let matches = matchRoutes(dataRoutes, href, init.basename);\n\n    if (!matches) {\n      setFetcherError(key, routeId, getInternalRouterError(404, {\n        pathname: href\n      }));\n      return;\n    }\n\n    let {\n      path,\n      submission\n    } = normalizeNavigateOptions(href, opts, true);\n    let match = getTargetMatch(matches, path);\n\n    if (submission && isMutationMethod(submission.formMethod)) {\n      handleFetcherAction(key, routeId, path, match, matches, submission);\n      return;\n    } // Store off the match so we can call it's shouldRevalidate on subsequent\n    // revalidations\n\n\n    fetchLoadMatches.set(key, [path, match, matches]);\n    handleFetcherLoader(key, routeId, path, match, matches, submission);\n  } // Call the action for the matched fetcher.submit(), and then handle redirects,\n  // errors, and revalidation\n\n\n  async function handleFetcherAction(key, routeId, path, match, requestMatches, submission) {\n    interruptActiveLoads();\n    fetchLoadMatches.delete(key);\n\n    if (!match.route.action) {\n      let error = getInternalRouterError(405, {\n        method: submission.formMethod,\n        pathname: path,\n        routeId: routeId\n      });\n      setFetcherError(key, routeId, error);\n      return;\n    } // Put this fetcher into it's submitting state\n\n\n    let existingFetcher = state.fetchers.get(key);\n\n    let fetcher = _extends({\n      state: \"submitting\"\n    }, submission, {\n      data: existingFetcher && existingFetcher.data,\n      \" _hasFetcherDoneAnything \": true\n    });\n\n    state.fetchers.set(key, fetcher);\n    updateState({\n      fetchers: new Map(state.fetchers)\n    }); // Call the action for the fetcher\n\n    let abortController = new AbortController();\n    let fetchRequest = createClientSideRequest(path, abortController.signal, submission);\n    fetchControllers.set(key, abortController);\n    let actionResult = await callLoaderOrAction(\"action\", fetchRequest, match, requestMatches, router.basename);\n\n    if (fetchRequest.signal.aborted) {\n      // We can delete this so long as we weren't aborted by ou our own fetcher\n      // re-submit which would have put _new_ controller is in fetchControllers\n      if (fetchControllers.get(key) === abortController) {\n        fetchControllers.delete(key);\n      }\n\n      return;\n    }\n\n    if (isRedirectResult(actionResult)) {\n      fetchControllers.delete(key);\n      fetchRedirectIds.add(key);\n\n      let loadingFetcher = _extends({\n        state: \"loading\"\n      }, submission, {\n        data: undefined,\n        \" _hasFetcherDoneAnything \": true\n      });\n\n      state.fetchers.set(key, loadingFetcher);\n      updateState({\n        fetchers: new Map(state.fetchers)\n      });\n      return startRedirectNavigation(state, actionResult, {\n        isFetchActionRedirect: true\n      });\n    } // Process any non-redirect errors thrown\n\n\n    if (isErrorResult(actionResult)) {\n      setFetcherError(key, routeId, actionResult.error);\n      return;\n    }\n\n    if (isDeferredResult(actionResult)) {\n      invariant(false, \"defer() is not supported in actions\");\n    } // Start the data load for current matches, or the next location if we're\n    // in the middle of a navigation\n\n\n    let nextLocation = state.navigation.location || state.location;\n    let revalidationRequest = createClientSideRequest(nextLocation, abortController.signal);\n    let matches = state.navigation.state !== \"idle\" ? matchRoutes(dataRoutes, state.navigation.location, init.basename) : state.matches;\n    invariant(matches, \"Didn't find any matches after fetcher action\");\n    let loadId = ++incrementingLoadId;\n    fetchReloadIds.set(key, loadId);\n\n    let loadFetcher = _extends({\n      state: \"loading\",\n      data: actionResult.data\n    }, submission, {\n      \" _hasFetcherDoneAnything \": true\n    });\n\n    state.fetchers.set(key, loadFetcher);\n    let [matchesToLoad, revalidatingFetchers] = getMatchesToLoad(state, matches, submission, nextLocation, isRevalidationRequired, cancelledDeferredRoutes, cancelledFetcherLoads, {\n      [match.route.id]: actionResult.data\n    }, undefined, // No need to send through errors since we short circuit above\n    fetchLoadMatches); // Put all revalidating fetchers into the loading state, except for the\n    // current fetcher which we want to keep in it's current loading state which\n    // contains it's action submission info + action data\n\n    revalidatingFetchers.filter(_ref5 => {\n      let [staleKey] = _ref5;\n      return staleKey !== key;\n    }).forEach(_ref6 => {\n      let [staleKey] = _ref6;\n      let existingFetcher = state.fetchers.get(staleKey);\n      let revalidatingFetcher = {\n        state: \"loading\",\n        data: existingFetcher && existingFetcher.data,\n        formMethod: undefined,\n        formAction: undefined,\n        formEncType: undefined,\n        formData: undefined,\n        \" _hasFetcherDoneAnything \": true\n      };\n      state.fetchers.set(staleKey, revalidatingFetcher);\n      fetchControllers.set(staleKey, abortController);\n    });\n    updateState({\n      fetchers: new Map(state.fetchers)\n    });\n    let {\n      results,\n      loaderResults,\n      fetcherResults\n    } = await callLoadersAndMaybeResolveData(state.matches, matches, matchesToLoad, revalidatingFetchers, revalidationRequest);\n\n    if (abortController.signal.aborted) {\n      return;\n    }\n\n    fetchReloadIds.delete(key);\n    fetchControllers.delete(key);\n    revalidatingFetchers.forEach(_ref7 => {\n      let [staleKey] = _ref7;\n      return fetchControllers.delete(staleKey);\n    });\n    let redirect = findRedirect(results);\n\n    if (redirect) {\n      return startRedirectNavigation(state, redirect);\n    } // Process and commit output from loaders\n\n\n    let {\n      loaderData,\n      errors\n    } = processLoaderData(state, state.matches, matchesToLoad, loaderResults, undefined, revalidatingFetchers, fetcherResults, activeDeferreds);\n    let doneFetcher = {\n      state: \"idle\",\n      data: actionResult.data,\n      formMethod: undefined,\n      formAction: undefined,\n      formEncType: undefined,\n      formData: undefined,\n      \" _hasFetcherDoneAnything \": true\n    };\n    state.fetchers.set(key, doneFetcher);\n    let didAbortFetchLoads = abortStaleFetchLoads(loadId); // If we are currently in a navigation loading state and this fetcher is\n    // more recent than the navigation, we want the newer data so abort the\n    // navigation and complete it with the fetcher data\n\n    if (state.navigation.state === \"loading\" && loadId > pendingNavigationLoadId) {\n      invariant(pendingAction, \"Expected pending action\");\n      pendingNavigationController && pendingNavigationController.abort();\n      completeNavigation(state.navigation.location, {\n        matches,\n        loaderData,\n        errors,\n        fetchers: new Map(state.fetchers)\n      });\n    } else {\n      // otherwise just update with the fetcher data, preserving any existing\n      // loaderData for loaders that did not need to reload.  We have to\n      // manually merge here since we aren't going through completeNavigation\n      updateState(_extends({\n        errors,\n        loaderData: mergeLoaderData(state.loaderData, loaderData, matches, errors)\n      }, didAbortFetchLoads ? {\n        fetchers: new Map(state.fetchers)\n      } : {}));\n      isRevalidationRequired = false;\n    }\n  } // Call the matched loader for fetcher.load(), handling redirects, errors, etc.\n\n\n  async function handleFetcherLoader(key, routeId, path, match, matches, submission) {\n    let existingFetcher = state.fetchers.get(key); // Put this fetcher into it's loading state\n\n    let loadingFetcher = _extends({\n      state: \"loading\",\n      formMethod: undefined,\n      formAction: undefined,\n      formEncType: undefined,\n      formData: undefined\n    }, submission, {\n      data: existingFetcher && existingFetcher.data,\n      \" _hasFetcherDoneAnything \": true\n    });\n\n    state.fetchers.set(key, loadingFetcher);\n    updateState({\n      fetchers: new Map(state.fetchers)\n    }); // Call the loader for this fetcher route match\n\n    let abortController = new AbortController();\n    let fetchRequest = createClientSideRequest(path, abortController.signal);\n    fetchControllers.set(key, abortController);\n    let result = await callLoaderOrAction(\"loader\", fetchRequest, match, matches, router.basename); // Deferred isn't supported or fetcher loads, await everything and treat it\n    // as a normal load.  resolveDeferredData will return undefined if this\n    // fetcher gets aborted, so we just leave result untouched and short circuit\n    // below if that happens\n\n    if (isDeferredResult(result)) {\n      result = (await resolveDeferredData(result, fetchRequest.signal, true)) || result;\n    } // We can delete this so long as we weren't aborted by ou our own fetcher\n    // re-load which would have put _new_ controller is in fetchControllers\n\n\n    if (fetchControllers.get(key) === abortController) {\n      fetchControllers.delete(key);\n    }\n\n    if (fetchRequest.signal.aborted) {\n      return;\n    } // If the loader threw a redirect Response, start a new REPLACE navigation\n\n\n    if (isRedirectResult(result)) {\n      await startRedirectNavigation(state, result);\n      return;\n    } // Process any non-redirect errors thrown\n\n\n    if (isErrorResult(result)) {\n      let boundaryMatch = findNearestBoundary(state.matches, routeId);\n      state.fetchers.delete(key); // TODO: In remix, this would reset to IDLE_NAVIGATION if it was a catch -\n      // do we need to behave any differently with our non-redirect errors?\n      // What if it was a non-redirect Response?\n\n      updateState({\n        fetchers: new Map(state.fetchers),\n        errors: {\n          [boundaryMatch.route.id]: result.error\n        }\n      });\n      return;\n    }\n\n    invariant(!isDeferredResult(result), \"Unhandled fetcher deferred data\"); // Put the fetcher back into an idle state\n\n    let doneFetcher = {\n      state: \"idle\",\n      data: result.data,\n      formMethod: undefined,\n      formAction: undefined,\n      formEncType: undefined,\n      formData: undefined,\n      \" _hasFetcherDoneAnything \": true\n    };\n    state.fetchers.set(key, doneFetcher);\n    updateState({\n      fetchers: new Map(state.fetchers)\n    });\n  }\n  /**\n   * Utility function to handle redirects returned from an action or loader.\n   * Normally, a redirect \"replaces\" the navigation that triggered it.  So, for\n   * example:\n   *\n   *  - user is on /a\n   *  - user clicks a link to /b\n   *  - loader for /b redirects to /c\n   *\n   * In a non-JS app the browser would track the in-flight navigation to /b and\n   * then replace it with /c when it encountered the redirect response.  In\n   * the end it would only ever update the URL bar with /c.\n   *\n   * In client-side routing using pushState/replaceState, we aim to emulate\n   * this behavior and we also do not update history until the end of the\n   * navigation (including processed redirects).  This means that we never\n   * actually touch history until we've processed redirects, so we just use\n   * the history action from the original navigation (PUSH or REPLACE).\n   */\n\n\n  async function startRedirectNavigation(state, redirect, _temp) {\n    var _window;\n\n    let {\n      submission,\n      replace,\n      isFetchActionRedirect\n    } = _temp === void 0 ? {} : _temp;\n\n    if (redirect.revalidate) {\n      isRevalidationRequired = true;\n    }\n\n    let redirectLocation = createLocation(state.location, redirect.location, // TODO: This can be removed once we get rid of useTransition in Remix v2\n    _extends({\n      _isRedirect: true\n    }, isFetchActionRedirect ? {\n      _isFetchActionRedirect: true\n    } : {}));\n    invariant(redirectLocation, \"Expected a location on the redirect navigation\"); // Check if this an external redirect that goes to a new origin\n\n    if (typeof ((_window = window) == null ? void 0 : _window.location) !== \"undefined\") {\n      let newOrigin = createClientSideURL(redirect.location).origin;\n\n      if (window.location.origin !== newOrigin) {\n        if (replace) {\n          window.location.replace(redirect.location);\n        } else {\n          window.location.assign(redirect.location);\n        }\n\n        return;\n      }\n    } // There's no need to abort on redirects, since we don't detect the\n    // redirect until the action/loaders have settled\n\n\n    pendingNavigationController = null;\n    let redirectHistoryAction = replace === true ? Action.Replace : Action.Push; // Use the incoming submission if provided, fallback on the active one in\n    // state.navigation\n\n    let {\n      formMethod,\n      formAction,\n      formEncType,\n      formData\n    } = state.navigation;\n\n    if (!submission && formMethod && formAction && formData && formEncType) {\n      submission = {\n        formMethod,\n        formAction,\n        formEncType,\n        formData\n      };\n    } // If this was a 307/308 submission we want to preserve the HTTP method and\n    // re-submit the GET/POST/PUT/PATCH/DELETE as a submission navigation to the\n    // redirected location\n\n\n    if (redirectPreserveMethodStatusCodes.has(redirect.status) && submission && isMutationMethod(submission.formMethod)) {\n      await startNavigation(redirectHistoryAction, redirectLocation, {\n        submission: _extends({}, submission, {\n          formAction: redirect.location\n        })\n      });\n    } else {\n      // Otherwise, we kick off a new loading navigation, preserving the\n      // submission info for the duration of this navigation\n      await startNavigation(redirectHistoryAction, redirectLocation, {\n        overrideNavigation: {\n          state: \"loading\",\n          location: redirectLocation,\n          formMethod: submission ? submission.formMethod : undefined,\n          formAction: submission ? submission.formAction : undefined,\n          formEncType: submission ? submission.formEncType : undefined,\n          formData: submission ? submission.formData : undefined\n        }\n      });\n    }\n  }\n\n  async function callLoadersAndMaybeResolveData(currentMatches, matches, matchesToLoad, fetchersToLoad, request) {\n    // Call all navigation loaders and revalidating fetcher loaders in parallel,\n    // then slice off the results into separate arrays so we can handle them\n    // accordingly\n    let results = await Promise.all([...matchesToLoad.map(match => callLoaderOrAction(\"loader\", request, match, matches, router.basename)), ...fetchersToLoad.map(_ref8 => {\n      let [, href, match, fetchMatches] = _ref8;\n      return callLoaderOrAction(\"loader\", createClientSideRequest(href, request.signal), match, fetchMatches, router.basename);\n    })]);\n    let loaderResults = results.slice(0, matchesToLoad.length);\n    let fetcherResults = results.slice(matchesToLoad.length);\n    await Promise.all([resolveDeferredResults(currentMatches, matchesToLoad, loaderResults, request.signal, false, state.loaderData), resolveDeferredResults(currentMatches, fetchersToLoad.map(_ref9 => {\n      let [,, match] = _ref9;\n      return match;\n    }), fetcherResults, request.signal, true)]);\n    return {\n      results,\n      loaderResults,\n      fetcherResults\n    };\n  }\n\n  function interruptActiveLoads() {\n    // Every interruption triggers a revalidation\n    isRevalidationRequired = true; // Cancel pending route-level deferreds and mark cancelled routes for\n    // revalidation\n\n    cancelledDeferredRoutes.push(...cancelActiveDeferreds()); // Abort in-flight fetcher loads\n\n    fetchLoadMatches.forEach((_, key) => {\n      if (fetchControllers.has(key)) {\n        cancelledFetcherLoads.push(key);\n        abortFetcher(key);\n      }\n    });\n  }\n\n  function setFetcherError(key, routeId, error) {\n    let boundaryMatch = findNearestBoundary(state.matches, routeId);\n    deleteFetcher(key);\n    updateState({\n      errors: {\n        [boundaryMatch.route.id]: error\n      },\n      fetchers: new Map(state.fetchers)\n    });\n  }\n\n  function deleteFetcher(key) {\n    if (fetchControllers.has(key)) abortFetcher(key);\n    fetchLoadMatches.delete(key);\n    fetchReloadIds.delete(key);\n    fetchRedirectIds.delete(key);\n    state.fetchers.delete(key);\n  }\n\n  function abortFetcher(key) {\n    let controller = fetchControllers.get(key);\n    invariant(controller, \"Expected fetch controller: \" + key);\n    controller.abort();\n    fetchControllers.delete(key);\n  }\n\n  function markFetchersDone(keys) {\n    for (let key of keys) {\n      let fetcher = getFetcher(key);\n      let doneFetcher = {\n        state: \"idle\",\n        data: fetcher.data,\n        formMethod: undefined,\n        formAction: undefined,\n        formEncType: undefined,\n        formData: undefined,\n        \" _hasFetcherDoneAnything \": true\n      };\n      state.fetchers.set(key, doneFetcher);\n    }\n  }\n\n  function markFetchRedirectsDone() {\n    let doneKeys = [];\n\n    for (let key of fetchRedirectIds) {\n      let fetcher = state.fetchers.get(key);\n      invariant(fetcher, \"Expected fetcher: \" + key);\n\n      if (fetcher.state === \"loading\") {\n        fetchRedirectIds.delete(key);\n        doneKeys.push(key);\n      }\n    }\n\n    markFetchersDone(doneKeys);\n  }\n\n  function abortStaleFetchLoads(landedId) {\n    let yeetedKeys = [];\n\n    for (let [key, id] of fetchReloadIds) {\n      if (id < landedId) {\n        let fetcher = state.fetchers.get(key);\n        invariant(fetcher, \"Expected fetcher: \" + key);\n\n        if (fetcher.state === \"loading\") {\n          abortFetcher(key);\n          fetchReloadIds.delete(key);\n          yeetedKeys.push(key);\n        }\n      }\n    }\n\n    markFetchersDone(yeetedKeys);\n    return yeetedKeys.length > 0;\n  }\n\n  function cancelActiveDeferreds(predicate) {\n    let cancelledRouteIds = [];\n    activeDeferreds.forEach((dfd, routeId) => {\n      if (!predicate || predicate(routeId)) {\n        // Cancel the deferred - but do not remove from activeDeferreds here -\n        // we rely on the subscribers to do that so our tests can assert proper\n        // cleanup via _internalActiveDeferreds\n        dfd.cancel();\n        cancelledRouteIds.push(routeId);\n        activeDeferreds.delete(routeId);\n      }\n    });\n    return cancelledRouteIds;\n  } // Opt in to capturing and reporting scroll positions during navigations,\n  // used by the <ScrollRestoration> component\n\n\n  function enableScrollRestoration(positions, getPosition, getKey) {\n    savedScrollPositions = positions;\n    getScrollPosition = getPosition;\n\n    getScrollRestorationKey = getKey || (location => location.key); // Perform initial hydration scroll restoration, since we miss the boat on\n    // the initial updateState() because we've not yet rendered <ScrollRestoration/>\n    // and therefore have no savedScrollPositions available\n\n\n    if (!initialScrollRestored && state.navigation === IDLE_NAVIGATION) {\n      initialScrollRestored = true;\n      let y = getSavedScrollPosition(state.location, state.matches);\n\n      if (y != null) {\n        updateState({\n          restoreScrollPosition: y\n        });\n      }\n    }\n\n    return () => {\n      savedScrollPositions = null;\n      getScrollPosition = null;\n      getScrollRestorationKey = null;\n    };\n  }\n\n  function saveScrollPosition(location, matches) {\n    if (savedScrollPositions && getScrollRestorationKey && getScrollPosition) {\n      let userMatches = matches.map(m => createUseMatchesMatch(m, state.loaderData));\n      let key = getScrollRestorationKey(location, userMatches) || location.key;\n      savedScrollPositions[key] = getScrollPosition();\n    }\n  }\n\n  function getSavedScrollPosition(location, matches) {\n    if (savedScrollPositions && getScrollRestorationKey && getScrollPosition) {\n      let userMatches = matches.map(m => createUseMatchesMatch(m, state.loaderData));\n      let key = getScrollRestorationKey(location, userMatches) || location.key;\n      let y = savedScrollPositions[key];\n\n      if (typeof y === \"number\") {\n        return y;\n      }\n    }\n\n    return null;\n  }\n\n  router = {\n    get basename() {\n      return init.basename;\n    },\n\n    get state() {\n      return state;\n    },\n\n    get routes() {\n      return dataRoutes;\n    },\n\n    initialize,\n    subscribe,\n    enableScrollRestoration,\n    navigate,\n    fetch,\n    revalidate,\n    // Passthrough to history-aware createHref used by useHref so we get proper\n    // hash-aware URLs in DOM paths\n    createHref: to => init.history.createHref(to),\n    encodeLocation: to => init.history.encodeLocation(to),\n    getFetcher,\n    deleteFetcher,\n    dispose,\n    _internalFetchControllers: fetchControllers,\n    _internalActiveDeferreds: activeDeferreds\n  };\n  return router;\n} //#endregion\n////////////////////////////////////////////////////////////////////////////////\n//#region createStaticHandler\n////////////////////////////////////////////////////////////////////////////////\n\nfunction createStaticHandler(routes, opts) {\n  invariant(routes.length > 0, \"You must provide a non-empty routes array to createStaticHandler\");\n  let dataRoutes = convertRoutesToDataRoutes(routes);\n  let basename = (opts ? opts.basename : null) || \"/\";\n  /**\n   * The query() method is intended for document requests, in which we want to\n   * call an optional action and potentially multiple loaders for all nested\n   * routes.  It returns a StaticHandlerContext object, which is very similar\n   * to the router state (location, loaderData, actionData, errors, etc.) and\n   * also adds SSR-specific information such as the statusCode and headers\n   * from action/loaders Responses.\n   *\n   * It _should_ never throw and should report all errors through the\n   * returned context.errors object, properly associating errors to their error\n   * boundary.  Additionally, it tracks _deepestRenderedBoundaryId which can be\n   * used to emulate React error boundaries during SSr by performing a second\n   * pass only down to the boundaryId.\n   *\n   * The one exception where we do not return a StaticHandlerContext is when a\n   * redirect response is returned or thrown from any action/loader.  We\n   * propagate that out and return the raw Response so the HTTP server can\n   * return it directly.\n   */\n\n  async function query(request, _temp2) {\n    let {\n      requestContext\n    } = _temp2 === void 0 ? {} : _temp2;\n    let url = new URL(request.url);\n    let method = request.method.toLowerCase();\n    let location = createLocation(\"\", createPath(url), null, \"default\");\n    let matches = matchRoutes(dataRoutes, location, basename); // SSR supports HEAD requests while SPA doesn't\n\n    if (!isValidMethod(method) && method !== \"head\") {\n      let error = getInternalRouterError(405, {\n        method\n      });\n      let {\n        matches: methodNotAllowedMatches,\n        route\n      } = getShortCircuitMatches(dataRoutes);\n      return {\n        basename,\n        location,\n        matches: methodNotAllowedMatches,\n        loaderData: {},\n        actionData: null,\n        errors: {\n          [route.id]: error\n        },\n        statusCode: error.status,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n    } else if (!matches) {\n      let error = getInternalRouterError(404, {\n        pathname: location.pathname\n      });\n      let {\n        matches: notFoundMatches,\n        route\n      } = getShortCircuitMatches(dataRoutes);\n      return {\n        basename,\n        location,\n        matches: notFoundMatches,\n        loaderData: {},\n        actionData: null,\n        errors: {\n          [route.id]: error\n        },\n        statusCode: error.status,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n    }\n\n    let result = await queryImpl(request, location, matches, requestContext);\n\n    if (isResponse(result)) {\n      return result;\n    } // When returning StaticHandlerContext, we patch back in the location here\n    // since we need it for React Context.  But this helps keep our submit and\n    // loadRouteData operating on a Request instead of a Location\n\n\n    return _extends({\n      location,\n      basename\n    }, result);\n  }\n  /**\n   * The queryRoute() method is intended for targeted route requests, either\n   * for fetch ?_data requests or resource route requests.  In this case, we\n   * are only ever calling a single action or loader, and we are returning the\n   * returned value directly.  In most cases, this will be a Response returned\n   * from the action/loader, but it may be a primitive or other value as well -\n   * and in such cases the calling context should handle that accordingly.\n   *\n   * We do respect the throw/return differentiation, so if an action/loader\n   * throws, then this method will throw the value.  This is important so we\n   * can do proper boundary identification in Remix where a thrown Response\n   * must go to the Catch Boundary but a returned Response is happy-path.\n   *\n   * One thing to note is that any Router-initiated Errors that make sense\n   * to associate with a status code will be thrown as an ErrorResponse\n   * instance which include the raw Error, such that the calling context can\n   * serialize the error as they see fit while including the proper response\n   * code.  Examples here are 404 and 405 errors that occur prior to reaching\n   * any user-defined loaders.\n   */\n\n\n  async function queryRoute(request, _temp3) {\n    let {\n      routeId,\n      requestContext\n    } = _temp3 === void 0 ? {} : _temp3;\n    let url = new URL(request.url);\n    let method = request.method.toLowerCase();\n    let location = createLocation(\"\", createPath(url), null, \"default\");\n    let matches = matchRoutes(dataRoutes, location, basename); // SSR supports HEAD requests while SPA doesn't\n\n    if (!isValidMethod(method) && method !== \"head\") {\n      throw getInternalRouterError(405, {\n        method\n      });\n    } else if (!matches) {\n      throw getInternalRouterError(404, {\n        pathname: location.pathname\n      });\n    }\n\n    let match = routeId ? matches.find(m => m.route.id === routeId) : getTargetMatch(matches, location);\n\n    if (routeId && !match) {\n      throw getInternalRouterError(403, {\n        pathname: location.pathname,\n        routeId\n      });\n    } else if (!match) {\n      // This should never hit I don't think?\n      throw getInternalRouterError(404, {\n        pathname: location.pathname\n      });\n    }\n\n    let result = await queryImpl(request, location, matches, requestContext, match);\n\n    if (isResponse(result)) {\n      return result;\n    }\n\n    let error = result.errors ? Object.values(result.errors)[0] : undefined;\n\n    if (error !== undefined) {\n      // If we got back result.errors, that means the loader/action threw\n      // _something_ that wasn't a Response, but it's not guaranteed/required\n      // to be an `instanceof Error` either, so we have to use throw here to\n      // preserve the \"error\" state outside of queryImpl.\n      throw error;\n    } // Pick off the right state value to return\n\n\n    let routeData = [result.actionData, result.loaderData].find(v => v);\n    return Object.values(routeData || {})[0];\n  }\n\n  async function queryImpl(request, location, matches, requestContext, routeMatch) {\n    invariant(request.signal, \"query()/queryRoute() requests must contain an AbortController signal\");\n\n    try {\n      if (isMutationMethod(request.method.toLowerCase())) {\n        let result = await submit(request, matches, routeMatch || getTargetMatch(matches, location), requestContext, routeMatch != null);\n        return result;\n      }\n\n      let result = await loadRouteData(request, matches, requestContext, routeMatch);\n      return isResponse(result) ? result : _extends({}, result, {\n        actionData: null,\n        actionHeaders: {}\n      });\n    } catch (e) {\n      // If the user threw/returned a Response in callLoaderOrAction, we throw\n      // it to bail out and then return or throw here based on whether the user\n      // returned or threw\n      if (isQueryRouteResponse(e)) {\n        if (e.type === ResultType.error && !isRedirectResponse(e.response)) {\n          throw e.response;\n        }\n\n        return e.response;\n      } // Redirects are always returned since they don't propagate to catch\n      // boundaries\n\n\n      if (isRedirectResponse(e)) {\n        return e;\n      }\n\n      throw e;\n    }\n  }\n\n  async function submit(request, matches, actionMatch, requestContext, isRouteRequest) {\n    let result;\n\n    if (!actionMatch.route.action) {\n      let error = getInternalRouterError(405, {\n        method: request.method,\n        pathname: new URL(request.url).pathname,\n        routeId: actionMatch.route.id\n      });\n\n      if (isRouteRequest) {\n        throw error;\n      }\n\n      result = {\n        type: ResultType.error,\n        error\n      };\n    } else {\n      result = await callLoaderOrAction(\"action\", request, actionMatch, matches, basename, true, isRouteRequest, requestContext);\n\n      if (request.signal.aborted) {\n        let method = isRouteRequest ? \"queryRoute\" : \"query\";\n        throw new Error(method + \"() call aborted\");\n      }\n    }\n\n    if (isRedirectResult(result)) {\n      // Uhhhh - this should never happen, we should always throw these from\n      // callLoaderOrAction, but the type narrowing here keeps TS happy and we\n      // can get back on the \"throw all redirect responses\" train here should\n      // this ever happen :/\n      throw new Response(null, {\n        status: result.status,\n        headers: {\n          Location: result.location\n        }\n      });\n    }\n\n    if (isDeferredResult(result)) {\n      throw new Error(\"defer() is not supported in actions\");\n    }\n\n    if (isRouteRequest) {\n      // Note: This should only be non-Response values if we get here, since\n      // isRouteRequest should throw any Response received in callLoaderOrAction\n      if (isErrorResult(result)) {\n        throw result.error;\n      }\n\n      return {\n        matches: [actionMatch],\n        loaderData: {},\n        actionData: {\n          [actionMatch.route.id]: result.data\n        },\n        errors: null,\n        // Note: statusCode + headers are unused here since queryRoute will\n        // return the raw Response or value\n        statusCode: 200,\n        loaderHeaders: {},\n        actionHeaders: {}\n      };\n    }\n\n    if (isErrorResult(result)) {\n      // Store off the pending error - we use it to determine which loaders\n      // to call and will commit it when we complete the navigation\n      let boundaryMatch = findNearestBoundary(matches, actionMatch.route.id);\n      let context = await loadRouteData(request, matches, requestContext, undefined, {\n        [boundaryMatch.route.id]: result.error\n      }); // action status codes take precedence over loader status codes\n\n      return _extends({}, context, {\n        statusCode: isRouteErrorResponse(result.error) ? result.error.status : 500,\n        actionData: null,\n        actionHeaders: _extends({}, result.headers ? {\n          [actionMatch.route.id]: result.headers\n        } : {})\n      });\n    } // Create a GET request for the loaders\n\n\n    let loaderRequest = new Request(request.url, {\n      headers: request.headers,\n      redirect: request.redirect,\n      signal: request.signal\n    });\n    let context = await loadRouteData(loaderRequest, matches, requestContext);\n    return _extends({}, context, result.statusCode ? {\n      statusCode: result.statusCode\n    } : {}, {\n      actionData: {\n        [actionMatch.route.id]: result.data\n      },\n      actionHeaders: _extends({}, result.headers ? {\n        [actionMatch.route.id]: result.headers\n      } : {})\n    });\n  }\n\n  async function loadRouteData(request, matches, requestContext, routeMatch, pendingActionError) {\n    let isRouteRequest = routeMatch != null; // Short circuit if we have no loaders to run (queryRoute())\n\n    if (isRouteRequest && !(routeMatch != null && routeMatch.route.loader)) {\n      throw getInternalRouterError(400, {\n        method: request.method,\n        pathname: new URL(request.url).pathname,\n        routeId: routeMatch == null ? void 0 : routeMatch.route.id\n      });\n    }\n\n    let requestMatches = routeMatch ? [routeMatch] : getLoaderMatchesUntilBoundary(matches, Object.keys(pendingActionError || {})[0]);\n    let matchesToLoad = requestMatches.filter(m => m.route.loader); // Short circuit if we have no loaders to run (query())\n\n    if (matchesToLoad.length === 0) {\n      return {\n        matches,\n        // Add a null for all matched routes for proper revalidation on the client\n        loaderData: matches.reduce((acc, m) => Object.assign(acc, {\n          [m.route.id]: null\n        }), {}),\n        errors: pendingActionError || null,\n        statusCode: 200,\n        loaderHeaders: {}\n      };\n    }\n\n    let results = await Promise.all([...matchesToLoad.map(match => callLoaderOrAction(\"loader\", request, match, matches, basename, true, isRouteRequest, requestContext))]);\n\n    if (request.signal.aborted) {\n      let method = isRouteRequest ? \"queryRoute\" : \"query\";\n      throw new Error(method + \"() call aborted\");\n    }\n\n    let executedLoaders = new Set();\n    results.forEach((result, i) => {\n      executedLoaders.add(matchesToLoad[i].route.id); // Can't do anything with these without the Remix side of things, so just\n      // cancel them for now\n\n      if (isDeferredResult(result)) {\n        result.deferredData.cancel();\n      }\n    }); // Process and commit output from loaders\n\n    let context = processRouteLoaderData(matches, matchesToLoad, results, pendingActionError); // Add a null for any non-loader matches for proper revalidation on the client\n\n    matches.forEach(match => {\n      if (!executedLoaders.has(match.route.id)) {\n        context.loaderData[match.route.id] = null;\n      }\n    });\n    return _extends({}, context, {\n      matches\n    });\n  }\n\n  return {\n    dataRoutes,\n    query,\n    queryRoute\n  };\n} //#endregion\n////////////////////////////////////////////////////////////////////////////////\n//#region Helpers\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Given an existing StaticHandlerContext and an error thrown at render time,\n * provide an updated StaticHandlerContext suitable for a second SSR render\n */\n\nfunction getStaticContextFromError(routes, context, error) {\n  let newContext = _extends({}, context, {\n    statusCode: 500,\n    errors: {\n      [context._deepestRenderedBoundaryId || routes[0].id]: error\n    }\n  });\n\n  return newContext;\n}\n\nfunction isSubmissionNavigation(opts) {\n  return opts != null && \"formData\" in opts;\n} // Normalize navigation options by converting formMethod=GET formData objects to\n// URLSearchParams so they behave identically to links with query params\n\n\nfunction normalizeNavigateOptions(to, opts, isFetcher) {\n  if (isFetcher === void 0) {\n    isFetcher = false;\n  }\n\n  let path = typeof to === \"string\" ? to : createPath(to); // Return location verbatim on non-submission navigations\n\n  if (!opts || !isSubmissionNavigation(opts)) {\n    return {\n      path\n    };\n  }\n\n  if (opts.formMethod && !isValidMethod(opts.formMethod)) {\n    return {\n      path,\n      error: getInternalRouterError(405, {\n        method: opts.formMethod\n      })\n    };\n  } // Create a Submission on non-GET navigations\n\n\n  let submission;\n\n  if (opts.formData) {\n    submission = {\n      formMethod: opts.formMethod || \"get\",\n      formAction: stripHashFromPath(path),\n      formEncType: opts && opts.formEncType || \"application/x-www-form-urlencoded\",\n      formData: opts.formData\n    };\n\n    if (isMutationMethod(submission.formMethod)) {\n      return {\n        path,\n        submission\n      };\n    }\n  } // Flatten submission onto URLSearchParams for GET submissions\n\n\n  let parsedPath = parsePath(path);\n\n  try {\n    let searchParams = convertFormDataToSearchParams(opts.formData); // Since fetcher GET submissions only run a single loader (as opposed to\n    // navigation GET submissions which run all loaders), we need to preserve\n    // any incoming ?index params\n\n    if (isFetcher && parsedPath.search && hasNakedIndexQuery(parsedPath.search)) {\n      searchParams.append(\"index\", \"\");\n    }\n\n    parsedPath.search = \"?\" + searchParams;\n  } catch (e) {\n    return {\n      path,\n      error: getInternalRouterError(400)\n    };\n  }\n\n  return {\n    path: createPath(parsedPath),\n    submission\n  };\n} // Filter out all routes below any caught error as they aren't going to\n// render so we don't need to load them\n\n\nfunction getLoaderMatchesUntilBoundary(matches, boundaryId) {\n  let boundaryMatches = matches;\n\n  if (boundaryId) {\n    let index = matches.findIndex(m => m.route.id === boundaryId);\n\n    if (index >= 0) {\n      boundaryMatches = matches.slice(0, index);\n    }\n  }\n\n  return boundaryMatches;\n}\n\nfunction getMatchesToLoad(state, matches, submission, location, isRevalidationRequired, cancelledDeferredRoutes, cancelledFetcherLoads, pendingActionData, pendingError, fetchLoadMatches) {\n  let actionResult = pendingError ? Object.values(pendingError)[0] : pendingActionData ? Object.values(pendingActionData)[0] : undefined; // Pick navigation matches that are net-new or qualify for revalidation\n\n  let boundaryId = pendingError ? Object.keys(pendingError)[0] : undefined;\n  let boundaryMatches = getLoaderMatchesUntilBoundary(matches, boundaryId);\n  let navigationMatches = boundaryMatches.filter((match, index) => match.route.loader != null && (isNewLoader(state.loaderData, state.matches[index], match) || // If this route had a pending deferred cancelled it must be revalidated\n  cancelledDeferredRoutes.some(id => id === match.route.id) || shouldRevalidateLoader(state.location, state.matches[index], submission, location, match, isRevalidationRequired, actionResult))); // Pick fetcher.loads that need to be revalidated\n\n  let revalidatingFetchers = [];\n  fetchLoadMatches && fetchLoadMatches.forEach((_ref10, key) => {\n    let [href, match, fetchMatches] = _ref10;\n\n    // This fetcher was cancelled from a prior action submission - force reload\n    if (cancelledFetcherLoads.includes(key)) {\n      revalidatingFetchers.push([key, href, match, fetchMatches]);\n    } else if (isRevalidationRequired) {\n      let shouldRevalidate = shouldRevalidateLoader(href, match, submission, href, match, isRevalidationRequired, actionResult);\n\n      if (shouldRevalidate) {\n        revalidatingFetchers.push([key, href, match, fetchMatches]);\n      }\n    }\n  });\n  return [navigationMatches, revalidatingFetchers];\n}\n\nfunction isNewLoader(currentLoaderData, currentMatch, match) {\n  let isNew = // [a] -> [a, b]\n  !currentMatch || // [a, b] -> [a, c]\n  match.route.id !== currentMatch.route.id; // Handle the case that we don't have data for a re-used route, potentially\n  // from a prior error or from a cancelled pending deferred\n\n  let isMissingData = currentLoaderData[match.route.id] === undefined; // Always load if this is a net-new route or we don't yet have data\n\n  return isNew || isMissingData;\n}\n\nfunction isNewRouteInstance(currentMatch, match) {\n  let currentPath = currentMatch.route.path;\n  return (// param change for this match, /users/123 -> /users/456\n    currentMatch.pathname !== match.pathname || // splat param changed, which is not present in match.path\n    // e.g. /files/images/avatar.jpg -> files/finances.xls\n    currentPath && currentPath.endsWith(\"*\") && currentMatch.params[\"*\"] !== match.params[\"*\"]\n  );\n}\n\nfunction shouldRevalidateLoader(currentLocation, currentMatch, submission, location, match, isRevalidationRequired, actionResult) {\n  let currentUrl = createClientSideURL(currentLocation);\n  let currentParams = currentMatch.params;\n  let nextUrl = createClientSideURL(location);\n  let nextParams = match.params; // This is the default implementation as to when we revalidate.  If the route\n  // provides it's own implementation, then we give them full control but\n  // provide this value so they can leverage it if needed after they check\n  // their own specific use cases\n  // Note that fetchers always provide the same current/next locations so the\n  // URL-based checks here don't apply to fetcher shouldRevalidate calls\n\n  let defaultShouldRevalidate = isNewRouteInstance(currentMatch, match) || // Clicked the same link, resubmitted a GET form\n  currentUrl.toString() === nextUrl.toString() || // Search params affect all loaders\n  currentUrl.search !== nextUrl.search || // Forced revalidation due to submission, useRevalidate, or X-Remix-Revalidate\n  isRevalidationRequired;\n\n  if (match.route.shouldRevalidate) {\n    let routeChoice = match.route.shouldRevalidate(_extends({\n      currentUrl,\n      currentParams,\n      nextUrl,\n      nextParams\n    }, submission, {\n      actionResult,\n      defaultShouldRevalidate\n    }));\n\n    if (typeof routeChoice === \"boolean\") {\n      return routeChoice;\n    }\n  }\n\n  return defaultShouldRevalidate;\n}\n\nasync function callLoaderOrAction(type, request, match, matches, basename, isStaticRequest, isRouteRequest, requestContext) {\n  if (basename === void 0) {\n    basename = \"/\";\n  }\n\n  if (isStaticRequest === void 0) {\n    isStaticRequest = false;\n  }\n\n  if (isRouteRequest === void 0) {\n    isRouteRequest = false;\n  }\n\n  let resultType;\n  let result; // Setup a promise we can race against so that abort signals short circuit\n\n  let reject;\n  let abortPromise = new Promise((_, r) => reject = r);\n\n  let onReject = () => reject();\n\n  request.signal.addEventListener(\"abort\", onReject);\n\n  try {\n    let handler = match.route[type];\n    invariant(handler, \"Could not find the \" + type + \" to run on the \\\"\" + match.route.id + \"\\\" route\");\n    result = await Promise.race([handler({\n      request,\n      params: match.params,\n      context: requestContext\n    }), abortPromise]);\n    invariant(result !== undefined, \"You defined \" + (type === \"action\" ? \"an action\" : \"a loader\") + \" for route \" + (\"\\\"\" + match.route.id + \"\\\" but didn't return anything from your `\" + type + \"` \") + \"function. Please return a value or `null`.\");\n  } catch (e) {\n    resultType = ResultType.error;\n    result = e;\n  } finally {\n    request.signal.removeEventListener(\"abort\", onReject);\n  }\n\n  if (isResponse(result)) {\n    let status = result.status; // Process redirects\n\n    if (redirectStatusCodes.has(status)) {\n      let location = result.headers.get(\"Location\");\n      invariant(location, \"Redirects returned/thrown from loaders/actions must have a Location header\");\n      let isAbsolute = /^[a-z+]+:\\/\\//i.test(location) || location.startsWith(\"//\"); // Support relative routing in internal redirects\n\n      if (!isAbsolute) {\n        let activeMatches = matches.slice(0, matches.indexOf(match) + 1);\n        let routePathnames = getPathContributingMatches(activeMatches).map(match => match.pathnameBase);\n        let resolvedLocation = resolveTo(location, routePathnames, new URL(request.url).pathname);\n        invariant(createPath(resolvedLocation), \"Unable to resolve redirect location: \" + location); // Prepend the basename to the redirect location if we have one\n\n        if (basename) {\n          let path = resolvedLocation.pathname;\n          resolvedLocation.pathname = path === \"/\" ? basename : joinPaths([basename, path]);\n        }\n\n        location = createPath(resolvedLocation);\n      } // Don't process redirects in the router during static requests requests.\n      // Instead, throw the Response and let the server handle it with an HTTP\n      // redirect.  We also update the Location header in place in this flow so\n      // basename and relative routing is taken into account\n\n\n      if (isStaticRequest) {\n        result.headers.set(\"Location\", location);\n        throw result;\n      }\n\n      return {\n        type: ResultType.redirect,\n        status,\n        location,\n        revalidate: result.headers.get(\"X-Remix-Revalidate\") !== null\n      };\n    } // For SSR single-route requests, we want to hand Responses back directly\n    // without unwrapping.  We do this with the QueryRouteResponse wrapper\n    // interface so we can know whether it was returned or thrown\n\n\n    if (isRouteRequest) {\n      // eslint-disable-next-line no-throw-literal\n      throw {\n        type: resultType || ResultType.data,\n        response: result\n      };\n    }\n\n    let data;\n    let contentType = result.headers.get(\"Content-Type\"); // Check between word boundaries instead of startsWith() due to the last\n    // paragraph of https://httpwg.org/specs/rfc9110.html#field.content-type\n\n    if (contentType && /\\bapplication\\/json\\b/.test(contentType)) {\n      data = await result.json();\n    } else {\n      data = await result.text();\n    }\n\n    if (resultType === ResultType.error) {\n      return {\n        type: resultType,\n        error: new ErrorResponse(status, result.statusText, data),\n        headers: result.headers\n      };\n    }\n\n    return {\n      type: ResultType.data,\n      data,\n      statusCode: result.status,\n      headers: result.headers\n    };\n  }\n\n  if (resultType === ResultType.error) {\n    return {\n      type: resultType,\n      error: result\n    };\n  }\n\n  if (result instanceof DeferredData) {\n    return {\n      type: ResultType.deferred,\n      deferredData: result\n    };\n  }\n\n  return {\n    type: ResultType.data,\n    data: result\n  };\n} // Utility method for creating the Request instances for loaders/actions during\n// client-side navigations and fetches.  During SSR we will always have a\n// Request instance from the static handler (query/queryRoute)\n\n\nfunction createClientSideRequest(location, signal, submission) {\n  let url = createClientSideURL(stripHashFromPath(location)).toString();\n  let init = {\n    signal\n  };\n\n  if (submission && isMutationMethod(submission.formMethod)) {\n    let {\n      formMethod,\n      formEncType,\n      formData\n    } = submission;\n    init.method = formMethod.toUpperCase();\n    init.body = formEncType === \"application/x-www-form-urlencoded\" ? convertFormDataToSearchParams(formData) : formData;\n  } // Content-Type is inferred (https://fetch.spec.whatwg.org/#dom-request)\n\n\n  return new Request(url, init);\n}\n\nfunction convertFormDataToSearchParams(formData) {\n  let searchParams = new URLSearchParams();\n\n  for (let [key, value] of formData.entries()) {\n    invariant(typeof value === \"string\", 'File inputs are not supported with encType \"application/x-www-form-urlencoded\", ' + 'please use \"multipart/form-data\" instead.');\n    searchParams.append(key, value);\n  }\n\n  return searchParams;\n}\n\nfunction processRouteLoaderData(matches, matchesToLoad, results, pendingError, activeDeferreds) {\n  // Fill in loaderData/errors from our loaders\n  let loaderData = {};\n  let errors = null;\n  let statusCode;\n  let foundError = false;\n  let loaderHeaders = {}; // Process loader results into state.loaderData/state.errors\n\n  results.forEach((result, index) => {\n    let id = matchesToLoad[index].route.id;\n    invariant(!isRedirectResult(result), \"Cannot handle redirect results in processLoaderData\");\n\n    if (isErrorResult(result)) {\n      // Look upwards from the matched route for the closest ancestor\n      // error boundary, defaulting to the root match\n      let boundaryMatch = findNearestBoundary(matches, id);\n      let error = result.error; // If we have a pending action error, we report it at the highest-route\n      // that throws a loader error, and then clear it out to indicate that\n      // it was consumed\n\n      if (pendingError) {\n        error = Object.values(pendingError)[0];\n        pendingError = undefined;\n      }\n\n      errors = errors || {}; // Prefer higher error values if lower errors bubble to the same boundary\n\n      if (errors[boundaryMatch.route.id] == null) {\n        errors[boundaryMatch.route.id] = error;\n      } // Clear our any prior loaderData for the throwing route\n\n\n      loaderData[id] = undefined; // Once we find our first (highest) error, we set the status code and\n      // prevent deeper status codes from overriding\n\n      if (!foundError) {\n        foundError = true;\n        statusCode = isRouteErrorResponse(result.error) ? result.error.status : 500;\n      }\n\n      if (result.headers) {\n        loaderHeaders[id] = result.headers;\n      }\n    } else if (isDeferredResult(result)) {\n      activeDeferreds && activeDeferreds.set(id, result.deferredData);\n      loaderData[id] = result.deferredData.data; // TODO: Add statusCode/headers once we wire up streaming in Remix\n    } else {\n      loaderData[id] = result.data; // Error status codes always override success status codes, but if all\n      // loaders are successful we take the deepest status code.\n\n      if (result.statusCode != null && result.statusCode !== 200 && !foundError) {\n        statusCode = result.statusCode;\n      }\n\n      if (result.headers) {\n        loaderHeaders[id] = result.headers;\n      }\n    }\n  }); // If we didn't consume the pending action error (i.e., all loaders\n  // resolved), then consume it here.  Also clear out any loaderData for the\n  // throwing route\n\n  if (pendingError) {\n    errors = pendingError;\n    loaderData[Object.keys(pendingError)[0]] = undefined;\n  }\n\n  return {\n    loaderData,\n    errors,\n    statusCode: statusCode || 200,\n    loaderHeaders\n  };\n}\n\nfunction processLoaderData(state, matches, matchesToLoad, results, pendingError, revalidatingFetchers, fetcherResults, activeDeferreds) {\n  let {\n    loaderData,\n    errors\n  } = processRouteLoaderData(matches, matchesToLoad, results, pendingError, activeDeferreds); // Process results from our revalidating fetchers\n\n  for (let index = 0; index < revalidatingFetchers.length; index++) {\n    let [key,, match] = revalidatingFetchers[index];\n    invariant(fetcherResults !== undefined && fetcherResults[index] !== undefined, \"Did not find corresponding fetcher result\");\n    let result = fetcherResults[index]; // Process fetcher non-redirect errors\n\n    if (isErrorResult(result)) {\n      let boundaryMatch = findNearestBoundary(state.matches, match.route.id);\n\n      if (!(errors && errors[boundaryMatch.route.id])) {\n        errors = _extends({}, errors, {\n          [boundaryMatch.route.id]: result.error\n        });\n      }\n\n      state.fetchers.delete(key);\n    } else if (isRedirectResult(result)) {\n      // Should never get here, redirects should get processed above, but we\n      // keep this to type narrow to a success result in the else\n      throw new Error(\"Unhandled fetcher revalidation redirect\");\n    } else if (isDeferredResult(result)) {\n      // Should never get here, deferred data should be awaited for fetchers\n      // in resolveDeferredResults\n      throw new Error(\"Unhandled fetcher deferred data\");\n    } else {\n      let doneFetcher = {\n        state: \"idle\",\n        data: result.data,\n        formMethod: undefined,\n        formAction: undefined,\n        formEncType: undefined,\n        formData: undefined,\n        \" _hasFetcherDoneAnything \": true\n      };\n      state.fetchers.set(key, doneFetcher);\n    }\n  }\n\n  return {\n    loaderData,\n    errors\n  };\n}\n\nfunction mergeLoaderData(loaderData, newLoaderData, matches, errors) {\n  let mergedLoaderData = _extends({}, newLoaderData);\n\n  for (let match of matches) {\n    let id = match.route.id;\n\n    if (newLoaderData.hasOwnProperty(id)) {\n      if (newLoaderData[id] !== undefined) {\n        mergedLoaderData[id] = newLoaderData[id];\n      }\n    } else if (loaderData[id] !== undefined) {\n      mergedLoaderData[id] = loaderData[id];\n    }\n\n    if (errors && errors.hasOwnProperty(id)) {\n      // Don't keep any loader data below the boundary\n      break;\n    }\n  }\n\n  return mergedLoaderData;\n} // Find the nearest error boundary, looking upwards from the leaf route (or the\n// route specified by routeId) for the closest ancestor error boundary,\n// defaulting to the root match\n\n\nfunction findNearestBoundary(matches, routeId) {\n  let eligibleMatches = routeId ? matches.slice(0, matches.findIndex(m => m.route.id === routeId) + 1) : [...matches];\n  return eligibleMatches.reverse().find(m => m.route.hasErrorBoundary === true) || matches[0];\n}\n\nfunction getShortCircuitMatches(routes) {\n  // Prefer a root layout route if present, otherwise shim in a route object\n  let route = routes.find(r => r.index || !r.path || r.path === \"/\") || {\n    id: \"__shim-error-route__\"\n  };\n  return {\n    matches: [{\n      params: {},\n      pathname: \"\",\n      pathnameBase: \"\",\n      route\n    }],\n    route\n  };\n}\n\nfunction getInternalRouterError(status, _temp4) {\n  let {\n    pathname,\n    routeId,\n    method\n  } = _temp4 === void 0 ? {} : _temp4;\n  let statusText = \"Unknown Server Error\";\n  let errorMessage = \"Unknown @remix-run/router error\";\n\n  if (status === 400) {\n    statusText = \"Bad Request\";\n\n    if (method && pathname && routeId) {\n      errorMessage = \"You made a \" + method + \" request to \\\"\" + pathname + \"\\\" but \" + (\"did not provide a `loader` for route \\\"\" + routeId + \"\\\", \") + \"so there is no way to handle the request.\";\n    } else {\n      errorMessage = \"Cannot submit binary form data using GET\";\n    }\n  } else if (status === 403) {\n    statusText = \"Forbidden\";\n    errorMessage = \"Route \\\"\" + routeId + \"\\\" does not match URL \\\"\" + pathname + \"\\\"\";\n  } else if (status === 404) {\n    statusText = \"Not Found\";\n    errorMessage = \"No route matches URL \\\"\" + pathname + \"\\\"\";\n  } else if (status === 405) {\n    statusText = \"Method Not Allowed\";\n\n    if (method && pathname && routeId) {\n      errorMessage = \"You made a \" + method.toUpperCase() + \" request to \\\"\" + pathname + \"\\\" but \" + (\"did not provide an `action` for route \\\"\" + routeId + \"\\\", \") + \"so there is no way to handle the request.\";\n    } else if (method) {\n      errorMessage = \"Invalid request method \\\"\" + method.toUpperCase() + \"\\\"\";\n    }\n  }\n\n  return new ErrorResponse(status || 500, statusText, new Error(errorMessage), true);\n} // Find any returned redirect errors, starting from the lowest match\n\n\nfunction findRedirect(results) {\n  for (let i = results.length - 1; i >= 0; i--) {\n    let result = results[i];\n\n    if (isRedirectResult(result)) {\n      return result;\n    }\n  }\n}\n\nfunction stripHashFromPath(path) {\n  let parsedPath = typeof path === \"string\" ? parsePath(path) : path;\n  return createPath(_extends({}, parsedPath, {\n    hash: \"\"\n  }));\n}\n\nfunction isHashChangeOnly(a, b) {\n  return a.pathname === b.pathname && a.search === b.search && a.hash !== b.hash;\n}\n\nfunction isDeferredResult(result) {\n  return result.type === ResultType.deferred;\n}\n\nfunction isErrorResult(result) {\n  return result.type === ResultType.error;\n}\n\nfunction isRedirectResult(result) {\n  return (result && result.type) === ResultType.redirect;\n}\n\nfunction isResponse(value) {\n  return value != null && typeof value.status === \"number\" && typeof value.statusText === \"string\" && typeof value.headers === \"object\" && typeof value.body !== \"undefined\";\n}\n\nfunction isRedirectResponse(result) {\n  if (!isResponse(result)) {\n    return false;\n  }\n\n  let status = result.status;\n  let location = result.headers.get(\"Location\");\n  return status >= 300 && status <= 399 && location != null;\n}\n\nfunction isQueryRouteResponse(obj) {\n  return obj && isResponse(obj.response) && (obj.type === ResultType.data || ResultType.error);\n}\n\nfunction isValidMethod(method) {\n  return validRequestMethods.has(method);\n}\n\nfunction isMutationMethod(method) {\n  return validMutationMethods.has(method);\n}\n\nasync function resolveDeferredResults(currentMatches, matchesToLoad, results, signal, isFetcher, currentLoaderData) {\n  for (let index = 0; index < results.length; index++) {\n    let result = results[index];\n    let match = matchesToLoad[index];\n    let currentMatch = currentMatches.find(m => m.route.id === match.route.id);\n    let isRevalidatingLoader = currentMatch != null && !isNewRouteInstance(currentMatch, match) && (currentLoaderData && currentLoaderData[match.route.id]) !== undefined;\n\n    if (isDeferredResult(result) && (isFetcher || isRevalidatingLoader)) {\n      // Note: we do not have to touch activeDeferreds here since we race them\n      // against the signal in resolveDeferredData and they'll get aborted\n      // there if needed\n      await resolveDeferredData(result, signal, isFetcher).then(result => {\n        if (result) {\n          results[index] = result || results[index];\n        }\n      });\n    }\n  }\n}\n\nasync function resolveDeferredData(result, signal, unwrap) {\n  if (unwrap === void 0) {\n    unwrap = false;\n  }\n\n  let aborted = await result.deferredData.resolveData(signal);\n\n  if (aborted) {\n    return;\n  }\n\n  if (unwrap) {\n    try {\n      return {\n        type: ResultType.data,\n        data: result.deferredData.unwrappedData\n      };\n    } catch (e) {\n      // Handle any TrackedPromise._error values encountered while unwrapping\n      return {\n        type: ResultType.error,\n        error: e\n      };\n    }\n  }\n\n  return {\n    type: ResultType.data,\n    data: result.deferredData.data\n  };\n}\n\nfunction hasNakedIndexQuery(search) {\n  return new URLSearchParams(search).getAll(\"index\").some(v => v === \"\");\n} // Note: This should match the format exported by useMatches, so if you change\n// this please also change that :)  Eventually we'll DRY this up\n\n\nfunction createUseMatchesMatch(match, loaderData) {\n  let {\n    route,\n    pathname,\n    params\n  } = match;\n  return {\n    id: route.id,\n    pathname,\n    params,\n    data: loaderData[route.id],\n    handle: route.handle\n  };\n}\n\nfunction getTargetMatch(matches, location) {\n  let search = typeof location === \"string\" ? parsePath(location).search : location.search;\n\n  if (matches[matches.length - 1].route.index && hasNakedIndexQuery(search || \"\")) {\n    // Return the leaf index route when index is present\n    return matches[matches.length - 1];\n  } // Otherwise grab the deepest \"path contributing\" match (ignoring index and\n  // pathless layout routes)\n\n\n  let pathMatches = getPathContributingMatches(matches);\n  return pathMatches[pathMatches.length - 1];\n} //#endregion\n\nexport { AbortedDeferredError, Action, ErrorResponse, IDLE_FETCHER, IDLE_NAVIGATION, convertRoutesToDataRoutes as UNSAFE_convertRoutesToDataRoutes, getPathContributingMatches as UNSAFE_getPathContributingMatches, createBrowserHistory, createHashHistory, createMemoryHistory, createPath, createRouter, createStaticHandler, defer, generatePath, getStaticContextFromError, getToPathname, invariant, isRouteErrorResponse, joinPaths, json, matchPath, matchRoutes, normalizePathname, parsePath, redirect, resolvePath, resolveTo, stripBasename, warning };\n//# sourceMappingURL=router.js.map\n","/**\n * React Router v6.6.1\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nimport { invariant, joinPaths, matchPath, UNSAFE_getPathContributingMatches, warning, resolveTo, parsePath, matchRoutes, Action, isRouteErrorResponse, createMemoryHistory, stripBasename, AbortedDeferredError, createRouter } from '@remix-run/router';\nexport { AbortedDeferredError, Action as NavigationType, createPath, defer, generatePath, isRouteErrorResponse, json, matchPath, matchRoutes, parsePath, redirect, resolvePath } from '@remix-run/router';\nimport * as React from 'react';\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\n/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\n\nfunction isPolyfill(x, y) {\n  return x === y && (x !== 0 || 1 / x === 1 / y) || x !== x && y !== y // eslint-disable-line no-self-compare\n  ;\n}\n\nconst is = typeof Object.is === \"function\" ? Object.is : isPolyfill; // Intentionally not using named imports because Rollup uses dynamic\n// dispatch for CommonJS interop named imports.\n\nconst {\n  useState,\n  useEffect,\n  useLayoutEffect,\n  useDebugValue\n} = React;\nlet didWarnOld18Alpha = false;\nlet didWarnUncachedGetSnapshot = false; // Disclaimer: This shim breaks many of the rules of React, and only works\n// because of a very particular set of implementation details and assumptions\n// -- change any one of them and it will break. The most important assumption\n// is that updates are always synchronous, because concurrent rendering is\n// only available in versions of React that also have a built-in\n// useSyncExternalStore API. And we only use this shim when the built-in API\n// does not exist.\n//\n// Do not assume that the clever hacks used by this hook also work in general.\n// The point of this shim is to replace the need for hacks by other libraries.\n\nfunction useSyncExternalStore$2(subscribe, getSnapshot, // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n// React do not expose a way to check if we're hydrating. So users of the shim\n// will need to track that themselves and return the correct value\n// from `getSnapshot`.\ngetServerSnapshot) {\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!didWarnOld18Alpha) {\n      if (\"startTransition\" in React) {\n        didWarnOld18Alpha = true;\n        console.error(\"You are using an outdated, pre-release alpha of React 18 that \" + \"does not support useSyncExternalStore. The \" + \"use-sync-external-store shim will not work correctly. Upgrade \" + \"to a newer pre-release.\");\n      }\n    }\n  } // Read the current snapshot from the store on every render. Again, this\n  // breaks the rules of React, and only works here because of specific\n  // implementation details, most importantly that updates are\n  // always synchronous.\n\n\n  const value = getSnapshot();\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!didWarnUncachedGetSnapshot) {\n      const cachedValue = getSnapshot();\n\n      if (!is(value, cachedValue)) {\n        console.error(\"The result of getSnapshot should be cached to avoid an infinite loop\");\n        didWarnUncachedGetSnapshot = true;\n      }\n    }\n  } // Because updates are synchronous, we don't queue them. Instead we force a\n  // re-render whenever the subscribed state changes by updating an some\n  // arbitrary useState hook. Then, during render, we call getSnapshot to read\n  // the current value.\n  //\n  // Because we don't actually use the state returned by the useState hook, we\n  // can save a bit of memory by storing other stuff in that slot.\n  //\n  // To implement the early bailout, we need to track some things on a mutable\n  // object. Usually, we would put that in a useRef hook, but we can stash it in\n  // our useState hook instead.\n  //\n  // To force a re-render, we call forceUpdate({inst}). That works because the\n  // new object always fails an equality check.\n\n\n  const [{\n    inst\n  }, forceUpdate] = useState({\n    inst: {\n      value,\n      getSnapshot\n    }\n  }); // Track the latest getSnapshot function with a ref. This needs to be updated\n  // in the layout phase so we can access it during the tearing check that\n  // happens on subscribe.\n\n  useLayoutEffect(() => {\n    inst.value = value;\n    inst.getSnapshot = getSnapshot; // Whenever getSnapshot or subscribe changes, we need to check in the\n    // commit phase if there was an interleaved mutation. In concurrent mode\n    // this can happen all the time, but even in synchronous mode, an earlier\n    // effect may have mutated the store.\n\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst\n      });\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [subscribe, value, getSnapshot]);\n  useEffect(() => {\n    // Check for changes right before subscribing. Subsequent changes will be\n    // detected in the subscription handler.\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst\n      });\n    }\n\n    const handleStoreChange = () => {\n      // TODO: Because there is no cross-renderer API for batching updates, it's\n      // up to the consumer of this library to wrap their subscription event\n      // with unstable_batchedUpdates. Should we try to detect when this isn't\n      // the case and print a warning in development?\n      // The store changed. Check if the snapshot changed since the last time we\n      // read from the store.\n      if (checkIfSnapshotChanged(inst)) {\n        // Force a re-render.\n        forceUpdate({\n          inst\n        });\n      }\n    }; // Subscribe to the store and return a clean-up function.\n\n\n    return subscribe(handleStoreChange); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [subscribe]);\n  useDebugValue(value);\n  return value;\n}\n\nfunction checkIfSnapshotChanged(inst) {\n  const latestGetSnapshot = inst.getSnapshot;\n  const prevValue = inst.value;\n\n  try {\n    const nextValue = latestGetSnapshot();\n    return !is(prevValue, nextValue);\n  } catch (error) {\n    return true;\n  }\n}\n\n/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\nfunction useSyncExternalStore$1(subscribe, getSnapshot, getServerSnapshot) {\n  // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n  // React do not expose a way to check if we're hydrating. So users of the shim\n  // will need to track that themselves and return the correct value\n  // from `getSnapshot`.\n  return getSnapshot();\n}\n\n/**\n * Inlined into the react-router repo since use-sync-external-store does not\n * provide a UMD-compatible package, so we need this to be able to distribute\n * UMD react-router bundles\n */\nconst canUseDOM = !!(typeof window !== \"undefined\" && typeof window.document !== \"undefined\" && typeof window.document.createElement !== \"undefined\");\nconst isServerEnvironment = !canUseDOM;\nconst shim = isServerEnvironment ? useSyncExternalStore$1 : useSyncExternalStore$2;\nconst useSyncExternalStore = \"useSyncExternalStore\" in React ? (module => module.useSyncExternalStore)(React) : shim;\n\n// Contexts for data routers\nconst DataStaticRouterContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  DataStaticRouterContext.displayName = \"DataStaticRouterContext\";\n}\n\nconst DataRouterContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  DataRouterContext.displayName = \"DataRouter\";\n}\n\nconst DataRouterStateContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  DataRouterStateContext.displayName = \"DataRouterState\";\n}\n\nconst AwaitContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  AwaitContext.displayName = \"Await\";\n}\n\nconst NavigationContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  NavigationContext.displayName = \"Navigation\";\n}\n\nconst LocationContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  LocationContext.displayName = \"Location\";\n}\n\nconst RouteContext = /*#__PURE__*/React.createContext({\n  outlet: null,\n  matches: []\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  RouteContext.displayName = \"Route\";\n}\n\nconst RouteErrorContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== \"production\") {\n  RouteErrorContext.displayName = \"RouteError\";\n}\n\n/**\n * Returns the full href for the given \"to\" value. This is useful for building\n * custom links that are also accessible and preserve right-click behavior.\n *\n * @see https://reactrouter.com/hooks/use-href\n */\n\nfunction useHref(to, _temp) {\n  let {\n    relative\n  } = _temp === void 0 ? {} : _temp;\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of the\n  // router loaded. We can help them understand how to avoid that.\n  \"useHref() may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  let {\n    basename,\n    navigator\n  } = React.useContext(NavigationContext);\n  let {\n    hash,\n    pathname,\n    search\n  } = useResolvedPath(to, {\n    relative\n  });\n  let joinedPathname = pathname; // If we're operating within a basename, prepend it to the pathname prior\n  // to creating the href.  If this is a root navigation, then just use the raw\n  // basename which allows the basename to have full control over the presence\n  // of a trailing slash on root links\n\n  if (basename !== \"/\") {\n    joinedPathname = pathname === \"/\" ? basename : joinPaths([basename, pathname]);\n  }\n\n  return navigator.createHref({\n    pathname: joinedPathname,\n    search,\n    hash\n  });\n}\n/**\n * Returns true if this component is a descendant of a <Router>.\n *\n * @see https://reactrouter.com/hooks/use-in-router-context\n */\n\nfunction useInRouterContext() {\n  return React.useContext(LocationContext) != null;\n}\n/**\n * Returns the current location object, which represents the current URL in web\n * browsers.\n *\n * Note: If you're using this it may mean you're doing some of your own\n * \"routing\" in your app, and we'd like to know what your use case is. We may\n * be able to provide something higher-level to better suit your needs.\n *\n * @see https://reactrouter.com/hooks/use-location\n */\n\nfunction useLocation() {\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of the\n  // router loaded. We can help them understand how to avoid that.\n  \"useLocation() may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  return React.useContext(LocationContext).location;\n}\n/**\n * Returns the current navigation action which describes how the router came to\n * the current location, either by a pop, push, or replace on the history stack.\n *\n * @see https://reactrouter.com/hooks/use-navigation-type\n */\n\nfunction useNavigationType() {\n  return React.useContext(LocationContext).navigationType;\n}\n/**\n * Returns a PathMatch object if the given pattern matches the current URL.\n * This is useful for components that need to know \"active\" state, e.g.\n * <NavLink>.\n *\n * @see https://reactrouter.com/hooks/use-match\n */\n\nfunction useMatch(pattern) {\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of the\n  // router loaded. We can help them understand how to avoid that.\n  \"useMatch() may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  let {\n    pathname\n  } = useLocation();\n  return React.useMemo(() => matchPath(pattern, pathname), [pathname, pattern]);\n}\n/**\n * The interface for the navigate() function returned from useNavigate().\n */\n\n/**\n * Returns an imperative method for changing the location. Used by <Link>s, but\n * may also be used by other elements to change the location.\n *\n * @see https://reactrouter.com/hooks/use-navigate\n */\nfunction useNavigate() {\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of the\n  // router loaded. We can help them understand how to avoid that.\n  \"useNavigate() may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  let {\n    basename,\n    navigator\n  } = React.useContext(NavigationContext);\n  let {\n    matches\n  } = React.useContext(RouteContext);\n  let {\n    pathname: locationPathname\n  } = useLocation();\n  let routePathnamesJson = JSON.stringify(UNSAFE_getPathContributingMatches(matches).map(match => match.pathnameBase));\n  let activeRef = React.useRef(false);\n  React.useEffect(() => {\n    activeRef.current = true;\n  });\n  let navigate = React.useCallback(function (to, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(activeRef.current, \"You should call navigate() in a React.useEffect(), not when \" + \"your component is first rendered.\") : void 0;\n    if (!activeRef.current) return;\n\n    if (typeof to === \"number\") {\n      navigator.go(to);\n      return;\n    }\n\n    let path = resolveTo(to, JSON.parse(routePathnamesJson), locationPathname, options.relative === \"path\"); // If we're operating within a basename, prepend it to the pathname prior\n    // to handing off to history.  If this is a root navigation, then we\n    // navigate to the raw basename which allows the basename to have full\n    // control over the presence of a trailing slash on root links\n\n    if (basename !== \"/\") {\n      path.pathname = path.pathname === \"/\" ? basename : joinPaths([basename, path.pathname]);\n    }\n\n    (!!options.replace ? navigator.replace : navigator.push)(path, options.state, options);\n  }, [basename, navigator, routePathnamesJson, locationPathname]);\n  return navigate;\n}\nconst OutletContext = /*#__PURE__*/React.createContext(null);\n/**\n * Returns the context (if provided) for the child route at this level of the route\n * hierarchy.\n * @see https://reactrouter.com/hooks/use-outlet-context\n */\n\nfunction useOutletContext() {\n  return React.useContext(OutletContext);\n}\n/**\n * Returns the element for the child route at this level of the route\n * hierarchy. Used internally by <Outlet> to render child routes.\n *\n * @see https://reactrouter.com/hooks/use-outlet\n */\n\nfunction useOutlet(context) {\n  let outlet = React.useContext(RouteContext).outlet;\n\n  if (outlet) {\n    return /*#__PURE__*/React.createElement(OutletContext.Provider, {\n      value: context\n    }, outlet);\n  }\n\n  return outlet;\n}\n/**\n * Returns an object of key/value pairs of the dynamic params from the current\n * URL that were matched by the route path.\n *\n * @see https://reactrouter.com/hooks/use-params\n */\n\nfunction useParams() {\n  let {\n    matches\n  } = React.useContext(RouteContext);\n  let routeMatch = matches[matches.length - 1];\n  return routeMatch ? routeMatch.params : {};\n}\n/**\n * Resolves the pathname of the given `to` value against the current location.\n *\n * @see https://reactrouter.com/hooks/use-resolved-path\n */\n\nfunction useResolvedPath(to, _temp2) {\n  let {\n    relative\n  } = _temp2 === void 0 ? {} : _temp2;\n  let {\n    matches\n  } = React.useContext(RouteContext);\n  let {\n    pathname: locationPathname\n  } = useLocation();\n  let routePathnamesJson = JSON.stringify(UNSAFE_getPathContributingMatches(matches).map(match => match.pathnameBase));\n  return React.useMemo(() => resolveTo(to, JSON.parse(routePathnamesJson), locationPathname, relative === \"path\"), [to, routePathnamesJson, locationPathname, relative]);\n}\n/**\n * Returns the element of the route that matched the current location, prepared\n * with the correct context to render the remainder of the route tree. Route\n * elements in the tree must render an <Outlet> to render their child route's\n * element.\n *\n * @see https://reactrouter.com/hooks/use-routes\n */\n\nfunction useRoutes(routes, locationArg) {\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of the\n  // router loaded. We can help them understand how to avoid that.\n  \"useRoutes() may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  let {\n    navigator\n  } = React.useContext(NavigationContext);\n  let dataRouterStateContext = React.useContext(DataRouterStateContext);\n  let {\n    matches: parentMatches\n  } = React.useContext(RouteContext);\n  let routeMatch = parentMatches[parentMatches.length - 1];\n  let parentParams = routeMatch ? routeMatch.params : {};\n  let parentPathname = routeMatch ? routeMatch.pathname : \"/\";\n  let parentPathnameBase = routeMatch ? routeMatch.pathnameBase : \"/\";\n  let parentRoute = routeMatch && routeMatch.route;\n\n  if (process.env.NODE_ENV !== \"production\") {\n    // You won't get a warning about 2 different <Routes> under a <Route>\n    // without a trailing *, but this is a best-effort warning anyway since we\n    // cannot even give the warning unless they land at the parent route.\n    //\n    // Example:\n    //\n    // <Routes>\n    //   {/* This route path MUST end with /* because otherwise\n    //       it will never match /blog/post/123 */}\n    //   <Route path=\"blog\" element={<Blog />} />\n    //   <Route path=\"blog/feed\" element={<BlogFeed />} />\n    // </Routes>\n    //\n    // function Blog() {\n    //   return (\n    //     <Routes>\n    //       <Route path=\"post/:id\" element={<Post />} />\n    //     </Routes>\n    //   );\n    // }\n    let parentPath = parentRoute && parentRoute.path || \"\";\n    warningOnce(parentPathname, !parentRoute || parentPath.endsWith(\"*\"), \"You rendered descendant <Routes> (or called `useRoutes()`) at \" + (\"\\\"\" + parentPathname + \"\\\" (under <Route path=\\\"\" + parentPath + \"\\\">) but the \") + \"parent route path has no trailing \\\"*\\\". This means if you navigate \" + \"deeper, the parent won't match anymore and therefore the child \" + \"routes will never render.\\n\\n\" + (\"Please change the parent <Route path=\\\"\" + parentPath + \"\\\"> to <Route \") + (\"path=\\\"\" + (parentPath === \"/\" ? \"*\" : parentPath + \"/*\") + \"\\\">.\"));\n  }\n\n  let locationFromContext = useLocation();\n  let location;\n\n  if (locationArg) {\n    var _parsedLocationArg$pa;\n\n    let parsedLocationArg = typeof locationArg === \"string\" ? parsePath(locationArg) : locationArg;\n    !(parentPathnameBase === \"/\" || ((_parsedLocationArg$pa = parsedLocationArg.pathname) == null ? void 0 : _parsedLocationArg$pa.startsWith(parentPathnameBase))) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, \" + \"the location pathname must begin with the portion of the URL pathname that was \" + (\"matched by all parent routes. The current pathname base is \\\"\" + parentPathnameBase + \"\\\" \") + (\"but pathname \\\"\" + parsedLocationArg.pathname + \"\\\" was given in the `location` prop.\")) : invariant(false) : void 0;\n    location = parsedLocationArg;\n  } else {\n    location = locationFromContext;\n  }\n\n  let pathname = location.pathname || \"/\";\n  let remainingPathname = parentPathnameBase === \"/\" ? pathname : pathname.slice(parentPathnameBase.length) || \"/\";\n  let matches = matchRoutes(routes, {\n    pathname: remainingPathname\n  });\n\n  if (process.env.NODE_ENV !== \"production\") {\n    process.env.NODE_ENV !== \"production\" ? warning(parentRoute || matches != null, \"No routes matched location \\\"\" + location.pathname + location.search + location.hash + \"\\\" \") : void 0;\n    process.env.NODE_ENV !== \"production\" ? warning(matches == null || matches[matches.length - 1].route.element !== undefined, \"Matched leaf route at location \\\"\" + location.pathname + location.search + location.hash + \"\\\" does not have an element. \" + \"This means it will render an <Outlet /> with a null value by default resulting in an \\\"empty\\\" page.\") : void 0;\n  }\n\n  let renderedMatches = _renderMatches(matches && matches.map(match => Object.assign({}, match, {\n    params: Object.assign({}, parentParams, match.params),\n    pathname: joinPaths([parentPathnameBase, // Re-encode pathnames that were decoded inside matchRoutes\n    navigator.encodeLocation ? navigator.encodeLocation(match.pathname).pathname : match.pathname]),\n    pathnameBase: match.pathnameBase === \"/\" ? parentPathnameBase : joinPaths([parentPathnameBase, // Re-encode pathnames that were decoded inside matchRoutes\n    navigator.encodeLocation ? navigator.encodeLocation(match.pathnameBase).pathname : match.pathnameBase])\n  })), parentMatches, dataRouterStateContext || undefined); // When a user passes in a `locationArg`, the associated routes need to\n  // be wrapped in a new `LocationContext.Provider` in order for `useLocation`\n  // to use the scoped location instead of the global location.\n\n\n  if (locationArg && renderedMatches) {\n    return /*#__PURE__*/React.createElement(LocationContext.Provider, {\n      value: {\n        location: _extends({\n          pathname: \"/\",\n          search: \"\",\n          hash: \"\",\n          state: null,\n          key: \"default\"\n        }, location),\n        navigationType: Action.Pop\n      }\n    }, renderedMatches);\n  }\n\n  return renderedMatches;\n}\n\nfunction DefaultErrorElement() {\n  let error = useRouteError();\n  let message = isRouteErrorResponse(error) ? error.status + \" \" + error.statusText : error instanceof Error ? error.message : JSON.stringify(error);\n  let stack = error instanceof Error ? error.stack : null;\n  let lightgrey = \"rgba(200,200,200, 0.5)\";\n  let preStyles = {\n    padding: \"0.5rem\",\n    backgroundColor: lightgrey\n  };\n  let codeStyles = {\n    padding: \"2px 4px\",\n    backgroundColor: lightgrey\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h2\", null, \"Unhandled Thrown Error!\"), /*#__PURE__*/React.createElement(\"h3\", {\n    style: {\n      fontStyle: \"italic\"\n    }\n  }, message), stack ? /*#__PURE__*/React.createElement(\"pre\", {\n    style: preStyles\n  }, stack) : null, /*#__PURE__*/React.createElement(\"p\", null, \"\\uD83D\\uDCBF Hey developer \\uD83D\\uDC4B\"), /*#__PURE__*/React.createElement(\"p\", null, \"You can provide a way better UX than this when your app throws errors by providing your own\\xA0\", /*#__PURE__*/React.createElement(\"code\", {\n    style: codeStyles\n  }, \"errorElement\"), \" props on\\xA0\", /*#__PURE__*/React.createElement(\"code\", {\n    style: codeStyles\n  }, \"<Route>\")));\n}\n\nclass RenderErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      location: props.location,\n      error: props.error\n    };\n  }\n\n  static getDerivedStateFromError(error) {\n    return {\n      error: error\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    // When we get into an error state, the user will likely click \"back\" to the\n    // previous page that didn't have an error. Because this wraps the entire\n    // application, that will have no effect--the error page continues to display.\n    // This gives us a mechanism to recover from the error when the location changes.\n    //\n    // Whether we're in an error state or not, we update the location in state\n    // so that when we are in an error state, it gets reset when a new location\n    // comes in and the user recovers from the error.\n    if (state.location !== props.location) {\n      return {\n        error: props.error,\n        location: props.location\n      };\n    } // If we're not changing locations, preserve the location but still surface\n    // any new errors that may come through. We retain the existing error, we do\n    // this because the error provided from the app state may be cleared without\n    // the location changing.\n\n\n    return {\n      error: props.error || state.error,\n      location: state.location\n    };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error(\"React Router caught the following error during render\", error, errorInfo);\n  }\n\n  render() {\n    return this.state.error ? /*#__PURE__*/React.createElement(RouteContext.Provider, {\n      value: this.props.routeContext\n    }, /*#__PURE__*/React.createElement(RouteErrorContext.Provider, {\n      value: this.state.error,\n      children: this.props.component\n    })) : this.props.children;\n  }\n\n}\n\nfunction RenderedRoute(_ref) {\n  let {\n    routeContext,\n    match,\n    children\n  } = _ref;\n  let dataStaticRouterContext = React.useContext(DataStaticRouterContext); // Track how deep we got in our render pass to emulate SSR componentDidCatch\n  // in a DataStaticRouter\n\n  if (dataStaticRouterContext && match.route.errorElement) {\n    dataStaticRouterContext._deepestRenderedBoundaryId = match.route.id;\n  }\n\n  return /*#__PURE__*/React.createElement(RouteContext.Provider, {\n    value: routeContext\n  }, children);\n}\n\nfunction _renderMatches(matches, parentMatches, dataRouterState) {\n  if (parentMatches === void 0) {\n    parentMatches = [];\n  }\n\n  if (matches == null) {\n    if (dataRouterState != null && dataRouterState.errors) {\n      // Don't bail if we have data router errors so we can render them in the\n      // boundary.  Use the pre-matched (or shimmed) matches\n      matches = dataRouterState.matches;\n    } else {\n      return null;\n    }\n  }\n\n  let renderedMatches = matches; // If we have data errors, trim matches to the highest error boundary\n\n  let errors = dataRouterState == null ? void 0 : dataRouterState.errors;\n\n  if (errors != null) {\n    let errorIndex = renderedMatches.findIndex(m => m.route.id && (errors == null ? void 0 : errors[m.route.id]));\n    !(errorIndex >= 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Could not find a matching route for the current errors: \" + errors) : invariant(false) : void 0;\n    renderedMatches = renderedMatches.slice(0, Math.min(renderedMatches.length, errorIndex + 1));\n  }\n\n  return renderedMatches.reduceRight((outlet, match, index) => {\n    let error = match.route.id ? errors == null ? void 0 : errors[match.route.id] : null; // Only data routers handle errors\n\n    let errorElement = dataRouterState ? match.route.errorElement || /*#__PURE__*/React.createElement(DefaultErrorElement, null) : null;\n    let matches = parentMatches.concat(renderedMatches.slice(0, index + 1));\n\n    let getChildren = () => /*#__PURE__*/React.createElement(RenderedRoute, {\n      match: match,\n      routeContext: {\n        outlet,\n        matches\n      }\n    }, error ? errorElement : match.route.element !== undefined ? match.route.element : outlet); // Only wrap in an error boundary within data router usages when we have an\n    // errorElement on this route.  Otherwise let it bubble up to an ancestor\n    // errorElement\n\n\n    return dataRouterState && (match.route.errorElement || index === 0) ? /*#__PURE__*/React.createElement(RenderErrorBoundary, {\n      location: dataRouterState.location,\n      component: errorElement,\n      error: error,\n      children: getChildren(),\n      routeContext: {\n        outlet: null,\n        matches\n      }\n    }) : getChildren();\n  }, null);\n}\nvar DataRouterHook;\n\n(function (DataRouterHook) {\n  DataRouterHook[\"UseRevalidator\"] = \"useRevalidator\";\n})(DataRouterHook || (DataRouterHook = {}));\n\nvar DataRouterStateHook;\n\n(function (DataRouterStateHook) {\n  DataRouterStateHook[\"UseLoaderData\"] = \"useLoaderData\";\n  DataRouterStateHook[\"UseActionData\"] = \"useActionData\";\n  DataRouterStateHook[\"UseRouteError\"] = \"useRouteError\";\n  DataRouterStateHook[\"UseNavigation\"] = \"useNavigation\";\n  DataRouterStateHook[\"UseRouteLoaderData\"] = \"useRouteLoaderData\";\n  DataRouterStateHook[\"UseMatches\"] = \"useMatches\";\n  DataRouterStateHook[\"UseRevalidator\"] = \"useRevalidator\";\n})(DataRouterStateHook || (DataRouterStateHook = {}));\n\nfunction getDataRouterConsoleError(hookName) {\n  return hookName + \" must be used within a data router.  See https://reactrouter.com/routers/picking-a-router.\";\n}\n\nfunction useDataRouterContext(hookName) {\n  let ctx = React.useContext(DataRouterContext);\n  !ctx ? process.env.NODE_ENV !== \"production\" ? invariant(false, getDataRouterConsoleError(hookName)) : invariant(false) : void 0;\n  return ctx;\n}\n\nfunction useDataRouterState(hookName) {\n  let state = React.useContext(DataRouterStateContext);\n  !state ? process.env.NODE_ENV !== \"production\" ? invariant(false, getDataRouterConsoleError(hookName)) : invariant(false) : void 0;\n  return state;\n}\n\nfunction useRouteContext(hookName) {\n  let route = React.useContext(RouteContext);\n  !route ? process.env.NODE_ENV !== \"production\" ? invariant(false, getDataRouterConsoleError(hookName)) : invariant(false) : void 0;\n  return route;\n}\n\nfunction useCurrentRouteId(hookName) {\n  let route = useRouteContext(hookName);\n  let thisRoute = route.matches[route.matches.length - 1];\n  !thisRoute.route.id ? process.env.NODE_ENV !== \"production\" ? invariant(false, hookName + \" can only be used on routes that contain a unique \\\"id\\\"\") : invariant(false) : void 0;\n  return thisRoute.route.id;\n}\n/**\n * Returns the current navigation, defaulting to an \"idle\" navigation when\n * no navigation is in progress\n */\n\n\nfunction useNavigation() {\n  let state = useDataRouterState(DataRouterStateHook.UseNavigation);\n  return state.navigation;\n}\n/**\n * Returns a revalidate function for manually triggering revalidation, as well\n * as the current state of any manual revalidations\n */\n\nfunction useRevalidator() {\n  let dataRouterContext = useDataRouterContext(DataRouterHook.UseRevalidator);\n  let state = useDataRouterState(DataRouterStateHook.UseRevalidator);\n  return {\n    revalidate: dataRouterContext.router.revalidate,\n    state: state.revalidation\n  };\n}\n/**\n * Returns the active route matches, useful for accessing loaderData for\n * parent/child routes or the route \"handle\" property\n */\n\nfunction useMatches() {\n  let {\n    matches,\n    loaderData\n  } = useDataRouterState(DataRouterStateHook.UseMatches);\n  return React.useMemo(() => matches.map(match => {\n    let {\n      pathname,\n      params\n    } = match; // Note: This structure matches that created by createUseMatchesMatch\n    // in the @remix-run/router , so if you change this please also change\n    // that :)  Eventually we'll DRY this up\n\n    return {\n      id: match.route.id,\n      pathname,\n      params,\n      data: loaderData[match.route.id],\n      handle: match.route.handle\n    };\n  }), [matches, loaderData]);\n}\n/**\n * Returns the loader data for the nearest ancestor Route loader\n */\n\nfunction useLoaderData() {\n  let state = useDataRouterState(DataRouterStateHook.UseLoaderData);\n  let routeId = useCurrentRouteId(DataRouterStateHook.UseLoaderData);\n\n  if (state.errors && state.errors[routeId] != null) {\n    console.error(\"You cannot `useLoaderData` in an errorElement (routeId: \" + routeId + \")\");\n    return undefined;\n  }\n\n  return state.loaderData[routeId];\n}\n/**\n * Returns the loaderData for the given routeId\n */\n\nfunction useRouteLoaderData(routeId) {\n  let state = useDataRouterState(DataRouterStateHook.UseRouteLoaderData);\n  return state.loaderData[routeId];\n}\n/**\n * Returns the action data for the nearest ancestor Route action\n */\n\nfunction useActionData() {\n  let state = useDataRouterState(DataRouterStateHook.UseActionData);\n  let route = React.useContext(RouteContext);\n  !route ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"useActionData must be used inside a RouteContext\") : invariant(false) : void 0;\n  return Object.values((state == null ? void 0 : state.actionData) || {})[0];\n}\n/**\n * Returns the nearest ancestor Route error, which could be a loader/action\n * error or a render error.  This is intended to be called from your\n * errorElement to display a proper error message.\n */\n\nfunction useRouteError() {\n  var _state$errors;\n\n  let error = React.useContext(RouteErrorContext);\n  let state = useDataRouterState(DataRouterStateHook.UseRouteError);\n  let routeId = useCurrentRouteId(DataRouterStateHook.UseRouteError); // If this was a render error, we put it in a RouteError context inside\n  // of RenderErrorBoundary\n\n  if (error) {\n    return error;\n  } // Otherwise look for errors from our data router state\n\n\n  return (_state$errors = state.errors) == null ? void 0 : _state$errors[routeId];\n}\n/**\n * Returns the happy-path data from the nearest ancestor <Await /> value\n */\n\nfunction useAsyncValue() {\n  let value = React.useContext(AwaitContext);\n  return value == null ? void 0 : value._data;\n}\n/**\n * Returns the error from the nearest ancestor <Await /> value\n */\n\nfunction useAsyncError() {\n  let value = React.useContext(AwaitContext);\n  return value == null ? void 0 : value._error;\n}\nconst alreadyWarned = {};\n\nfunction warningOnce(key, cond, message) {\n  if (!cond && !alreadyWarned[key]) {\n    alreadyWarned[key] = true;\n    process.env.NODE_ENV !== \"production\" ? warning(false, message) : void 0;\n  }\n}\n\n/**\n * Given a Remix Router instance, render the appropriate UI\n */\nfunction RouterProvider(_ref) {\n  let {\n    fallbackElement,\n    router\n  } = _ref;\n  // Sync router state to our component state to force re-renders\n  let state = useSyncExternalStore(router.subscribe, () => router.state, // We have to provide this so React@18 doesn't complain during hydration,\n  // but we pass our serialized hydration data into the router so state here\n  // is already synced with what the server saw\n  () => router.state);\n  let navigator = React.useMemo(() => {\n    return {\n      createHref: router.createHref,\n      encodeLocation: router.encodeLocation,\n      go: n => router.navigate(n),\n      push: (to, state, opts) => router.navigate(to, {\n        state,\n        preventScrollReset: opts == null ? void 0 : opts.preventScrollReset\n      }),\n      replace: (to, state, opts) => router.navigate(to, {\n        replace: true,\n        state,\n        preventScrollReset: opts == null ? void 0 : opts.preventScrollReset\n      })\n    };\n  }, [router]);\n  let basename = router.basename || \"/\";\n  return /*#__PURE__*/React.createElement(DataRouterContext.Provider, {\n    value: {\n      router,\n      navigator,\n      static: false,\n      // Do we need this?\n      basename\n    }\n  }, /*#__PURE__*/React.createElement(DataRouterStateContext.Provider, {\n    value: state\n  }, /*#__PURE__*/React.createElement(Router, {\n    basename: router.basename,\n    location: router.state.location,\n    navigationType: router.state.historyAction,\n    navigator: navigator\n  }, router.state.initialized ? /*#__PURE__*/React.createElement(Routes, null) : fallbackElement)));\n}\n\n/**\n * A <Router> that stores all entries in memory.\n *\n * @see https://reactrouter.com/router-components/memory-router\n */\nfunction MemoryRouter(_ref2) {\n  let {\n    basename,\n    children,\n    initialEntries,\n    initialIndex\n  } = _ref2;\n  let historyRef = React.useRef();\n\n  if (historyRef.current == null) {\n    historyRef.current = createMemoryHistory({\n      initialEntries,\n      initialIndex,\n      v5Compat: true\n    });\n  }\n\n  let history = historyRef.current;\n  let [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n  React.useLayoutEffect(() => history.listen(setState), [history]);\n  return /*#__PURE__*/React.createElement(Router, {\n    basename: basename,\n    children: children,\n    location: state.location,\n    navigationType: state.action,\n    navigator: history\n  });\n}\n\n/**\n * Changes the current location.\n *\n * Note: This API is mostly useful in React.Component subclasses that are not\n * able to use hooks. In functional components, we recommend you use the\n * `useNavigate` hook instead.\n *\n * @see https://reactrouter.com/components/navigate\n */\nfunction Navigate(_ref3) {\n  let {\n    to,\n    replace,\n    state,\n    relative\n  } = _ref3;\n  !useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, // TODO: This error is probably because they somehow have 2 versions of\n  // the router loaded. We can help them understand how to avoid that.\n  \"<Navigate> may be used only in the context of a <Router> component.\") : invariant(false) : void 0;\n  process.env.NODE_ENV !== \"production\" ? warning(!React.useContext(NavigationContext).static, \"<Navigate> must not be used on the initial render in a <StaticRouter>. \" + \"This is a no-op, but you should modify your code so the <Navigate> is \" + \"only ever rendered in response to some user interaction or state change.\") : void 0;\n  let dataRouterState = React.useContext(DataRouterStateContext);\n  let navigate = useNavigate();\n  React.useEffect(() => {\n    // Avoid kicking off multiple navigations if we're in the middle of a\n    // data-router navigation, since components get re-rendered when we enter\n    // a submitting/loading state\n    if (dataRouterState && dataRouterState.navigation.state !== \"idle\") {\n      return;\n    }\n\n    navigate(to, {\n      replace,\n      state,\n      relative\n    });\n  });\n  return null;\n}\n\n/**\n * Renders the child route's element, if there is one.\n *\n * @see https://reactrouter.com/components/outlet\n */\nfunction Outlet(props) {\n  return useOutlet(props.context);\n}\n\n/**\n * Declares an element that should be rendered at a certain URL path.\n *\n * @see https://reactrouter.com/components/route\n */\nfunction Route(_props) {\n  process.env.NODE_ENV !== \"production\" ? invariant(false, \"A <Route> is only ever to be used as the child of <Routes> element, \" + \"never rendered directly. Please wrap your <Route> in a <Routes>.\") : invariant(false) ;\n}\n\n/**\n * Provides location context for the rest of the app.\n *\n * Note: You usually won't render a <Router> directly. Instead, you'll render a\n * router that is more specific to your environment such as a <BrowserRouter>\n * in web browsers or a <StaticRouter> for server rendering.\n *\n * @see https://reactrouter.com/router-components/router\n */\nfunction Router(_ref4) {\n  let {\n    basename: basenameProp = \"/\",\n    children = null,\n    location: locationProp,\n    navigationType = Action.Pop,\n    navigator,\n    static: staticProp = false\n  } = _ref4;\n  !!useInRouterContext() ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"You cannot render a <Router> inside another <Router>.\" + \" You should never have more than one in your app.\") : invariant(false) : void 0; // Preserve trailing slashes on basename, so we can let the user control\n  // the enforcement of trailing slashes throughout the app\n\n  let basename = basenameProp.replace(/^\\/*/, \"/\");\n  let navigationContext = React.useMemo(() => ({\n    basename,\n    navigator,\n    static: staticProp\n  }), [basename, navigator, staticProp]);\n\n  if (typeof locationProp === \"string\") {\n    locationProp = parsePath(locationProp);\n  }\n\n  let {\n    pathname = \"/\",\n    search = \"\",\n    hash = \"\",\n    state = null,\n    key = \"default\"\n  } = locationProp;\n  let location = React.useMemo(() => {\n    let trailingPathname = stripBasename(pathname, basename);\n\n    if (trailingPathname == null) {\n      return null;\n    }\n\n    return {\n      pathname: trailingPathname,\n      search,\n      hash,\n      state,\n      key\n    };\n  }, [basename, pathname, search, hash, state, key]);\n  process.env.NODE_ENV !== \"production\" ? warning(location != null, \"<Router basename=\\\"\" + basename + \"\\\"> is not able to match the URL \" + (\"\\\"\" + pathname + search + hash + \"\\\" because it does not start with the \") + \"basename, so the <Router> won't render anything.\") : void 0;\n\n  if (location == null) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(NavigationContext.Provider, {\n    value: navigationContext\n  }, /*#__PURE__*/React.createElement(LocationContext.Provider, {\n    children: children,\n    value: {\n      location,\n      navigationType\n    }\n  }));\n}\n\n/**\n * A container for a nested tree of <Route> elements that renders the branch\n * that best matches the current location.\n *\n * @see https://reactrouter.com/components/routes\n */\nfunction Routes(_ref5) {\n  let {\n    children,\n    location\n  } = _ref5;\n  let dataRouterContext = React.useContext(DataRouterContext); // When in a DataRouterContext _without_ children, we use the router routes\n  // directly.  If we have children, then we're in a descendant tree and we\n  // need to use child routes.\n\n  let routes = dataRouterContext && !children ? dataRouterContext.router.routes : createRoutesFromChildren(children);\n  return useRoutes(routes, location);\n}\n\n/**\n * Component to use for rendering lazily loaded data from returning defer()\n * in a loader function\n */\nfunction Await(_ref6) {\n  let {\n    children,\n    errorElement,\n    resolve\n  } = _ref6;\n  return /*#__PURE__*/React.createElement(AwaitErrorBoundary, {\n    resolve: resolve,\n    errorElement: errorElement\n  }, /*#__PURE__*/React.createElement(ResolveAwait, null, children));\n}\nvar AwaitRenderStatus;\n\n(function (AwaitRenderStatus) {\n  AwaitRenderStatus[AwaitRenderStatus[\"pending\"] = 0] = \"pending\";\n  AwaitRenderStatus[AwaitRenderStatus[\"success\"] = 1] = \"success\";\n  AwaitRenderStatus[AwaitRenderStatus[\"error\"] = 2] = \"error\";\n})(AwaitRenderStatus || (AwaitRenderStatus = {}));\n\nconst neverSettledPromise = new Promise(() => {});\n\nclass AwaitErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null\n    };\n  }\n\n  static getDerivedStateFromError(error) {\n    return {\n      error\n    };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error(\"<Await> caught the following error during render\", error, errorInfo);\n  }\n\n  render() {\n    let {\n      children,\n      errorElement,\n      resolve\n    } = this.props;\n    let promise = null;\n    let status = AwaitRenderStatus.pending;\n\n    if (!(resolve instanceof Promise)) {\n      // Didn't get a promise - provide as a resolved promise\n      status = AwaitRenderStatus.success;\n      promise = Promise.resolve();\n      Object.defineProperty(promise, \"_tracked\", {\n        get: () => true\n      });\n      Object.defineProperty(promise, \"_data\", {\n        get: () => resolve\n      });\n    } else if (this.state.error) {\n      // Caught a render error, provide it as a rejected promise\n      status = AwaitRenderStatus.error;\n      let renderError = this.state.error;\n      promise = Promise.reject().catch(() => {}); // Avoid unhandled rejection warnings\n\n      Object.defineProperty(promise, \"_tracked\", {\n        get: () => true\n      });\n      Object.defineProperty(promise, \"_error\", {\n        get: () => renderError\n      });\n    } else if (resolve._tracked) {\n      // Already tracked promise - check contents\n      promise = resolve;\n      status = promise._error !== undefined ? AwaitRenderStatus.error : promise._data !== undefined ? AwaitRenderStatus.success : AwaitRenderStatus.pending;\n    } else {\n      // Raw (untracked) promise - track it\n      status = AwaitRenderStatus.pending;\n      Object.defineProperty(resolve, \"_tracked\", {\n        get: () => true\n      });\n      promise = resolve.then(data => Object.defineProperty(resolve, \"_data\", {\n        get: () => data\n      }), error => Object.defineProperty(resolve, \"_error\", {\n        get: () => error\n      }));\n    }\n\n    if (status === AwaitRenderStatus.error && promise._error instanceof AbortedDeferredError) {\n      // Freeze the UI by throwing a never resolved promise\n      throw neverSettledPromise;\n    }\n\n    if (status === AwaitRenderStatus.error && !errorElement) {\n      // No errorElement, throw to the nearest route-level error boundary\n      throw promise._error;\n    }\n\n    if (status === AwaitRenderStatus.error) {\n      // Render via our errorElement\n      return /*#__PURE__*/React.createElement(AwaitContext.Provider, {\n        value: promise,\n        children: errorElement\n      });\n    }\n\n    if (status === AwaitRenderStatus.success) {\n      // Render children with resolved value\n      return /*#__PURE__*/React.createElement(AwaitContext.Provider, {\n        value: promise,\n        children: children\n      });\n    } // Throw to the suspense boundary\n\n\n    throw promise;\n  }\n\n}\n/**\n * @private\n * Indirection to leverage useAsyncValue for a render-prop API on <Await>\n */\n\n\nfunction ResolveAwait(_ref7) {\n  let {\n    children\n  } = _ref7;\n  let data = useAsyncValue();\n\n  if (typeof children === \"function\") {\n    return children(data);\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, children);\n} ///////////////////////////////////////////////////////////////////////////////\n// UTILS\n///////////////////////////////////////////////////////////////////////////////\n\n/**\n * Creates a route config from a React \"children\" object, which is usually\n * either a `<Route>` element or an array of them. Used internally by\n * `<Routes>` to create a route config from its children.\n *\n * @see https://reactrouter.com/utils/create-routes-from-children\n */\n\n\nfunction createRoutesFromChildren(children, parentPath) {\n  if (parentPath === void 0) {\n    parentPath = [];\n  }\n\n  let routes = [];\n  React.Children.forEach(children, (element, index) => {\n    if (! /*#__PURE__*/React.isValidElement(element)) {\n      // Ignore non-elements. This allows people to more easily inline\n      // conditionals in their route config.\n      return;\n    }\n\n    if (element.type === React.Fragment) {\n      // Transparently support React.Fragment and its children.\n      routes.push.apply(routes, createRoutesFromChildren(element.props.children, parentPath));\n      return;\n    }\n\n    !(element.type === Route) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"[\" + (typeof element.type === \"string\" ? element.type : element.type.name) + \"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>\") : invariant(false) : void 0;\n    !(!element.props.index || !element.props.children) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"An index route cannot have child routes.\") : invariant(false) : void 0;\n    let treePath = [...parentPath, index];\n    let route = {\n      id: element.props.id || treePath.join(\"-\"),\n      caseSensitive: element.props.caseSensitive,\n      element: element.props.element,\n      index: element.props.index,\n      path: element.props.path,\n      loader: element.props.loader,\n      action: element.props.action,\n      errorElement: element.props.errorElement,\n      hasErrorBoundary: element.props.errorElement != null,\n      shouldRevalidate: element.props.shouldRevalidate,\n      handle: element.props.handle\n    };\n\n    if (element.props.children) {\n      route.children = createRoutesFromChildren(element.props.children, treePath);\n    }\n\n    routes.push(route);\n  });\n  return routes;\n}\n/**\n * Renders the result of `matchRoutes()` into a React element.\n */\n\nfunction renderMatches(matches) {\n  return _renderMatches(matches);\n}\n/**\n * @private\n * Walk the route tree and add hasErrorBoundary if it's not provided, so that\n * users providing manual route arrays can just specify errorElement\n */\n\nfunction enhanceManualRouteObjects(routes) {\n  return routes.map(route => {\n    let routeClone = _extends({}, route);\n\n    if (routeClone.hasErrorBoundary == null) {\n      routeClone.hasErrorBoundary = routeClone.errorElement != null;\n    }\n\n    if (routeClone.children) {\n      routeClone.children = enhanceManualRouteObjects(routeClone.children);\n    }\n\n    return routeClone;\n  });\n}\n\nfunction createMemoryRouter(routes, opts) {\n  return createRouter({\n    basename: opts == null ? void 0 : opts.basename,\n    history: createMemoryHistory({\n      initialEntries: opts == null ? void 0 : opts.initialEntries,\n      initialIndex: opts == null ? void 0 : opts.initialIndex\n    }),\n    hydrationData: opts == null ? void 0 : opts.hydrationData,\n    routes: enhanceManualRouteObjects(routes)\n  }).initialize();\n} ///////////////////////////////////////////////////////////////////////////////\n\nexport { Await, MemoryRouter, Navigate, Outlet, Route, Router, RouterProvider, Routes, DataRouterContext as UNSAFE_DataRouterContext, DataRouterStateContext as UNSAFE_DataRouterStateContext, DataStaticRouterContext as UNSAFE_DataStaticRouterContext, LocationContext as UNSAFE_LocationContext, NavigationContext as UNSAFE_NavigationContext, RouteContext as UNSAFE_RouteContext, enhanceManualRouteObjects as UNSAFE_enhanceManualRouteObjects, createMemoryRouter, createRoutesFromChildren, createRoutesFromChildren as createRoutesFromElements, renderMatches, useActionData, useAsyncError, useAsyncValue, useHref, useInRouterContext, useLoaderData, useLocation, useMatch, useMatches, useNavigate, useNavigation, useNavigationType, useOutlet, useOutletContext, useParams, useResolvedPath, useRevalidator, useRouteError, useRouteLoaderData, useRoutes };\n//# sourceMappingURL=index.js.map\n","/**\n * React Router DOM v6.6.1\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nimport * as React from 'react';\nimport { UNSAFE_enhanceManualRouteObjects, Router, useHref, useResolvedPath, useLocation, UNSAFE_DataRouterStateContext, UNSAFE_NavigationContext, useNavigate, createPath, UNSAFE_RouteContext, useMatches, useNavigation, UNSAFE_DataRouterContext } from 'react-router';\nexport { AbortedDeferredError, Await, MemoryRouter, Navigate, NavigationType, Outlet, Route, Router, RouterProvider, Routes, UNSAFE_DataRouterContext, UNSAFE_DataRouterStateContext, UNSAFE_DataStaticRouterContext, UNSAFE_LocationContext, UNSAFE_NavigationContext, UNSAFE_RouteContext, UNSAFE_enhanceManualRouteObjects, createMemoryRouter, createPath, createRoutesFromChildren, createRoutesFromElements, defer, generatePath, isRouteErrorResponse, json, matchPath, matchRoutes, parsePath, redirect, renderMatches, resolvePath, useActionData, useAsyncError, useAsyncValue, useHref, useInRouterContext, useLoaderData, useLocation, useMatch, useMatches, useNavigate, useNavigation, useNavigationType, useOutlet, useOutletContext, useParams, useResolvedPath, useRevalidator, useRouteError, useRouteLoaderData, useRoutes } from 'react-router';\nimport { createRouter, createBrowserHistory, createHashHistory, ErrorResponse, invariant, joinPaths } from '@remix-run/router';\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nconst defaultMethod = \"get\";\nconst defaultEncType = \"application/x-www-form-urlencoded\";\nfunction isHtmlElement(object) {\n  return object != null && typeof object.tagName === \"string\";\n}\nfunction isButtonElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"button\";\n}\nfunction isFormElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"form\";\n}\nfunction isInputElement(object) {\n  return isHtmlElement(object) && object.tagName.toLowerCase() === \"input\";\n}\n\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\n\nfunction shouldProcessLinkClick(event, target) {\n  return event.button === 0 && ( // Ignore everything but left clicks\n  !target || target === \"_self\") && // Let browser handle \"target=_blank\" etc.\n  !isModifiedEvent(event) // Ignore clicks with modifier keys\n  ;\n}\n/**\n * Creates a URLSearchParams object using the given initializer.\n *\n * This is identical to `new URLSearchParams(init)` except it also\n * supports arrays as values in the object form of the initializer\n * instead of just strings. This is convenient when you need multiple\n * values for a given key, but don't want to use an array initializer.\n *\n * For example, instead of:\n *\n *   let searchParams = new URLSearchParams([\n *     ['sort', 'name'],\n *     ['sort', 'price']\n *   ]);\n *\n * you can do:\n *\n *   let searchParams = createSearchParams({\n *     sort: ['name', 'price']\n *   });\n */\n\nfunction createSearchParams(init) {\n  if (init === void 0) {\n    init = \"\";\n  }\n\n  return new URLSearchParams(typeof init === \"string\" || Array.isArray(init) || init instanceof URLSearchParams ? init : Object.keys(init).reduce((memo, key) => {\n    let value = init[key];\n    return memo.concat(Array.isArray(value) ? value.map(v => [key, v]) : [[key, value]]);\n  }, []));\n}\nfunction getSearchParamsForLocation(locationSearch, defaultSearchParams) {\n  let searchParams = createSearchParams(locationSearch);\n\n  for (let key of defaultSearchParams.keys()) {\n    if (!searchParams.has(key)) {\n      defaultSearchParams.getAll(key).forEach(value => {\n        searchParams.append(key, value);\n      });\n    }\n  }\n\n  return searchParams;\n}\nfunction getFormSubmissionInfo(target, defaultAction, options) {\n  let method;\n  let action;\n  let encType;\n  let formData;\n\n  if (isFormElement(target)) {\n    let submissionTrigger = options.submissionTrigger;\n    method = options.method || target.getAttribute(\"method\") || defaultMethod;\n    action = options.action || target.getAttribute(\"action\") || defaultAction;\n    encType = options.encType || target.getAttribute(\"enctype\") || defaultEncType;\n    formData = new FormData(target);\n\n    if (submissionTrigger && submissionTrigger.name) {\n      formData.append(submissionTrigger.name, submissionTrigger.value);\n    }\n  } else if (isButtonElement(target) || isInputElement(target) && (target.type === \"submit\" || target.type === \"image\")) {\n    let form = target.form;\n\n    if (form == null) {\n      throw new Error(\"Cannot submit a <button> or <input type=\\\"submit\\\"> without a <form>\");\n    } // <button>/<input type=\"submit\"> may override attributes of <form>\n\n\n    method = options.method || target.getAttribute(\"formmethod\") || form.getAttribute(\"method\") || defaultMethod;\n    action = options.action || target.getAttribute(\"formaction\") || form.getAttribute(\"action\") || defaultAction;\n    encType = options.encType || target.getAttribute(\"formenctype\") || form.getAttribute(\"enctype\") || defaultEncType;\n    formData = new FormData(form); // Include name + value from a <button>, appending in case the button name\n    // matches an existing input name\n\n    if (target.name) {\n      formData.append(target.name, target.value);\n    }\n  } else if (isHtmlElement(target)) {\n    throw new Error(\"Cannot submit element that is not <form>, <button>, or \" + \"<input type=\\\"submit|image\\\">\");\n  } else {\n    method = options.method || defaultMethod;\n    action = options.action || defaultAction;\n    encType = options.encType || defaultEncType;\n\n    if (target instanceof FormData) {\n      formData = target;\n    } else {\n      formData = new FormData();\n\n      if (target instanceof URLSearchParams) {\n        for (let [name, value] of target) {\n          formData.append(name, value);\n        }\n      } else if (target != null) {\n        for (let name of Object.keys(target)) {\n          formData.append(name, target[name]);\n        }\n      }\n    }\n  }\n\n  let {\n    protocol,\n    host\n  } = window.location;\n  let url = new URL(action, protocol + \"//\" + host);\n  return {\n    url,\n    method: method.toLowerCase(),\n    encType,\n    formData\n  };\n}\n\nconst _excluded = [\"onClick\", \"relative\", \"reloadDocument\", \"replace\", \"state\", \"target\", \"to\", \"preventScrollReset\"],\n      _excluded2 = [\"aria-current\", \"caseSensitive\", \"className\", \"end\", \"style\", \"to\", \"children\"],\n      _excluded3 = [\"reloadDocument\", \"replace\", \"method\", \"action\", \"onSubmit\", \"fetcherKey\", \"routeId\", \"relative\"];\n//#region Routers\n////////////////////////////////////////////////////////////////////////////////\n\nfunction createBrowserRouter(routes, opts) {\n  return createRouter({\n    basename: opts == null ? void 0 : opts.basename,\n    history: createBrowserHistory({\n      window: opts == null ? void 0 : opts.window\n    }),\n    hydrationData: (opts == null ? void 0 : opts.hydrationData) || parseHydrationData(),\n    routes: UNSAFE_enhanceManualRouteObjects(routes)\n  }).initialize();\n}\nfunction createHashRouter(routes, opts) {\n  return createRouter({\n    basename: opts == null ? void 0 : opts.basename,\n    history: createHashHistory({\n      window: opts == null ? void 0 : opts.window\n    }),\n    hydrationData: (opts == null ? void 0 : opts.hydrationData) || parseHydrationData(),\n    routes: UNSAFE_enhanceManualRouteObjects(routes)\n  }).initialize();\n}\n\nfunction parseHydrationData() {\n  var _window;\n\n  let state = (_window = window) == null ? void 0 : _window.__staticRouterHydrationData;\n\n  if (state && state.errors) {\n    state = _extends({}, state, {\n      errors: deserializeErrors(state.errors)\n    });\n  }\n\n  return state;\n}\n\nfunction deserializeErrors(errors) {\n  if (!errors) return null;\n  let entries = Object.entries(errors);\n  let serialized = {};\n\n  for (let [key, val] of entries) {\n    // Hey you!  If you change this, please change the corresponding logic in\n    // serializeErrors in react-router-dom/server.tsx :)\n    if (val && val.__type === \"RouteErrorResponse\") {\n      serialized[key] = new ErrorResponse(val.status, val.statusText, val.data, val.internal === true);\n    } else if (val && val.__type === \"Error\") {\n      let error = new Error(val.message); // Wipe away the client-side stack trace.  Nothing to fill it in with\n      // because we don't serialize SSR stack traces for security reasons\n\n      error.stack = \"\";\n      serialized[key] = error;\n    } else {\n      serialized[key] = val;\n    }\n  }\n\n  return serialized;\n}\n/**\n * A `<Router>` for use in web browsers. Provides the cleanest URLs.\n */\n\n\nfunction BrowserRouter(_ref) {\n  let {\n    basename,\n    children,\n    window\n  } = _ref;\n  let historyRef = React.useRef();\n\n  if (historyRef.current == null) {\n    historyRef.current = createBrowserHistory({\n      window,\n      v5Compat: true\n    });\n  }\n\n  let history = historyRef.current;\n  let [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n  React.useLayoutEffect(() => history.listen(setState), [history]);\n  return /*#__PURE__*/React.createElement(Router, {\n    basename: basename,\n    children: children,\n    location: state.location,\n    navigationType: state.action,\n    navigator: history\n  });\n}\n/**\n * A `<Router>` for use in web browsers. Stores the location in the hash\n * portion of the URL so it is not sent to the server.\n */\n\nfunction HashRouter(_ref2) {\n  let {\n    basename,\n    children,\n    window\n  } = _ref2;\n  let historyRef = React.useRef();\n\n  if (historyRef.current == null) {\n    historyRef.current = createHashHistory({\n      window,\n      v5Compat: true\n    });\n  }\n\n  let history = historyRef.current;\n  let [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n  React.useLayoutEffect(() => history.listen(setState), [history]);\n  return /*#__PURE__*/React.createElement(Router, {\n    basename: basename,\n    children: children,\n    location: state.location,\n    navigationType: state.action,\n    navigator: history\n  });\n}\n/**\n * A `<Router>` that accepts a pre-instantiated history object. It's important\n * to note that using your own history object is highly discouraged and may add\n * two versions of the history library to your bundles unless you use the same\n * version of the history library that React Router uses internally.\n */\n\nfunction HistoryRouter(_ref3) {\n  let {\n    basename,\n    children,\n    history\n  } = _ref3;\n  const [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n  React.useLayoutEffect(() => history.listen(setState), [history]);\n  return /*#__PURE__*/React.createElement(Router, {\n    basename: basename,\n    children: children,\n    location: state.location,\n    navigationType: state.action,\n    navigator: history\n  });\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  HistoryRouter.displayName = \"unstable_HistoryRouter\";\n}\n/**\n * The public API for rendering a history-aware <a>.\n */\n\nconst Link = /*#__PURE__*/React.forwardRef(function LinkWithRef(_ref4, ref) {\n  let {\n    onClick,\n    relative,\n    reloadDocument,\n    replace,\n    state,\n    target,\n    to,\n    preventScrollReset\n  } = _ref4,\n      rest = _objectWithoutPropertiesLoose(_ref4, _excluded);\n\n  let href = useHref(to, {\n    relative\n  });\n  let internalOnClick = useLinkClickHandler(to, {\n    replace,\n    state,\n    target,\n    preventScrollReset,\n    relative\n  });\n\n  function handleClick(event) {\n    if (onClick) onClick(event);\n\n    if (!event.defaultPrevented) {\n      internalOnClick(event);\n    }\n  }\n\n  return (\n    /*#__PURE__*/\n    // eslint-disable-next-line jsx-a11y/anchor-has-content\n    React.createElement(\"a\", _extends({}, rest, {\n      href: href,\n      onClick: reloadDocument ? onClick : handleClick,\n      ref: ref,\n      target: target\n    }))\n  );\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  Link.displayName = \"Link\";\n}\n/**\n * A <Link> wrapper that knows if it's \"active\" or not.\n */\n\n\nconst NavLink = /*#__PURE__*/React.forwardRef(function NavLinkWithRef(_ref5, ref) {\n  let {\n    \"aria-current\": ariaCurrentProp = \"page\",\n    caseSensitive = false,\n    className: classNameProp = \"\",\n    end = false,\n    style: styleProp,\n    to,\n    children\n  } = _ref5,\n      rest = _objectWithoutPropertiesLoose(_ref5, _excluded2);\n\n  let path = useResolvedPath(to, {\n    relative: rest.relative\n  });\n  let location = useLocation();\n  let routerState = React.useContext(UNSAFE_DataRouterStateContext);\n  let {\n    navigator\n  } = React.useContext(UNSAFE_NavigationContext);\n  let toPathname = navigator.encodeLocation ? navigator.encodeLocation(path).pathname : path.pathname;\n  let locationPathname = location.pathname;\n  let nextLocationPathname = routerState && routerState.navigation && routerState.navigation.location ? routerState.navigation.location.pathname : null;\n\n  if (!caseSensitive) {\n    locationPathname = locationPathname.toLowerCase();\n    nextLocationPathname = nextLocationPathname ? nextLocationPathname.toLowerCase() : null;\n    toPathname = toPathname.toLowerCase();\n  }\n\n  let isActive = locationPathname === toPathname || !end && locationPathname.startsWith(toPathname) && locationPathname.charAt(toPathname.length) === \"/\";\n  let isPending = nextLocationPathname != null && (nextLocationPathname === toPathname || !end && nextLocationPathname.startsWith(toPathname) && nextLocationPathname.charAt(toPathname.length) === \"/\");\n  let ariaCurrent = isActive ? ariaCurrentProp : undefined;\n  let className;\n\n  if (typeof classNameProp === \"function\") {\n    className = classNameProp({\n      isActive,\n      isPending\n    });\n  } else {\n    // If the className prop is not a function, we use a default `active`\n    // class for <NavLink />s that are active. In v5 `active` was the default\n    // value for `activeClassName`, but we are removing that API and can still\n    // use the old default behavior for a cleaner upgrade path and keep the\n    // simple styling rules working as they currently do.\n    className = [classNameProp, isActive ? \"active\" : null, isPending ? \"pending\" : null].filter(Boolean).join(\" \");\n  }\n\n  let style = typeof styleProp === \"function\" ? styleProp({\n    isActive,\n    isPending\n  }) : styleProp;\n  return /*#__PURE__*/React.createElement(Link, _extends({}, rest, {\n    \"aria-current\": ariaCurrent,\n    className: className,\n    ref: ref,\n    style: style,\n    to: to\n  }), typeof children === \"function\" ? children({\n    isActive,\n    isPending\n  }) : children);\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  NavLink.displayName = \"NavLink\";\n}\n/**\n * A `@remix-run/router`-aware `<form>`. It behaves like a normal form except\n * that the interaction with the server is with `fetch` instead of new document\n * requests, allowing components to add nicer UX to the page as the form is\n * submitted and returns with data.\n */\n\n\nconst Form = /*#__PURE__*/React.forwardRef((props, ref) => {\n  return /*#__PURE__*/React.createElement(FormImpl, _extends({}, props, {\n    ref: ref\n  }));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  Form.displayName = \"Form\";\n}\n\nconst FormImpl = /*#__PURE__*/React.forwardRef((_ref6, forwardedRef) => {\n  let {\n    reloadDocument,\n    replace,\n    method = defaultMethod,\n    action,\n    onSubmit,\n    fetcherKey,\n    routeId,\n    relative\n  } = _ref6,\n      props = _objectWithoutPropertiesLoose(_ref6, _excluded3);\n\n  let submit = useSubmitImpl(fetcherKey, routeId);\n  let formMethod = method.toLowerCase() === \"get\" ? \"get\" : \"post\";\n  let formAction = useFormAction(action, {\n    relative\n  });\n\n  let submitHandler = event => {\n    onSubmit && onSubmit(event);\n    if (event.defaultPrevented) return;\n    event.preventDefault();\n    let submitter = event.nativeEvent.submitter;\n    let submitMethod = (submitter == null ? void 0 : submitter.getAttribute(\"formmethod\")) || method;\n    submit(submitter || event.currentTarget, {\n      method: submitMethod,\n      replace,\n      relative\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"form\", _extends({\n    ref: forwardedRef,\n    method: formMethod,\n    action: formAction,\n    onSubmit: reloadDocument ? onSubmit : submitHandler\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  FormImpl.displayName = \"FormImpl\";\n}\n/**\n * This component will emulate the browser's scroll restoration on location\n * changes.\n */\n\n\nfunction ScrollRestoration(_ref7) {\n  let {\n    getKey,\n    storageKey\n  } = _ref7;\n  useScrollRestoration({\n    getKey,\n    storageKey\n  });\n  return null;\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  ScrollRestoration.displayName = \"ScrollRestoration\";\n} //#endregion\n////////////////////////////////////////////////////////////////////////////////\n//#region Hooks\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar DataRouterHook;\n\n(function (DataRouterHook) {\n  DataRouterHook[\"UseScrollRestoration\"] = \"useScrollRestoration\";\n  DataRouterHook[\"UseSubmitImpl\"] = \"useSubmitImpl\";\n  DataRouterHook[\"UseFetcher\"] = \"useFetcher\";\n})(DataRouterHook || (DataRouterHook = {}));\n\nvar DataRouterStateHook;\n\n(function (DataRouterStateHook) {\n  DataRouterStateHook[\"UseFetchers\"] = \"useFetchers\";\n  DataRouterStateHook[\"UseScrollRestoration\"] = \"useScrollRestoration\";\n})(DataRouterStateHook || (DataRouterStateHook = {}));\n\nfunction getDataRouterConsoleError(hookName) {\n  return hookName + \" must be used within a data router.  See https://reactrouter.com/routers/picking-a-router.\";\n}\n\nfunction useDataRouterContext(hookName) {\n  let ctx = React.useContext(UNSAFE_DataRouterContext);\n  !ctx ? process.env.NODE_ENV !== \"production\" ? invariant(false, getDataRouterConsoleError(hookName)) : invariant(false) : void 0;\n  return ctx;\n}\n\nfunction useDataRouterState(hookName) {\n  let state = React.useContext(UNSAFE_DataRouterStateContext);\n  !state ? process.env.NODE_ENV !== \"production\" ? invariant(false, getDataRouterConsoleError(hookName)) : invariant(false) : void 0;\n  return state;\n}\n/**\n * Handles the click behavior for router `<Link>` components. This is useful if\n * you need to create custom `<Link>` components with the same click behavior we\n * use in our exported `<Link>`.\n */\n\n\nfunction useLinkClickHandler(to, _temp) {\n  let {\n    target,\n    replace: replaceProp,\n    state,\n    preventScrollReset,\n    relative\n  } = _temp === void 0 ? {} : _temp;\n  let navigate = useNavigate();\n  let location = useLocation();\n  let path = useResolvedPath(to, {\n    relative\n  });\n  return React.useCallback(event => {\n    if (shouldProcessLinkClick(event, target)) {\n      event.preventDefault(); // If the URL hasn't changed, a regular <a> will do a replace instead of\n      // a push, so do the same here unless the replace prop is explicitly set\n\n      let replace = replaceProp !== undefined ? replaceProp : createPath(location) === createPath(path);\n      navigate(to, {\n        replace,\n        state,\n        preventScrollReset,\n        relative\n      });\n    }\n  }, [location, navigate, path, replaceProp, state, target, to, preventScrollReset, relative]);\n}\n/**\n * A convenient wrapper for reading and writing search parameters via the\n * URLSearchParams interface.\n */\n\nfunction useSearchParams(defaultInit) {\n  process.env.NODE_ENV !== \"production\" ? warning(typeof URLSearchParams !== \"undefined\", \"You cannot use the `useSearchParams` hook in a browser that does not \" + \"support the URLSearchParams API. If you need to support Internet \" + \"Explorer 11, we recommend you load a polyfill such as \" + \"https://github.com/ungap/url-search-params\\n\\n\" + \"If you're unsure how to load polyfills, we recommend you check out \" + \"https://polyfill.io/v3/ which provides some recommendations about how \" + \"to load polyfills only for users that need them, instead of for every \" + \"user.\") : void 0;\n  let defaultSearchParamsRef = React.useRef(createSearchParams(defaultInit));\n  let location = useLocation();\n  let searchParams = React.useMemo(() => getSearchParamsForLocation(location.search, defaultSearchParamsRef.current), [location.search]);\n  let navigate = useNavigate();\n  let setSearchParams = React.useCallback((nextInit, navigateOptions) => {\n    const newSearchParams = createSearchParams(typeof nextInit === \"function\" ? nextInit(searchParams) : nextInit);\n    navigate(\"?\" + newSearchParams, navigateOptions);\n  }, [navigate, searchParams]);\n  return [searchParams, setSearchParams];\n}\n/**\n * Returns a function that may be used to programmatically submit a form (or\n * some arbitrary data) to the server.\n */\n\nfunction useSubmit() {\n  return useSubmitImpl();\n}\n\nfunction useSubmitImpl(fetcherKey, routeId) {\n  let {\n    router\n  } = useDataRouterContext(DataRouterHook.UseSubmitImpl);\n  let defaultAction = useFormAction();\n  return React.useCallback(function (target, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof document === \"undefined\") {\n      throw new Error(\"You are calling submit during the server render. \" + \"Try calling submit within a `useEffect` or callback instead.\");\n    }\n\n    let {\n      method,\n      encType,\n      formData,\n      url\n    } = getFormSubmissionInfo(target, defaultAction, options);\n    let href = url.pathname + url.search;\n    let opts = {\n      replace: options.replace,\n      formData,\n      formMethod: method,\n      formEncType: encType\n    };\n\n    if (fetcherKey) {\n      !(routeId != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"No routeId available for useFetcher()\") : invariant(false) : void 0;\n      router.fetch(fetcherKey, routeId, href, opts);\n    } else {\n      router.navigate(href, opts);\n    }\n  }, [defaultAction, router, fetcherKey, routeId]);\n}\n\nfunction useFormAction(action, _temp2) {\n  let {\n    relative\n  } = _temp2 === void 0 ? {} : _temp2;\n  let {\n    basename\n  } = React.useContext(UNSAFE_NavigationContext);\n  let routeContext = React.useContext(UNSAFE_RouteContext);\n  !routeContext ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"useFormAction must be used inside a RouteContext\") : invariant(false) : void 0;\n  let [match] = routeContext.matches.slice(-1); // Shallow clone path so we can modify it below, otherwise we modify the\n  // object referenced by useMemo inside useResolvedPath\n\n  let path = _extends({}, useResolvedPath(action ? action : \".\", {\n    relative\n  })); // Previously we set the default action to \".\". The problem with this is that\n  // `useResolvedPath(\".\")` excludes search params and the hash of the resolved\n  // URL. This is the intended behavior of when \".\" is specifically provided as\n  // the form action, but inconsistent w/ browsers when the action is omitted.\n  // https://github.com/remix-run/remix/issues/927\n\n\n  let location = useLocation();\n\n  if (action == null) {\n    // Safe to write to these directly here since if action was undefined, we\n    // would have called useResolvedPath(\".\") which will never include a search\n    // or hash\n    path.search = location.search;\n    path.hash = location.hash; // When grabbing search params from the URL, remove the automatically\n    // inserted ?index param so we match the useResolvedPath search behavior\n    // which would not include ?index\n\n    if (match.route.index) {\n      let params = new URLSearchParams(path.search);\n      params.delete(\"index\");\n      path.search = params.toString() ? \"?\" + params.toString() : \"\";\n    }\n  }\n\n  if ((!action || action === \".\") && match.route.index) {\n    path.search = path.search ? path.search.replace(/^\\?/, \"?index&\") : \"?index\";\n  } // If we're operating within a basename, prepend it to the pathname prior\n  // to creating the form action.  If this is a root navigation, then just use\n  // the raw basename which allows the basename to have full control over the\n  // presence of a trailing slash on root actions\n\n\n  if (basename !== \"/\") {\n    path.pathname = path.pathname === \"/\" ? basename : joinPaths([basename, path.pathname]);\n  }\n\n  return createPath(path);\n}\n\nfunction createFetcherForm(fetcherKey, routeId) {\n  let FetcherForm = /*#__PURE__*/React.forwardRef((props, ref) => {\n    return /*#__PURE__*/React.createElement(FormImpl, _extends({}, props, {\n      ref: ref,\n      fetcherKey: fetcherKey,\n      routeId: routeId\n    }));\n  });\n\n  if (process.env.NODE_ENV !== \"production\") {\n    FetcherForm.displayName = \"fetcher.Form\";\n  }\n\n  return FetcherForm;\n}\n\nlet fetcherId = 0;\n/**\n * Interacts with route loaders and actions without causing a navigation. Great\n * for any interaction that stays on the same page.\n */\n\nfunction useFetcher() {\n  var _route$matches;\n\n  let {\n    router\n  } = useDataRouterContext(DataRouterHook.UseFetcher);\n  let route = React.useContext(UNSAFE_RouteContext);\n  !route ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"useFetcher must be used inside a RouteContext\") : invariant(false) : void 0;\n  let routeId = (_route$matches = route.matches[route.matches.length - 1]) == null ? void 0 : _route$matches.route.id;\n  !(routeId != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"useFetcher can only be used on routes that contain a unique \\\"id\\\"\") : invariant(false) : void 0;\n  let [fetcherKey] = React.useState(() => String(++fetcherId));\n  let [Form] = React.useState(() => {\n    !routeId ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"No routeId available for fetcher.Form()\") : invariant(false) : void 0;\n    return createFetcherForm(fetcherKey, routeId);\n  });\n  let [load] = React.useState(() => href => {\n    !router ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"No router available for fetcher.load()\") : invariant(false) : void 0;\n    !routeId ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"No routeId available for fetcher.load()\") : invariant(false) : void 0;\n    router.fetch(fetcherKey, routeId, href);\n  });\n  let submit = useSubmitImpl(fetcherKey, routeId);\n  let fetcher = router.getFetcher(fetcherKey);\n  let fetcherWithComponents = React.useMemo(() => _extends({\n    Form,\n    submit,\n    load\n  }, fetcher), [fetcher, Form, submit, load]);\n  React.useEffect(() => {\n    // Is this busted when the React team gets real weird and calls effects\n    // twice on mount?  We really just need to garbage collect here when this\n    // fetcher is no longer around.\n    return () => {\n      if (!router) {\n        console.warn(\"No fetcher available to clean up from useFetcher()\");\n        return;\n      }\n\n      router.deleteFetcher(fetcherKey);\n    };\n  }, [router, fetcherKey]);\n  return fetcherWithComponents;\n}\n/**\n * Provides all fetchers currently on the page. Useful for layouts and parent\n * routes that need to provide pending/optimistic UI regarding the fetch.\n */\n\nfunction useFetchers() {\n  let state = useDataRouterState(DataRouterStateHook.UseFetchers);\n  return [...state.fetchers.values()];\n}\nconst SCROLL_RESTORATION_STORAGE_KEY = \"react-router-scroll-positions\";\nlet savedScrollPositions = {};\n/**\n * When rendered inside a RouterProvider, will restore scroll positions on navigations\n */\n\nfunction useScrollRestoration(_temp3) {\n  let {\n    getKey,\n    storageKey\n  } = _temp3 === void 0 ? {} : _temp3;\n  let {\n    router\n  } = useDataRouterContext(DataRouterHook.UseScrollRestoration);\n  let {\n    restoreScrollPosition,\n    preventScrollReset\n  } = useDataRouterState(DataRouterStateHook.UseScrollRestoration);\n  let location = useLocation();\n  let matches = useMatches();\n  let navigation = useNavigation(); // Trigger manual scroll restoration while we're active\n\n  React.useEffect(() => {\n    window.history.scrollRestoration = \"manual\";\n    return () => {\n      window.history.scrollRestoration = \"auto\";\n    };\n  }, []); // Save positions on unload\n\n  useBeforeUnload(React.useCallback(() => {\n    if (navigation.state === \"idle\") {\n      let key = (getKey ? getKey(location, matches) : null) || location.key;\n      savedScrollPositions[key] = window.scrollY;\n    }\n\n    sessionStorage.setItem(storageKey || SCROLL_RESTORATION_STORAGE_KEY, JSON.stringify(savedScrollPositions));\n    window.history.scrollRestoration = \"auto\";\n  }, [storageKey, getKey, navigation.state, location, matches])); // Read in any saved scroll locations\n\n  if (typeof document !== \"undefined\") {\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    React.useLayoutEffect(() => {\n      try {\n        let sessionPositions = sessionStorage.getItem(storageKey || SCROLL_RESTORATION_STORAGE_KEY);\n\n        if (sessionPositions) {\n          savedScrollPositions = JSON.parse(sessionPositions);\n        }\n      } catch (e) {// no-op, use default empty object\n      }\n    }, [storageKey]); // Enable scroll restoration in the router\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n\n    React.useLayoutEffect(() => {\n      let disableScrollRestoration = router == null ? void 0 : router.enableScrollRestoration(savedScrollPositions, () => window.scrollY, getKey);\n      return () => disableScrollRestoration && disableScrollRestoration();\n    }, [router, getKey]); // Restore scrolling when state.restoreScrollPosition changes\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n\n    React.useLayoutEffect(() => {\n      // Explicit false means don't do anything (used for submissions)\n      if (restoreScrollPosition === false) {\n        return;\n      } // been here before, scroll to it\n\n\n      if (typeof restoreScrollPosition === \"number\") {\n        window.scrollTo(0, restoreScrollPosition);\n        return;\n      } // try to scroll to the hash\n\n\n      if (location.hash) {\n        let el = document.getElementById(location.hash.slice(1));\n\n        if (el) {\n          el.scrollIntoView();\n          return;\n        }\n      } // Opt out of scroll reset if this link requested it\n\n\n      if (preventScrollReset === true) {\n        return;\n      } // otherwise go to the top on new locations\n\n\n      window.scrollTo(0, 0);\n    }, [location, restoreScrollPosition, preventScrollReset]);\n  }\n}\n/**\n * Setup a callback to be fired on the window's `beforeunload` event. This is\n * useful for saving some data to `window.localStorage` just before the page\n * refreshes.\n *\n * Note: The `callback` argument should be a function created with\n * `React.useCallback()`.\n */\n\n\nfunction useBeforeUnload(callback) {\n  React.useEffect(() => {\n    window.addEventListener(\"beforeunload\", callback);\n    return () => {\n      window.removeEventListener(\"beforeunload\", callback);\n    };\n  }, [callback]);\n} //#endregion\n////////////////////////////////////////////////////////////////////////////////\n//#region Utils\n////////////////////////////////////////////////////////////////////////////////\n\nfunction warning(cond, message) {\n  if (!cond) {\n    // eslint-disable-next-line no-console\n    if (typeof console !== \"undefined\") console.warn(message);\n\n    try {\n      // Welcome to debugging React Router!\n      //\n      // This error is thrown as a convenience so you can more easily\n      // find the source for a warning that appears in the console by\n      // enabling \"pause on exceptions\" in your JavaScript debugger.\n      throw new Error(message); // eslint-disable-next-line no-empty\n    } catch (e) {}\n  }\n} //#endregion\n\nexport { BrowserRouter, Form, HashRouter, Link, NavLink, ScrollRestoration, useScrollRestoration as UNSAFE_useScrollRestoration, createBrowserRouter, createHashRouter, createSearchParams, HistoryRouter as unstable_HistoryRouter, useBeforeUnload, useFetcher, useFetchers, useFormAction, useLinkClickHandler, useSearchParams, useSubmit };\n//# sourceMappingURL=index.js.map\n","import * as React from 'react';\nimport { Context } from './injectIntl';\nimport { invariantIntlContext } from '../utils';\nexport default function useIntl() {\n    var intl = React.useContext(Context);\n    invariantIntlContext(intl);\n    return intl;\n}\n","/*\n * Copyright 2015, Yahoo Inc.\n * Copyrights licensed under the New BSD License.\n * See the accompanying LICENSE file for terms.\n */\nimport { __rest } from \"tslib\";\nimport * as React from 'react';\nimport useIntl from './useIntl';\nimport { shallowEqual } from '../utils';\nfunction areEqual(prevProps, nextProps) {\n    var values = prevProps.values, otherProps = __rest(prevProps, [\"values\"]);\n    var nextValues = nextProps.values, nextOtherProps = __rest(nextProps, [\"values\"]);\n    return (shallowEqual(nextValues, values) &&\n        shallowEqual(otherProps, nextOtherProps));\n}\nfunction FormattedMessage(props) {\n    var intl = useIntl();\n    var formatMessage = intl.formatMessage, _a = intl.textComponent, Text = _a === void 0 ? React.Fragment : _a;\n    var id = props.id, description = props.description, defaultMessage = props.defaultMessage, values = props.values, children = props.children, _b = props.tagName, Component = _b === void 0 ? Text : _b, ignoreTag = props.ignoreTag;\n    var descriptor = { id: id, description: description, defaultMessage: defaultMessage };\n    var nodes = formatMessage(descriptor, values, {\n        ignoreTag: ignoreTag,\n    });\n    if (typeof children === 'function') {\n        return children(Array.isArray(nodes) ? nodes : [nodes]);\n    }\n    if (Component) {\n        return React.createElement(Component, null, React.Children.toArray(nodes));\n    }\n    return React.createElement(React.Fragment, null, nodes);\n}\nFormattedMessage.displayName = 'FormattedMessage';\nvar MemoizedFormattedMessage = React.memo(FormattedMessage, areEqual);\nMemoizedFormattedMessage.displayName = 'MemoizedFormattedMessage';\nexport default MemoizedFormattedMessage;\n","import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport useIntl from './useIntl';\nvar DisplayName;\n(function (DisplayName) {\n    DisplayName[\"formatDate\"] = \"FormattedDate\";\n    DisplayName[\"formatTime\"] = \"FormattedTime\";\n    DisplayName[\"formatNumber\"] = \"FormattedNumber\";\n    DisplayName[\"formatList\"] = \"FormattedList\";\n    // Note that this DisplayName is the locale display name, not to be confused with\n    // the name of the enum, which is for React component display name in dev tools.\n    DisplayName[\"formatDisplayName\"] = \"FormattedDisplayName\";\n})(DisplayName || (DisplayName = {}));\nvar DisplayNameParts;\n(function (DisplayNameParts) {\n    DisplayNameParts[\"formatDate\"] = \"FormattedDateParts\";\n    DisplayNameParts[\"formatTime\"] = \"FormattedTimeParts\";\n    DisplayNameParts[\"formatNumber\"] = \"FormattedNumberParts\";\n    DisplayNameParts[\"formatList\"] = \"FormattedListParts\";\n})(DisplayNameParts || (DisplayNameParts = {}));\nexport var FormattedNumberParts = function (props) {\n    var intl = useIntl();\n    var value = props.value, children = props.children, formatProps = __rest(props, [\"value\", \"children\"]);\n    return children(intl.formatNumberToParts(value, formatProps));\n};\nFormattedNumberParts.displayName = 'FormattedNumberParts';\nexport var FormattedListParts = function (props) {\n    var intl = useIntl();\n    var value = props.value, children = props.children, formatProps = __rest(props, [\"value\", \"children\"]);\n    return children(intl.formatListToParts(value, formatProps));\n};\nFormattedNumberParts.displayName = 'FormattedNumberParts';\nexport function createFormattedDateTimePartsComponent(name) {\n    var ComponentParts = function (props) {\n        var intl = useIntl();\n        var value = props.value, children = props.children, formatProps = __rest(props, [\"value\", \"children\"]);\n        var date = typeof value === 'string' ? new Date(value || 0) : value;\n        var formattedParts = name === 'formatDate'\n            ? intl.formatDateToParts(date, formatProps)\n            : intl.formatTimeToParts(date, formatProps);\n        return children(formattedParts);\n    };\n    ComponentParts.displayName = DisplayNameParts[name];\n    return ComponentParts;\n}\nexport function createFormattedComponent(name) {\n    var Component = function (props) {\n        var intl = useIntl();\n        var value = props.value, children = props.children, formatProps = __rest(props\n        // TODO: fix TS type definition for localeMatcher upstream\n        , [\"value\", \"children\"]);\n        // TODO: fix TS type definition for localeMatcher upstream\n        var formattedValue = intl[name](value, formatProps);\n        if (typeof children === 'function') {\n            return children(formattedValue);\n        }\n        var Text = intl.textComponent || React.Fragment;\n        return React.createElement(Text, null, formattedValue);\n    };\n    Component.displayName = DisplayName[name];\n    return Component;\n}\n","import { createFormattedComponent, createFormattedDateTimePartsComponent, } from './src/components/createFormattedComponent';\nimport injectIntl, { Provider as RawIntlProvider, Context as IntlContext, } from './src/components/injectIntl';\nimport useIntl from './src/components/useIntl';\nimport IntlProvider, { createIntl } from './src/components/provider';\nimport FormattedRelativeTime from './src/components/relative';\nimport FormattedPlural from './src/components/plural';\nimport FormattedMessage from './src/components/message';\nimport FormattedDateTimeRange from './src/components/dateTimeRange';\nexport { FormattedDateTimeRange, FormattedMessage, FormattedPlural, FormattedRelativeTime, IntlContext, IntlProvider, RawIntlProvider, createIntl, injectIntl, useIntl, };\nexport { createIntlCache, UnsupportedFormatterError, InvalidConfigError, MissingDataError, MessageFormatError, MissingTranslationError, IntlErrorCode as ReactIntlErrorCode, IntlError as ReactIntlError, } from '@formatjs/intl';\nexport function defineMessages(msgs) {\n    return msgs;\n}\nexport function defineMessage(msg) {\n    return msg;\n}\n// IMPORTANT: Explicit here to prevent api-extractor from outputing `import('./src/types').CustomFormatConfig`\nexport var FormattedDate = createFormattedComponent('formatDate');\nexport var FormattedTime = createFormattedComponent('formatTime');\nexport var FormattedNumber = createFormattedComponent('formatNumber');\nexport var FormattedList = createFormattedComponent('formatList');\nexport var FormattedDisplayName = createFormattedComponent('formatDisplayName');\nexport var FormattedDateParts = createFormattedDateTimePartsComponent('formatDate');\nexport var FormattedTimeParts = createFormattedDateTimePartsComponent('formatTime');\nexport { FormattedNumberParts, FormattedListParts, } from './src/components/createFormattedComponent';\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\ninterface ErrorTypes {\n  [key: string]: string;\n  PATTERN_MISMATCH: string;\n  RANGE_OVERFLOW: string;\n  RANGE_UNDERFLOW: string;\n  STEP_MISMATCH: string;\n  TOO_LONG: string;\n  TYPE_MISMATCH: string;\n  VALUE_MISSING: string;\n}\n\nexport class ValidationError extends Error {\n  public label: string;\n  constructor(label: string) {\n    super(label);\n    this.name = this.constructor.name;\n    this.label = label;\n  }\n\n  is = (label: string) => {\n    return this.label === label;\n  };\n\n  static getAllPropertyNames(obj: {}): string[] {\n    let props: string[] = [];\n    do {\n      props = props.concat(Object.getOwnPropertyNames(obj));\n    } while ((obj = Object.getPrototypeOf(obj)));\n    return props;\n  }\n\n  static handleValidationState(fieldName: string, validationState: ValidityState): ValidationError | null {\n    const field = ValidationError.getFieldByName(fieldName);\n    const validationStateKeys = ValidationError.getAllPropertyNames(validationState);\n    for (const key of validationStateKeys) {\n      if (Object.values(ValidationError.ERROR).includes(key) && validationState[key as keyof ValidityState]) {\n        return new ValidationError(field[ValidationError.getErrorKeyByValue(key)]);\n      }\n    }\n    return null;\n  }\n\n  static ERROR = {\n    PATTERN_MISMATCH: 'patternMismatch',\n    RANGE_OVERFLOW: 'rangeOverflow',\n    RANGE_UNDERFLOW: 'rangeUnderflow',\n    STEP_MISMATCH: 'stepMismatch',\n    TOO_LONG: 'tooLong',\n    TYPE_MISMATCH: 'typeMismatch',\n    VALUE_MISSING: 'valueMissing',\n  };\n\n  static getErrorKeyByValue = (errorValue: string): string => {\n    return Object.entries(ValidationError.ERROR).find(([key, value]) => value === errorValue)[0];\n  };\n\n  static mapErrorsToField = (fieldName: string): ErrorTypes => {\n    return Object.entries(ValidationError.ERROR).reduce(\n      (errors, [key, value]) => ({...errors, [key]: `${fieldName}-${value}`}),\n      ValidationError.ERROR,\n    );\n  };\n\n  static FIELD = {\n    EMAIL: {...ValidationError.mapErrorsToField('email'), name: 'email'},\n    NAME: {...ValidationError.mapErrorsToField('name'), name: 'name'},\n    PASSWORD: {...ValidationError.mapErrorsToField('password'), name: 'password'},\n    PASSWORD_LOGIN: {...ValidationError.mapErrorsToField('password-login'), name: 'password-login'},\n    SSO_CODE: {...ValidationError.mapErrorsToField('sso-code'), name: 'sso-code'},\n    SSO_EMAIL_CODE: {...ValidationError.mapErrorsToField('sso-code-email'), name: 'sso-code-email'},\n  };\n\n  static getFieldByName = (fieldName: string): ErrorTypes => {\n    return Object.entries(ValidationError.FIELD).find(([key, value]) => value.name === fieldName)[1];\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BackendErrorLabel, SyntheticErrorLabel} from '@wireapp/api-client/lib/http/';\nimport {defineMessages} from 'react-intl';\n\nimport {BackendError} from './auth/module/action/BackendError';\nimport {LabeledError} from './auth/module/action/LabeledError';\nimport {ValidationError} from './auth/module/action/ValidationError';\nimport {LOGOUT_REASON} from './auth/route';\nimport {BackendClientError} from './error/BackendClientError';\n\nexport const footerStrings = defineMessages({\n  copy: {\n    defaultMessage: '© Wire Swiss GmbH',\n    id: 'footer.copy',\n  },\n});\n\nexport const customEnvRedirectStrings = defineMessages({\n  credentialsInfo: {\n    defaultMessage: \"Provide credentials only if you're sure this is your organization's login.\",\n    id: 'customEnvRedirect.credentialsInfo',\n  },\n  redirectHeadline: {\n    defaultMessage: 'Redirecting...',\n    id: 'customEnvRedirect.redirectHeadline',\n  },\n  redirectTo: {\n    defaultMessage: 'You are being redirected to your dedicated enterprise service.',\n    id: 'customEnvRedirect.redirectTo',\n  },\n});\n\nexport const cookiePolicyStrings = defineMessages({\n  bannerText: {\n    defaultMessage:\n      'We use cookies to personalize your experience on our website. By continuing to use the website, you agree to the use of cookies.{newline}Further information on cookies can be found in our <strong>privacy policy</strong>.',\n    id: 'cookiePolicyStrings.bannerText',\n  },\n});\n\nexport const indexStrings = defineMessages({\n  createAccount: {\n    defaultMessage: 'Create account',\n    id: 'index.createAccount',\n  },\n  enterprise: {\n    defaultMessage: 'Enterprise Login',\n    id: 'index.enterprise',\n  },\n  logIn: {\n    defaultMessage: 'Log in',\n    id: 'index.login',\n  },\n  ssoLogin: {\n    defaultMessage: 'Log in with SSO',\n    id: 'index.ssoLogin',\n  },\n  welcome: {\n    defaultMessage: 'Welcome to {brandName}',\n    id: 'index.welcome',\n  },\n});\n\nexport const setAccountTypeStrings = defineMessages({\n  createAccountForOrganizations: {\n    defaultMessage: 'Wire for Free',\n    id: 'index.createAccountForOrganizations',\n  },\n  createAccountForPersonalUse: {\n    defaultMessage: 'Personal',\n    id: 'index.createAccountForPersonalUse',\n  },\n  createPersonalAccount: {\n    defaultMessage: 'Chat privately with groups of friends and family',\n    id: 'index.createPersonalAccount',\n  },\n  createTeam: {\n    defaultMessage: 'Secure collaboration for businesses, institutions and professional organizations',\n    id: 'index.createTeam',\n  },\n  goBack: {\n    defaultMessage: 'Go Back',\n    id: 'index.goBack',\n  },\n});\n\nexport const teamNameStrings = defineMessages({\n  headline: {\n    defaultMessage: 'Name your team',\n    id: 'teamName.headline',\n  },\n  subhead: {\n    defaultMessage: 'You can always change it later.',\n    id: 'teamName.subhead',\n  },\n  teamNamePlaceholder: {\n    defaultMessage: 'Team name',\n    id: 'teamName.teamNamePlaceholder',\n  },\n  whatIsWireTeamsLink: {\n    defaultMessage: 'What is a team?',\n    id: 'teamName.whatIsWireTeamsLink',\n  },\n});\n\nexport const accountFormStrings = defineMessages({\n  emailPersonalPlaceholder: {\n    defaultMessage: 'you@email.com',\n    id: 'accountForm.emailPersonalPlaceholder',\n  },\n  emailTeamPlaceholder: {\n    defaultMessage: 'you@yourcompany.com',\n    id: 'accountForm.emailTeamPlaceholder',\n  },\n  namePlaceholder: {\n    defaultMessage: 'Name',\n    id: 'accountForm.namePlaceholder',\n  },\n  passwordHelp: {\n    defaultMessage:\n      'Use at least {minPasswordLength} characters, with one lowercase letter, one capital letter, a number, and a special character.',\n    id: 'accountForm.passwordHelp',\n  },\n  passwordPlaceholder: {\n    defaultMessage: 'Password',\n    id: 'accountForm.passwordPlaceholder',\n  },\n  submitButton: {\n    defaultMessage: 'Next',\n    id: 'accountForm.submitButton',\n  },\n  terms: {\n    defaultMessage: 'I accept the <terms>terms and conditions</terms>',\n    id: 'accountForm.terms',\n  },\n  termsAndPrivacyPolicy: {\n    defaultMessage:\n      'I accept the <privacypolicy>privacy policy</privacypolicy> and <terms>terms and conditions</terms>',\n    id: 'accountForm.termsAndPrivacyPolicy',\n  },\n});\n\nexport const createAccountStrings = defineMessages({\n  headLine: {\n    defaultMessage: 'Set up your account',\n    id: 'createAccount.headLine',\n  },\n  submitButton: {\n    defaultMessage: 'Next',\n    id: 'createAccount.nextButton',\n  },\n});\n\nexport const createPersonalAccountStrings = defineMessages({\n  goBack: {\n    defaultMessage: 'Go back',\n    id: 'createPersonalAccount.goBack',\n  },\n  headLine: {\n    defaultMessage: 'New account',\n    id: 'createPersonalAccount.headLine',\n  },\n  submitButton: {\n    defaultMessage: 'Register',\n    id: 'createPersonalAccount.nextButton',\n  },\n});\n\nexport const verifyStrings = defineMessages({\n  changeEmail: {\n    defaultMessage: 'Change email',\n    id: 'verify.changeEmail',\n  },\n  headline: {\n    defaultMessage: 'You’ve got mail',\n    id: 'verify.headline',\n  },\n  resendCode: {\n    defaultMessage: 'Resend code',\n    id: 'verify.resendCode',\n  },\n  subhead: {\n    defaultMessage: 'Enter the verification code we sent to{newline}{email}',\n    id: 'verify.subhead',\n  },\n});\n\nexport const inviteStrings = defineMessages({\n  emailPlaceholder: {\n    defaultMessage: 'colleague@email.com',\n    id: 'invite.emailPlaceholder',\n  },\n  headline: {\n    defaultMessage: 'Build your team',\n    id: 'invite.headline',\n  },\n  nextButton: {\n    defaultMessage: 'Next',\n    id: 'invite.nextButton',\n  },\n  skipForNow: {\n    defaultMessage: 'Skip for now',\n    id: 'invite.skipForNow',\n  },\n  subhead: {\n    defaultMessage: 'Invite your colleagues to join.',\n    id: 'invite.subhead',\n  },\n});\n\nexport const chooseHandleStrings = defineMessages({\n  handlePlaceholder: {\n    defaultMessage: 'Username',\n    id: 'chooseHandle.handlePlaceholder',\n  },\n  headline: {\n    defaultMessage: 'Set username',\n    id: 'chooseHandle.headline',\n  },\n  subhead: {\n    defaultMessage: 'Your username helps people find you.',\n    id: 'chooseHandle.subhead',\n  },\n});\n\nexport const setEmailStrings = defineMessages({\n  button: {\n    defaultMessage: 'Set email',\n    id: 'setEmail.button',\n  },\n  emailPlaceholder: {\n    defaultMessage: 'Email',\n    id: 'setEmail.emailPlaceholder',\n  },\n  headline: {\n    defaultMessage: 'Set email',\n    id: 'setEmail.headline',\n  },\n  noMailHeadline: {\n    defaultMessage: 'No email showing up?',\n    id: 'authPostedResendAction',\n  },\n  tryAgain: {\n    defaultMessage: 'Try again',\n    id: 'setEmail.tryAgain',\n  },\n  verifyHeadline: {\n    defaultMessage: 'You’ve got mail.',\n    id: 'authPostedResendHeadline',\n  },\n  verifySubhead: {\n    defaultMessage: 'Check your email inbox and follow the instructions.',\n    id: 'authPostedResendDetail',\n  },\n});\n\nexport const setEntropyStrings = defineMessages({\n  continue: {\n    defaultMessage: 'Continue',\n    id: 'setEntropy.continue',\n  },\n  headline: {\n    defaultMessage: 'Increase your account’s security',\n    id: 'setEntropy.headline',\n  },\n  subheadline: {\n    defaultMessage:\n      'Move your mouse as randomly as possible in the white window until the progress bar is 100% full. In this way, you will help improve the quality of the random numbers used to create the long-term cryptographic secrets of this device and thus increase the security of your account.',\n    id: 'setEntropy.subheadline',\n  },\n  success: {\n    defaultMessage: 'Thanks for your support!',\n    id: 'setEntropy.success',\n  },\n});\n\nexport const setPasswordStrings = defineMessages({\n  button: {\n    defaultMessage: 'Set password',\n    id: 'setPassword.button',\n  },\n  headline: {\n    defaultMessage: 'Set password',\n    id: 'setPassword.headline',\n  },\n  passwordPlaceholder: {\n    defaultMessage: 'Password',\n    id: 'setPassword.passwordPlaceholder',\n  },\n});\n\nexport const appAlreadyOpenStrings = defineMessages({\n  continueButton: {\n    defaultMessage: 'Continue',\n    id: 'appAlreadyOpen.continueButton',\n  },\n  headline: {\n    defaultMessage: '{brandName} is already open in this browser',\n    id: 'appAlreadyOpen.headline',\n  },\n  text: {\n    defaultMessage: 'If you continue here, you will be logged out on the other tab.',\n    id: 'appAlreadyOpen.text',\n  },\n});\n\nexport const acceptNewsModalStrings = defineMessages({\n  confirmButton: {\n    defaultMessage: 'Accept',\n    id: 'acceptNewsModal.confirmButton',\n  },\n  declineButton: {\n    defaultMessage: 'No, thanks',\n    id: 'acceptNewsModal.declineButton',\n  },\n  headline: {\n    defaultMessage: 'Do you want to receive news and product updates from {brandName} via email?',\n    id: 'acceptNewsModal.headline',\n  },\n  privacyDescription: {\n    defaultMessage: 'Check our <strong>Privacy Policy</strong>.',\n    id: 'acceptNewsModal.privacyDescription',\n  },\n  unsubscribeDescription: {\n    defaultMessage: 'You can unsubscribe at any time.',\n    id: 'acceptNewsModal.unsubscribeDescription',\n  },\n});\n\nexport const unsupportedStrings = defineMessages({\n  desktopOnlyMessage: {\n    defaultMessage: 'Please use {brandName} on your desktop app instead.',\n    id: 'unsupported.desktopOnlyMessage',\n  },\n  headlineBrowser: {\n    defaultMessage: 'This browser is not supported.',\n    id: 'unsupported.headlineBrowser',\n  },\n  headlineCookies: {\n    defaultMessage: 'Enable cookies',\n    id: 'unsupported.headlineCookies',\n  },\n  headlineIndexedDb: {\n    defaultMessage: 'Your browser is in private mode',\n    id: 'unsupported.headlineIndexedDb',\n  },\n  subheadBrowser: {\n    defaultMessage:\n      'Download the latest version of <strong>Google Chrome, Mozilla Firefox, Opera</strong> or <strong>Microsoft Edge.</strong>',\n    id: 'unsupported.subheadBrowser',\n  },\n  subheadCookies: {\n    defaultMessage: 'Enable cookies to log in to {brandName}.',\n    id: 'unsupported.subheadCookies',\n  },\n  subheadIndexedDb: {\n    defaultMessage:\n      '{brandName} needs access to local storage to display your messages. Local storage is not available in private mode.',\n    id: 'unsupported.subheadIndexedDb',\n  },\n});\n\nexport const unsupportedJoinStrings = defineMessages({\n  unsupportedJoinHeadline: {\n    defaultMessage: 'You have been invited to join a conversation in {brandName}',\n    id: 'conversationJoin.unsupportedJoinHeadline',\n  },\n  unsupportedJoinMobileSubhead: {\n    defaultMessage: 'Open this link on your computer.',\n    id: 'conversationJoin.unsupportedJoinMobileSubhead',\n  },\n});\n\nexport const conversationJoinStrings = defineMessages({\n  existentAccountHeadline: {\n    defaultMessage: '{name}, you have been invited to join a conversation in {brandName}',\n    id: 'conversationJoin.existentAccountHeadline',\n  },\n  existentAccountJoinWithoutLink: {\n    defaultMessage: 'Join the conversation',\n    id: 'conversationJoin.existentAccountJoinWithoutLink',\n  },\n  existentAccountJoinWithoutText: {\n    defaultMessage: '{existentAccountJoinWithoutLink} without an account',\n    id: 'conversationJoin.existentAccountJoinWithoutText',\n  },\n  existentAccountOpenButton: {\n    defaultMessage: 'Open in {brandName}',\n    id: 'conversationJoin.buttonExistentAccountOpen',\n  },\n  existentAccountSubhead: {\n    defaultMessage:\n      'Audio and video conferencing, text messaging, file sharing, and screen sharing, all end-to-end-encrypted.',\n    id: 'conversationJoin.existentAccountSubhead',\n  },\n  fullConversationHeadline: {\n    defaultMessage: 'Unable to join conversation',\n    id: 'conversationJoin.fullConversationHeadline',\n  },\n  fullConversationSubhead: {\n    defaultMessage: 'The maximum number of participants in this conversation has been reached.',\n    id: 'conversationJoin.fullConversationSubhead',\n  },\n  hasAccount: {\n    defaultMessage: 'Already have an account?',\n    id: 'conversationJoin.hasAccount',\n  },\n  headline: {\n    defaultMessage: 'You have been invited to join a conversation in {brandName}',\n    id: 'conversationJoin.headline',\n  },\n  invalidCreateAccountLink: {\n    defaultMessage: 'Create an account',\n    id: 'conversationJoin.invalidCreateAccountLink',\n  },\n  invalidCreateAccountText: {\n    defaultMessage: 'for group messaging and conference calls.',\n    id: 'conversationJoin.invalidCreateAccountText',\n  },\n  invalidHeadline: {\n    defaultMessage: 'Conversation not found',\n    id: 'conversationJoin.invalidHeadline',\n  },\n  invalidSubhead: {\n    defaultMessage: 'The link to this group conversation expired or the conversation was set to private.',\n    id: 'conversationJoin.invalidSubhead',\n  },\n  loginLink: {\n    defaultMessage: 'Log in',\n    id: 'conversationJoin.loginLink',\n  },\n  namePlaceholder: {\n    defaultMessage: 'Your name',\n    id: 'conversationJoin.namePlaceholder',\n  },\n  subhead: {\n    defaultMessage: 'Join conversation as temporary guest (access expires after 24 hours)',\n    id: 'conversationJoin.subhead',\n  },\n});\n\nexport const errorHandlerStrings = defineMessages({\n  [SyntheticErrorLabel.INVALID_PHONE_NUMBER]: {\n    defaultMessage: 'Invalid Phone Number',\n    id: 'authErrorPhoneNumberInvalid',\n  },\n  [SyntheticErrorLabel.FORBIDDEN_PHONE_NUMBER]: {\n    defaultMessage: 'Sorry. This phone number is forbidden.',\n    id: 'authErrorPhoneNumberForbidden',\n  },\n  [BackendError.LABEL.CONVERSATION_CODE_NOT_FOUND]: {\n    defaultMessage: 'This link is no longer valid. Ask the person who invited you how to join.',\n    id: 'BackendError.LABEL.CONVERSATION_CODE_NOT_FOUND',\n  },\n  [BackendError.LABEL.CONVERSATION_NOT_FOUND]: {\n    defaultMessage: 'CONVERSATION_NOT_FOUND',\n    id: 'BackendError.LABEL.CONVERSATION_NOT_FOUND',\n  },\n  [BackendError.LABEL.CONVERSATION_TOO_MANY_MEMBERS]: {\n    defaultMessage: 'This conversation has reached the limit of participants',\n    id: 'BackendError.LABEL.CONVERSATION_TOO_MANY_MEMBERS',\n  },\n  [BackendError.LABEL.ACCESS_DENIED]: {\n    defaultMessage: 'Please verify your details and try again',\n    id: 'BackendError.LABEL.ACCESS_DENIED',\n  },\n  [BackendError.LABEL.BLACKLISTED_EMAIL]: {\n    defaultMessage: 'This email address is not allowed',\n    id: 'BackendError.LABEL.BLACKLISTED_EMAIL',\n  },\n  [BackendError.LABEL.BLACKLISTED_PHONE]: {\n    defaultMessage: 'This phone number is not allowed',\n    id: 'BackendError.LABEL.BLACKLISTED_PHONE',\n  },\n  [BackendClientError.LABEL.DOMAIN_BLOCKED_FOR_REGISTRATION]: {\n    defaultMessage:\n      'You can’t create this account as your email domain is intentionally blocked. Please ask your team admin to invite you via email.',\n    id: 'BackendErrorLabel.DOMAIN_BLOCKED_FOR_REGISTRATION',\n  },\n  [BackendError.LABEL.INVALID_CODE]: {\n    defaultMessage: 'Please retry, or request another code.',\n    id: 'BackendError.LABEL.INVALID_CODE',\n  },\n  [BackendError.LABEL.INVALID_CREDENTIALS]: {\n    defaultMessage: 'Please verify your details and try again',\n    id: 'BackendError.LABEL.INVALID_CREDENTIALS',\n  },\n  [BackendError.LABEL.INVALID_EMAIL]: {\n    defaultMessage: 'This email address is invalid',\n    id: 'BackendError.LABEL.INVALID_EMAIL',\n  },\n  [BackendError.LABEL.KEY_EXISTS]: {\n    defaultMessage: 'This email address has already been registered. {supportEmailExistsLink}',\n    id: 'BackendError.LABEL.KEY_EXISTS',\n  },\n  [BackendError.LABEL.ALREADY_INVITED]: {\n    defaultMessage: 'This email has already been invited',\n    id: 'BackendError.LABEL.ALREADY_INVITED',\n  },\n  [BackendError.LABEL.MISSING_AUTH]: {\n    defaultMessage: 'Please verify your details and try again',\n    id: 'BackendError.LABEL.MISSING_AUTH',\n  },\n  [BackendError.LABEL.PENDING_ACTIVATION]: {\n    defaultMessage: 'The email address you provided has already been invited. Please check your email',\n    id: 'BackendError.LABEL.PENDING_ACTIVATION',\n  },\n  [BackendError.LABEL.PENDING_LOGIN]: {\n    defaultMessage: 'BackendError.LABEL.PENDING_LOGIN',\n    id: 'BackendError.LABEL.PENDING_LOGIN',\n  },\n  [BackendError.LABEL.TOO_MANY_LOGINS]: {\n    defaultMessage: 'Please try again later',\n    id: 'BackendError.LABEL.TOO_MANY_LOGINS',\n  },\n  [BackendError.LABEL.TOO_MANY_REQUESTS]: {\n    defaultMessage: 'Too many requests, please try again later.',\n    id: 'BackendError.LABEL.TOO_MANY_REQUESTS',\n  },\n  [BackendError.LABEL.BAD_REQUEST]: {\n    defaultMessage: 'Invalid input',\n    id: 'BackendError.LABEL.BAD_REQUEST',\n  },\n  [BackendError.LABEL.INVALID_OPERATION]: {\n    defaultMessage: 'Invalid operation',\n    id: 'BackendError.LABEL.INVALID_OPERATION',\n  },\n  [BackendError.LABEL.INVALID_PAYLOAD]: {\n    defaultMessage: 'Invalid input',\n    id: 'BackendError.LABEL.INVALID_PAYLOAD',\n  },\n  [BackendError.LABEL.NOT_FOUND]: {\n    defaultMessage: 'Could not find resource',\n    id: 'BackendError.LABEL.NOT_FOUND',\n  },\n  [BackendError.LABEL.OPERATION_DENIED]: {\n    defaultMessage: 'You don’t have permission',\n    id: 'BackendError.LABEL.OPERATION_DENIED',\n  },\n  [BackendError.LABEL.UNAUTHORIZED]: {\n    defaultMessage: 'Something went wrong. Please reload the page and try again',\n    id: 'BackendError.LABEL.UNAUTHORIZED',\n  },\n  [BackendError.LABEL.HANDLE_EXISTS]: {\n    defaultMessage: 'This username is already taken',\n    id: 'BackendError.LABEL.HANDLE_EXISTS',\n  },\n  [BackendError.LABEL.HANDLE_TOO_SHORT]: {\n    defaultMessage: 'Please enter a username with at least 2 characters',\n    id: 'BackendError.LABEL.HANDLE_TOO_SHORT',\n  },\n  [BackendError.LABEL.INVALID_HANDLE]: {\n    defaultMessage: 'This username is invalid',\n    id: 'BackendError.LABEL.INVALID_HANDLE',\n  },\n  [BackendError.LABEL.INVALID_INVITATION_CODE]: {\n    defaultMessage: 'Invitation has been revoked or expired',\n    id: 'BackendError.LABEL.INVALID_INVITATION_CODE',\n  },\n  [BackendError.LABEL.NO_OTHER_OWNER]: {\n    defaultMessage: 'The last owner cannot be removed from the team',\n    id: 'BackendError.LABEL.NO_OTHER_OWNER',\n  },\n  [BackendError.LABEL.NO_TEAM]: {\n    defaultMessage: 'Could not find team',\n    id: 'BackendError.LABEL.NO_TEAM',\n  },\n  [BackendError.LABEL.NO_TEAM_MEMBER]: {\n    defaultMessage: 'Could not find team member',\n    id: 'BackendError.LABEL.NO_TEAM_MEMBER',\n  },\n  [BackendError.LABEL.TOO_MANY_MEMBERS]: {\n    defaultMessage: 'This team has reached its maximum size',\n    id: 'BackendError.LABEL.TOO_MANY_MEMBERS',\n  },\n  [BackendError.LABEL.SUSPENDED]: {\n    defaultMessage: 'This account is no longer authorized to log in',\n    id: 'BackendError.LABEL.SUSPENDED',\n  },\n  [BackendError.LABEL.EMAIL_EXISTS]: {\n    defaultMessage: 'This email address is already in use. {supportEmailExistsLink}',\n    id: 'BackendError.LABEL.EMAIL_EXISTS',\n  },\n  [BackendError.LABEL.SSO_FORBIDDEN]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 8).',\n    id: 'BackendError.LABEL.SSO_FORBIDDEN',\n  },\n  [BackendError.LABEL.SSO_INSUFFICIENT_PERMISSIONS]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 10).',\n    id: 'BackendError.LABEL.SSO_INSUFFICIENT_PERMISSIONS',\n  },\n  [BackendError.LABEL.SSO_INVALID_FAILURE_REDIRECT]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 3).',\n    id: 'BackendError.LABEL.SSO_INVALID_FAILURE_REDIRECT',\n  },\n  [BackendError.LABEL.SSO_INVALID_SUCCESS_REDIRECT]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 2).',\n    id: 'BackendError.LABEL.SSO_INVALID_SUCCESS_REDIRECT',\n  },\n  [BackendError.LABEL.SSO_INVALID_UPSTREAM]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 5).',\n    id: 'BackendError.LABEL.SSO_INVALID_UPSTREAM',\n  },\n  [BackendError.LABEL.SSO_INVALID_USERNAME]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 4).',\n    id: 'BackendError.LABEL.SSO_INVALID_USERNAME',\n  },\n  [BackendError.LABEL.SSO_NO_MATCHING_AUTH]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 9).',\n    id: 'BackendError.LABEL.SSO_NO_MATCHING_AUTH',\n  },\n  [BackendError.LABEL.SSO_NOT_FOUND]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 7).',\n    id: 'BackendError.LABEL.SSO_NOT_FOUND',\n  },\n  [BackendError.LABEL.SSO_SERVER_ERROR]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 6).',\n    id: 'BackendError.LABEL.SSO_SERVER_ERROR',\n  },\n  [BackendError.LABEL.SSO_UNSUPPORTED_SAML]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 1).',\n    id: 'BackendError.LABEL.SSO_UNSUPPORTED_SAML',\n  },\n  [BackendError.LABEL.CODE_AUTHENTICATION_FAILED]: {\n    defaultMessage: 'Please retry, or request another code.',\n    id: 'BackendError.LABEL.CODE_AUTHENTICATION_FAILED',\n  },\n  [BackendError.LABEL.SSO_GENERIC_ERROR]: {\n    defaultMessage: 'Something went wrong. Please contact your team administrator for details (Error 0).',\n    id: 'BackendError.LABEL.SSO_GENERIC_ERROR',\n  },\n  [LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE]: {\n    defaultMessage: 'Not enough disk space',\n    id: 'LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE',\n  },\n  [BackendErrorLabel.CUSTOM_BACKEND_NOT_FOUND]: {\n    defaultMessage: 'This email cannot be used for enterprise login. Please enter the SSO code to proceed.',\n    id: 'BackendErrorLabel.CUSTOM_BACKEND_NOT_FOUND',\n  },\n  learnMore: {\n    defaultMessage: 'Learn more',\n    id: 'BackendError.learnMore',\n  },\n  unexpected: {\n    defaultMessage: 'Unexpected error',\n    id: 'BackendError.unexpected',\n  },\n});\n\nexport const validationErrorStrings = defineMessages({\n  [ValidationError.FIELD.NAME.PATTERN_MISMATCH]: {\n    defaultMessage: 'Enter a name with at least 2 characters',\n    id: 'ValidationError.FIELD.NAME.PATTERN_MISMATCH',\n  },\n  [ValidationError.FIELD.NAME.VALUE_MISSING]: {\n    defaultMessage: 'Enter a name with at least 2 characters',\n    id: 'ValidationError.FIELD.NAME.VALUE_MISSING',\n  },\n  [ValidationError.FIELD.PASSWORD.PATTERN_MISMATCH]: {\n    defaultMessage:\n      'Use at least {minPasswordLength} characters, with one lowercase letter, one capital letter, a number, and a special character.',\n    id: 'ValidationError.FIELD.PASSWORD.PATTERN_MISMATCH',\n  },\n  [ValidationError.FIELD.PASSWORD_LOGIN.PATTERN_MISMATCH]: {\n    defaultMessage: 'Wrong password. Please try again.',\n    id: 'ValidationError.FIELD.PASSWORD_LOGIN.PATTERN_MISMATCH',\n  },\n  [ValidationError.FIELD.SSO_CODE.PATTERN_MISMATCH]: {\n    defaultMessage: 'Please enter a valid SSO code',\n    id: 'ValidationError.FIELD.SSO_CODE.PATTERN_MISMATCH',\n  },\n  [ValidationError.FIELD.SSO_EMAIL_CODE.PATTERN_MISMATCH]: {\n    defaultMessage: 'Please enter a valid email or SSO code',\n    id: 'ValidationError.FIELD.SSO_EMAIL_CODE.PATTERN_MISMATCH',\n  },\n  [ValidationError.FIELD.EMAIL.TYPE_MISMATCH]: {\n    defaultMessage: 'Please enter a valid email address',\n    id: 'ValidationError.FIELD.EMAIL.TYPE_MISMATCH',\n  },\n  unexpected: {\n    defaultMessage: 'Unexpected error',\n    id: 'BackendError.unexpected',\n  },\n});\n\nexport const loginStrings = defineMessages({\n  emailPlaceholder: {\n    defaultMessage: 'Email or username',\n    id: 'login.emailPlaceholder',\n  },\n  forgotPassword: {\n    defaultMessage: 'Forgot password?',\n    id: 'login.forgotPassword',\n  },\n  goBack: {\n    defaultMessage: 'Go Back',\n    id: 'login.goBack',\n  },\n  headline: {\n    defaultMessage: 'Log in',\n    id: 'login.headline',\n  },\n  passwordPlaceholder: {\n    defaultMessage: 'Password',\n    id: 'login.passwordPlaceholder',\n  },\n  phoneLogin: {\n    defaultMessage: 'Log in with phone number',\n    id: 'login.phoneLogin',\n  },\n  publicComputer: {\n    defaultMessage: 'This is a public computer',\n    id: 'login.publicComputer',\n  },\n  ssoLogin: {\n    defaultMessage: 'Company log in',\n    id: 'login.ssoLogin',\n  },\n  subhead: {\n    defaultMessage: 'Enter your email address or username.',\n    id: 'login.subhead',\n  },\n  twoFactorLoginSubHead: {\n    defaultMessage: 'Please check your email {email} for the verification code and enter it below.',\n    id: 'login.twoFactorLoginSubHead',\n  },\n  twoFactorLoginTitle: {\n    defaultMessage: 'Verify your account',\n    id: 'login.twoFactorLoginTitle',\n  },\n});\n\nexport const ssoLoginStrings = defineMessages({\n  codeInputPlaceholder: {\n    defaultMessage: 'SSO code',\n    id: 'ssoLogin.codeInputPlaceholder',\n  },\n  codeOrMailInputPlaceholder: {\n    defaultMessage: 'Email or SSO code',\n    id: 'ssoLogin.codeOrMailInputPlaceholder',\n  },\n  headline: {\n    defaultMessage: 'Company log in',\n    id: 'ssoLogin.headline',\n  },\n  overlayDescription: {\n    defaultMessage: \"If you don't see the Single Sign On window, continue your Company Log in from here.\",\n    id: 'ssoLogin.overlayDescription',\n  },\n  overlayFocusLink: {\n    defaultMessage: 'Click to continue',\n    id: 'ssoLogin.overlayFocusLink',\n  },\n  subheadCode: {\n    defaultMessage: 'Please enter your SSO code',\n    id: 'ssoLogin.subheadCode',\n  },\n  subheadCodeOrEmail: {\n    defaultMessage: 'Please enter your email or SSO code.',\n    id: 'ssoLogin.subheadCodeOrEmail',\n  },\n  subheadEmailEnvironmentSwitchWarning: {\n    defaultMessage:\n      'If your email matches an enterprise installation of {brandName}, this app will connect to that server.',\n    id: 'ssoLogin.subheadEmailEnvironmentSwitchWarning',\n  },\n});\n\nexport const phoneLoginStrings = defineMessages({\n  accountCountryCode: {\n    defaultMessage: 'Country Code',\n    id: 'authAccountCountryCode',\n  },\n  errorCountryCodeInvalid: {\n    defaultMessage: 'Invalid Country Code',\n    id: 'authErrorCountryCodeInvalid',\n  },\n  loginHead: {\n    defaultMessage: 'Phone Log in',\n    id: 'authAccountSignInPhone',\n  },\n  verifyCodeChangePhone: {\n    defaultMessage: 'Change phone number',\n    id: 'authVerifyCodeChangePhone',\n  },\n  verifyCodeDescription: {\n    defaultMessage: 'Enter the verification code we sent to {number}.',\n    id: 'authVerifyCodeDescription',\n  },\n  verifyCodeResend: {\n    defaultMessage: 'Resend',\n    id: 'authVerifyCodeResendDetail',\n  },\n  verifyPasswordHeadline: {\n    defaultMessage: 'Enter your password',\n    id: 'authVerifyPasswordHeadline',\n  },\n});\n\nexport const logoutReasonStrings = defineMessages({\n  [LOGOUT_REASON.ACCOUNT_REMOVED]: {\n    defaultMessage: 'You were signed out because your account was deleted.',\n    id: 'LOGOUT_REASON.ACCOUNT_REMOVED',\n  },\n  [LOGOUT_REASON.CLIENT_REMOVED]: {\n    defaultMessage: 'You were signed out because your device was deleted.',\n    id: 'LOGOUT_REASON.CLIENT_REMOVED',\n  },\n  [LOGOUT_REASON.NO_APP_CONFIG]: {\n    defaultMessage: 'You were signed out because the initial configuration could not be loaded.',\n    id: 'LOGOUT_REASON.NO_APP_CONFIG',\n  },\n  [LOGOUT_REASON.SESSION_EXPIRED]: {\n    defaultMessage: 'You were signed out because your session expired.{newline}Please log in again.',\n    id: 'LOGOUT_REASON.SESSION_EXPIRED',\n  },\n});\n\nexport const clientManagerStrings = defineMessages({\n  headline: {\n    defaultMessage: 'Remove a device',\n    id: 'clientManager.headline',\n  },\n  logout: {\n    defaultMessage: 'Cancel process',\n    id: 'clientManager.logout',\n  },\n  subhead: {\n    defaultMessage: 'Remove one of your other devices to start using {brandName} on this one.',\n    id: 'clientManager.subhead',\n  },\n});\n\nexport const clientItemStrings = defineMessages({\n  passwordPlaceholder: {\n    defaultMessage: 'Password',\n    id: 'clientItem.passwordPlaceholder',\n  },\n});\n\nexport const historyInfoStrings = defineMessages({\n  learnMore: {\n    defaultMessage: 'Learn more',\n    id: 'historyInfo.learnMore',\n  },\n  noHistoryHeadline: {\n    defaultMessage: 'It’s the first time you’re using {brandName} on this device.',\n    id: 'historyInfo.noHistoryHeadline',\n  },\n  noHistoryInfo: {\n    defaultMessage: 'For privacy reasons, {newline}your conversation history will not appear here.',\n    id: 'historyInfo.noHistoryInfo',\n  },\n  ok: {\n    defaultMessage: 'OK',\n    id: 'historyInfo.ok',\n  },\n});\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Config} from '../Config';\n\nexport const EXTERNAL_ROUTE = {\n  PWA: Config.getConfig().URL.MOBILE_BASE,\n  PWA_LOGIN: `${Config.getConfig().URL.MOBILE_BASE}/login/`,\n  WEBAPP: '../',\n  WIRE_ACCOUNT: Config.getConfig().URL.ACCOUNT_BASE,\n  WIRE_ACCOUNT_PASSWORD_RESET: `${Config.getConfig().URL.ACCOUNT_BASE}/forgot/`,\n  WIRE_TEAM_FEATURES: `${Config.getConfig().URL.WEBSITE_BASE}/create-team/#features`,\n  WIRE_TERMS_PERSONAL: `${Config.getConfig().URL.WEBSITE_BASE}/legal/terms/#personal`,\n  WIRE_TERMS_TEAMS: `${Config.getConfig().URL.WEBSITE_BASE}/legal/terms/#teams`,\n  WIRE_WEBSITE: Config.getConfig().URL.WEBSITE_BASE,\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {SVGIcon} from '@wireapp/react-ui-kit/lib/Icon/SVGIcon';\nimport {FormattedMessage, useIntl} from 'react-intl';\n\nimport {CloseIcon, Content, Footer, Header, Link, Small} from '@wireapp/react-ui-kit';\n\nimport {Config} from '../../Config';\nimport {cookiePolicyStrings, footerStrings} from '../../strings';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {getSVG} from '../util/SVGProvider';\n\nexport interface Props extends React.HTMLAttributes<HTMLDivElement> {\n  children: React.ReactNode;\n  onCookiePolicyBannerClose?: (event: React.MouseEvent<HTMLElement>) => void;\n  showCookiePolicyBanner?: boolean;\n}\n\nconst WirelessContainer: React.FC<Props> = ({showCookiePolicyBanner, onCookiePolicyBannerClose, children}) => {\n  const {formatMessage: _} = useIntl();\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        minHeight: '100vh',\n        width: '100%',\n      }}\n    >\n      {showCookiePolicyBanner && (\n        <Header\n          style={{\n            backgroundColor: 'rgba(254, 191, 2, 0.2)',\n            display: 'flex',\n            height: 'auto',\n            margin: '0',\n          }}\n        >\n          <div style={{margin: '16px 40px', textAlign: 'center', width: '100%'}}>\n            <Link\n              onClick={(event: React.MouseEvent<HTMLAnchorElement>) => onCookiePolicyBannerClose?.(event)}\n              href={Config.getConfig().URL.PRIVACY_POLICY}\n              style={{fontSize: '1rem'}}\n              target=\"_blank\"\n              textTransform=\"none\"\n              bold={false}\n              data-uie-name=\"go-privacy\"\n            >\n              <FormattedMessage\n                {...cookiePolicyStrings.bannerText}\n                values={{\n                  newline: <br />,\n                  // eslint-disable-next-line react/display-name\n                  strong: ((...chunks: any[]) => <strong>{chunks}</strong>) as any,\n                }}\n              />\n            </Link>\n          </div>\n          <button\n            type=\"button\"\n            onClick={(event: React.MouseEvent<HTMLButtonElement>) => onCookiePolicyBannerClose?.(event)}\n            style={{\n              background: 'none',\n              border: 'none',\n              cursor: 'pointer',\n              padding: '16px',\n              position: 'absolute',\n              right: 0,\n              top: 0,\n            }}\n            data-uie-name=\"do-close-cookie-banner\"\n          >\n            <CloseIcon />\n          </button>\n        </Header>\n      )}\n      <Content>\n        <Header style={{height: '40px', marginLeft: '8px', marginTop: '20px'}}>\n          <SVGIcon aria-hidden=\"true\" scale={0.9} realWidth={78} realHeight={25}>\n            <g dangerouslySetInnerHTML={{__html: getSVG('logo-full-icon')?.documentElement?.innerHTML}} />\n          </SVGIcon>\n        </Header>\n        <Content style={{flex: '1', paddingLeft: '8px', width: '100%'}}>{children}</Content>\n        <Footer style={{height: '30px', justifyContent: 'flex-end', margin: '0 0 18px 8px'}}>\n          <Link href={EXTERNAL_ROUTE.WIRE_WEBSITE}>{Config.getConfig().WEBSITE_LABEL}</Link>\n          <Small> &middot; {_(footerStrings.copy)}</Small>\n        </Footer>\n      </Content>\n    </div>\n  );\n};\n\nexport {WirelessContainer};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {MessageDescriptor, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\n\nimport {Runtime} from '@wireapp/commons';\nimport {Container, ContainerXS, H1, H2, H3, Loading, Logo, Text} from '@wireapp/react-ui-kit';\n\nimport {WirelessContainer} from './WirelessContainer';\n\nimport {Config} from '../../Config';\nimport {unsupportedJoinStrings, unsupportedStrings} from '../../strings';\nimport {RootState} from '../module/reducer';\nimport * as RuntimeSelector from '../module/selector/RuntimeSelector';\n\ninterface UnsupportedProps extends React.HTMLProps<HTMLDivElement> {\n  headline: MessageDescriptor;\n  subhead: MessageDescriptor;\n}\n\nconst UnsupportedMessage: React.FC<UnsupportedProps> = ({headline, subhead}) => {\n  const {formatMessage: _} = useIntl();\n  return (\n    <ContainerXS verticalCenter centerText>\n      <Logo height={20} />\n      <H1 center css={{marginBottom: 48, marginTop: 24}}>\n        {_(headline, {brandName: Config.getConfig().BRAND_NAME})}\n      </H1>\n      <Text center>{_(subhead, {brandName: Config.getConfig().BRAND_NAME})}</Text>\n    </ContainerXS>\n  );\n};\n\nexport interface UnsupportedBrowserProps extends React.HTMLProps<HTMLDivElement> {\n  isTemporaryGuest?: boolean;\n}\n\nexport const UnsupportedBrowserComponent = ({\n  children,\n  hasCookieSupport,\n  hasIndexedDbSupport,\n  isCheckingSupport,\n  isSupportedBrowser,\n  isTemporaryGuest,\n  hasToUseDesktopApplication,\n}: UnsupportedBrowserProps & ConnectedProps) => {\n  const {formatMessage: _} = useIntl();\n  if (!isSupportedBrowser) {\n    return (\n      <WirelessContainer>\n        <Container verticalCenter>\n          <H2 css={{fontWeight: 500, marginBottom: 10, marginTop: 0}} data-uie-name=\"element-unsupported-headline\">\n            {_(isTemporaryGuest ? unsupportedJoinStrings.unsupportedJoinHeadline : unsupportedStrings.headlineBrowser, {\n              brandName: Config.getConfig().BRAND_NAME,\n            })}\n          </H2>\n          {isTemporaryGuest && Runtime.isMobileOS() ? (\n            <H3 css={{marginBottom: 10}} data-uie-name=\"element-unsupported-mobile-guest\">\n              {_(unsupportedJoinStrings.unsupportedJoinMobileSubhead)}\n            </H3>\n          ) : hasToUseDesktopApplication ? (\n            <H3 css={{marginBottom: 10}} data-uie-name=\"element-unsupported-desktop-only\">\n              {_(unsupportedStrings.desktopOnlyMessage, {brandName: Config.getConfig().BRAND_NAME})}\n            </H3>\n          ) : (\n            <H3 css={{marginBottom: 10}} data-uie-name=\"element-unsupported-general\">\n              {_(unsupportedStrings.subheadBrowser, {\n                // eslint-disable-next-line react/display-name\n                strong: (...chunks: any[]) => <strong style={{fontWeight: 800}}>{chunks}</strong>,\n              })}\n            </H3>\n          )}\n        </Container>\n      </WirelessContainer>\n    );\n  }\n\n  if (isCheckingSupport) {\n    return (\n      <ContainerXS centerText verticalCenter css={{justifyContent: 'center'}}>\n        <Loading />\n      </ContainerXS>\n    );\n  }\n\n  if (!hasCookieSupport) {\n    return (\n      <UnsupportedMessage headline={unsupportedStrings.headlineCookies} subhead={unsupportedStrings.subheadCookies} />\n    );\n  }\n\n  if (!hasIndexedDbSupport) {\n    return (\n      <UnsupportedMessage\n        headline={unsupportedStrings.headlineIndexedDb}\n        subhead={unsupportedStrings.subheadIndexedDb}\n      />\n    );\n  }\n\n  return <>{children}</>;\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasCookieSupport: RuntimeSelector.hasCookieSupport(state),\n  hasIndexedDbSupport: RuntimeSelector.hasIndexedDbSupport(state),\n  hasToUseDesktopApplication: RuntimeSelector.hasToUseDesktopApplication(state),\n  isCheckingSupport: RuntimeSelector.isChecking(state),\n  isSupportedBrowser: RuntimeSelector.isSupportedBrowser(state),\n});\n\nconst UnsupportedBrowser = connect(mapStateToProps)(UnsupportedBrowserComponent);\n\nexport {UnsupportedBrowser};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {TeamData} from '@wireapp/api-client/lib/team';\nimport {connect} from 'react-redux';\nimport {Navigate} from 'react-router-dom';\n\nimport {UnsupportedBrowser} from '../component/UnsupportedBrowser';\nimport {RootState} from '../module/reducer';\nimport {RegistrationDataState} from '../module/reducer/authReducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\n\ninterface Props extends React.HTMLProps<HTMLDivElement> {\n  hasAccountData?: boolean;\n  hasTeamData?: boolean;\n  isAuthenticated?: boolean;\n}\n\nconst hasInvalidAccountData = (account: RegistrationDataState) => !account.name || !account.email || !account.password;\n\nconst hasInvalidTeamData = ({team}: {team: TeamData}) => !team || !team.name;\n\nconst redirects = {\n  [AuthSelector.REGISTER_FLOW.PERSONAL]: ROUTE.CREATE_ACCOUNT,\n  [AuthSelector.REGISTER_FLOW.GENERIC_INVITATION]: ROUTE.CREATE_ACCOUNT,\n  [AuthSelector.REGISTER_FLOW.TEAM]: ROUTE.CREATE_TEAM,\n};\n\nconst PageComponent = ({\n  hasAccountData,\n  hasTeamData,\n  currentFlow,\n  isAuthenticated,\n  isStateAuthenticated,\n  account,\n  children,\n}: Props & ConnectedProps) => {\n  if (\n    (hasAccountData && hasInvalidAccountData(account) && !isStateAuthenticated) ||\n    (hasTeamData && hasInvalidTeamData(account) && !isStateAuthenticated) ||\n    (isAuthenticated && !isStateAuthenticated)\n  ) {\n    return <Navigate to={redirects[currentFlow] || ROUTE.INDEX} replace />;\n  }\n  return <UnsupportedBrowser>{children}</UnsupportedBrowser>;\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  account: AuthSelector.getAccount(state),\n  currentFlow: AuthSelector.getCurrentFlow(state),\n  isStateAuthenticated: AuthSelector.isAuthenticated(state),\n});\n\nconst Page = connect(mapStateToProps)(PageComponent);\n\nexport {Page};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Fragment} from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nimport {ErrorMessage} from '@wireapp/react-ui-kit';\n\nimport {Config} from '../../Config';\nimport {errorHandlerStrings, validationErrorStrings} from '../../strings';\n\ninterface ExceptionProps {\n  errors: any[];\n}\n\nconst Exception = ({errors = []}: ExceptionProps) => {\n  return (\n    <Fragment>\n      {errors.map(error => {\n        const translatedErrors = {...validationErrorStrings, ...errorHandlerStrings};\n        if (!error) {\n          return null;\n        }\n        return (\n          <ErrorMessage\n            data-uie-name=\"error-message\"\n            data-uie-value={error.label || 'unexpected-error'}\n            key={error.label || 'unexpected-error'}\n          >\n            {translatedErrors.hasOwnProperty(error.label) ? (\n              <FormattedMessage\n                {...translatedErrors[error.label]}\n                values={{\n                  minPasswordLength: Config.getConfig().MINIMUM_PASSWORD_LENGTH,\n                  supportEmailExistsLink: (\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href={Config.getConfig().URL.SUPPORT.EMAIL_EXISTS}>\n                      <FormattedMessage {...errorHandlerStrings.learnMore} />\n                    </a>\n                  ),\n                }}\n              />\n            ) : (\n              <FormattedMessage {...translatedErrors.unexpected} values={error} />\n            )}\n          </ErrorMessage>\n        );\n      })}\n    </Fragment>\n  );\n};\n\nexport {Exception};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef, useState} from 'react';\n\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {BackendErrorLabel} from '@wireapp/api-client/lib/http';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {\n  ArrowIcon,\n  ContainerXS,\n  Form,\n  H1,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  Link,\n  Loading,\n  RoundIconButton,\n} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {loginStrings, phoneLoginStrings} from '../../strings';\nimport {Exception} from '../component/Exception';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {actionRoot} from '../module/action';\nimport {LabeledError} from '../module/action/LabeledError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\nimport * as UrlUtil from '../util/urlUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst CheckPasswordComponent = ({\n  loginData,\n  doLogin,\n  resetAuthError,\n  isFetching,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n\n  const passwordInput = useRef<HTMLInputElement>();\n\n  const [error, setError] = useState(null);\n  const [password, setPassword] = useState<string>('');\n  const [validPasswordInput, setValidPasswordInput] = useState(true);\n\n  useEffect(() => {\n    if (!loginData.phone) {\n      navigate(ROUTE.LOGIN_PHONE);\n    }\n  }, []);\n\n  const handleLogin = async (event: React.SyntheticEvent) => {\n    let validationError: Error;\n    event.preventDefault();\n\n    if (!passwordInput.current.checkValidity()) {\n      validationError = ValidationError.handleValidationState(\n        passwordInput.current.name,\n        passwordInput.current.validity,\n      );\n    }\n    setValidPasswordInput(passwordInput.current.validity.valid);\n    try {\n      if (validationError) {\n        throw validationError;\n      }\n      const login: LoginData = {clientType: loginData.clientType, password, phone: loginData.phone};\n      await doLogin(login);\n      return navigate(ROUTE.HISTORY_INFO);\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        setError(error);\n        return;\n      }\n      switch (error.label) {\n        case BackendErrorLabel.TOO_MANY_CLIENTS: {\n          resetAuthError();\n          navigate(ROUTE.CLIENTS);\n          break;\n        }\n        case BackendErrorLabel.INVALID_CREDENTIALS:\n        case LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE:\n        case BackendErrorLabel.BAD_REQUEST: {\n          setError(error);\n          return;\n        }\n        default: {\n          setError(error);\n          throw error;\n        }\n      }\n    }\n  };\n  const onPasswordChange = (event: React.ChangeEvent<HTMLInputElement>) => setPassword(event.target.value);\n\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n      >\n        <H1 center>{_(phoneLoginStrings.verifyPasswordHeadline)}</H1>\n        <Form style={{marginTop: 30}} data-uie-name=\"login\" onSubmit={handleLogin}>\n          <InputBlock>\n            <InputSubmitCombo>\n              <Input\n                id=\"password-login\"\n                onChange={onPasswordChange}\n                type=\"password\"\n                name=\"password-login\"\n                autoComplete=\"section-login password\"\n                placeholder={_(loginStrings.passwordPlaceholder)}\n                pattern=\".{1,1024}\"\n                data-uie-name=\"enter-password\"\n                required\n                ref={passwordInput}\n                markInvalid={!validPasswordInput}\n                value={password}\n              />\n              {isFetching ? (\n                <Loading size={32} />\n              ) : (\n                <RoundIconButton\n                  style={{marginLeft: 16}}\n                  type=\"submit\"\n                  formNoValidate\n                  onClick={handleLogin}\n                  disabled={isFetching || !password}\n                  showLoading={isFetching}\n                  data-uie-name=\"do-sign-in\"\n                >\n                  <ArrowIcon />\n                </RoundIconButton>\n              )}\n            </InputSubmitCombo>\n          </InputBlock>\n          <Exception errors={[error]} />\n        </Form>\n        <Link\n          center\n          onClick={() => UrlUtil.openTab(EXTERNAL_ROUTE.WIRE_ACCOUNT_PASSWORD_RESET)}\n          data-uie-name=\"go-forgot-password\"\n        >\n          {_(loginStrings.forgotPassword)}\n        </Link>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isFetching: AuthSelector.isFetching(state),\n  loginData: AuthSelector.getLoginData(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doLogin: actionRoot.authAction.doLogin,\n      resetAuthError: actionRoot.authAction.resetAuthError,\n    },\n    dispatch,\n  );\n\nconst CheckPassword = connect(mapStateToProps, mapDispatchToProps)(CheckPasswordComponent);\n\nexport {CheckPassword};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FormattedMessage} from 'react-intl';\n\nimport {ErrorMessage} from '@wireapp/react-ui-kit';\n\nimport {errorHandlerStrings, validationErrorStrings} from '../../strings';\nimport {ValidationError} from '../module/action/ValidationError';\n\nexport function parseError(error: any): JSX.Element | null {\n  if (error) {\n    if (errorHandlerStrings.hasOwnProperty(error.label)) {\n      return (\n        <ErrorMessage data-uie-name=\"error-message\" data-uie-value={error.label}>\n          <FormattedMessage {...errorHandlerStrings[error.label]} />\n        </ErrorMessage>\n      );\n    }\n    return (\n      <ErrorMessage data-uie-name=\"error-message\" data-uie-value={'unexpected-error'}>\n        <FormattedMessage {...errorHandlerStrings.unexpected} values={error} />\n      </ErrorMessage>\n    );\n  }\n  return null;\n}\n\nexport function parseValidationErrors(errors: any | any[]): JSX.Element[] {\n  const errorMessages = [].concat(errors || []);\n  return errorMessages.map(error => (\n    <ErrorMessage data-uie-name=\"error-message\" data-uie-value={error.label} key={error.label}>\n      {validationErrorStrings.hasOwnProperty(error.label) ? (\n        <FormattedMessage {...validationErrorStrings[error.label]} />\n      ) : (\n        <FormattedMessage {...validationErrorStrings.unexpected} values={error} />\n      )}\n    </ErrorMessage>\n  ));\n}\n\nexport const isValidationError = (error: any) => {\n  return error instanceof ValidationError;\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {RegisteredClient} from '@wireapp/api-client/lib/client/index';\nimport {TabIndex} from '@wireapp/react-ui-kit/lib/types/enums';\nimport {useIntl} from 'react-intl';\n\nimport {\n  COLOR,\n  ContainerXS,\n  DeviceIcon,\n  FlexBox,\n  Form,\n  IconButton,\n  Input,\n  Line,\n  Small,\n  Text,\n  TrashIcon,\n} from '@wireapp/react-ui-kit';\n\nimport {isEnterKey} from 'Util/KeyboardUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport {splitFingerprint} from 'Util/StringUtil';\n\nimport {clientItemStrings} from '../../strings';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {parseError, parseValidationErrors} from '../util/errorUtil';\n\nexport interface Props extends React.HTMLProps<HTMLDivElement> {\n  client: RegisteredClient;\n  onClick: (event: React.MouseEvent<HTMLDivElement> | React.KeyboardEvent) => void;\n  onClientRemoval: (password?: string) => void;\n  requirePassword: boolean;\n  selected: boolean;\n  clientError?: Error;\n}\n\nconst ClientItem = ({selected, onClientRemoval, onClick, client, clientError, requirePassword}: Props) => {\n  const {formatMessage: _} = useIntl();\n  const passwordInput = React.useRef<HTMLInputElement>(null);\n\n  const CONFIG = {\n    animationSteps: 8,\n  };\n\n  const [animationStep, setAnimationStep] = useState(selected ? CONFIG.animationSteps : 0);\n  const [isSelected, setIsSelected] = useState(selected);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [password, setPassword] = useState('');\n  const [isValidPassword, setIsValidPassword] = useState(true);\n  const [validationError, setValidationError] = useState<ValidationError | null>(null);\n  const [isOpen, setIsOpen] = useState(requirePassword && (isSelected || isAnimating));\n\n  useEffect(() => {\n    if (!selected && isSelected) {\n      setIsAnimating(true);\n      setIsSelected(false);\n      setIsOpen(false);\n      requestAnimationFrame(() => executeAnimateOut());\n    } else if (selected && !isSelected) {\n      setIsAnimating(true);\n      setIsSelected(true);\n      setIsOpen(true);\n      requestAnimationFrame(() => executeAnimateIn());\n    } else if (selected && isSelected) {\n      setIsOpen(true);\n    } else {\n      setAnimationStep(0);\n      setIsOpen(false);\n    }\n  }, [selected]);\n\n  const formatId = (id = '?') => splitFingerprint(id).join(' ');\n\n  const executeAnimateIn = (): void => {\n    setAnimationStep(step => {\n      if (step < CONFIG.animationSteps) {\n        window.requestAnimationFrame(executeAnimateIn);\n        return step + 1;\n      }\n      setIsAnimating(false);\n      return step;\n    });\n  };\n\n  const executeAnimateOut = (): void => {\n    setAnimationStep(step => {\n      if (step > 0) {\n        window.requestAnimationFrame(executeAnimateOut);\n        return step - 1;\n      }\n      setIsAnimating(false);\n      return step;\n    });\n  };\n\n  const formatDate = (dateString: string): string =>\n    dateString\n      ? new Date(dateString).toLocaleString('en-US', {\n          day: 'numeric',\n          hour: 'numeric',\n          hour12: false,\n          minute: 'numeric',\n          month: 'short',\n          weekday: 'short',\n          year: 'numeric',\n        })\n      : '?';\n\n  const formatName = (model: string, clazz: string): string | JSX.Element =>\n    model || (\n      <Text bold textTransform={'capitalize'}>\n        {clazz}\n      </Text>\n    ) ||\n    '?';\n\n  const resetState = () => {\n    setAnimationStep(selected ? CONFIG.animationSteps : 0);\n    setIsAnimating(false);\n  };\n\n  const handleWrapperClick = (event: React.MouseEvent<HTMLDivElement> | React.KeyboardEvent): void => {\n    resetState();\n    onClick(event);\n  };\n\n  const onWrapperEnter = (event: React.KeyboardEvent) => {\n    if (!isEnterKey(event)) {\n      return;\n    }\n    handleWrapperClick(event);\n  };\n\n  const handlePasswordlessClientDeletion = (event: React.FormEvent): Promise<void> => {\n    event.preventDefault();\n\n    return Promise.resolve()\n      .then(() => onClientRemoval())\n      .catch(error => {\n        if (!error.label) {\n          throw error;\n        }\n      });\n  };\n\n  const handleSubmit = (event: React.FormEvent): Promise<void> => {\n    event.preventDefault();\n    let localValidationError = null;\n\n    if (passwordInput.current) {\n      if (!passwordInput.current.checkValidity()) {\n        localValidationError = ValidationError.handleValidationState(\n          passwordInput.current.name,\n          passwordInput.current.validity,\n        );\n      }\n      setIsValidPassword(passwordInput.current.validity.valid);\n    }\n\n    setValidationError(localValidationError);\n    return Promise.resolve(localValidationError)\n      .then(error => {\n        if (error) {\n          throw error;\n        }\n      })\n      .then(() => onClientRemoval(password))\n      .catch(error => {\n        if (error.label) {\n          switch (error.label) {\n            default: {\n              const isValidationError = Object.values(ValidationError.ERROR).some(errorType =>\n                error.label.endsWith(errorType),\n              );\n              if (!isValidationError) {\n                throw error;\n              }\n            }\n          }\n        } else {\n          throw error;\n        }\n      });\n  };\n\n  const onPasswordChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setPassword(event.target.value);\n    setIsValidPassword(true);\n  };\n\n  const animatedCardSpacing = {\n    l: 32,\n    m: 16,\n    s: 12,\n    xl: 48,\n    xs: 8,\n    xxs: 4,\n  };\n\n  const inputContainerHeight = 104;\n\n  const animationPosition = animationStep / CONFIG.animationSteps;\n  const smoothHeight = animationPosition * inputContainerHeight;\n  const smoothMarginTop = animationPosition * animatedCardSpacing.m;\n\n  return (\n    <ContainerXS>\n      <ContainerXS\n        css={{\n          ['&:focus-within']: {\n            boxShadow: `0 0 0 1px ${COLOR.BLUE}`,\n          },\n          backgroundColor: selected ? '#FFF' : '',\n          borderRadius: '12px',\n          transition: 'background-color .35s linear',\n        }}\n        data-uie-value={client.model}\n      >\n        <ContainerXS\n          onClick={(event: React.MouseEvent<HTMLDivElement>) => requirePassword && handleWrapperClick(event)}\n          onKeyDown={(event: React.KeyboardEvent) => requirePassword && onWrapperEnter(event)}\n          css={{\n            ['&:focus-visible']: {\n              outline: `none`,\n            },\n            cursor: requirePassword ? 'pointer' : 'auto',\n            margin: `${smoothMarginTop}px 0 0 0`,\n            padding: `0 ${animatedCardSpacing.m}px`,\n          }}\n          data-uie-name=\"go-remove-device\"\n          tabIndex={TabIndex.FOCUSABLE}\n        >\n          <FlexBox>\n            <div\n              style={{\n                flexBasis: animatedCardSpacing.l,\n                margin: isOpen ? `${18 - smoothMarginTop / 2}px 0 0 0` : 'auto',\n              }}\n            >\n              <DeviceIcon color=\"#323639\" />\n            </div>\n            <div style={{flexGrow: 1, marginTop: isOpen ? smoothMarginTop : 0}}>\n              {client.model && (\n                <Text bold block color=\"#323639\" data-uie-name=\"device-header-model\">\n                  {formatName(client.model, client.class)}\n                </Text>\n              )}\n              <Small block data-uie-name=\"device-id\">{`ID: ${formatId(client.id)}`}</Small>\n              <Small block>{formatDate(client.time)}</Small>\n            </div>\n            {!requirePassword && (\n              <IconButton\n                aria-label={t('modalAccountRemoveDeviceAction')}\n                data-uie-name=\"do-remove-device\"\n                formNoValidate\n                onClick={handlePasswordlessClientDeletion}\n                style={{margin: 'auto'}}\n                type=\"submit\"\n              >\n                <TrashIcon />\n              </IconButton>\n            )}\n          </FlexBox>\n          <Line\n            color=\"rgba(51, 55, 58, .04)\"\n            style={{\n              backgroundColor: 'transparent',\n              margin: `${animatedCardSpacing.xxs}px 0 0 ${animatedCardSpacing.l}px`,\n            }}\n          />\n        </ContainerXS>\n        {isOpen && (\n          <ContainerXS style={{overflow: 'hidden'}}>\n            <Form>\n              <FlexBox\n                css={{\n                  alignItems: 'center',\n                  margin: `${animatedCardSpacing.s}px ${animatedCardSpacing.m}px 0px ${animatedCardSpacing.xl}px`,\n                  maxHeight: smoothHeight,\n                }}\n              >\n                <FlexBox css={{flexGrow: 1, marginRight: `${animatedCardSpacing.s}px`}}>\n                  {/* eslint jsx-a11y/no-autofocus : \"off\" */}\n                  <Input\n                    autoFocus\n                    id=\"remove-device-password\"\n                    autoComplete=\"section-login password\"\n                    data-uie-name=\"remove-device-password\"\n                    ref={passwordInput}\n                    name=\"password\"\n                    label={t('modalAccountRemoveDevicePlaceholder')}\n                    onChange={onPasswordChange}\n                    pattern=\".{1,1024}\"\n                    placeholder={_(clientItemStrings.passwordPlaceholder)}\n                    required\n                    type=\"password\"\n                    value={password}\n                  />\n                </FlexBox>\n                <IconButton\n                  aria-label={t('modalAccountRemoveDeviceAction')}\n                  data-uie-name=\"do-remove-device\"\n                  disabled={!password || !isValidPassword}\n                  formNoValidate\n                  css={{margin: `0 ${animatedCardSpacing.xs}px`}}\n                  onClick={handleSubmit}\n                  type=\"submit\"\n                >\n                  <TrashIcon />\n                </IconButton>\n              </FlexBox>\n            </Form>\n          </ContainerXS>\n        )}\n      </ContainerXS>\n      {validationError && selected ? (\n        <div style={{margin: `${animatedCardSpacing.m}px 0 0 0`}}>{parseValidationErrors(validationError)}</div>\n      ) : clientError && selected ? (\n        <div style={{margin: `${animatedCardSpacing.m}px 0 0 0`}} data-uie-name=\"error-message\">\n          {parseError(clientError)}\n        </div>\n      ) : null}\n    </ContainerXS>\n  );\n};\n\nexport {ClientItem};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientType, RegisteredClient} from '@wireapp/api-client/lib/client/';\n\nimport type {RootState} from '../reducer';\n\nexport const getClients = (state: RootState) => state.clientState.clients || [];\nexport const getCurrentSelfClient = (state: RootState): RegisteredClient | null => state.clientState.currentClient;\nexport const hasLoadedClients = (state: RootState) => state.clientState.clients !== null;\nexport const isNewCurrentSelfClient = (state: RootState): boolean => state.clientState.isNewClient;\nexport const getPermanentClients = (state: RootState) =>\n  getClients(state).filter(client => client.type === ClientType.PERMANENT) || [];\nexport const getError = (state: RootState) => state.clientState.error;\nexport const isFetching = (state: RootState) => state.clientState.fetching;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {ClientType} from '@wireapp/api-client/lib/client/index';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {ContainerXS, Loading} from '@wireapp/react-ui-kit';\n\nimport {getLogger} from 'Util/Logger';\n\nimport {ClientItem} from './ClientItem';\n\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport * as LocalStorageAction from '../module/action/LocalStorageAction';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport {getEntropy} from '../module/selector/AuthSelector';\nimport * as ClientSelector from '../module/selector/ClientSelector';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {QUERY_KEY, ROUTE} from '../route';\n\nconst logger = getLogger('ClientList');\n\ntype Props = React.HTMLProps<HTMLDivElement>;\nconst ClientListComponent = ({\n  clientError,\n  isFetching,\n  isNoPasswordSSO,\n  permanentClients,\n  entropy,\n  doInitializeClient,\n  doRemoveClient,\n  getLocalStorage,\n  resetAuthError,\n  resetClientError,\n  removeLocalStorage,\n}: Props & ConnectedProps & DispatchProps) => {\n  const navigate = useNavigate();\n  const [showLoading, setShowLoading] = React.useState(false);\n  const [currentlySelectedClient, setCurrentlySelectedClient] = React.useState<string | null>(null);\n\n  const setSelectedClient = (clientId: string) => {\n    const isSelectedClient = currentlySelectedClient === clientId;\n\n    const selectedClientId = isSelectedClient ? null : clientId;\n    setCurrentlySelectedClient(selectedClientId);\n    resetAuthError();\n    resetClientError();\n  };\n\n  const removeClient = async (clientId: string, password?: string) => {\n    try {\n      const SFAcode = (await getLocalStorage(QUERY_KEY.CONVERSATION_CODE)) ?? undefined;\n      setShowLoading(true);\n      await doRemoveClient(clientId, password);\n      const persist = await getLocalStorage(LocalStorageAction.LocalStorageKey.AUTH.PERSIST);\n      await doInitializeClient(persist ? ClientType.PERMANENT : ClientType.TEMPORARY, password, SFAcode, entropy);\n      removeLocalStorage(QUERY_KEY.CONVERSATION_CODE);\n      removeLocalStorage(QUERY_KEY.JOIN_EXPIRES);\n      return navigate(ROUTE.HISTORY_INFO);\n    } catch (error) {\n      logger.error(error);\n    } finally {\n      setShowLoading(false);\n    }\n  };\n\n  const isSelectedClient = (clientId: string) => clientId === currentlySelectedClient;\n\n  return isFetching || showLoading ? (\n    <ContainerXS centerText verticalCenter style={{justifyContent: 'center'}}>\n      <Loading />\n    </ContainerXS>\n  ) : (\n    <ContainerXS\n      centerText\n      verticalCenter\n      style={{display: 'flex', flexDirection: 'column', justifyContent: 'space-around'}}\n    >\n      {permanentClients.map(client => (\n        <ClientItem\n          client={client}\n          clientError={isSelectedClient(client.id) ? clientError : undefined}\n          key={client.id}\n          onClick={() => setSelectedClient(client.id)}\n          onClientRemoval={(password?: string) => removeClient(client.id, password)}\n          requirePassword={!isNoPasswordSSO}\n          selected={isSelectedClient(client.id)}\n        />\n      ))}\n    </ContainerXS>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  clientError: ClientSelector.getError(state),\n  entropy: getEntropy(state),\n  isFetching: ClientSelector.isFetching(state),\n  isNoPasswordSSO: SelfSelector.isNoPasswordSSO(state),\n  permanentClients: ClientSelector.getPermanentClients(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doInitializeClient: ROOT_ACTIONS.clientAction.doInitializeClient,\n      doRemoveClient: ROOT_ACTIONS.clientAction.doRemoveClient,\n      getLocalStorage: ROOT_ACTIONS.localStorageAction.getLocalStorage,\n      removeLocalStorage: ROOT_ACTIONS.localStorageAction.deleteLocalStorage,\n      resetAuthError: ROOT_ACTIONS.authAction.resetAuthError,\n      resetClientError: ROOT_ACTIONS.clientAction.resetClientError,\n    },\n    dispatch,\n  );\n\nconst ClientList = connect(mapStateToProps, mapDispatchToProps)(ClientListComponent);\n\nexport {ClientList};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Button, ButtonVariant, ContainerXS, H1, Muted, useTimeout} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {clientManagerStrings} from '../../strings';\nimport {ClientList} from '../component/ClientList';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport {QUERY_KEY} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst ClientManagerComponent = ({doGetAllClients, doLogout}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const SFAcode = localStorage.getItem(QUERY_KEY.CONVERSATION_CODE);\n  const timeRemaining = JSON.parse(localStorage.getItem(QUERY_KEY.JOIN_EXPIRES) ?? '{}')?.data ?? Date.now();\n\n  // Automatically log the user out if ten minutes passes and they are a 2fa user.\n  const {startTimeout} = useTimeout(\n    () => {\n      localStorage.removeItem(QUERY_KEY.CONVERSATION_CODE);\n      localStorage.removeItem(QUERY_KEY.JOIN_EXPIRES);\n      logout();\n    },\n    timeRemaining - Date.now() > 0 ? timeRemaining - Date.now() : 0,\n  );\n\n  useEffect(() => {\n    doGetAllClients();\n    if (SFAcode) {\n      startTimeout();\n    }\n  }, [SFAcode, doGetAllClients, startTimeout]);\n\n  const logout = async () => {\n    try {\n      await doLogout();\n    } catch (error) {}\n  };\n\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', justifyContent: 'space-around', minHeight: 428}}\n      >\n        <H1 center style={{marginTop: '140px'}}>\n          {_(clientManagerStrings.headline)}\n        </H1>\n        <Muted center style={{marginBottom: '42px'}} data-uie-name=\"status-device-limit-info\">\n          {_(clientManagerStrings.subhead, {brandName: Config.getConfig().BRAND_NAME})}\n        </Muted>\n        <ClientList />\n        <Button\n          variant={ButtonVariant.SECONDARY}\n          onClick={logout}\n          style={{alignSelf: 'center', margin: '48px 0 80px 0'}}\n          data-uie-name=\"go-sign-out\"\n        >\n          {_(clientManagerStrings.logout)}\n        </Button>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doGetAllClients: ROOT_ACTIONS.clientAction.doGetAllClients,\n      doLogout: ROOT_ACTIONS.authAction.doLogout,\n    },\n    dispatch,\n  );\n\nconst ClientManager = connect(mapStateToProps, mapDispatchToProps)(ClientManagerComponent);\n\nexport {ClientManager};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport interface EntropyFrame {\n  x: number;\n  y: number;\n  t: number;\n}\n\n/**\n * calculate shannon entropy over a set of uint8 values\n */\nexport function shannonEntropy(entropyData: Uint8Array): number {\n  const len = entropyData.length;\n  const frequencies = entropyData.reduce((freq: Map<number, number>, c: number) => {\n    freq.set(c, (freq.get(c) || 0) + 1);\n    return freq;\n  }, new Map<number, number>());\n  let sum = 0;\n  for (const f of frequencies.values()) {\n    sum -= (f / len) * Math.log2(f / len);\n  }\n  return sum;\n}\n\n/**\n * calculate the difference between every n-th element in a flattened list\n * @param data The list of elements to calculate the differences on, containing a multipe of `n` elements\n * @param n The number of different elements representing one flattened object\n */\nexport function calculateDeltaValues(data: Uint8Array, n: number): Uint8Array {\n  const prev = Array<number | null>(3);\n  const result = new Array<number>();\n\n  data.forEach((value, index) => {\n    const i = index % n;\n    const prevValue = prev[i];\n    if (prevValue != null) {\n      result.push(Math.abs(value - prevValue));\n    }\n    prev[i] = value;\n  });\n  return new Uint8Array(result);\n}\n\nexport class EntropyData {\n  readonly frames: EntropyFrame[];\n  constructor() {\n    this.frames = [];\n  }\n\n  get length(): number {\n    return this.frames.length;\n  }\n\n  get entropyData(): Uint8Array {\n    return new Uint8Array(\n      this.frames.reduce((acc: number[], val: EntropyFrame) => {\n        acc.push(val.x);\n        acc.push(val.y);\n        acc.push(val.t);\n        return acc;\n      }, []),\n    );\n  }\n\n  get entropyBits(): number {\n    const entropyData = this.entropyData;\n    const entropy = shannonEntropy(entropyData);\n    const valuesPerFrame = ~~(entropyData.length / this.frames.length);\n    // 1st derivation\n    const deltaValues = calculateDeltaValues(entropyData, valuesPerFrame);\n    const deltaEntropy = shannonEntropy(deltaValues);\n    // 2nd derivation\n    const delta2Values = calculateDeltaValues(deltaValues, valuesPerFrame);\n    const delta2Entropy = shannonEntropy(delta2Values);\n    // 3rd derivation\n    const delta3Values = calculateDeltaValues(delta2Values, valuesPerFrame);\n    const delta3Entropy = shannonEntropy(delta3Values);\n\n    return Math.min(entropy, deltaEntropy, delta2Entropy, delta3Entropy) * entropyData.length;\n  }\n\n  addFrame(value: EntropyFrame, duplicateCheck = true): void {\n    value.x &= 0xff;\n    value.y &= 0xff;\n    value.t &= 0xff;\n    // skip duplicate entries\n    if (\n      duplicateCheck &&\n      this.frames.length > 0 &&\n      this.frames[this.frames.length - 1].x === value.x &&\n      this.frames[this.frames.length - 1].y === value.y\n    ) {\n      return;\n    }\n    this.frames.push(value);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useRef, useEffect, useState} from 'react';\n\nexport const usePausableInterval = (callback: () => void, timer: number) => {\n  const intervalIdRef = useRef<() => void>();\n  const totalTimeRun = useRef(0);\n  const intervalId = useRef<number>();\n  const startTime = useRef(new Date().getTime());\n  const [pause, setPause] = useState(true);\n\n  const pauseInterval = () => setPause(true);\n  const startInterval = () => setPause(false);\n  const clearInterval = () => window.clearTimeout(intervalId.current);\n\n  useEffect(() => {\n    intervalIdRef.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    const fn = () => {\n      intervalIdRef.current();\n    };\n\n    if (timer !== null) {\n      if (pause === false) {\n        intervalId.current = window.setTimeout(function interval() {\n          startTime.current = new Date().getTime();\n          fn();\n          intervalId.current = window.setTimeout(interval, timer);\n        }, timer - totalTimeRun.current);\n        totalTimeRun.current = 0;\n      }\n      if (pause === true) {\n        totalTimeRun.current = new Date().getTime() - startTime.current;\n        clearInterval();\n      }\n    }\n  }, [timer, pause]);\n  return {clearInterval, pauseInterval, startInterval};\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {MouseEvent, useRef, useEffect, useState} from 'react';\n\nimport {CSSObject} from '@emotion/react';\n\nimport {usePausableInterval} from '../../hooks/usePausableInterval';\nimport {EntropyData} from '../../util/Entropy';\n\ninterface CanvasProps {\n  css?: CSSObject;\n  'data-uie-name'?: string;\n  onProgress: (entropyData: EntropyData, percent: number, pause: boolean) => void;\n  /** width of the canvas in px*/\n  sizeX: number;\n  /** height of the canvas in px*/\n  sizeY: number;\n  /** minimum number of frames (good default: 300) */\n  minFrames: number;\n  /** minimum bits of overall estimated entropy (good default: 1024) */\n  minEntropyBits: number;\n}\n\ntype Point = {\n  x: number;\n  y: number;\n};\n\nconst EntropyCanvas = (props: CanvasProps) => {\n  const {sizeX, sizeY, onProgress, css, minEntropyBits, minFrames, ...rest} = props;\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [percent, setPercent] = useState(0);\n  const [entropy] = useState<EntropyData>(new EntropyData());\n  const [previousPoint, setPreviousPoint] = useState<Point | null>(null);\n  const [lastPoint, setLastPoint] = useState<Point | null>(null);\n\n  const {clearInterval, startInterval, pauseInterval} = usePausableInterval(() => {\n    setPercent(Math.floor(100 * Math.min(entropy.entropyBits / minEntropyBits, entropy.length / minFrames)));\n    onProgress(entropy, percent, false);\n  }, 100);\n\n  useEffect(() => {\n    if (percent >= 100) {\n      clearInterval();\n      onProgress(entropy, percent, false);\n    }\n  }, [clearInterval, percent]);\n\n  const onMouseLeave = () => {\n    onProgress(entropy, percent, true);\n    pauseInterval();\n    // add null value to prevent render artifacts when the mouse leaves on one side and enters at a different position\n    setPreviousPoint(lastPoint);\n    setLastPoint(null);\n  };\n\n  const draw = (ctx: CanvasRenderingContext2D) => {\n    if (!previousPoint || !lastPoint) {\n      return;\n    }\n    ctx.beginPath();\n    ctx.moveTo(previousPoint.x, previousPoint.y);\n    ctx.lineJoin = 'round';\n    ctx.lineCap = 'round';\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = 'blue';\n    ctx.lineTo(lastPoint.x, lastPoint.y);\n    ctx.stroke();\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n    const context = canvas.getContext('2d');\n    if (!context) {\n      return;\n    }\n    draw(context);\n  }, [lastPoint]);\n\n  const onMouseMove = (event: MouseEvent<HTMLCanvasElement>) => {\n    startInterval();\n    const boundingRect = event.currentTarget?.getBoundingClientRect();\n    const drawPoint: Point = {\n      x: event.clientX - boundingRect.x,\n      y: event.clientY - boundingRect.y,\n    };\n    entropy.addFrame({\n      t: Date.now(),\n      x: (255 * drawPoint.x) / boundingRect.width,\n      y: (255 * drawPoint.y) / boundingRect.height,\n    });\n    setPreviousPoint(lastPoint);\n    setLastPoint(drawPoint);\n  };\n\n  return (\n    <canvas\n      data-uie-name={props['data-uie-name'] ?? 'element-entropy-canvas'}\n      height={sizeY}\n      width={sizeX}\n      css={{\n        ...css,\n        alignSelf: 'center',\n        backgroundColor: 'white',\n        borderRadius: '5px',\n        height: `${sizeY}px`,\n        transition: '0.5s ease-in',\n        width: `${sizeX}px`,\n      }}\n      onMouseMove={onMouseMove}\n      onMouseLeave={onMouseLeave}\n      ref={canvasRef}\n      {...rest}\n    />\n  );\n};\n\nexport {EntropyCanvas};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as React from 'react';\n\ninterface ProgressProps {\n  error: boolean;\n  percent: number;\n  style?: React.CSSProperties;\n  width: number;\n}\nexport const ProgressBar = ({width, percent, error, style}: ProgressProps) => {\n  const progress = (percent / 100) * width;\n\n  return (\n    <div\n      data-uie-name=\"element-progess-bar\"\n      style={{\n        alignSelf: 'center',\n        backgroundColor: 'white',\n        borderRadius: '5px',\n        height: '8px',\n        marginTop: '8px',\n        width: width,\n        ...style,\n      }}\n    >\n      <div\n        style={{\n          backgroundColor: error ? 'red' : 'blue',\n          borderRadius: '5px',\n          height: 'inherit',\n          transition: 'ease-in',\n          width: `${progress}px`,\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useState} from 'react';\n\nimport {useIntl} from 'react-intl';\n\nimport {Button, CheckRoundIcon, ContainerSM, H1, Muted, Text} from '@wireapp/react-ui-kit';\n\nimport {KEY} from 'Util/KeyboardUtil';\n\nimport {setEntropyStrings} from '../../strings';\nimport {EntropyData} from '../../util/Entropy';\nimport {EntropyCanvas} from '../component/EntropyCanvas';\nimport {ProgressBar} from '../component/ProgressBar';\n\ninterface Props extends React.HTMLProps<HTMLDivElement> {\n  onSetEntropy: (entropyData: Uint8Array) => void;\n  containerSize?: number;\n}\n\nconst EntropyContainer = ({onSetEntropy, containerSize = 400}: Props) => {\n  const {formatMessage: _} = useIntl();\n  const [entropy, setEntropy] = useState<EntropyData>(new EntropyData());\n  const [pause, setPause] = useState<boolean>();\n  const [percent, setPercent] = useState(0);\n\n  const onProgress = (entropyData: EntropyData, percentage: number, pause: boolean) => {\n    setEntropy(entropyData);\n    setPause(pause);\n    setPercent(percentage);\n  };\n\n  const forwardEntropy = async (entropy: Uint8Array) => {\n    // we want to hash the entire entropy array to get a 256 bit (32 bytes) array\n    const hashedValue = await window.crypto.subtle.digest('SHA-256', entropy);\n    onSetEntropy(new Uint8Array(hashedValue));\n  };\n\n  return (\n    <ContainerSM\n      centerText\n      verticalCenter\n      style={{\n        alignItems: 'center',\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-around',\n        minHeight: 428,\n      }}\n    >\n      <H1 center css={{marginBottom: 16}}>\n        {_(setEntropyStrings.headline)}\n      </H1>\n      {percent >= 100 ? (\n        <>\n          <CheckRoundIcon width={64} height={64} css={{alignSelf: 'center', marginBottom: 64}} />\n          <Muted center style={{marginBottom: 40}}>\n            {_(setEntropyStrings.success)}\n          </Muted>\n          <Button\n            css={{width: '70%'}}\n            onClick={() => forwardEntropy(entropy.entropyData)}\n            data-uie-name=\"do-entropy-confirm\"\n            onKeyDown={(event: React.KeyboardEvent) => {\n              if (event.key === KEY.ENTER) {\n                forwardEntropy(entropy.entropyData);\n              }\n            }}\n          >\n            {_(setEntropyStrings.continue)}\n          </Button>\n        </>\n      ) : (\n        <>\n          <Muted center css={{marginBottom: '24px'}}>\n            {_(setEntropyStrings.subheadline)}\n          </Muted>\n          <EntropyCanvas\n            css={{border: pause ? 'red 2px solid' : 'black 2px solid'}}\n            data-uie-name=\"element-entropy-canvas\"\n            sizeX={containerSize}\n            sizeY={containerSize}\n            onProgress={onProgress}\n            minEntropyBits={1024}\n            minFrames={300}\n          />\n          <ProgressBar error={!!pause} width={containerSize} percent={percent} />\n          <Text data-uie-name=\"element-entropy-percent\" center>\n            {percent}%\n          </Text>\n        </>\n      )}\n    </ContainerSM>\n  );\n};\n\nexport {EntropyContainer};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useIntl} from 'react-intl';\n\nimport {Button, Column, Columns, Container, H3, Modal, Text} from '@wireapp/react-ui-kit';\n\nimport {useSingleInstance} from 'src/script/hooks/useSingleInstance';\n\nimport {Config} from '../../Config';\nimport {appAlreadyOpenStrings} from '../../strings';\n\ninterface AppAlreadyOpenProps {\n  fullscreen?: boolean;\n}\nexport const AppAlreadyOpen = ({fullscreen}: AppAlreadyOpenProps) => {\n  const {formatMessage: _} = useIntl();\n  const {hasOtherInstance, killRunningInstance} = useSingleInstance();\n  if (!hasOtherInstance) {\n    return null;\n  }\n\n  return (\n    <Modal fullscreen={fullscreen}>\n      <Container style={{maxWidth: '320px'}} data-uie-name=\"modal-already-open\">\n        <H3 style={{fontWeight: 500, marginTop: '10px'}} data-uie-name=\"status-modal-title\">\n          {_(appAlreadyOpenStrings.headline, {brandName: Config.getConfig().BRAND_NAME})}\n        </H3>\n        <Text data-uie-name=\"status-modal-text\">{_(appAlreadyOpenStrings.text)}</Text>\n        <Columns style={{marginTop: '20px'}}>\n          <Column style={{textAlign: 'center'}}>\n            <Button\n              type=\"button\"\n              block\n              onClick={killRunningInstance}\n              style={{marginBottom: '10px'}}\n              data-uie-name=\"do-action\"\n            >\n              {_(appAlreadyOpenStrings.continueButton)}\n            </Button>\n          </Column>\n        </Columns>\n      </Container>\n    </Modal>\n  );\n};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as RouterDOM from 'react-router-dom';\n\nimport {LinkProps, linkStyle, Theme} from '@wireapp/react-ui-kit';\n\ntype RouterLinkProps = LinkProps & RouterDOM.LinkProps;\n\nconst RRLink = RouterDOM.Link;\n\nconst RouterLink = (props: RouterLinkProps) => <RRLink css={(theme: Theme) => linkStyle(theme, props)} {...props} />;\n\nexport {RouterLink};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {RootState} from '../reducer';\n\nexport const isFetching = (state: RootState) => state.conversationState.fetching;\nexport const getError = (state: RootState) => state.conversationState.error;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function randomArrayElement<T>(array: T[]): T {\n  return array[randomInt(array.length - 1)];\n}\n\n// returns number: 0 <= number <= max\nexport function randomInt(max: number): number {\n  return Math.floor(Math.random() * (max + 1));\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as RandomUtil from './randomUtil';\n\nexport interface AccentColor {\n  color: string;\n  id: number;\n  name: string;\n}\n\nexport const STRONG_BLUE: AccentColor = {\n  color: '#2391d3',\n  id: 1,\n  name: 'StrongBlue',\n};\n\nexport const STRONG_LIME_GREEN: AccentColor = {\n  color: '#00c800',\n  id: 2,\n  name: 'StrongLimeGreen',\n};\n\nexport const VIVID_RED: AccentColor = {\n  color: '#fb0807',\n  id: 4,\n  name: 'VividRed',\n};\n\nexport const BRIGHT_ORANGE: AccentColor = {\n  color: '#ff8900',\n  id: 5,\n  name: 'BrightOrange',\n};\n\nexport const SOFT_PINK: AccentColor = {\n  color: '#fe5ebd',\n  id: 6,\n  name: 'SoftPink',\n};\n\nexport const VIOLET: AccentColor = {\n  color: '#9c00fe',\n  id: 7,\n  name: 'Violet',\n};\n\nexport const ACCENT_COLORS: AccentColor[] = [\n  STRONG_BLUE,\n  STRONG_LIME_GREEN,\n  VIVID_RED,\n  BRIGHT_ORANGE,\n  SOFT_PINK,\n  VIOLET,\n];\n\nexport const accentColorById = (id: number): AccentColor => ACCENT_COLORS.find(color => color.id === id);\n\nexport const random = (): AccentColor => RandomUtil.randomArrayElement(ACCENT_COLORS);\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport type {RegisterData} from '@wireapp/api-client/lib/auth';\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime, UrlUtil} from '@wireapp/commons';\nimport {\n  ArrowIcon,\n  Button,\n  ContainerXS,\n  Form,\n  H2,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  Link,\n  RoundIconButton,\n  Small,\n  Text,\n} from '@wireapp/react-ui-kit';\n\nimport {noop} from 'Util/util';\n\nimport {EntropyContainer} from './EntropyContainer';\n\nimport {Config} from '../../Config';\nimport {conversationJoinStrings} from '../../strings';\nimport {AppAlreadyOpen} from '../component/AppAlreadyOpen';\nimport {RouterLink} from '../component/RouterLink';\nimport {UnsupportedBrowser} from '../component/UnsupportedBrowser';\nimport {WirelessContainer} from '../component/WirelessContainer';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {BackendError} from '../module/action/BackendError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport * as ConversationSelector from '../module/selector/ConversationSelector';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {QUERY_KEY, ROUTE} from '../route';\nimport * as AccentColor from '../util/AccentColor';\nimport {parseError, parseValidationErrors} from '../util/errorUtil';\nimport * as StringUtil from '../util/stringUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst ConversationJoinComponent = ({\n  doCheckConversationCode,\n  doJoinConversationByCode,\n  doInit,\n  doRegisterWireless,\n  setLastEventDate,\n  doLogout,\n  isAuthenticated,\n  isTemporaryGuest,\n  selfName,\n  conversationError,\n}: Props & ConnectedProps & DispatchProps) => {\n  const nameInput = React.useRef<HTMLInputElement>();\n  const {formatMessage: _} = useIntl();\n\n  const [accentColor] = useState(AccentColor.random());\n  const [isPwaEnabled, setIsPwaEnabled] = useState<boolean>();\n  const [conversationCode, setConversationCode] = useState<string>();\n  const [conversationKey, setConversationKey] = useState<string>();\n  const [enteredName, setEnteredName] = useState<string>();\n  const [error, setError] = useState<any>();\n  const [expiresIn, setExpiresIn] = useState<number>();\n  const [forceNewTemporaryGuestAccount, setForceNewTemporaryGuestAccount] = useState(false);\n  const [isValidLink, setIsValidLink] = useState(true);\n  const [isValidName, setIsValidName] = useState(true);\n  const [showCookiePolicyBanner, setShowCookiePolicyBanner] = useState(true);\n  const [showEntropyForm, setShowEntropyForm] = useState(false);\n  const isEntropyRequired = Config.getConfig().FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY;\n\n  const isPwaSupportedBrowser = () => {\n    return Runtime.isMobileOS() || Runtime.isSafari();\n  };\n\n  useEffect(() => {\n    const localConversationCode = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_CODE);\n    const localConversationKey = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_KEY);\n    const localExpiresIn = parseInt(UrlUtil.getURLParameter(QUERY_KEY.JOIN_EXPIRES), 10) || undefined;\n\n    setConversationCode(localConversationCode);\n    setConversationKey(localConversationKey);\n    setExpiresIn(localExpiresIn);\n    setIsValidLink(true);\n    doInit({isImmediateLogin: false, shouldValidateLocalClient: true})\n      .catch(noop)\n      .then(() =>\n        localConversationCode && localConversationKey\n          ? doCheckConversationCode(localConversationKey, localConversationCode)\n          : null,\n      )\n      .catch(error => {\n        setIsValidLink(false);\n      });\n  }, []);\n\n  useEffect(() => {\n    const isEnabled =\n      Config.getConfig().URL.MOBILE_BASE && UrlUtil.hasURLParameter(QUERY_KEY.PWA_AWARE) && isPwaSupportedBrowser();\n    setIsPwaEnabled(isEnabled);\n    if (isEnabled) {\n      setForceNewTemporaryGuestAccount(true);\n    }\n  }, []);\n\n  const routeToApp = (conversation: string = '', domain: string = '') => {\n    const redirectLocation = isPwaEnabled\n      ? UrlUtil.pathWithParams(EXTERNAL_ROUTE.PWA_LOGIN, {[QUERY_KEY.IMMEDIATE_LOGIN]: 'true'})\n      : `${UrlUtil.pathWithParams(EXTERNAL_ROUTE.WEBAPP)}${\n          conversation && `#/conversation/${conversation}${domain && `/${domain}`}`\n        }`;\n    window.location.replace(redirectLocation);\n  };\n\n  const handleSubmit = async (entropyData?: Uint8Array) => {\n    try {\n      const name = enteredName.trim();\n      const registrationData = {\n        accent_id: accentColor.id,\n        expires_in: expiresIn,\n        name,\n      };\n      await doRegisterWireless(\n        registrationData as RegisterData,\n        {\n          shouldInitializeClient: !isPwaEnabled,\n        },\n        entropyData,\n      );\n      const conversationEvent = await doJoinConversationByCode(conversationKey, conversationCode);\n      /* When we join a conversation, we create the join event before loading the webapp.\n       * That means that when the webapp loads and tries to fetch the notificationStream is will get the join event once again and will try to handle it\n       * Here we set the core's lastEventDate so that it knows that this duplicated event should be skipped\n       */\n      await setLastEventDate(new Date(conversationEvent.time));\n\n      routeToApp(conversationEvent.conversation, conversationEvent.qualified_conversation.domain);\n    } catch (error) {\n      if (error.label) {\n        switch (error.label) {\n          default: {\n            const isValidationError = Object.values(ValidationError.ERROR).some(errorType =>\n              error.label.endsWith(errorType),\n            );\n            if (!isValidationError) {\n              doLogout();\n              console.warn('Unable to create wireless account', error);\n              setShowEntropyForm(false);\n            }\n          }\n        }\n      } else {\n        await doLogout();\n        console.warn('Unable to create wireless account', error);\n        setShowEntropyForm(false);\n      }\n    }\n    if (nameInput.current) {\n      nameInput.current.focus();\n    }\n  };\n\n  const checkNameValidity = (event: React.FormEvent) => {\n    event.preventDefault();\n    nameInput.current.value = nameInput.current.value.trim();\n    if (!nameInput.current.checkValidity()) {\n      setError(ValidationError.handleValidationState('name', nameInput.current.validity));\n      setIsValidName(false);\n    } else if (isEntropyRequired) {\n      setShowEntropyForm(true);\n    } else {\n      handleSubmit();\n    }\n  };\n\n  const resetErrors = () => {\n    setError(null);\n    setIsValidName(true);\n  };\n\n  const onNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    resetErrors();\n    setEnteredName(event.target.value);\n  };\n\n  const isFullConversation =\n    conversationError &&\n    conversationError.label &&\n    conversationError.label === BackendError.CONVERSATION_ERRORS.CONVERSATION_TOO_MANY_MEMBERS;\n  const renderTemporaryGuestAccountCreation = !isAuthenticated || isTemporaryGuest || forceNewTemporaryGuestAccount;\n\n  if (!isValidLink) {\n    return <Navigate to={ROUTE.CONVERSATION_JOIN_INVALID} replace />;\n  }\n  return (\n    <UnsupportedBrowser isTemporaryGuest>\n      <WirelessContainer\n        showCookiePolicyBanner={showCookiePolicyBanner}\n        onCookiePolicyBannerClose={() => setShowCookiePolicyBanner(false)}\n      >\n        {isEntropyRequired && showEntropyForm ? (\n          <EntropyContainer onSetEntropy={handleSubmit} />\n        ) : isFullConversation ? (\n          <ContainerXS style={{margin: 'auto 0'}}>\n            <H2 style={{fontWeight: 500, marginBottom: '10px', marginTop: '0'}} data-uie-name=\"status-full-headline\">\n              <FormattedMessage {...conversationJoinStrings.fullConversationHeadline} />\n            </H2>\n            <Text style={{fontSize: '1rem', marginTop: '10px'}} data-uie-name=\"status-full-text\">\n              {_(conversationJoinStrings.fullConversationSubhead)}\n            </Text>\n          </ContainerXS>\n        ) : renderTemporaryGuestAccountCreation ? (\n          <div>\n            <ContainerXS style={{margin: 'auto 0'}}>\n              <AppAlreadyOpen fullscreen={isPwaEnabled} />\n              <H2 style={{fontWeight: 500, marginBottom: '10px', marginTop: '0'}}>\n                <FormattedMessage\n                  {...conversationJoinStrings.headline}\n                  values={{\n                    brandName: Config.getConfig().BRAND_NAME,\n                  }}\n                />\n              </H2>\n              <Text style={{fontSize: '1rem', marginTop: '10px'}}>\n                <FormattedMessage {...conversationJoinStrings.subhead} />\n              </Text>\n              <Form style={{marginTop: 30}}>\n                <InputBlock>\n                  <InputSubmitCombo>\n                    <Input\n                      id=\"enter-name\"\n                      name=\"name\"\n                      autoComplete=\"username\"\n                      value={enteredName}\n                      ref={nameInput}\n                      onChange={onNameChange}\n                      placeholder={_(conversationJoinStrings.namePlaceholder)}\n                      maxLength={64}\n                      minLength={2}\n                      pattern=\".{2,64}\"\n                      required\n                      data-uie-name=\"enter-name\"\n                    />\n                    <RoundIconButton\n                      disabled={!enteredName || !isValidName}\n                      type=\"submit\"\n                      formNoValidate\n                      onClick={checkNameValidity}\n                      data-uie-name=\"do-next\"\n                    >\n                      <ArrowIcon />\n                    </RoundIconButton>\n                  </InputSubmitCombo>\n                </InputBlock>\n                {error ? parseValidationErrors(error) : parseError(conversationError)}\n              </Form>\n              {!isPwaEnabled && (\n                <Small block>\n                  {`${_(conversationJoinStrings.hasAccount)} `}\n                  <RouterLink\n                    to={`${ROUTE.LOGIN}/${conversationKey}/${conversationCode}`}\n                    textTransform={'none'}\n                    data-uie-name=\"go-login\"\n                  >\n                    {_(conversationJoinStrings.loginLink)}\n                  </RouterLink>\n                </Small>\n              )}\n            </ContainerXS>\n          </div>\n        ) : (\n          <ContainerXS style={{margin: 'auto 0'}}>\n            <AppAlreadyOpen fullscreen={isPwaEnabled} />\n            <H2 style={{fontWeight: 500, marginBottom: '10px', marginTop: '0'}} data-uie-name=\"status-join-headline\">\n              {selfName\n                ? _(conversationJoinStrings.existentAccountHeadline, {\n                    brandName: Config.getConfig().BRAND_NAME,\n                    name: StringUtil.capitalize(selfName),\n                  })\n                : _(conversationJoinStrings.headline, {brandName: Config.getConfig().BRAND_NAME})}\n            </H2>\n            <Text block style={{fontSize: '1rem', marginTop: '10px'}}>\n              {_(conversationJoinStrings.existentAccountSubhead)}\n            </Text>\n            <Button\n              type=\"button\"\n              style={{marginTop: 16}}\n              onClick={async () => {\n                try {\n                  const conversationEvent = await doJoinConversationByCode(conversationKey, conversationCode);\n                  routeToApp(conversationEvent.conversation, conversationEvent.qualified_conversation.domain);\n                } catch (error) {\n                  console.warn('Unable to join conversation with existing account', error);\n                }\n              }}\n              data-uie-name=\"do-open\"\n            >\n              {_(conversationJoinStrings.existentAccountOpenButton, {brandName: Config.getConfig().BRAND_NAME})}\n            </Button>\n            {error ? parseValidationErrors(error) : parseError(conversationError)}\n            <Small block>\n              {_(conversationJoinStrings.existentAccountJoinWithoutText, {\n                existentAccountJoinWithoutLink: (\n                  <Link\n                    onClick={() => setForceNewTemporaryGuestAccount(true)}\n                    textTransform={'none'}\n                    data-uie-name=\"go-join\"\n                  >\n                    {_(conversationJoinStrings.existentAccountJoinWithoutLink)}\n                  </Link>\n                ),\n              })}\n            </Small>\n          </ContainerXS>\n        )}\n      </WirelessContainer>\n    </UnsupportedBrowser>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  conversationError: ConversationSelector.getError(state),\n  isAuthenticated: AuthSelector.isAuthenticated(state),\n  isFetching: ConversationSelector.isFetching(state),\n  isTemporaryGuest: SelfSelector.isTemporaryGuest(state),\n  selfName: SelfSelector.getSelfName(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doCheckConversationCode: ROOT_ACTIONS.conversationAction.doCheckConversationCode,\n      doInit: ROOT_ACTIONS.authAction.doInit,\n      doJoinConversationByCode: ROOT_ACTIONS.conversationAction.doJoinConversationByCode,\n      doLogout: ROOT_ACTIONS.authAction.doLogout,\n      doRegisterWireless: ROOT_ACTIONS.authAction.doRegisterWireless,\n      setLastEventDate: ROOT_ACTIONS.notificationAction.setLastEventDate,\n    },\n    dispatch,\n  );\n\nconst ConversationJoin = connect(mapStateToProps, mapDispatchToProps)(ConversationJoinComponent);\n\nexport {ConversationJoin};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {FormattedMessage, useIntl} from 'react-intl';\n\nimport {ContainerXS, H2, Text} from '@wireapp/react-ui-kit';\n\nimport {Config} from '../../Config';\nimport {conversationJoinStrings} from '../../strings';\nimport {UnsupportedBrowser} from '../component/UnsupportedBrowser';\nimport {WirelessContainer} from '../component/WirelessContainer';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst ConversationJoinInvalid = ({}: Props) => {\n  const {formatMessage: _} = useIntl();\n  return (\n    <UnsupportedBrowser isTemporaryGuest>\n      <WirelessContainer>\n        <ContainerXS style={{margin: 'auto 0'}}>\n          <H2 style={{fontWeight: 500, marginBottom: '10px', marginTop: '0'}} data-uie-name=\"status-invalid-headline\">\n            <FormattedMessage\n              {...conversationJoinStrings.invalidHeadline}\n              values={{\n                brandName: Config.getConfig().BRAND_NAME,\n              }}\n            />\n          </H2>\n          <Text style={{fontSize: '1rem', marginTop: '10px'}} data-uie-name=\"status-invalid-text\">\n            {_(conversationJoinStrings.invalidSubhead)}\n          </Text>\n        </ContainerXS>\n      </WirelessContainer>\n    </UnsupportedBrowser>\n  );\n};\n\nexport {ConversationJoinInvalid};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef, useState} from 'react';\n\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {ValidationUtil} from '@wireapp/commons';\nimport {Button, Checkbox, CheckboxLabel, Form, Input, Small} from '@wireapp/react-ui-kit';\n\nimport {KEY} from 'Util/KeyboardUtil';\nimport {getLogger} from 'Util/Logger';\n\nimport {Exception} from './Exception';\n\nimport {Config} from '../../Config';\nimport {accountFormStrings} from '../../strings';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {BackendError} from '../module/action/BackendError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport * as AccentColor from '../util/AccentColor';\n\nconst logger = getLogger('AccountForm');\n\ninterface Props extends React.HTMLProps<HTMLFormElement> {\n  beforeSubmit?: () => Promise<void>;\n  onSubmit: () => void;\n  submitText?: string;\n}\n\nconst AccountFormComponent = ({account, ...props}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n\n  const [registrationData, setRegistrationData] = useState({\n    accent_id: AccentColor.random().id,\n    email: '',\n    name: '',\n    password: '',\n    termsAccepted: false,\n  });\n\n  const [validInputs, setValidInputs] = useState<Record<string, boolean>>({\n    email: true,\n    name: true,\n    password: true,\n    terms: true,\n  });\n\n  const [validationErrors, setValidationErrors] = useState<Error[]>([]);\n\n  const inputs = {\n    email: useRef<HTMLInputElement | null>(null),\n    name: useRef<HTMLInputElement | null>(null),\n    password: useRef<HTMLInputElement | null>(null),\n    terms: useRef<HTMLInputElement | null>(null),\n  };\n\n  useEffect(() => {\n    setRegistrationData(prevState => ({\n      ...prevState,\n      email: account?.email || '',\n      name: account?.name || '',\n      password: account?.password || '',\n      termsAccepted: !!account?.termsAccepted,\n    }));\n  }, [account]);\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const errors: Error[] | ValidationError[] = [];\n    const newValidInputs: Record<string, boolean> = {};\n\n    Object.entries(inputs).forEach(([inputKey, currentInput]) => {\n      const currentInputNode = currentInput.current;\n      if (currentInputNode) {\n        if (!['password', 'terms'].includes(inputKey)) {\n          currentInputNode.value = currentInputNode.value.trim();\n        }\n\n        if (!currentInputNode.checkValidity()) {\n          const validationError = ValidationError.handleValidationState(\n            currentInputNode.name,\n            currentInputNode.validity,\n          );\n\n          if (validationError) {\n            errors.push(validationError);\n          }\n        }\n        newValidInputs[inputKey] = currentInputNode.validity.valid;\n      }\n    });\n    setValidInputs(newValidInputs);\n    setValidationErrors(errors);\n\n    try {\n      if (errors.length > 0) {\n        throw errors[0];\n      }\n\n      await (props.beforeSubmit && props.beforeSubmit());\n      await props.pushAccountRegistrationData({...registrationData});\n      await props.doSendActivationCode(registrationData.email);\n\n      return props.onSubmit();\n    } catch (error) {\n      const label = (error as BackendError)?.label;\n      if (label) {\n        switch (label) {\n          case BackendError.AUTH_ERRORS.BLACKLISTED_EMAIL:\n          case BackendError.AUTH_ERRORS.DOMAIN_BLOCKED_FOR_REGISTRATION:\n          case BackendError.AUTH_ERRORS.INVALID_EMAIL:\n          case BackendError.AUTH_ERRORS.KEY_EXISTS: {\n            inputs.email.current?.setCustomValidity(label);\n            setValidInputs({...validInputs, email: false});\n            break;\n          }\n          case BackendError.AUTH_ERRORS.INVALID_CREDENTIALS:\n          case BackendError.GENERAL_ERRORS.UNAUTHORIZED: {\n            inputs.email.current?.setCustomValidity(label);\n            inputs.password.current?.setCustomValidity(label);\n            setValidInputs({...validInputs, email: false, password: false});\n            break;\n          }\n          default: {\n            const isValidationError = Object.values(ValidationError.ERROR).some(errorType => label.endsWith(errorType));\n            if (!isValidationError) {\n              throw error;\n            }\n          }\n        }\n      } else {\n        logger.error('Account registration error', error);\n      }\n    }\n  };\n  return (\n    <Form onSubmit={handleSubmit} style={{display: 'flex', flexDirection: 'column'}}>\n      <div>\n        <Input\n          name=\"name\"\n          id=\"name\"\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n            inputs.name.current?.setCustomValidity('');\n            setRegistrationData({...registrationData, name: event.target.value});\n            setValidInputs({...validInputs, name: true});\n          }}\n          ref={inputs.name}\n          markInvalid={!validInputs.name}\n          value={registrationData.name}\n          autoComplete=\"section-create-team username\"\n          placeholder={_(accountFormStrings.namePlaceholder)}\n          onKeyDown={(event: React.KeyboardEvent<HTMLInputElement>) => {\n            if (event.key === KEY.ENTER) {\n              inputs.email.current?.focus();\n            }\n          }}\n          maxLength={64}\n          minLength={2}\n          pattern=\".{2,64}\"\n          required\n          data-uie-name=\"enter-name\"\n        />\n\n        <Input\n          name=\"email\"\n          id=\"email\"\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n            inputs.email.current?.setCustomValidity('');\n            setRegistrationData({...registrationData, email: event.target.value});\n            setValidInputs({...validInputs, email: true});\n          }}\n          ref={inputs.email}\n          markInvalid={!validInputs.email}\n          value={registrationData.email}\n          autoComplete=\"section-create-team email\"\n          placeholder={_(\n            props.isPersonalFlow\n              ? accountFormStrings.emailPersonalPlaceholder\n              : accountFormStrings.emailTeamPlaceholder,\n          )}\n          onKeyDown={(event: React.KeyboardEvent<HTMLInputElement>) => {\n            if (event.key === KEY.ENTER) {\n              inputs.password.current?.focus();\n            }\n          }}\n          maxLength={128}\n          type=\"email\"\n          required\n          data-uie-name=\"enter-email\"\n        />\n\n        <Input\n          name=\"password\"\n          id=\"password\"\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n            inputs.password.current?.setCustomValidity('');\n            setRegistrationData({...registrationData, password: event.target.value});\n            setValidInputs({...validInputs, password: true});\n          }}\n          ref={inputs.password}\n          markInvalid={!validInputs.password}\n          value={registrationData.password}\n          autoComplete=\"section-create-team new-password\"\n          type=\"password\"\n          placeholder={_(accountFormStrings.passwordPlaceholder)}\n          pattern={ValidationUtil.getNewPasswordPattern(Config.getConfig().NEW_PASSWORD_MINIMUM_LENGTH)}\n          required\n          data-uie-name=\"enter-password\"\n        />\n\n        <Small\n          style={{\n            display: validationErrors.length ? 'none' : 'block',\n            marginBottom: '32px',\n            padding: '0 16px',\n          }}\n          data-uie-name=\"element-password-help\"\n        >\n          {_(accountFormStrings.passwordHelp, {minPasswordLength: Config.getConfig().NEW_PASSWORD_MINIMUM_LENGTH})}\n        </Small>\n\n        <Exception errors={[props.authError, ...validationErrors]} />\n      </div>\n\n      <Checkbox\n        ref={inputs.terms}\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n          inputs.terms.current?.setCustomValidity('');\n          setRegistrationData({...registrationData, termsAccepted: event.target.checked});\n          setValidInputs({...validInputs, terms: true});\n        }}\n        markInvalid={!validInputs.terms}\n        aligncenter\n        name=\"accept\"\n        id=\"accept\"\n        required\n        checked={registrationData.termsAccepted}\n        data-uie-name=\"do-terms\"\n        style={{justifyContent: 'center'}}\n      >\n        <CheckboxLabel htmlFor=\"accept\">\n          {Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION_ACCEPT_TERMS_AND_PRIVACY_POLICY ? (\n            <FormattedMessage\n              {...accountFormStrings.termsAndPrivacyPolicy}\n              values={{\n                // eslint-disable-next-line react/display-name\n                privacypolicy: ((...chunks: string[] | React.ReactNode[]) => (\n                  <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    data-uie-name=\"go-privacy-policy\"\n                    href={Config.getConfig().URL.PRIVACY_POLICY}\n                  >\n                    {chunks}\n                  </a>\n                )) as any,\n                // eslint-disable-next-line react/display-name\n                terms: ((...chunks: string[] | React.ReactNode[]) => (\n                  <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    data-uie-name=\"go-terms\"\n                    href={\n                      props.isPersonalFlow\n                        ? Config.getConfig().URL.TERMS_OF_USE_PERSONAL\n                        : Config.getConfig().URL.TERMS_OF_USE_TEAMS\n                    }\n                  >\n                    {chunks}\n                  </a>\n                )) as any,\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              {...accountFormStrings.terms}\n              values={{\n                // eslint-disable-next-line react/display-name\n                terms: ((...chunks: string[] | React.ReactNode[]) => (\n                  <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    data-uie-name=\"go-terms\"\n                    href={\n                      props.isPersonalFlow\n                        ? Config.getConfig().URL.TERMS_OF_USE_PERSONAL\n                        : Config.getConfig().URL.TERMS_OF_USE_TEAMS\n                    }\n                  >\n                    {chunks}\n                  </a>\n                )) as any,\n              }}\n            />\n          )}\n        </CheckboxLabel>\n      </Checkbox>\n\n      <Button\n        disabled={\n          !(\n            registrationData.email &&\n            registrationData.name &&\n            registrationData.password &&\n            registrationData.termsAccepted\n          ) || props.isFetching\n        }\n        formNoValidate\n        type=\"submit\"\n        style={{margin: '16px auto'}}\n        data-uie-name=\"do-next\"\n      >\n        {props.submitText || _(accountFormStrings.submitButton)}\n      </Button>\n    </Form>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  account: AuthSelector.getAccount(state),\n  authError: AuthSelector.getError(state),\n  isFetching: AuthSelector.isFetching(state),\n  isPersonalFlow: AuthSelector.isPersonalFlow(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doSendActivationCode: ROOT_ACTIONS.userAction.doSendActivationCode,\n      pushAccountRegistrationData: ROOT_ACTIONS.authAction.pushAccountRegistrationData,\n    },\n    dispatch,\n  );\n\nconst AccountForm = connect(mapStateToProps, mapDispatchToProps)(AccountFormComponent);\n\nexport {AccountForm};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {useNavigate} from 'react-router-dom';\n\nimport {ArrowIcon, COLOR, Column, Columns, Container, ContainerXS, H1, IsMobile} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../../script/Config';\nimport {createAccountStrings} from '../../strings';\nimport {AccountForm} from '../component/AccountForm';\nimport {RouterLink} from '../component/RouterLink';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst CreateAccount = ({}: Props) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const backArrow = (\n    <RouterLink to={ROUTE.CREATE_TEAM} data-uie-name=\"go-register-team\">\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n\n  return (\n    <Page hasTeamData>\n      <IsMobile>\n        <div style={{margin: 16}}>{backArrow}</div>\n      </IsMobile>\n      <Container centerText verticalCenter style={{width: '100%'}}>\n        <Columns>\n          <IsMobile not>\n            <Column style={{display: 'flex'}}>\n              <div style={{margin: 'auto'}}>{backArrow}</div>\n            </Column>\n          </IsMobile>\n          <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n            <ContainerXS\n              centerText\n              style={{display: 'flex', flexDirection: 'column', justifyContent: 'space-between', minHeight: 428}}\n            >\n              <H1 center>{_(createAccountStrings.headLine)}</H1>\n              <AccountForm\n                onSubmit={() => {\n                  if (Config.getConfig().FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY) {\n                    navigate(ROUTE.SET_ENTROPY);\n                  } else {\n                    navigate(ROUTE.VERIFY_EMAIL_CODE);\n                  }\n                }}\n                submitText={_(createAccountStrings.submitButton)}\n              />\n            </ContainerXS>\n          </Column>\n          <Column />\n        </Columns>\n      </Container>\n      <IsMobile>\n        <div style={{minWidth: 48}} />\n      </IsMobile>\n    </Page>\n  );\n};\n\nexport {CreateAccount};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime} from '@wireapp/commons';\nimport {ArrowIcon, COLOR, Column, Columns, Container, ContainerXS, H1, IsMobile} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {createPersonalAccountStrings} from '../../strings';\nimport {AccountForm} from '../component/AccountForm';\nimport {RouterLink} from '../component/RouterLink';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLAttributes<HTMLDivElement>;\n\nconst CreatePersonalAccountComponent = ({\n  isPersonalFlow,\n  enterPersonalCreationFlow,\n}: Props & ConnectedProps & DispatchProps) => {\n  const navigate = useNavigate();\n  const {formatMessage: _} = useIntl();\n  const isMacOsWrapper = Runtime.isDesktopApp() && Runtime.isMacOS();\n  React.useEffect(() => {\n    enterPersonalCreationFlow();\n  }, []);\n\n  const pageContent = (\n    <ContainerXS\n      centerText\n      verticalCenter\n      style={{display: 'flex', flexDirection: 'column', justifyContent: 'space-between', minHeight: 428}}\n    >\n      <H1 center>{_(createPersonalAccountStrings.headLine)}</H1>\n      <AccountForm\n        onSubmit={() => {\n          if (Config.getConfig().FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY) {\n            navigate(ROUTE.SET_ENTROPY);\n          } else {\n            navigate(ROUTE.VERIFY_EMAIL_CODE);\n          }\n        }}\n        submitText={_(createPersonalAccountStrings.submitButton)}\n      />\n    </ContainerXS>\n  );\n  const backArrow = (\n    <RouterLink\n      to={isMacOsWrapper ? ROUTE.INDEX : ROUTE.SET_ACCOUNT_TYPE}\n      data-uie-name=\"go-index\"\n      aria-label={_(createPersonalAccountStrings.goBack)}\n    >\n      <ArrowIcon aria-hidden=\"true\" direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n  return (\n    <Page>\n      <IsMobile>\n        <div style={{margin: 16}}>{backArrow}</div>\n      </IsMobile>\n      {isPersonalFlow ? (\n        <Container centerText verticalCenter style={{width: '100%'}}>\n          <Columns>\n            <IsMobile not>\n              <Column style={{display: 'flex'}}>\n                <div style={{margin: 'auto'}}>{backArrow}</div>\n              </Column>\n            </IsMobile>\n            <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>{pageContent}</Column>\n            <Column />\n          </Columns>\n        </Container>\n      ) : (\n        pageContent\n      )}\n      <IsMobile>\n        <div style={{minWidth: 48}} />\n      </IsMobile>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isPersonalFlow: AuthSelector.isPersonalFlow(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      enterPersonalCreationFlow: ROOT_ACTIONS.authAction.enterPersonalCreationFlow,\n    },\n    dispatch,\n  );\n\nconst CreatePersonalAccount = connect(mapStateToProps, mapDispatchToProps)(CreatePersonalAccountComponent);\n\nexport {CreatePersonalAccount};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useEffect, useState} from 'react';\n\nimport {SVGIcon} from '@wireapp/react-ui-kit/lib/Icon/SVGIcon';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime, UrlUtil} from '@wireapp/commons';\nimport {COLOR, ContainerXS, FlexBox, Text} from '@wireapp/react-ui-kit';\n\nimport {afterRender} from 'Util/util';\n\nimport {Page} from './Page';\n\nimport {customEnvRedirectStrings} from '../../strings';\nimport {actionRoot} from '../module/action';\nimport {bindActionCreators} from '../module/reducer';\nimport {QUERY_KEY} from '../route';\nimport {getSVG} from '../util/SVGProvider';\n\nconst REDIRECT_DELAY = 5000;\nconst CustomEnvironmentRedirectComponent = ({doNavigate, doSendNavigationEvent}: DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n\n  const [destinationUrl, setDestinationUrl] = useState<string | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  useEffect(() => {\n    const destinationParam = UrlUtil.getURLParameter(QUERY_KEY.DESTINATION_URL);\n    setDestinationUrl(destinationParam);\n  }, []);\n\n  useEffect(() => {\n    let redirectTimeoutId: number;\n    if (destinationUrl) {\n      redirectTimeoutId = window.setTimeout(() => {\n        if (Runtime.isDesktopApp()) {\n          doSendNavigationEvent(destinationUrl).catch(console.error);\n        } else {\n          doNavigate(destinationUrl);\n        }\n      }, REDIRECT_DELAY);\n      afterRender(() => setIsAnimating(true));\n    }\n    return () => {\n      window.clearTimeout(redirectTimeoutId);\n    };\n  }, [destinationUrl]);\n\n  return (\n    <Page>\n      <FlexBox column>\n        <FlexBox\n          justify=\"center\"\n          align=\"flex-end\"\n          style={{backgroundColor: 'black', height: 216, marginBottom: 64, width: '100vw'}}\n        >\n          <FlexBox\n            justify=\"center\"\n            align=\"center\"\n            style={{\n              backgroundColor: COLOR.ICON,\n              borderRadius: '50%',\n              boxShadow: '0 2px 4px 0 rgba(53, 63, 71, 0.29)',\n              height: 120,\n              marginBottom: -64,\n              position: 'relative',\n              width: 120,\n            }}\n          >\n            <SVGIcon aria-hidden=\"true\" color={COLOR.WHITE} realWidth={47} realHeight={38}>\n              <g dangerouslySetInnerHTML={{__html: getSVG('logo-icon')?.documentElement?.innerHTML}} />\n            </SVGIcon>\n            <svg\n              aria-hidden=\"true\"\n              style={{position: 'absolute'}}\n              width={124}\n              height={124}\n              viewBox=\"0 0 124 124\"\n              fill=\"none\"\n              data-uie-name=\"redirection-timer\"\n            >\n              <circle\n                style={{\n                  strokeDashoffset: isAnimating ? 0 : 377,\n                  transition: `stroke-dashoffset ${REDIRECT_DELAY}ms linear`,\n                }}\n                cx=\"62\"\n                cy=\"62\"\n                r=\"60\"\n                strokeWidth=\"4\"\n                stroke={COLOR.BLUE}\n                strokeLinecap=\"round\"\n                strokeDasharray={377}\n                transform=\"rotate(-90)\"\n                // eslint-disable-next-line react/no-unknown-property\n                transform-origin=\"center\"\n              />\n            </svg>\n          </FlexBox>\n        </FlexBox>\n        <ContainerXS centerText style={{marginTop: 48}}>\n          <Text block bold fontSize={'24px'} center style={{marginBottom: 16, marginTop: 0}}>\n            {_(customEnvRedirectStrings.redirectHeadline)}\n          </Text>\n          <Text block center>\n            {_(customEnvRedirectStrings.redirectTo)}\n          </Text>\n          <Text block center fontSize=\"16px\" bold style={{marginTop: '16px'}} data-uie-name=\"credentials-info\">\n            {_(customEnvRedirectStrings.credentialsInfo)}\n          </Text>\n        </ContainerXS>\n      </FlexBox>\n    </Page>\n  );\n};\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doNavigate: actionRoot.navigationAction.doNavigate,\n      doSendNavigationEvent: actionRoot.wrapperEventAction.doSendNavigationEvent,\n    },\n    dispatch,\n  );\n\nconst CustomEnvironmentRedirect = connect(null, mapDispatchToProps)(CustomEnvironmentRedirectComponent);\n\nexport {CustomEnvironmentRedirect};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect} from 'react';\n\nimport {ClientType} from '@wireapp/api-client/lib/client/index';\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate, useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Button, ContainerXS, H1, Link, Paragraph} from '@wireapp/react-ui-kit';\n\nimport {KEY} from 'Util/KeyboardUtil';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {historyInfoStrings} from '../../strings';\nimport {actionRoot} from '../module/action/';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as ClientSelector from '../module/selector/ClientSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst HistoryInfoComponent = ({\n  clients,\n  currentSelfClient,\n  hasLoadedClients,\n  isNewCurrentSelfClient,\n  doGetAllClients,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const shouldLoadClients = !hasLoadedClients && isNewCurrentSelfClient;\n\n  const onContinue = () => {\n    return navigate(ROUTE.SET_EMAIL);\n  };\n\n  useEffect(() => {\n    if (shouldLoadClients) {\n      doGetAllClients();\n    }\n  }, [doGetAllClients, shouldLoadClients]);\n\n  /**\n   * Show history screen when a new client was created and there is at least one previously registered client\n   */\n  const shouldShowHistoryInfo =\n    isNewCurrentSelfClient &&\n    (clients.length > 1 || (currentSelfClient && currentSelfClient.type === ClientType.TEMPORARY));\n\n  if (shouldLoadClients) {\n    return null;\n  }\n\n  if (!shouldShowHistoryInfo) {\n    return <Navigate to={ROUTE.SET_EMAIL} />;\n  }\n\n  return (\n    <Page>\n      <ContainerXS centerText verticalCenter style={{width: '100%'}}>\n        <H1 center>{_(historyInfoStrings.noHistoryHeadline, {brandName: Config.getConfig().BRAND_NAME})}</H1>\n        <Paragraph center style={{marginBottom: 56}}>\n          <FormattedMessage\n            {...historyInfoStrings.noHistoryInfo}\n            values={{\n              newline: <br />,\n            }}\n          />\n        </Paragraph>\n        <Button\n          style={{margin: 'auto', width: 200}}\n          type=\"button\"\n          onClick={onContinue}\n          data-uie-name=\"do-history-confirm\"\n          onKeyDown={(event: React.KeyboardEvent) => {\n            if (event.key === KEY.ENTER) {\n              onContinue();\n            }\n          }}\n        >\n          {_(historyInfoStrings.ok)}\n        </Button>\n        <Paragraph center style={{marginTop: 40}}>\n          <Link href={Config.getConfig().URL.SUPPORT.HISTORY} target=\"_blank\" data-uie-name=\"do-history-learn-more\">\n            {_(historyInfoStrings.learnMore)}\n          </Link>\n        </Paragraph>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  clients: ClientSelector.getClients(state),\n  isFeching: ClientSelector.isFetching(state),\n  currentSelfClient: ClientSelector.getCurrentSelfClient(state),\n  hasLoadedClients: ClientSelector.hasLoadedClients(state),\n  isNewCurrentSelfClient: ClientSelector.isNewCurrentSelfClient(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doGetAllClients: actionRoot.clientAction.doGetAllClients,\n    },\n    dispatch,\n  );\n\nconst HistoryInfo = connect(mapStateToProps, mapDispatchToProps)(HistoryInfoComponent);\n\nexport {HistoryInfo};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {SVGIcon} from '@wireapp/react-ui-kit/lib/Icon/SVGIcon';\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate, useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {UrlUtil} from '@wireapp/commons';\nimport {Button, ButtonVariant, ContainerXS, ErrorMessage, Text} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport '../../localization/Localizer';\nimport {indexStrings, logoutReasonStrings} from '../../strings';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {QUERY_KEY, ROUTE} from '../route';\nimport {getSVG} from '../util/SVGProvider';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst IndexComponent = ({defaultSSOCode}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const [logoutReason, setLogoutReason] = useState<string>();\n\n  useEffect(() => {\n    const queryLogoutReason = UrlUtil.getURLParameter(QUERY_KEY.LOGOUT_REASON) || null;\n    if (queryLogoutReason) {\n      setLogoutReason(queryLogoutReason);\n    }\n  }, []);\n\n  if (defaultSSOCode) {\n    // Redirect to prefilled SSO login if default SSO code is set on backend\n    return <Navigate to={`${ROUTE.SSO}/wire-${defaultSSOCode}`} />;\n  }\n\n  const features = Config.getConfig().FEATURE;\n  if (!features.ENABLE_DOMAIN_DISCOVERY && !features.ENABLE_SSO && !features.ENABLE_ACCOUNT_REGISTRATION) {\n    // Navigate directly to email login because it's the only available option on the index page\n    return <Navigate to={ROUTE.LOGIN} />;\n  }\n\n  return (\n    <Page>\n      <ContainerXS centerText verticalCenter style={{width: '380px'}}>\n        <SVGIcon\n          aria-hidden=\"true\"\n          scale={1.3}\n          realWidth={78}\n          realHeight={25}\n          style={{marginBottom: '80px'}}\n          data-uie-name=\"ui-wire-logo\"\n        >\n          <g dangerouslySetInnerHTML={{__html: getSVG('logo-full-icon')?.documentElement?.innerHTML}} />\n        </SVGIcon>\n        <Text\n          block\n          center\n          style={{fontSize: '2rem', fontWeight: 300, marginBottom: '48px'}}\n          data-uie-name=\"welcome-text\"\n        >\n          {_(indexStrings.welcome, {brandName: Config.getConfig().BACKEND_NAME})}\n        </Text>\n        {features.ENABLE_ACCOUNT_REGISTRATION && (\n          <Button\n            type=\"button\"\n            onClick={() => navigate(ROUTE.SET_ACCOUNT_TYPE)}\n            block\n            data-uie-name=\"go-set-account-type\"\n          >\n            {_(indexStrings.createAccount)}\n          </Button>\n        )}\n        <Button type=\"button\" onClick={() => navigate(ROUTE.LOGIN)} block data-uie-name=\"go-login\">\n          {_(indexStrings.logIn)}\n        </Button>\n        {logoutReason && (\n          <ErrorMessage data-uie-name=\"status-logout-reason\">\n            <FormattedMessage\n              {...logoutReasonStrings[logoutReason]}\n              values={{\n                newline: <br />,\n              }}\n            />\n          </ErrorMessage>\n        )}\n        {(features.ENABLE_SSO || features.ENABLE_DOMAIN_DISCOVERY) && (\n          <Button\n            type=\"button\"\n            variant={ButtonVariant.SECONDARY}\n            onClick={() => navigate(ROUTE.SSO)}\n            block\n            style={{marginTop: '120px'}}\n            data-uie-name=\"go-sso-login\"\n          >\n            {_(features.ENABLE_DOMAIN_DISCOVERY ? indexStrings.enterprise : indexStrings.ssoLogin)}\n          </Button>\n        )}\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  defaultSSOCode: AuthSelector.getDefaultSSOCode(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) => bindActionCreators({}, dispatch);\n\nconst Index = connect(mapStateToProps, mapDispatchToProps)(IndexComponent);\n\nexport {Index};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useState} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {\n  Button,\n  COLOR,\n  CheckIcon,\n  ContainerXS,\n  Form,\n  H1,\n  Input,\n  InputSubmitCombo,\n  Link,\n  Muted,\n  PlaneIcon,\n  RoundIconButton,\n  Text,\n  InputBlock,\n} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {inviteStrings} from '../../strings';\nimport {Exception} from '../component/Exception';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {BackendError} from '../module/action/BackendError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport * as InviteSelector from '../module/selector/InviteSelector';\nimport * as LanguageSelector from '../module/selector/LanguageSelector';\nimport {QUERY_KEY} from '../route';\nimport {pathWithParams} from '../util/urlUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst InitialInviteComponent = ({\n  invites,\n  isFetching,\n  inviteError,\n  resetInviteErrors,\n  invite,\n  isTeamFlow,\n  doFlushDatabase,\n  removeLocalStorage,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const emailInput = React.useRef<HTMLInputElement>();\n  const [enteredEmail, setEnteredEmail] = useState('');\n  const [error, setError] = useState(null);\n\n  const onInviteDone = async () => {\n    await doFlushDatabase();\n    // Remove local storage item for 2FA logout if token expires.\n    removeLocalStorage(QUERY_KEY.JOIN_EXPIRES);\n    window.location.replace(pathWithParams(EXTERNAL_ROUTE.WEBAPP));\n  };\n\n  const renderEmail = (email: string): JSX.Element => (\n    <div\n      style={{\n        alignItems: 'center',\n        display: 'flex',\n        justifyContent: 'space-between',\n        margin: '17px auto',\n        padding: '0 24px 0 20px',\n      }}\n      key={email}\n    >\n      <Text fontSize=\"14px\" data-uie-name=\"item-pending-email\">\n        {email}\n      </Text>\n      <CheckIcon color={COLOR.TEXT} />\n    </div>\n  );\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n    emailInput.current.value = emailInput.current.value.trim();\n    emailInput.current.focus();\n    if (!emailInput.current.checkValidity()) {\n      setError(ValidationError.handleValidationState('email', emailInput.current.validity));\n    } else {\n      try {\n        await invite({email: emailInput.current.value});\n        setEnteredEmail('');\n        emailInput.current.value = '';\n      } catch (error) {\n        if (error.label) {\n          switch (error.label) {\n            case BackendError.LABEL.EMAIL_EXISTS:\n            case BackendError.LABEL.ALREADY_INVITED: {\n              return;\n            }\n            default: {\n              const isValidationError = Object.values(ValidationError.ERROR).some(errorType =>\n                error.label.endsWith(errorType),\n              );\n              if (!isValidationError) {\n                throw error;\n              }\n            }\n          }\n        } else {\n          throw error;\n        }\n      }\n    }\n  };\n\n  const resetErrors = (): void => {\n    setError(null);\n    resetInviteErrors();\n  };\n\n  if (!isTeamFlow) {\n    onInviteDone();\n    return null;\n  }\n\n  const onEmailChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    resetErrors();\n    setEnteredEmail(event.target.value);\n  };\n\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', justifyContent: 'space-between', minHeight: 428}}\n      >\n        <div>\n          <H1 center>{_(inviteStrings.headline)}</H1>\n          <Muted>{_(inviteStrings.subhead)}</Muted>\n        </div>\n        <div style={{margin: '18px 0', minHeight: 220}}>\n          {invites.map(({email}) => renderEmail(email))}\n          <Form onSubmit={handleSubmit}>\n            <InputBlock>\n              <InputSubmitCombo>\n                <Input\n                  id=\"enter-invite-email\"\n                  name=\"email\"\n                  placeholder={_(inviteStrings.emailPlaceholder)}\n                  type=\"email\"\n                  onChange={onEmailChange}\n                  // Note: Curser issues when using controlled input\n                  // value={enteredEmail}\n                  ref={emailInput}\n                  data-uie-name=\"enter-invite-email\"\n                />\n                <RoundIconButton\n                  disabled={isFetching || !enteredEmail}\n                  type=\"submit\"\n                  data-uie-name=\"do-send-invite\"\n                  formNoValidate\n                >\n                  <PlaneIcon />\n                </RoundIconButton>\n              </InputSubmitCombo>\n            </InputBlock>\n          </Form>\n          <Exception errors={[error, inviteError]} />\n        </div>\n        <div>\n          {invites.length ? (\n            <Button type=\"button\" onClick={onInviteDone} data-uie-name=\"do-next\">\n              {_(inviteStrings.nextButton)}\n            </Button>\n          ) : (\n            <Link onClick={onInviteDone} data-uie-name=\"do-skip\">\n              {_(inviteStrings.skipForNow)}\n            </Link>\n          )}\n        </div>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  inviteError: InviteSelector.getError(state),\n  invites: InviteSelector.getInvites(state),\n  isFetching: InviteSelector.isFetching(state),\n  isTeamFlow: AuthSelector.isTeamFlow(state),\n  language: LanguageSelector.getLanguage(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doFlushDatabase: ROOT_ACTIONS.authAction.doFlushDatabase,\n      invite: ROOT_ACTIONS.invitationAction.invite,\n      removeLocalStorage: ROOT_ACTIONS.localStorageAction.deleteLocalStorage,\n      resetInviteErrors: ROOT_ACTIONS.invitationAction.resetInviteErrors,\n    },\n    dispatch,\n  );\n\nconst InitialInvite = connect(mapStateToProps, mapDispatchToProps)(InitialInviteComponent);\n\nexport {InitialInvite};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useRef, useState} from 'react';\n\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {useIntl} from 'react-intl';\n\nimport {Button, Input, Loading} from '@wireapp/react-ui-kit';\n\nimport {isValidEmail, isValidPhoneNumber, isValidUsername} from 'Util/ValidationUtil';\n\nimport {Config} from '../../Config';\nimport {loginStrings} from '../../strings';\nimport {ValidationError} from '../module/action/ValidationError';\n\ninterface LoginFormProps {\n  isFetching: boolean;\n  onSubmit: (loginData: Partial<LoginData>, validationErrors: Error[]) => Promise<void>;\n}\n\nconst LoginForm = ({isFetching, onSubmit}: LoginFormProps) => {\n  const {formatMessage: _} = useIntl();\n  const emailInput = useRef<HTMLInputElement>(null);\n  const passwordInput = useRef<HTMLInputElement>(null);\n\n  const [validEmailInput, setValidEmailInput] = useState(true);\n  const [validPasswordInput, setValidPasswordInput] = useState(true);\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n\n  const handleSubmit = (event: React.FormEvent): void => {\n    event.preventDefault();\n    if (isFetching) {\n      return;\n    }\n\n    if (!emailInput.current || !passwordInput.current) {\n      return;\n    }\n\n    emailInput.current.value = emailInput.current.value.trim();\n    const validationErrors: Error[] = [];\n\n    const isEmailValid = emailInput.current.checkValidity();\n    if (!isEmailValid) {\n      const emailValidationError = ValidationError.handleValidationState(\n        emailInput.current.name,\n        emailInput.current.validity,\n      );\n      if (emailValidationError) {\n        validationErrors.push(emailValidationError);\n      }\n    }\n\n    setValidEmailInput(emailInput.current.validity.valid);\n\n    const isPasswordValid = passwordInput.current.checkValidity();\n\n    if (!isPasswordValid) {\n      const passwordValidationError = ValidationError.handleValidationState(\n        passwordInput.current.name,\n        passwordInput.current.validity,\n      );\n      if (passwordValidationError) {\n        validationErrors.push(passwordValidationError);\n      }\n    }\n\n    const loginData: Partial<LoginData> = {password};\n    setValidPasswordInput(passwordInput.current.validity.valid);\n\n    const localEmail = email.trim();\n\n    if (isValidEmail(localEmail)) {\n      loginData.email = localEmail;\n    } else if (isValidUsername(localEmail.toLowerCase())) {\n      loginData.handle = localEmail.replace('@', '').toLowerCase();\n    } else if (Config.getConfig().FEATURE.ENABLE_PHONE_LOGIN && isValidPhoneNumber(localEmail)) {\n      loginData.phone = localEmail;\n    }\n    onSubmit(loginData, validationErrors);\n  };\n\n  return (\n    <div>\n      <Input\n        id=\"email\"\n        name=\"email\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n          setEmail(event.target.value);\n          setValidEmailInput(true);\n        }}\n        ref={emailInput}\n        markInvalid={!validEmailInput}\n        value={email}\n        autoComplete=\"username email\"\n        placeholder={_(loginStrings.emailPlaceholder)}\n        maxLength={128}\n        type=\"text\"\n        required\n        data-uie-name=\"enter-email\"\n      />\n      <Input\n        id=\"password-login\"\n        name=\"password-login\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n          setPassword(event.target.value);\n          setValidPasswordInput(true);\n        }}\n        ref={passwordInput}\n        markInvalid={!validPasswordInput}\n        value={password}\n        autoComplete=\"section-login password\"\n        type=\"password\"\n        placeholder={_(loginStrings.passwordPlaceholder)}\n        pattern={'.{1,1024}'}\n        required\n        data-uie-name=\"enter-password\"\n      />\n\n      {isFetching ? (\n        <Loading size={32} />\n      ) : (\n        <Button\n          block\n          type=\"submit\"\n          disabled={!email || !password}\n          formNoValidate\n          onClick={handleSubmit}\n          aria-label={_(loginStrings.headline)}\n          data-uie-name=\"do-sign-in\"\n        >\n          {_(loginStrings.headline)}\n        </Button>\n      )}\n    </div>\n  );\n};\n\nexport {LoginForm};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef, useState} from 'react';\n\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {ClientType} from '@wireapp/api-client/lib/client/index';\nimport {StatusCodes} from 'http-status-codes';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate} from 'react-router';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime, UrlUtil} from '@wireapp/commons';\nimport {\n  ArrowIcon,\n  Checkbox,\n  CheckboxLabel,\n  CodeInput,\n  COLOR,\n  Column,\n  Columns,\n  Container,\n  ContainerXS,\n  Form,\n  H1,\n  H2,\n  IsMobile,\n  Label,\n  Link,\n  LinkVariant,\n  Loading,\n  Muted,\n  Text,\n  TextLink,\n} from '@wireapp/react-ui-kit';\n\nimport {getLogger} from 'Util/Logger';\nimport {isBackendError} from 'Util/TypePredicateUtil';\n\nimport {EntropyContainer} from './EntropyContainer';\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {loginStrings, verifyStrings} from '../../strings';\nimport {AppAlreadyOpen} from '../component/AppAlreadyOpen';\nimport {LoginForm} from '../component/LoginForm';\nimport {RouterLink} from '../component/RouterLink';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {actionRoot} from '../module/action/';\nimport {BackendError} from '../module/action/BackendError';\nimport {LabeledError} from '../module/action/LabeledError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {QUERY_KEY, ROUTE} from '../route';\nimport {parseError, parseValidationErrors} from '../util/errorUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst LoginComponent = ({\n  authError,\n  resetAuthError,\n  doCheckConversationCode,\n  doInit,\n  doSetLocalStorage,\n  doInitializeClient,\n  doLoginAndJoin,\n  doLogin,\n  pushEntropyData,\n  doSendTwoFactorCode,\n  isFetching,\n  pushLoginData,\n  loginData,\n  defaultSSOCode,\n  isSendingTwoFactorCode,\n}: Props & ConnectedProps & DispatchProps) => {\n  const logger = getLogger('Login');\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const [conversationCode, setConversationCode] = useState<string | null>(null);\n  const [conversationKey, setConversationKey] = useState<string | null>(null);\n\n  const [isValidLink, setIsValidLink] = useState(true);\n  const [validationErrors, setValidationErrors] = useState<Error[]>([]);\n\n  const [twoFactorSubmitError, setTwoFactorSubmitError] = useState<string | Error>('');\n  const [twoFactorLoginData, setTwoFactorLoginData] = useState<LoginData>();\n\n  const [showEntropyForm, setShowEntropyForm] = useState(false);\n  const isEntropyRequired = Config.getConfig().FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY;\n\n  const onEntropyGenerated = useRef<((entropy: Uint8Array) => void) | undefined>();\n  const entropy = useRef<Uint8Array | undefined>();\n  const getEntropy = isEntropyRequired\n    ? () => {\n        // This is somewhat hacky. When the login action detects a new device and that entropy is required, then we give back a promise to the login action.\n        // This way we can just halt the login process, wait for the user to generate entropy and then give back the resulting entropy to the login action.\n        setShowEntropyForm(true);\n        return new Promise<Uint8Array>(resolve => {\n          // we need to keep a reference to the resolve function of the promise as it's going to be called by the entropyContainer callback\n          onEntropyGenerated.current = entropyData => {\n            entropy.current = entropyData;\n            resolve(entropyData);\n          };\n        });\n      }\n    : undefined;\n\n  useEffect(() => {\n    const queryClientType = UrlUtil.getURLParameter(QUERY_KEY.CLIENT_TYPE);\n    if (queryClientType === ClientType.TEMPORARY) {\n      pushLoginData({clientType: ClientType.TEMPORARY});\n    }\n  }, []);\n\n  useEffect(() => {\n    // Redirect to prefilled SSO login if default SSO code is set on backend\n    if (defaultSSOCode) {\n      navigate(`${ROUTE.SSO}/${defaultSSOCode}`);\n    }\n  }, [defaultSSOCode]);\n\n  useEffect(() => {\n    const queryConversationCode = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_CODE) || null;\n    const queryConversationKey = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_KEY) || null;\n\n    const keyAndCodeExistent = queryConversationKey && queryConversationCode;\n    if (keyAndCodeExistent) {\n      setConversationCode(queryConversationCode);\n      setConversationKey(queryConversationKey);\n      setIsValidLink(true);\n      doCheckConversationCode(queryConversationKey, queryConversationCode).catch(error => {\n        logger.warn('Invalid conversation code', error);\n        setIsValidLink(false);\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    resetAuthError();\n    const isImmediateLogin = UrlUtil.hasURLParameter(QUERY_KEY.IMMEDIATE_LOGIN);\n    if (isImmediateLogin) {\n      immediateLogin();\n    }\n    return () => {\n      resetAuthError();\n    };\n  }, []);\n\n  const immediateLogin = async () => {\n    try {\n      await doInit({isImmediateLogin: true, shouldValidateLocalClient: false});\n      const entropyData = await getEntropy?.();\n      await doInitializeClient(ClientType.PERMANENT, undefined, undefined, entropyData);\n      return navigate(ROUTE.HISTORY_INFO);\n    } catch (error) {\n      logger.error('Unable to login immediately', error);\n    }\n  };\n\n  const handleSubmit = async (formLoginData: Partial<LoginData>, validationErrors: Error[] = []) => {\n    setValidationErrors(validationErrors);\n    try {\n      const login: LoginData = {...formLoginData, clientType: loginData.clientType};\n      if (validationErrors.length) {\n        throw validationErrors[0];\n      }\n\n      const hasKeyAndCode = conversationKey && conversationCode;\n      if (hasKeyAndCode) {\n        await doLoginAndJoin(login, conversationKey, conversationCode, undefined, getEntropy);\n      } else {\n        await doLogin(login, getEntropy);\n      }\n\n      return navigate(ROUTE.HISTORY_INFO);\n    } catch (error) {\n      if (isBackendError(error)) {\n        switch (error.label) {\n          case BackendError.LABEL.TOO_MANY_CLIENTS: {\n            resetAuthError();\n            if (formLoginData?.verificationCode) {\n              doSetLocalStorage(QUERY_KEY.CONVERSATION_CODE, formLoginData.verificationCode);\n            }\n            if (entropy.current) {\n              pushEntropyData(entropy.current);\n            }\n            navigate(ROUTE.CLIENTS);\n            break;\n          }\n          case BackendError.LABEL.CODE_AUTHENTICATION_REQUIRED: {\n            const login: LoginData = {...formLoginData, clientType: loginData.clientType};\n            if (login.email) {\n              setTwoFactorLoginData(login);\n              doSendTwoFactorCode(login.email);\n              doSetLocalStorage(QUERY_KEY.JOIN_EXPIRES, Date.now() + 1000 * 60 * 10);\n            }\n            break;\n          }\n          case BackendError.LABEL.CODE_AUTHENTICATION_FAILED: {\n            setTwoFactorSubmitError(error);\n            break;\n          }\n          case BackendError.LABEL.INVALID_CREDENTIALS:\n          case BackendError.LABEL.SUSPENDED:\n          case LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE: {\n            break;\n          }\n          default: {\n            const backendError = error;\n            const isValidationError = Object.values(ValidationError.ERROR).some(errorType =>\n              backendError.label.endsWith(errorType),\n            );\n            if (!isValidationError) {\n              throw error;\n            }\n          }\n        }\n      } else {\n        throw error;\n      }\n    }\n  };\n\n  const resendTwoFactorCode = async () => {\n    try {\n      const email = twoFactorLoginData?.email;\n      if (email) {\n        await doSendTwoFactorCode(email);\n      }\n    } catch (error) {\n      setTwoFactorSubmitError(\n        new BackendError({code: StatusCodes.TOO_MANY_REQUESTS, label: BackendError.GENERAL_ERRORS.TOO_MANY_REQUESTS}),\n      );\n    }\n  };\n\n  const submitTwoFactorLogin = (code?: string) => {\n    setTwoFactorSubmitError('');\n    handleSubmit({...twoFactorLoginData, verificationCode: code}, []);\n  };\n\n  const storeEntropy = async (entropyData: Uint8Array) => {\n    onEntropyGenerated.current?.(entropyData);\n  };\n\n  const backArrow = (\n    <RouterLink to={ROUTE.INDEX} data-uie-name=\"go-index\" aria-label={_(loginStrings.goBack)}>\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n\n  return (\n    <Page>\n      {(Config.getConfig().FEATURE.ENABLE_DOMAIN_DISCOVERY ||\n        Config.getConfig().FEATURE.ENABLE_SSO ||\n        Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION) && (\n        <IsMobile>\n          <div style={{margin: 16}}>{backArrow}</div>\n        </IsMobile>\n      )}\n      {isEntropyRequired && showEntropyForm ? (\n        <EntropyContainer onSetEntropy={storeEntropy} />\n      ) : (\n        <Container centerText verticalCenter style={{width: '100%'}}>\n          {!isValidLink && <Navigate to={ROUTE.CONVERSATION_JOIN_INVALID} replace />}\n          <AppAlreadyOpen />\n          <Columns>\n            <IsMobile not>\n              <Column style={{display: 'flex'}}>\n                {(Config.getConfig().FEATURE.ENABLE_DOMAIN_DISCOVERY ||\n                  Config.getConfig().FEATURE.ENABLE_SSO ||\n                  Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION) && (\n                  <div style={{margin: 'auto'}}>{backArrow}</div>\n                )}\n              </Column>\n            </IsMobile>\n            <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n              <ContainerXS\n                centerText\n                style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n              >\n                {twoFactorLoginData ? (\n                  <div>\n                    <H2 center>{_(loginStrings.twoFactorLoginTitle)}</H2>\n                    <Text data-uie-name=\"label-with-email\">\n                      {_(loginStrings.twoFactorLoginSubHead, {email: twoFactorLoginData.email})}\n                    </Text>\n                    <Label markInvalid={!!twoFactorSubmitError}>\n                      <CodeInput\n                        style={{marginTop: 60}}\n                        onCodeComplete={submitTwoFactorLogin}\n                        data-uie-name=\"enter-code\"\n                        markInvalid={!!twoFactorSubmitError}\n                      />\n                    </Label>\n                    <div style={{display: 'flex', justifyContent: 'center', marginTop: 10}}>\n                      {!!twoFactorSubmitError && parseError(twoFactorSubmitError)}\n                    </div>\n                    <div style={{marginTop: 20}}>\n                      {isSendingTwoFactorCode ? (\n                        <Loading size={20} />\n                      ) : (\n                        <TextLink onClick={resendTwoFactorCode} center data-uie-name=\"do-resend-code\">\n                          {_(verifyStrings.resendCode)}\n                        </TextLink>\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    <div>\n                      <H1 center>{_(loginStrings.headline)}</H1>\n                      <Muted>{_(loginStrings.subhead)}</Muted>\n                      <Form style={{marginTop: 30}} data-uie-name=\"login\">\n                        <LoginForm isFetching={isFetching} onSubmit={handleSubmit} />\n                        {validationErrors.length ? (\n                          parseValidationErrors(validationErrors)\n                        ) : authError ? (\n                          parseError(authError)\n                        ) : (\n                          <div style={{marginTop: '4px'}}>&nbsp;</div>\n                        )}\n                        {!Runtime.isDesktopApp() && (\n                          <Checkbox\n                            onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                              pushLoginData({\n                                clientType: event.target.checked ? ClientType.TEMPORARY : ClientType.PERMANENT,\n                              });\n                            }}\n                            checked={loginData.clientType === ClientType.TEMPORARY}\n                            data-uie-name=\"enter-public-computer-sign-in\"\n                            style={{justifyContent: 'center', marginTop: '12px'}}\n                            aligncenter\n                          >\n                            <CheckboxLabel htmlFor=\"enter-public-computer-sign-in\">\n                              {_(loginStrings.publicComputer)}\n                            </CheckboxLabel>\n                          </Checkbox>\n                        )}\n                      </Form>\n                    </div>\n                    <Link\n                      variant={LinkVariant.PRIMARY}\n                      style={{paddingTop: '24px', textAlign: 'center'}}\n                      href={EXTERNAL_ROUTE.WIRE_ACCOUNT_PASSWORD_RESET}\n                      target=\"_blank\"\n                      data-uie-name=\"go-forgot-password\"\n                    >\n                      {_(loginStrings.forgotPassword)}\n                    </Link>\n                    {Config.getConfig().FEATURE.ENABLE_PHONE_LOGIN && (\n                      <RouterLink\n                        variant={LinkVariant.PRIMARY}\n                        style={{paddingTop: '12px', textAlign: 'center'}}\n                        to={ROUTE.LOGIN_PHONE}\n                        data-uie-name=\"go-sign-in-phone\"\n                      >\n                        {_(loginStrings.phoneLogin)}\n                      </RouterLink>\n                    )}\n                  </>\n                )}\n              </ContainerXS>\n            </Column>\n            <Column />\n          </Columns>\n        </Container>\n      )}\n      <IsMobile>\n        <div style={{minWidth: 48}} />\n      </IsMobile>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  defaultSSOCode: AuthSelector.getDefaultSSOCode(state),\n  isFetching: AuthSelector.isFetching(state),\n  isSendingTwoFactorCode: AuthSelector.isSendingTwoFactorCode(state),\n  loginData: AuthSelector.getLoginData(state),\n  authError: AuthSelector.getError(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doCheckConversationCode: actionRoot.conversationAction.doCheckConversationCode,\n      doInit: actionRoot.authAction.doInit,\n      doInitializeClient: actionRoot.clientAction.doInitializeClient,\n      doLogin: actionRoot.authAction.doLogin,\n      doLoginAndJoin: actionRoot.authAction.doLoginAndJoin,\n      doSendTwoFactorCode: actionRoot.authAction.doSendTwoFactorLoginCode,\n      doSetLocalStorage: actionRoot.localStorageAction.setLocalStorage,\n      pushEntropyData: actionRoot.authAction.pushEntropyData,\n      pushLoginData: actionRoot.authAction.pushLoginData,\n      resetAuthError: actionRoot.authAction.resetAuthError,\n    },\n    dispatch,\n  );\n\nconst Login = connect(mapStateToProps, mapDispatchToProps)(LoginComponent);\n\nexport {Login};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/* cspell:disable */\n\nexport interface CountryCode {\n  code: number;\n  iso: string;\n  name: string;\n  population: number;\n}\n\nexport const COUNTRY_CODES: CountryCode[] = [\n  {\n    code: 93,\n    iso: 'AF',\n    name: 'Afghanistan',\n    population: 31,\n  },\n  {\n    code: 355,\n    iso: 'AL',\n    name: 'Albania',\n    population: 2,\n  },\n  {\n    code: 213,\n    iso: 'DZ',\n    name: 'Algeria',\n    population: 34,\n  },\n  {\n    code: 1684,\n    iso: 'AS',\n    name: 'American Samoa',\n    population: 0,\n  },\n  {\n    code: 376,\n    iso: 'AD',\n    name: 'Andorra',\n    population: 0,\n  },\n  {\n    code: 244,\n    iso: 'AO',\n    name: 'Angola',\n    population: 13,\n  },\n  {\n    code: 1264,\n    iso: 'AI',\n    name: 'Anguilla',\n    population: 0,\n  },\n  {\n    code: 672,\n    iso: 'AQ',\n    name: 'Antarctica',\n    population: 0,\n  },\n  {\n    code: 1268,\n    iso: 'AG',\n    name: 'Antigua and Barbuda',\n    population: 0,\n  },\n  {\n    code: 54,\n    iso: 'AR',\n    name: 'Argentina',\n    population: 41,\n  },\n  {\n    code: 374,\n    iso: 'AM',\n    name: 'Armenia',\n    population: 2,\n  },\n  {\n    code: 297,\n    iso: 'AW',\n    name: 'Aruba',\n    population: 0,\n  },\n  {\n    code: 61,\n    iso: 'AU',\n    name: 'Australia',\n    population: 21,\n  },\n  {\n    code: 43,\n    iso: 'AT',\n    name: 'Austria',\n    population: 8,\n  },\n  {\n    code: 994,\n    iso: 'AZ',\n    name: 'Azerbaijan',\n    population: 8,\n  },\n  {\n    code: 1242,\n    iso: 'BS',\n    name: 'Bahamas',\n    population: 0,\n  },\n  {\n    code: 973,\n    iso: 'BH',\n    name: 'Bahrain',\n    population: 0,\n  },\n  {\n    code: 880,\n    iso: 'BD',\n    name: 'Bangladesh',\n    population: 171,\n  },\n  {\n    code: 1246,\n    iso: 'BB',\n    name: 'Barbados',\n    population: 0,\n  },\n  {\n    code: 375,\n    iso: 'BY',\n    name: 'Belarus',\n    population: 9,\n  },\n  {\n    code: 32,\n    iso: 'BE',\n    name: 'Belgium',\n    population: 10,\n  },\n  {\n    code: 501,\n    iso: 'BZ',\n    name: 'Belize',\n    population: 0,\n  },\n  {\n    code: 229,\n    iso: 'BJ',\n    name: 'Benin',\n    population: 9,\n  },\n  {\n    code: 1441,\n    iso: 'BM',\n    name: 'Bermuda',\n    population: 0,\n  },\n  {\n    code: 975,\n    iso: 'BT',\n    name: 'Bhutan',\n    population: 0,\n  },\n  {\n    code: 591,\n    iso: 'BO',\n    name: 'Bolivia',\n    population: 9,\n  },\n  {\n    code: 387,\n    iso: 'BA',\n    name: 'Bosnia and Herzegovina',\n    population: 4,\n  },\n  {\n    code: 267,\n    iso: 'BW',\n    name: 'Botswana',\n    population: 2,\n  },\n  {\n    code: 55,\n    iso: 'BR',\n    name: 'Brazil',\n    population: 201,\n  },\n  {\n    code: 246,\n    iso: 'IO',\n    name: 'British Indian Ocean Territory',\n    population: 0,\n  },\n  {\n    code: 1284,\n    iso: 'VG',\n    name: 'British Virgin Islands',\n    population: 0,\n  },\n  {\n    code: 673,\n    iso: 'BN',\n    name: 'Brunei',\n    population: 0,\n  },\n  {\n    code: 359,\n    iso: 'BG',\n    name: 'Bulgaria',\n    population: 7,\n  },\n  {\n    code: 226,\n    iso: 'BF',\n    name: 'Burkina Faso',\n    population: 16,\n  },\n  {\n    code: 257,\n    iso: 'BI',\n    name: 'Burundi',\n    population: 9,\n  },\n  {\n    code: 855,\n    iso: 'KH',\n    name: 'Cambodia',\n    population: 14,\n  },\n  {\n    code: 237,\n    iso: 'CM',\n    name: 'Cameroon',\n    population: 19,\n  },\n  {\n    code: 1,\n    iso: 'CA',\n    name: 'Canada',\n    population: 33,\n  },\n  {\n    code: 238,\n    iso: 'CV',\n    name: 'Cape Verde',\n    population: 0,\n  },\n  {\n    code: 1345,\n    iso: 'KY',\n    name: 'Cayman Islands',\n    population: 0,\n  },\n  {\n    code: 236,\n    iso: 'CF',\n    name: 'Central African Republic',\n    population: 4,\n  },\n  {\n    code: 235,\n    iso: 'TD',\n    name: 'Chad',\n    population: 10,\n  },\n  {\n    code: 56,\n    iso: 'CL',\n    name: 'Chile',\n    population: 16,\n  },\n  {\n    code: 86,\n    iso: 'CN',\n    name: 'China',\n    population: 1376,\n  },\n  {\n    code: 61,\n    iso: 'CX',\n    name: 'Christmas Island',\n    population: 0,\n  },\n  {\n    code: 61,\n    iso: 'CC',\n    name: 'Cocos Islands',\n    population: 0,\n  },\n  {\n    code: 57,\n    iso: 'CO',\n    name: 'Colombia',\n    population: 47,\n  },\n  {\n    code: 269,\n    iso: 'KM',\n    name: 'Comoros',\n    population: 0,\n  },\n  {\n    code: 682,\n    iso: 'CK',\n    name: 'Cook Islands',\n    population: 0,\n  },\n  {\n    code: 506,\n    iso: 'CR',\n    name: 'Costa Rica',\n    population: 4,\n  },\n  {\n    code: 385,\n    iso: 'HR',\n    name: 'Croatia',\n    population: 4,\n  },\n  {\n    code: 53,\n    iso: 'CU',\n    name: 'Cuba',\n    population: 11,\n  },\n  {\n    code: 599,\n    iso: 'CW',\n    name: 'Curacao',\n    population: 0,\n  },\n  {\n    code: 357,\n    iso: 'CY',\n    name: 'Cyprus',\n    population: 1,\n  },\n  {\n    code: 420,\n    iso: 'CZ',\n    name: 'Czech Republic',\n    population: 10,\n  },\n  {\n    code: 243,\n    iso: 'CD',\n    name: 'Democratic Republic of the Congo',\n    population: 81,\n  },\n  {\n    code: 45,\n    iso: 'DK',\n    name: 'Denmark',\n    population: 5,\n  },\n  {\n    code: 253,\n    iso: 'DJ',\n    name: 'Djibouti',\n    population: 0,\n  },\n  {\n    code: 1767,\n    iso: 'DM',\n    name: 'Dominica',\n    population: 0,\n  },\n  {\n    code: 1809,\n    iso: 'DO',\n    name: 'Dominican Republic',\n    population: 9,\n  },\n  {\n    code: 670,\n    iso: 'TL',\n    name: 'East Timor',\n    population: 1,\n  },\n  {\n    code: 593,\n    iso: 'EC',\n    name: 'Ecuador',\n    population: 14,\n  },\n  {\n    code: 20,\n    iso: 'EG',\n    name: 'Egypt',\n    population: 91,\n  },\n  {\n    code: 503,\n    iso: 'SV',\n    name: 'El Salvador',\n    population: 6,\n  },\n  {\n    code: 240,\n    iso: 'GQ',\n    name: 'Equatorial Guinea',\n    population: 1,\n  },\n  {\n    code: 291,\n    iso: 'ER',\n    name: 'Eritrea',\n    population: 5,\n  },\n  {\n    code: 372,\n    iso: 'EE',\n    name: 'Estonia',\n    population: 1,\n  },\n  {\n    code: 251,\n    iso: 'ET',\n    name: 'Ethiopia',\n    population: 88,\n  },\n  {\n    code: 500,\n    iso: 'FK',\n    name: 'Falkland Islands',\n    population: 0,\n  },\n  {\n    code: 298,\n    iso: 'FO',\n    name: 'Faroe Islands',\n    population: 0,\n  },\n  {\n    code: 679,\n    iso: 'FJ',\n    name: 'Fiji',\n    population: 0,\n  },\n  {\n    code: 358,\n    iso: 'FI',\n    name: 'Finland',\n    population: 5,\n  },\n  {\n    code: 33,\n    iso: 'FR',\n    name: 'France',\n    population: 64,\n  },\n  {\n    code: 689,\n    iso: 'PF',\n    name: 'French Polynesia',\n    population: 0,\n  },\n  {\n    code: 241,\n    iso: 'GA',\n    name: 'Gabon',\n    population: 1,\n  },\n  {\n    code: 220,\n    iso: 'GM',\n    name: 'Gambia',\n    population: 1,\n  },\n  {\n    code: 995,\n    iso: 'GE',\n    name: 'Georgia',\n    population: 4,\n  },\n  {\n    code: 49,\n    iso: 'DE',\n    name: 'Germany',\n    population: 81,\n  },\n  {\n    code: 233,\n    iso: 'GH',\n    name: 'Ghana',\n    population: 24,\n  },\n  {\n    code: 350,\n    iso: 'GI',\n    name: 'Gibraltar',\n    population: 0,\n  },\n  {\n    code: 30,\n    iso: 'GR',\n    name: 'Greece',\n    population: 11,\n  },\n  {\n    code: 299,\n    iso: 'GL',\n    name: 'Greenland',\n    population: 0,\n  },\n  {\n    code: 1473,\n    iso: 'GD',\n    name: 'Grenada',\n    population: 0,\n  },\n  {\n    code: 1671,\n    iso: 'GU',\n    name: 'Guam',\n    population: 0,\n  },\n  {\n    code: 502,\n    iso: 'GT',\n    name: 'Guatemala',\n    population: 13,\n  },\n  {\n    code: 441481,\n    iso: 'GG',\n    name: 'Guernsey',\n    population: 0,\n  },\n  {\n    code: 224,\n    iso: 'GN',\n    name: 'Guinea',\n    population: 10,\n  },\n  {\n    code: 245,\n    iso: 'GW',\n    name: 'Guinea-Bissau',\n    population: 1,\n  },\n  {\n    code: 592,\n    iso: 'GY',\n    name: 'Guyana',\n    population: 0,\n  },\n  {\n    code: 509,\n    iso: 'HT',\n    name: 'Haiti',\n    population: 9,\n  },\n  {\n    code: 504,\n    iso: 'HN',\n    name: 'Honduras',\n    population: 7,\n  },\n  {\n    code: 852,\n    iso: 'HK',\n    name: 'Hong Kong',\n    population: 6,\n  },\n  {\n    code: 36,\n    iso: 'HU',\n    name: 'Hungary',\n    population: 9,\n  },\n  {\n    code: 354,\n    iso: 'IS',\n    name: 'Iceland',\n    population: 0,\n  },\n  {\n    code: 91,\n    iso: 'IN',\n    name: 'India',\n    population: 1173,\n  },\n  {\n    code: 62,\n    iso: 'ID',\n    name: 'Indonesia',\n    population: 242,\n  },\n  {\n    code: 98,\n    iso: 'IR',\n    name: 'Iran',\n    population: 76,\n  },\n  {\n    code: 964,\n    iso: 'IQ',\n    name: 'Iraq',\n    population: 29,\n  },\n  {\n    code: 353,\n    iso: 'IE',\n    name: 'Ireland',\n    population: 4,\n  },\n  {\n    code: 441624,\n    iso: 'IM',\n    name: 'Isle of Man',\n    population: 0,\n  },\n  {\n    code: 972,\n    iso: 'IL',\n    name: 'Israel',\n    population: 7,\n  },\n  {\n    code: 39,\n    iso: 'IT',\n    name: 'Italy',\n    population: 60,\n  },\n  {\n    code: 225,\n    iso: 'CI',\n    name: 'Ivory Coast',\n    population: 21,\n  },\n  {\n    code: 1876,\n    iso: 'JM',\n    name: 'Jamaica',\n    population: 2,\n  },\n  {\n    code: 81,\n    iso: 'JP',\n    name: 'Japan',\n    population: 127,\n  },\n  {\n    code: 441534,\n    iso: 'JE',\n    name: 'Jersey',\n    population: 0,\n  },\n  {\n    code: 962,\n    iso: 'JO',\n    name: 'Jordan',\n    population: 6,\n  },\n  {\n    code: 7,\n    iso: 'KZ',\n    name: 'Kazakhstan',\n    population: 15,\n  },\n  {\n    code: 254,\n    iso: 'KE',\n    name: 'Kenya',\n    population: 40,\n  },\n  {\n    code: 686,\n    iso: 'KI',\n    name: 'Kiribati',\n    population: 0,\n  },\n  {\n    code: 383,\n    iso: 'XK',\n    name: 'Kosovo',\n    population: 1,\n  },\n  {\n    code: 965,\n    iso: 'KW',\n    name: 'Kuwait',\n    population: 2,\n  },\n  {\n    code: 996,\n    iso: 'KG',\n    name: 'Kyrgyzstan',\n    population: 5,\n  },\n  {\n    code: 856,\n    iso: 'LA',\n    name: 'Laos',\n    population: 6,\n  },\n  {\n    code: 371,\n    iso: 'LV',\n    name: 'Latvia',\n    population: 2,\n  },\n  {\n    code: 961,\n    iso: 'LB',\n    name: 'Lebanon',\n    population: 4,\n  },\n  {\n    code: 266,\n    iso: 'LS',\n    name: 'Lesotho',\n    population: 1,\n  },\n  {\n    code: 231,\n    iso: 'LR',\n    name: 'Liberia',\n    population: 3,\n  },\n  {\n    code: 218,\n    iso: 'LY',\n    name: 'Libya',\n    population: 6,\n  },\n  {\n    code: 423,\n    iso: 'LI',\n    name: 'Liechtenstein',\n    population: 0,\n  },\n  {\n    code: 370,\n    iso: 'LT',\n    name: 'Lithuania',\n    population: 2,\n  },\n  {\n    code: 352,\n    iso: 'LU',\n    name: 'Luxembourg',\n    population: 0,\n  },\n  {\n    code: 853,\n    iso: 'MO',\n    name: 'Macao',\n    population: 0,\n  },\n  {\n    code: 389,\n    iso: 'MK',\n    name: 'Macedonia',\n    population: 2,\n  },\n  {\n    code: 261,\n    iso: 'MG',\n    name: 'Madagascar',\n    population: 21,\n  },\n  {\n    code: 265,\n    iso: 'MW',\n    name: 'Malawi',\n    population: 15,\n  },\n  {\n    code: 60,\n    iso: 'MY',\n    name: 'Malaysia',\n    population: 28,\n  },\n  {\n    code: 960,\n    iso: 'MV',\n    name: 'Maldives',\n    population: 0,\n  },\n  {\n    code: 223,\n    iso: 'ML',\n    name: 'Mali',\n    population: 13,\n  },\n  {\n    code: 356,\n    iso: 'MT',\n    name: 'Malta',\n    population: 0,\n  },\n  {\n    code: 692,\n    iso: 'MH',\n    name: 'Marshall Islands',\n    population: 0,\n  },\n  {\n    code: 222,\n    iso: 'MR',\n    name: 'Mauritania',\n    population: 3,\n  },\n  {\n    code: 230,\n    iso: 'MU',\n    name: 'Mauritius',\n    population: 1,\n  },\n  {\n    code: 262,\n    iso: 'YT',\n    name: 'Mayotte',\n    population: 0,\n  },\n  {\n    code: 52,\n    iso: 'MX',\n    name: 'Mexico',\n    population: 112,\n  },\n  {\n    code: 691,\n    iso: 'FM',\n    name: 'Micronesia',\n    population: 0,\n  },\n  {\n    code: 373,\n    iso: 'MD',\n    name: 'Moldova',\n    population: 4,\n  },\n  {\n    code: 377,\n    iso: 'MC',\n    name: 'Monaco',\n    population: 0,\n  },\n  {\n    code: 976,\n    iso: 'MN',\n    name: 'Mongolia',\n    population: 3,\n  },\n  {\n    code: 382,\n    iso: 'ME',\n    name: 'Montenegro',\n    population: 0,\n  },\n  {\n    code: 1664,\n    iso: 'MS',\n    name: 'Montserrat',\n    population: 0,\n  },\n  {\n    code: 212,\n    iso: 'MA',\n    name: 'Morocco',\n    population: 33,\n  },\n  {\n    code: 258,\n    iso: 'MZ',\n    name: 'Mozambique',\n    population: 22,\n  },\n  {\n    code: 95,\n    iso: 'MM',\n    name: 'Myanmar',\n    population: 53,\n  },\n  {\n    code: 264,\n    iso: 'NA',\n    name: 'Namibia',\n    population: 2,\n  },\n  {\n    code: 674,\n    iso: 'NR',\n    name: 'Nauru',\n    population: 0,\n  },\n  {\n    code: 977,\n    iso: 'NP',\n    name: 'Nepal',\n    population: 28,\n  },\n  {\n    code: 31,\n    iso: 'NL',\n    name: 'Netherlands',\n    population: 16,\n  },\n  {\n    code: 599,\n    iso: 'AN',\n    name: 'Netherlands Antilles',\n    population: 0,\n  },\n  {\n    code: 687,\n    iso: 'NC',\n    name: 'New Caledonia',\n    population: 0,\n  },\n  {\n    code: 64,\n    iso: 'NZ',\n    name: 'New Zealand',\n    population: 4,\n  },\n  {\n    code: 505,\n    iso: 'NI',\n    name: 'Nicaragua',\n    population: 5,\n  },\n  {\n    code: 227,\n    iso: 'NE',\n    name: 'Niger',\n    population: 15,\n  },\n  {\n    code: 234,\n    iso: 'NG',\n    name: 'Nigeria',\n    population: 182,\n  },\n  {\n    code: 683,\n    iso: 'NU',\n    name: 'Niue',\n    population: 0,\n  },\n  {\n    code: 850,\n    iso: 'KP',\n    name: 'North Korea',\n    population: 22,\n  },\n  {\n    code: 1670,\n    iso: 'MP',\n    name: 'Northern Mariana Islands',\n    population: 0,\n  },\n  {\n    code: 47,\n    iso: 'NO',\n    name: 'Norway',\n    population: 5,\n  },\n  {\n    code: 968,\n    iso: 'OM',\n    name: 'Oman',\n    population: 2,\n  },\n  {\n    code: 92,\n    iso: 'PK',\n    name: 'Pakistan',\n    population: 184,\n  },\n  {\n    code: 680,\n    iso: 'PW',\n    name: 'Palau',\n    population: 0,\n  },\n  {\n    code: 970,\n    iso: 'PS',\n    name: 'Palestine',\n    population: 3,\n  },\n  {\n    code: 507,\n    iso: 'PA',\n    name: 'Panama',\n    population: 3,\n  },\n  {\n    code: 675,\n    iso: 'PG',\n    name: 'Papua New Guinea',\n    population: 6,\n  },\n  {\n    code: 595,\n    iso: 'PY',\n    name: 'Paraguay',\n    population: 6,\n  },\n  {\n    code: 51,\n    iso: 'PE',\n    name: 'Peru',\n    population: 29,\n  },\n  {\n    code: 63,\n    iso: 'PH',\n    name: 'Philippines',\n    population: 102,\n  },\n  {\n    code: 64,\n    iso: 'PN',\n    name: 'Pitcairn',\n    population: 0,\n  },\n  {\n    code: 48,\n    iso: 'PL',\n    name: 'Poland',\n    population: 38,\n  },\n  {\n    code: 351,\n    iso: 'PT',\n    name: 'Portugal',\n    population: 10,\n  },\n  {\n    code: 1787,\n    iso: 'PR',\n    name: 'Puerto Rico',\n    population: 3,\n  },\n  {\n    code: 974,\n    iso: 'QA',\n    name: 'Qatar',\n    population: 0,\n  },\n  {\n    code: 242,\n    iso: 'CG',\n    name: 'Republic of the Congo',\n    population: 3,\n  },\n  {\n    code: 262,\n    iso: 'RE',\n    name: 'Reunion',\n    population: 0,\n  },\n  {\n    code: 40,\n    iso: 'RO',\n    name: 'Romania',\n    population: 21,\n  },\n  {\n    code: 7,\n    iso: 'RU',\n    name: 'Russia',\n    population: 140,\n  },\n  {\n    code: 250,\n    iso: 'RW',\n    name: 'Rwanda',\n    population: 11,\n  },\n  {\n    code: 590,\n    iso: 'BL',\n    name: 'Saint Barthelemy',\n    population: 0,\n  },\n  {\n    code: 290,\n    iso: 'SH',\n    name: 'Saint Helena',\n    population: 0,\n  },\n  {\n    code: 1869,\n    iso: 'KN',\n    name: 'Saint Kitts and Nevis',\n    population: 0,\n  },\n  {\n    code: 1758,\n    iso: 'LC',\n    name: 'Saint Lucia',\n    population: 0,\n  },\n  {\n    code: 590,\n    iso: 'MF',\n    name: 'Saint Martin',\n    population: 0,\n  },\n  {\n    code: 508,\n    iso: 'PM',\n    name: 'Saint Pierre and Miquelon',\n    population: 0,\n  },\n  {\n    code: 1784,\n    iso: 'VC',\n    name: 'Saint Vincent and the Grenadines',\n    population: 0,\n  },\n  {\n    code: 685,\n    iso: 'WS',\n    name: 'Samoa',\n    population: 0,\n  },\n  {\n    code: 378,\n    iso: 'SM',\n    name: 'San Marino',\n    population: 0,\n  },\n  {\n    code: 239,\n    iso: 'ST',\n    name: 'Sao Tome and Principe',\n    population: 0,\n  },\n  {\n    code: 966,\n    iso: 'SA',\n    name: 'Saudi Arabia',\n    population: 25,\n  },\n  {\n    code: 221,\n    iso: 'SN',\n    name: 'Senegal',\n    population: 12,\n  },\n  {\n    code: 381,\n    iso: 'RS',\n    name: 'Serbia',\n    population: 7,\n  },\n  {\n    code: 248,\n    iso: 'SC',\n    name: 'Seychelles',\n    population: 0,\n  },\n  {\n    code: 232,\n    iso: 'SL',\n    name: 'Sierra Leone',\n    population: 5,\n  },\n  {\n    code: 65,\n    iso: 'SG',\n    name: 'Singapore',\n    population: 4,\n  },\n  {\n    code: 1721,\n    iso: 'SX',\n    name: 'Sint Maarten',\n    population: 0,\n  },\n  {\n    code: 421,\n    iso: 'SK',\n    name: 'Slovakia',\n    population: 5,\n  },\n  {\n    code: 386,\n    iso: 'SI',\n    name: 'Slovenia',\n    population: 2,\n  },\n  {\n    code: 677,\n    iso: 'SB',\n    name: 'Solomon Islands',\n    population: 0,\n  },\n  {\n    code: 252,\n    iso: 'SO',\n    name: 'Somalia',\n    population: 10,\n  },\n  {\n    code: 27,\n    iso: 'ZA',\n    name: 'South Africa',\n    population: 54,\n  },\n  {\n    code: 82,\n    iso: 'KR',\n    name: 'South Korea',\n    population: 48,\n  },\n  {\n    code: 211,\n    iso: 'SS',\n    name: 'South Sudan',\n    population: 8,\n  },\n  {\n    code: 34,\n    iso: 'ES',\n    name: 'Spain',\n    population: 46,\n  },\n  {\n    code: 94,\n    iso: 'LK',\n    name: 'Sri Lanka',\n    population: 21,\n  },\n  {\n    code: 249,\n    iso: 'SD',\n    name: 'Sudan',\n    population: 35,\n  },\n  {\n    code: 597,\n    iso: 'SR',\n    name: 'Suriname',\n    population: 0,\n  },\n  {\n    code: 47,\n    iso: 'SJ',\n    name: 'Svalbard and Jan Mayen',\n    population: 0,\n  },\n  {\n    code: 268,\n    iso: 'SZ',\n    name: 'Swaziland',\n    population: 1,\n  },\n  {\n    code: 46,\n    iso: 'SE',\n    name: 'Sweden',\n    population: 9,\n  },\n  {\n    code: 41,\n    iso: 'CH',\n    name: 'Switzerland',\n    population: 8,\n  },\n  {\n    code: 963,\n    iso: 'SY',\n    name: 'Syria',\n    population: 22,\n  },\n  {\n    code: 886,\n    iso: 'TW',\n    name: 'Taiwan',\n    population: 22,\n  },\n  {\n    code: 992,\n    iso: 'TJ',\n    name: 'Tajikistan',\n    population: 7,\n  },\n  {\n    code: 255,\n    iso: 'TZ',\n    name: 'Tanzania',\n    population: 41,\n  },\n  {\n    code: 66,\n    iso: 'TH',\n    name: 'Thailand',\n    population: 67,\n  },\n  {\n    code: 228,\n    iso: 'TG',\n    name: 'Togo',\n    population: 6,\n  },\n  {\n    code: 690,\n    iso: 'TK',\n    name: 'Tokelau',\n    population: 0,\n  },\n  {\n    code: 676,\n    iso: 'TO',\n    name: 'Tonga',\n    population: 0,\n  },\n  {\n    code: 1868,\n    iso: 'TT',\n    name: 'Trinidad and Tobago',\n    population: 1,\n  },\n  {\n    code: 216,\n    iso: 'TN',\n    name: 'Tunisia',\n    population: 10,\n  },\n  {\n    code: 90,\n    iso: 'TR',\n    name: 'Turkey',\n    population: 77,\n  },\n  {\n    code: 993,\n    iso: 'TM',\n    name: 'Turkmenistan',\n    population: 4,\n  },\n  {\n    code: 1649,\n    iso: 'TC',\n    name: 'Turks and Caicos Islands',\n    population: 0,\n  },\n  {\n    code: 688,\n    iso: 'TV',\n    name: 'Tuvalu',\n    population: 0,\n  },\n  {\n    code: 1340,\n    iso: 'VI',\n    name: 'U.S. Virgin Islands',\n    population: 0,\n  },\n  {\n    code: 256,\n    iso: 'UG',\n    name: 'Uganda',\n    population: 33,\n  },\n  {\n    code: 380,\n    iso: 'UA',\n    name: 'Ukraine',\n    population: 45,\n  },\n  {\n    code: 971,\n    iso: 'AE',\n    name: 'United Arab Emirates',\n    population: 4,\n  },\n  {\n    code: 44,\n    iso: 'GB',\n    name: 'United Kingdom',\n    population: 65,\n  },\n  {\n    code: 1,\n    iso: 'US',\n    name: 'United States',\n    population: 324,\n  },\n  {\n    code: 598,\n    iso: 'UY',\n    name: 'Uruguay',\n    population: 3,\n  },\n  {\n    code: 998,\n    iso: 'UZ',\n    name: 'Uzbekistan',\n    population: 27,\n  },\n  {\n    code: 678,\n    iso: 'VU',\n    name: 'Vanuatu',\n    population: 0,\n  },\n  {\n    code: 379,\n    iso: 'VA',\n    name: 'Vatican',\n    population: 0,\n  },\n  {\n    code: 58,\n    iso: 'VE',\n    name: 'Venezuela',\n    population: 26,\n  },\n  {\n    code: 84,\n    iso: 'VN',\n    name: 'Vietnam',\n    population: 91,\n  },\n  {\n    code: 681,\n    iso: 'WF',\n    name: 'Wallis and Futuna',\n    population: 0,\n  },\n  {\n    code: 212,\n    iso: 'EH',\n    name: 'Western Sahara',\n    population: 0,\n  },\n  {\n    code: 967,\n    iso: 'YE',\n    name: 'Yemen',\n    population: 24,\n  },\n  {\n    code: 260,\n    iso: 'ZM',\n    name: 'Zambia',\n    population: 16,\n  },\n  {\n    code: 263,\n    iso: 'ZW',\n    name: 'Zimbabwe',\n    population: 12,\n  },\n];\n\n/**\n * Get the country code matching to an ISO name\n * @param countryCode Country code\n * @returns Returns the ISO standard country name of the most populated country with the matching country code\n */\nexport const getCountryByCode = (countryCode: string): string | void => {\n  const parsedCode = parseInt(countryCode, 10);\n  const country = COUNTRY_CODES.filter(({code}) => code === parsedCode)\n    .sort((countryA, countryB) => countryA.population - countryB.population)\n    .pop();\n  if (country) {\n    return country.iso;\n  }\n};\n\n/**\n * Get the country code matching an ISO name\n * @param isoName ISO standard country name\n * @returns Matching country code\n */\nexport const getCountryCode = (isoName: string): number | void => {\n  const country = COUNTRY_CODES.find(({iso}) => iso === isoName);\n  if (country) {\n    return country.code;\n  }\n};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useRef, useState} from 'react';\n\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {useIntl} from 'react-intl';\n\nimport {\n  ArrowIcon,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  Loading,\n  RoundIconButton,\n  Select,\n  QUERY,\n  useMatchMedia,\n} from '@wireapp/react-ui-kit';\n\nimport {COUNTRY_CODES, getCountryByCode, getCountryCode} from 'Util/CountryCodes';\n\nimport {phoneLoginStrings} from '../../strings';\n\ninterface LoginFormProps {\n  isFetching: boolean;\n  onSubmit: (loginData: Partial<LoginData>, validationErrors: Error[]) => Promise<void>;\n}\n\nconst PhoneLoginForm = ({isFetching, onSubmit}: LoginFormProps) => {\n  const {formatMessage: _} = useIntl();\n  const [phoneNumber, setPhoneNumber] = useState('');\n  const [countryCode, setCountryCode] = useState('1');\n  const [country, setCountry] = useState('US');\n  const [validInput, setValidInput] = useState(true);\n  const phoneInput = useRef(null);\n  const countryCodeInput = useRef(null);\n  const countryList = COUNTRY_CODES.map(({iso, name}) => ({\n    label: name,\n    value: iso,\n  }));\n  const expandedCountryList = [\n    {label: _(phoneLoginStrings.accountCountryCode), value: 'X0'},\n    {label: _(phoneLoginStrings.errorCountryCodeInvalid), value: 'X1'},\n    ...countryList,\n  ];\n  const currentSelectValue = expandedCountryList.find(selectedCountry => selectedCountry.value === country);\n\n  const isTiny = useMatchMedia('max-width: 480px');\n  const isMobile = useMatchMedia(QUERY.mobile);\n\n  const onCountryCodeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const {value} = event.target;\n    const codeNumbers = value.replace(/\\D/g, '');\n    setCountryCode(codeNumbers);\n    setCountry(codeNumbers ? getCountryByCode(codeNumbers) || 'X1' : 'X0');\n  };\n\n  const onPhoneNumberChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setPhoneNumber(event.target.value);\n    setValidInput(true);\n  };\n\n  const handleSubmit = (event: React.FormEvent) => {\n    event.preventDefault();\n    if (isFetching) {\n      return;\n    }\n    onSubmit({phone: `+${countryCode}${phoneNumber}`}, []);\n  };\n\n  return (\n    <div>\n      <Select\n        id=\"select-phone\"\n        onChange={country => {\n          const selectedCountryValue = country?.value.toString();\n\n          if (selectedCountryValue) {\n            setCountry(selectedCountryValue);\n            setCountryCode((getCountryCode(selectedCountryValue) || 'X2').toString(10));\n          }\n        }}\n        dataUieName=\"select-phone\"\n        options={expandedCountryList}\n        value={currentSelectValue}\n      />\n\n      <InputBlock>\n        <InputSubmitCombo style={{background: 'none', boxShadow: 'inset 16px 16px 0 #fff, inset -100px -16px 0 #fff'}}>\n          <Input\n            id=\"enter-country-code\"\n            ref={countryCodeInput}\n            value={`+${countryCode}`}\n            onChange={onCountryCodeChange}\n            data-uie-name=\"enter-country-code\"\n          />\n          <Input\n            id=\"enter-phone\"\n            name=\"phone-login\"\n            onChange={onPhoneNumberChange}\n            style={{width: isTiny ? 'calc(100vw - 200px)' : isMobile ? 'calc(100vw - 250px)' : '280px'}}\n            ref={phoneInput}\n            markInvalid={!validInput}\n            value={phoneNumber}\n            autoComplete=\"section-login phone\"\n            pattern={'.{1,1024}'}\n            type=\"tel\"\n            required\n            placeholder=\"phone number\"\n            data-uie-name=\"enter-phone\"\n          />\n          {isFetching ? (\n            <Loading size={32} />\n          ) : (\n            <RoundIconButton\n              disabled={!phoneNumber}\n              type=\"submit\"\n              formNoValidate\n              onClick={handleSubmit}\n              data-uie-name=\"do-sign-in-phone\"\n            >\n              <ArrowIcon />\n            </RoundIconButton>\n          )}\n        </InputSubmitCombo>\n      </InputBlock>\n    </div>\n  );\n};\nexport {PhoneLoginForm};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useState} from 'react';\n\nimport {\n  ForbiddenPhoneNumberError,\n  InvalidPhoneNumberError,\n  LoginData,\n  PasswordExistsError,\n} from '@wireapp/api-client/lib/auth';\nimport {ClientType} from '@wireapp/api-client/lib/client/index';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime} from '@wireapp/commons';\nimport {\n  ArrowIcon,\n  Checkbox,\n  CheckboxLabel,\n  COLOR,\n  Column,\n  Columns,\n  Container,\n  ContainerXS,\n  Form,\n  H1,\n  IsMobile,\n} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {loginStrings, phoneLoginStrings} from '../../strings';\nimport {AppAlreadyOpen} from '../component/AppAlreadyOpen';\nimport {PhoneLoginForm} from '../component/PhoneLoginForm';\nimport {RouterLink} from '../component/RouterLink';\nimport {actionRoot} from '../module/action';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\nimport {isValidationError, parseError, parseValidationErrors} from '../util/errorUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst PhoneLoginComponent = ({\n  pushLoginData,\n  doSendPhoneLoginCode,\n  isFetching,\n  loginData,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n\n  const [error, setError] = useState();\n\n  const handleSubmit = async (formLoginData: Partial<LoginData>, validationErrors: Error[]) => {\n    try {\n      if (validationErrors.length) {\n        throw validationErrors[0];\n      }\n      await pushLoginData({phone: formLoginData.phone});\n      await doSendPhoneLoginCode({phone: formLoginData.phone});\n      return navigate(ROUTE.VERIFY_PHONE_CODE);\n    } catch (error) {\n      switch (true) {\n        case error instanceof PasswordExistsError: {\n          return navigate(ROUTE.CHECK_PASSWORD);\n        }\n        case error instanceof ValidationError:\n        case error instanceof InvalidPhoneNumberError:\n        case error instanceof ForbiddenPhoneNumberError: {\n          setError(error);\n          break;\n        }\n        default: {\n          setError(error);\n          throw error;\n        }\n      }\n    }\n  };\n\n  const backArrow = (\n    <RouterLink to={ROUTE.LOGIN} data-uie-name=\"go-login\">\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n  return (\n    <Page>\n      <IsMobile>\n        <div style={{margin: 16}}>{backArrow}</div>\n      </IsMobile>\n      <Container centerText verticalCenter style={{width: '100%'}}>\n        <AppAlreadyOpen />\n        <Columns>\n          <IsMobile not>\n            <Column style={{display: 'flex'}}>\n              <div style={{margin: 'auto'}}>{backArrow}</div>\n            </Column>\n          </IsMobile>\n          <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n            <ContainerXS\n              centerText\n              style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n            >\n              <div>\n                <H1 center>{_(phoneLoginStrings.loginHead)}</H1>\n                <Form style={{marginTop: 30}} data-uie-name=\"login\">\n                  <PhoneLoginForm isFetching={isFetching} onSubmit={handleSubmit} />\n                  {!error ? (\n                    <div style={{marginTop: '4px'}}>&nbsp;</div>\n                  ) : isValidationError(error) ? (\n                    parseValidationErrors(error)\n                  ) : (\n                    parseError(error)\n                  )}\n                  {!Runtime.isDesktopApp() && (\n                    <Checkbox\n                      onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                        pushLoginData({clientType: event.target.checked ? ClientType.TEMPORARY : ClientType.PERMANENT});\n                      }}\n                      checked={loginData.clientType === ClientType.TEMPORARY}\n                      data-uie-name=\"enter-public-computer-phone-sign-in\"\n                      style={{justifyContent: 'center', marginTop: '12px'}}\n                      aligncenter\n                    >\n                      <CheckboxLabel>{_(loginStrings.publicComputer)}</CheckboxLabel>\n                    </Checkbox>\n                  )}\n                </Form>\n              </div>\n            </ContainerXS>\n          </Column>\n          <Column />\n        </Columns>\n      </Container>\n      <IsMobile>\n        <div style={{minWidth: 48}} />\n      </IsMobile>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isFetching: AuthSelector.isFetching(state),\n  loginData: AuthSelector.getLoginData(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doSendPhoneLoginCode: actionRoot.authAction.doSendPhoneLoginCode,\n      pushLoginData: actionRoot.authAction.pushLoginData,\n    },\n    dispatch,\n  );\n\nconst PhoneLogin = connect(mapStateToProps, mapDispatchToProps)(PhoneLoginComponent);\n\nexport {PhoneLogin};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {Navigate} from 'react-router-dom';\n\nimport {Runtime} from '@wireapp/commons';\nimport {\n  ArrowIcon,\n  Bold,\n  COLOR,\n  Column,\n  Columns,\n  Container,\n  IsMobile,\n  Link,\n  Logo,\n  ProfileIcon,\n  TeamIcon,\n  Text,\n} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {setAccountTypeStrings} from '../../strings';\nimport {RouterLink} from '../component/RouterLink';\nimport {ROUTE} from '../route';\nimport {pathWithParams} from '../util/urlUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst SetAccountType = ({}: Props) => {\n  const {formatMessage: _} = useIntl();\n  const isMacOsWrapper = Runtime.isDesktopApp() && Runtime.isMacOS();\n\n  const backArrow = (\n    <RouterLink to={ROUTE.INDEX} data-uie-name=\"go-index\" aria-label={_(setAccountTypeStrings.goBack)}>\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n\n  const iconStyles: React.CSSProperties = {\n    alignItems: 'center',\n    borderRadius: '50%',\n    display: 'flex',\n    height: 72,\n    justifyContent: 'center',\n    margin: '0 auto',\n    width: 72,\n  };\n\n  return (\n    <Page>\n      {(Config.getConfig().FEATURE.ENABLE_DOMAIN_DISCOVERY ||\n        Config.getConfig().FEATURE.ENABLE_SSO ||\n        Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION) && (\n        <IsMobile>\n          <div style={{margin: 16}}>{backArrow}</div>\n        </IsMobile>\n      )}\n      {!Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && (\n        <Navigate to={pathWithParams(ROUTE.INDEX)} replace data-uie-name=\"redirect-login\" />\n      )}\n      {isMacOsWrapper && (\n        <Navigate to={pathWithParams(ROUTE.CREATE_ACCOUNT)} replace data-uie-name=\"redirect-register-personal\" />\n      )}\n      <Container centerText verticalCenter style={{width: '100%'}}>\n        <Columns>\n          <IsMobile not>\n            <Column style={{display: 'flex'}}>\n              <div style={{margin: 'auto'}}>{backArrow}</div>\n            </Column>\n          </IsMobile>\n          <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n            <Column>\n              <Logo scale={1.68} data-uie-name=\"ui-wire-logo\" />\n            </Column>\n            <Columns style={{margin: '70px auto'}}>\n              <Column style={{marginLeft: isMacOsWrapper ? 0 : 16}}>\n                <RouterLink to={ROUTE.CREATE_ACCOUNT} data-uie-name=\"go-register-personal\">\n                  <div\n                    style={{\n                      ...iconStyles,\n                      background: COLOR.GREEN,\n                    }}\n                  >\n                    <ProfileIcon height={31} width={31} color={'white'} />\n                  </div>\n                  <Bold fontSize=\"24px\" color={COLOR.LINK}>\n                    {_(setAccountTypeStrings.createAccountForPersonalUse)}\n                  </Bold>\n                  <br />\n                  <Text\n                    block\n                    center\n                    light\n                    fontSize=\"16px\"\n                    color={COLOR.LINK}\n                    style={{\n                      marginTop: 8,\n                    }}\n                  >\n                    {_(setAccountTypeStrings.createPersonalAccount)}\n                  </Text>\n                </RouterLink>\n              </Column>\n              <Column>\n                <Link\n                  href={`${Config.getConfig().URL.TEAMS_BASE}/register/email`}\n                  target=\"_blank\"\n                  data-uie-name=\"go-register-team\"\n                >\n                  <div\n                    style={{\n                      ...iconStyles,\n                      background: COLOR.BLUE,\n                    }}\n                  >\n                    <TeamIcon height={31} width={31} color={'white'} />\n                  </div>\n                  <Bold fontSize=\"24px\" color={COLOR.LINK}>\n                    {_(setAccountTypeStrings.createAccountForOrganizations)}\n                  </Bold>\n                  <br />\n                  <Text\n                    block\n                    center\n                    light\n                    fontSize=\"16px\"\n                    color={COLOR.LINK}\n                    style={{\n                      marginTop: 8,\n                    }}\n                  >\n                    {_(setAccountTypeStrings.createTeam)}\n                  </Text>\n                </Link>\n              </Column>\n            </Columns>\n          </Column>\n          <Column />\n        </Columns>\n      </Container>\n      <IsMobile>\n        <div style={{minWidth: 48}} />\n      </IsMobile>\n    </Page>\n  );\n};\n\nexport {SetAccountType};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useRef, useState} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate, useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Button, ContainerXS, Form, H1, Input} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {setEmailStrings} from '../../strings';\nimport {Exception} from '../component/Exception';\nimport {actionRoot} from '../module/action';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst SetEmailComponent = ({\n  hasSelfEmail,\n  isSelfSSOUser,\n  doSetEmail,\n  isFetching,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n\n  const emailInput = useRef<HTMLInputElement>();\n  const [error, setError] = useState();\n  const [isValidEmail, setIsValidEmail] = useState(true);\n  const [email, setEmail] = useState('');\n  const navigate = useNavigate();\n\n  const onSetEmail = async (event: React.FormEvent): Promise<void> => {\n    event.preventDefault();\n    let validationError: Error;\n\n    const currentInputNode = emailInput.current;\n    currentInputNode.value = currentInputNode.value.trim();\n    currentInputNode.focus();\n    if (!currentInputNode.checkValidity()) {\n      validationError = ValidationError.handleValidationState(currentInputNode.name, currentInputNode.validity);\n    }\n    setIsValidEmail(currentInputNode.validity.valid);\n    try {\n      if (validationError) {\n        throw validationError;\n      }\n      await doSetEmail(currentInputNode.value);\n      navigate(ROUTE.VERIFY_EMAIL_LINK);\n    } catch (error) {\n      setError(error);\n    }\n  };\n\n  if (hasSelfEmail || isSelfSSOUser) {\n    return <Navigate to={ROUTE.SET_PASSWORD} />;\n  }\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n      >\n        <Form onSubmit={onSetEmail}>\n          <H1 center>{_(setEmailStrings.headline)}</H1>\n          <Input\n            name=\"email\"\n            placeholder={_(setEmailStrings.emailPlaceholder)}\n            type=\"email\"\n            onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n              emailInput.current.setCustomValidity('');\n              setEmail(event.target.value);\n              setError(null);\n              setIsValidEmail(true);\n            }}\n            autoComplete=\"email\"\n            value={email}\n            ref={emailInput}\n            markInvalid={!isValidEmail}\n            maxLength={128}\n            required\n            data-uie-name=\"enter-email\"\n          />\n          {!error ? <>&nbsp;</> : <Exception errors={[error]} />}\n          <Button\n            block\n            showLoading={isFetching}\n            disabled={isFetching || !email}\n            formNoValidate\n            type=\"submit\"\n            data-uie-name=\"do-verify-email\"\n          >\n            {_(setEmailStrings.button)}\n          </Button>\n        </Form>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasSelfEmail: SelfSelector.hasSelfEmail(state),\n  isFetching: SelfSelector.isFetching(state),\n  isSelfSSOUser: SelfSelector.isSSOUser(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doSetEmail: actionRoot.selfAction.doSetEmail,\n    },\n    dispatch,\n  );\n\nconst SetEmail = connect(mapStateToProps, mapDispatchToProps)(SetEmailComponent);\n\nexport {SetEmail};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {EntropyContainer} from './EntropyContainer';\nimport {Page} from './Page';\n\nimport {actionRoot as ROOT_ACTIONS} from '../module/action';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst SetEntropyPageComponent = ({pushEntropyData}: Props & ConnectedProps & DispatchProps) => {\n  const navigate = useNavigate();\n\n  const onSetEntropy = async (entropyData: Uint8Array): Promise<void> => {\n    try {\n      await pushEntropyData(entropyData);\n      navigate(ROUTE.VERIFY_EMAIL_CODE);\n    } catch (error) {\n      console.warn(error);\n    }\n  };\n\n  return (\n    <Page>\n      <EntropyContainer onSetEntropy={onSetEntropy} />\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      pushEntropyData: ROOT_ACTIONS.authAction.pushEntropyData,\n    },\n    dispatch,\n  );\n\nconst SetEntropyPage = connect(mapStateToProps, mapDispatchToProps)(SetEntropyPageComponent);\n\nexport {SetEntropyPage};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {FormattedMessage, useIntl} from 'react-intl';\n\nimport {Button, COLOR, Column, Columns, Container, H3, Link, Modal, Text} from '@wireapp/react-ui-kit';\n\nimport {Config} from '../../Config';\nimport {acceptNewsModalStrings} from '../../strings';\n\nexport interface Props extends React.HTMLProps<HTMLDivElement> {\n  onConfirm: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  onDecline: (event: React.MouseEvent<HTMLButtonElement>) => void;\n}\n\nconst AcceptNewsModal = ({onConfirm, onDecline}: Props) => {\n  const {formatMessage: _} = useIntl();\n  return (\n    <Modal>\n      <Container style={{maxWidth: '400px'}} data-uie-name=\"modal-marketing-consent\">\n        <H3 style={{fontWeight: 500, marginTop: '10px'}} data-uie-name=\"modal-marketing-consent-title\">\n          {_(acceptNewsModalStrings.headline, {brandName: Config.getConfig().BRAND_NAME})}\n        </H3>\n        <div data-uie-name=\"modal-marketing-consent-description\">\n          <Text block>{_(acceptNewsModalStrings.unsubscribeDescription)}</Text>\n          <Link href={Config.getConfig().URL.PRIVACY_POLICY} target=\"_blank\" data-uie-name=\"go-privacy\">\n            <Text block>\n              <FormattedMessage\n                {...acceptNewsModalStrings.privacyDescription}\n                values={{\n                  // eslint-disable-next-line react/display-name\n                  strong: ((...chunks: any[]) => <strong>{chunks}</strong>) as any,\n                }}\n              />\n            </Text>\n          </Link>\n        </div>\n        <Columns style={{margin: '20px 0 10px'}}>\n          <Column style={{textAlign: 'center'}}>\n            <Button\n              type=\"button\"\n              onClick={onDecline}\n              backgroundColor={COLOR.GRAY}\n              data-uie-name=\"do-decline-marketing-consent\"\n            >\n              {_(acceptNewsModalStrings.declineButton)}\n            </Button>\n          </Column>\n          <Column style={{textAlign: 'center'}}>\n            <Button type=\"button\" onClick={onConfirm} data-uie-name=\"do-confirm-marketing-consent\">\n              {_(acceptNewsModalStrings.confirmButton)}\n            </Button>\n          </Column>\n        </Columns>\n      </Container>\n    </Modal>\n  );\n};\n\nexport {AcceptNewsModal};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport getSlug from 'speakingurl';\n\nimport {randomArrayElement, randomInt} from './randomUtil';\n\nconst MAX_HANDLE_LENGTH = 21;\nconst DEFAULT_NUMBER_VARIATIONS = 5;\nconst RANDOM_WORDS_1 = [\n  ...['acid', 'agate', 'agile', 'amber', 'aqua', 'arid', 'avid', 'azure'],\n  ...['baby', 'basic', 'beige', 'best', 'black', 'blond', 'blue', 'brass'],\n  ...['brave', 'brown', 'busy', 'chief', 'chill', 'clear', 'cold', 'cool'],\n  ...['coral', 'cosy', 'cozy', 'cream', 'curly', 'cyan', 'dear', 'dry'],\n  ...['early', 'even', 'fancy', 'fast', 'fit', 'folk', 'gold', 'green'],\n  ...['grey', 'happy', 'hazy', 'icy', 'iron', 'kind', 'large', 'lazy'],\n  ...['lemon', 'light', 'lilac', 'lime', 'lord', 'lucid', 'mauve', 'melt'],\n  ...['merry', 'mint', 'nice', 'noir', 'ochre', 'odd', 'olive', 'opal'],\n  ...['peach', 'pearl', 'pink', 'plain', 'purple', 'quiet', 'rapid', 'red'],\n  ...['rock', 'rose', 'ruby', 'rust', 'sand', 'sassy', 'shiny', 'shy'],\n  ...['silly', 'slow', 'small', 'stone', 'sweet', 'swift', 'talc', 'tame'],\n  ...['tiny', 'topaz', 'torn', 'total', 'vinyl', 'violet', 'warm', 'white'],\n  ...['wise', 'witty', 'yellow', 'young', 'zinc'],\n];\nconst RANDOM_WORDS_2 = [\n  ...['alligator', 'alpaca', 'ant', 'antelope', 'asp', 'badger', 'bat', 'bear'],\n  ...['bee', 'beetle', 'bird', 'bison', 'bobcat', 'buffalo', 'buzzard'],\n  ...['camel', 'caribou', 'carp', 'cat', 'catfish', 'cheetah', 'clam', 'cobra'],\n  ...['cod', 'condor', 'cow', 'coyote', 'crane', 'crayfish', 'cricket', 'crow'],\n  ...['deer', 'dog', 'dolphin', 'donkey', 'dove', 'duck', 'eagle', 'eel'],\n  ...['elk', 'falcon', 'ferret', 'finch', 'fly', 'fox', 'frog', 'gazelle'],\n  ...['giraffe', 'gnu', 'goat', 'goose', 'gopher', 'grouse', 'gull', 'halibut'],\n  ...['hamster', 'hare', 'hawk', 'heron', 'herring', 'horse', 'husky'],\n  ...['impala', 'jackal', 'jaguar', 'kangaroo', 'koala', 'lemur', 'lion'],\n  ...['lizard', 'llama', 'lobster', 'mackerel', 'mole', 'moose', 'moth'],\n  ...['mouse', 'mule', 'mussel', 'newt', 'octopus', 'orca', 'ostrich', 'otter'],\n  ...['owl', 'ox', 'oyster', 'panda', 'panther', 'parrot', 'pelican', 'penguin'],\n  ...['pigeon', 'pike', 'pony', 'quail', 'rabbit', 'racoon', 'ram', 'raven'],\n  ...['salmon', 'sardine', 'seal', 'shark', 'sheep', 'sloth', 'snail', 'snake'],\n  ...['squid', 'sturgeon', 'swan', 'tiger', 'tilapia', 'toad', 'trout', 'tuna'],\n  ...['turkey', 'turtle', 'walrus', 'wapiti', 'wasp', 'weasel', 'whale'],\n  ...['wolf', 'wombat', 'yak', 'zebra'],\n];\n\nfunction getRandomWordCombination(): string {\n  return `${randomArrayElement(RANDOM_WORDS_1)}${randomArrayElement(RANDOM_WORDS_2)}`;\n}\n\nexport function generateHandleVariations(\n  handle: string,\n  numberOfVariations: number = DEFAULT_NUMBER_VARIATIONS,\n): string[] {\n  return Array.from(Array(numberOfVariations), (_, index) => {\n    const digitCount = index + 1;\n    return appendRandomDigits(handle.slice(0, MAX_HANDLE_LENGTH - digitCount), digitCount);\n  });\n}\n\nexport function appendRandomDigits(handle: string, additionalNumbers: number): string {\n  const MAX_RANDOM_INT = 9;\n  const randomDigits = Array.from(Array(additionalNumbers), () => randomInt(MAX_RANDOM_INT));\n  return `${handle}${randomDigits.join('')}`;\n}\n\nexport function normalizeName(name: string): string {\n  return getSlug(name)\n    .toLowerCase()\n    .replace(/[^a-z0-9_]/g, '')\n    .substring(0, MAX_HANDLE_LENGTH);\n}\n\nexport function createSuggestions(name: string): string[] {\n  const normalizedName = normalizeName(name);\n  const randomName = getRandomWordCombination();\n  let suggestions: string[] = [];\n\n  if (normalizedName) {\n    suggestions.push(normalizedName);\n    const normalizedNameVariations = generateHandleVariations(normalizedName);\n    suggestions = suggestions.concat(normalizedNameVariations);\n  }\n\n  suggestions.push(randomName);\n  const randomNameVariations = generateHandleVariations(randomName);\n  return suggestions.concat(randomNameVariations);\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {ConsentType} from '@wireapp/api-client/lib/self/index';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {\n  ArrowIcon,\n  ContainerXS,\n  Form,\n  H1,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  Muted,\n  RoundIconButton,\n  Text,\n} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {chooseHandleStrings} from '../../strings';\nimport {AcceptNewsModal} from '../component/AcceptNewsModal';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action';\nimport {BackendError} from '../module/action/BackendError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {ROUTE} from '../route';\nimport {parseError} from '../util/errorUtil';\nimport {createSuggestions} from '../util/handleUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst SetHandleComponent = ({\n  doGetConsents,\n  doSetConsent,\n  doSetHandle,\n  hasSelfHandle,\n  hasUnsetMarketingConsent,\n  checkHandles,\n  isFetching,\n  name,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const [error, setError] = useState(null);\n  const [handle, setHandle] = useState('');\n\n  useEffect(() => {\n    if (hasSelfHandle) {\n      navigate(ROUTE.INITIAL_INVITE);\n    }\n  }, [hasSelfHandle]);\n\n  useEffect(() => {\n    (async () => {\n      doGetConsents();\n      try {\n        const suggestions = createSuggestions(name);\n        const handle = await checkHandles(suggestions);\n        setHandle(handle);\n      } catch (error) {\n        setError(error);\n      }\n    })();\n  }, []);\n\n  const updateConsent = (consentType: ConsentType, value: number): Promise<void> => doSetConsent(consentType, value);\n\n  const onSetHandle = async (event: React.FormEvent): Promise<void> => {\n    event.preventDefault();\n    try {\n      await doSetHandle(handle.trim());\n    } catch (error) {\n      if (error.label === BackendError.HANDLE_ERRORS.INVALID_HANDLE && handle.trim().length < 2) {\n        error.label = BackendError.HANDLE_ERRORS.HANDLE_TOO_SHORT;\n      }\n      setError(error);\n    }\n  };\n\n  const onHandleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setError(null);\n    setHandle(event.target.value);\n  };\n\n  if (hasSelfHandle) {\n    return null;\n  }\n\n  return (\n    <Page>\n      <ContainerXS centerText verticalCenter style={{display: 'flex', flexDirection: 'column', minHeight: 428}}>\n        <H1 center>{_(chooseHandleStrings.headline)}</H1>\n        <Muted center>{_(chooseHandleStrings.subhead)}</Muted>\n        <Form style={{marginTop: 30}} onSubmit={onSetHandle}>\n          <InputBlock>\n            <InputSubmitCombo style={{paddingLeft: 0}}>\n              <Text center style={{minWidth: 38}}>\n                {'@'}\n              </Text>\n              <Input\n                id=\"handle\"\n                name=\"handle\"\n                placeholder={_(chooseHandleStrings.handlePlaceholder)}\n                type=\"text\"\n                onChange={onHandleChange}\n                value={handle}\n                data-uie-name=\"enter-handle\"\n              />\n              <RoundIconButton\n                disabled={!handle || isFetching}\n                type=\"submit\"\n                data-uie-name=\"do-send-handle\"\n                formNoValidate\n              >\n                <ArrowIcon />\n              </RoundIconButton>\n            </InputSubmitCombo>\n          </InputBlock>\n        </Form>\n        {error && parseError(error)}\n      </ContainerXS>\n      {!isFetching && hasUnsetMarketingConsent && (\n        <AcceptNewsModal\n          onConfirm={() => updateConsent(ConsentType.MARKETING, 1)}\n          onDecline={() => updateConsent(ConsentType.MARKETING, 0)}\n        />\n      )}\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasSelfHandle: SelfSelector.hasSelfHandle(state),\n  hasUnsetMarketingConsent: SelfSelector.hasUnsetConsent(state, ConsentType.MARKETING) || false,\n  isFetching: SelfSelector.isFetching(state),\n  name: SelfSelector.getSelfName(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      checkHandles: ROOT_ACTIONS.userAction.checkHandles,\n      doGetConsents: ROOT_ACTIONS.selfAction.doGetConsents,\n      doSetConsent: ROOT_ACTIONS.selfAction.doSetConsent,\n      doSetHandle: ROOT_ACTIONS.selfAction.setHandle,\n    },\n    dispatch,\n  );\n\nconst SetHandle = connect(mapStateToProps, mapDispatchToProps)(SetHandleComponent);\n\nexport {SetHandle};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useRef, useState} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate, useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {ValidationUtil} from '@wireapp/commons';\nimport {Button, ContainerXS, Form, H1, Input, Small} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {Config} from '../../Config';\nimport {accountFormStrings, setPasswordStrings} from '../../strings';\nimport {Exception} from '../component/Exception';\nimport {actionRoot} from '../module/action';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst SetPasswordComponent = ({\n  isSelfSSOUser,\n  hasSelfPassword,\n  doSetPassword,\n  isFetching,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n\n  const passwordInput = useRef<HTMLInputElement>();\n  const [error, setError] = useState();\n  const [isValidPassword, setIsValidPassword] = useState(true);\n  const [password, setPassword] = useState('');\n  const navigate = useNavigate();\n\n  const onSetPassword = async (event: React.FormEvent): Promise<void> => {\n    event.preventDefault();\n    let validationError: Error;\n\n    const currentInputNode = passwordInput.current;\n    currentInputNode.focus();\n    if (!currentInputNode.checkValidity()) {\n      validationError = ValidationError.handleValidationState(currentInputNode.name, currentInputNode.validity);\n    }\n    setIsValidPassword(currentInputNode.validity.valid);\n    try {\n      if (validationError) {\n        throw validationError;\n      }\n      await doSetPassword({new_password: password});\n      navigate(ROUTE.SET_HANDLE);\n    } catch (error) {\n      setError(error);\n    }\n  };\n\n  if (hasSelfPassword || isSelfSSOUser) {\n    return <Navigate to={ROUTE.SET_HANDLE} />;\n  }\n\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n      >\n        <Form onSubmit={onSetPassword}>\n          <H1 center>{_(setPasswordStrings.headline)}</H1>\n          <Input\n            autoComplete=\"new-password\"\n            name=\"password\"\n            placeholder={_(setPasswordStrings.passwordPlaceholder)}\n            type=\"password\"\n            markInvalid={!isValidPassword}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n              passwordInput.current.setCustomValidity('');\n              setError(null);\n              setPassword(event.target.value);\n              setIsValidPassword(true);\n            }}\n            ref={passwordInput}\n            value={password}\n            required\n            pattern={ValidationUtil.getNewPasswordPattern(Config.getConfig().NEW_PASSWORD_MINIMUM_LENGTH)}\n            data-uie-name=\"enter-password\"\n          />\n          <Small\n            style={{\n              display: error ? 'none' : 'block',\n              padding: '0 16px',\n            }}\n            data-uie-name=\"element-password-help\"\n          >\n            {_(accountFormStrings.passwordHelp, {minPasswordLength: Config.getConfig().NEW_PASSWORD_MINIMUM_LENGTH})}\n          </Small>\n          {!error ? <>&nbsp;</> : <Exception errors={[error]} />}\n          <Button\n            block\n            showLoading={isFetching}\n            disabled={isFetching || !password}\n            formNoValidate\n            type=\"submit\"\n            data-uie-name=\"do-set-password\"\n          >\n            {_(setPasswordStrings.button)}\n          </Button>\n        </Form>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasSelfPassword: SelfSelector.hasSelfPassword(state),\n  isFetching: SelfSelector.isFetching(state),\n  isSelfSSOUser: SelfSelector.isSSOUser(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doSetPassword: actionRoot.selfAction.doSetPassword,\n    },\n    dispatch,\n  );\n\nconst SetPassword = connect(mapStateToProps, mapDispatchToProps)(SetPasswordComponent);\n\nexport {SetPassword};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef, useState} from 'react';\n\nimport {ClientType} from '@wireapp/api-client/lib/client/index';\nimport {BackendErrorLabel} from '@wireapp/api-client/lib/http';\nimport {pathWithParams} from '@wireapp/commons/lib/util/UrlUtil';\nimport {isValidEmail, PATTERN} from '@wireapp/commons/lib/util/ValidationUtil';\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {Navigate, useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {Runtime, UrlUtil} from '@wireapp/commons';\nimport {\n  ArrowIcon,\n  Checkbox,\n  CheckboxLabel,\n  ErrorMessage,\n  Form,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  Loading,\n  RoundIconButton,\n} from '@wireapp/react-ui-kit';\n\nimport {Config} from '../../Config';\nimport {loginStrings, logoutReasonStrings, ssoLoginStrings} from '../../strings';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {BackendError} from '../module/action/BackendError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {QUERY_KEY, ROUTE} from '../route';\nimport {parseError, parseValidationErrors} from '../util/errorUtil';\nimport {getSearchParams} from '../util/urlUtil';\n\nexport interface SingleSignOnFormProps extends React.HTMLAttributes<HTMLDivElement> {\n  doLogin: (code: string) => Promise<void>;\n  initialCode?: string;\n}\n\nconst SSO_CODE_PREFIX = 'wire-';\nconst SSO_CODE_PREFIX_REGEX = '[wW][iI][rR][eE]-';\nconst SingleSignOnFormComponent = ({\n  initialCode,\n  isFetching,\n  authError,\n  resetAuthError,\n  validateSSOCode,\n  doLogin,\n  doFinalizeSSOLogin,\n  doGetDomainInfo,\n  doCheckConversationCode,\n  doJoinConversationByCode,\n  doNavigate,\n}: SingleSignOnFormProps & ConnectedProps & DispatchProps) => {\n  const codeOrMailInput = useRef<HTMLInputElement>();\n  const [codeOrMail, setCodeOrMail] = useState('');\n  const [disableInput, setDisableInput] = useState(false);\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const [clientType, setClientType] = useState<ClientType>(null);\n  const [ssoError, setSsoError] = useState(null);\n  const [isCodeOrMailInputValid, setIsCodeOrMailInputValid] = useState(true);\n  const [validationError, setValidationError] = useState<any>();\n  const [logoutReason, setLogoutReason] = useState<string>();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [conversationCode, setConversationCode] = useState<string>();\n  const [conversationKey, setConversationKey] = useState<string>();\n  const [isValidLink, setIsValidLink] = useState(true);\n\n  const [shouldAutoLogin, setShouldAutoLogin] = useState(false);\n\n  useEffect(() => {\n    const queryAutoLogin = UrlUtil.hasURLParameter(QUERY_KEY.SSO_AUTO_LOGIN);\n    if (queryAutoLogin === true && initialCode) {\n      setShouldAutoLogin(true);\n    }\n  }, []);\n\n  useEffect(() => {\n    const queryClientType = UrlUtil.getURLParameter(QUERY_KEY.CLIENT_TYPE);\n    if (queryClientType === ClientType.TEMPORARY) {\n      setClientType(ClientType.TEMPORARY);\n    } else {\n      setClientType(ClientType.PERMANENT);\n    }\n  }, []);\n\n  useEffect(() => {\n    const queryLogoutReason = UrlUtil.getURLParameter(QUERY_KEY.LOGOUT_REASON) || null;\n    if (queryLogoutReason) {\n      setLogoutReason(queryLogoutReason);\n    }\n  }, []);\n\n  useEffect(() => {\n    const queryConversationCode = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_CODE) || null;\n    const queryConversationKey = UrlUtil.getURLParameter(QUERY_KEY.CONVERSATION_KEY) || null;\n\n    const keyAndCodeExistent = queryConversationKey && queryConversationCode;\n    if (keyAndCodeExistent) {\n      setConversationCode(queryConversationCode);\n      setConversationKey(queryConversationKey);\n      setIsValidLink(true);\n      doCheckConversationCode(queryConversationKey, queryConversationCode).catch(error => {\n        console.warn('Invalid conversation code', error);\n        setIsValidLink(false);\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    if (initialCode && initialCode !== codeOrMail) {\n      setCodeOrMail(initialCode);\n      setDisableInput(true);\n    }\n  }, [initialCode]);\n\n  useEffect(() => {\n    if (shouldAutoLogin && clientType && initialCode && initialCode === codeOrMail) {\n      handleSubmit();\n    }\n  }, [shouldAutoLogin, clientType, initialCode, codeOrMail]);\n\n  const onCodeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setCodeOrMail(event.target.value);\n    setIsCodeOrMailInputValid(true);\n  };\n\n  const handleSubmit = async (event?: React.FormEvent): Promise<void> => {\n    if (event) {\n      event.preventDefault();\n    }\n    resetAuthError();\n    if (isFetching) {\n      return;\n    }\n\n    const currentlyDisabled = codeOrMailInput.current.disabled;\n    codeOrMailInput.current.disabled = false;\n\n    codeOrMailInput.current.value = codeOrMailInput.current.value.trim();\n    const currentValidationError = codeOrMailInput.current.checkValidity()\n      ? null\n      : ValidationError.handleValidationState(codeOrMailInput.current.name, codeOrMailInput.current.validity);\n\n    setValidationError(currentValidationError);\n    setIsCodeOrMailInputValid(codeOrMailInput.current.validity.valid);\n\n    codeOrMailInput.current.disabled = currentlyDisabled;\n\n    try {\n      if (currentValidationError) {\n        throw currentValidationError;\n      }\n      const email = codeOrMail.trim();\n      if (isValidEmail(email)) {\n        const domain = email.split('@')[1];\n        const {webapp_welcome_url} = await doGetDomainInfo(domain);\n        const [path, query = ''] = webapp_welcome_url.split('?');\n        const welcomeUrl = pathWithParams(\n          path,\n          {[QUERY_KEY.CLIENT_TYPE]: clientType, [QUERY_KEY.SSO_AUTO_LOGIN]: true},\n          null,\n          query,\n        );\n\n        // This refreshes the page as we replace the whole URL.\n        // This works for now as we don't need anything from the state anymore at this point.\n        // Ideal would be to abandon the HashRouter (in the near future) and use something that\n        // allows us to pass search query parameters.\n        // https://reacttraining.com/react-router/web/api/HashRouter\n        doNavigate(\n          `/auth?${getSearchParams({[QUERY_KEY.DESTINATION_URL]: encodeURIComponent(welcomeUrl)})}#${\n            ROUTE.CUSTOM_ENV_REDIRECT\n          }`,\n        );\n      } else {\n        setIsLoading(true);\n        const strippedCode = stripPrefix(codeOrMail);\n        await validateSSOCode(strippedCode);\n        await doLogin(strippedCode);\n        await doFinalizeSSOLogin({clientType});\n        const hasKeyAndCode = conversationKey && conversationCode;\n        if (hasKeyAndCode) {\n          await doJoinConversationByCode(conversationKey, conversationCode);\n        }\n\n        navigate(ROUTE.HISTORY_INFO);\n      }\n    } catch (error) {\n      setIsLoading(false);\n      switch (error.label) {\n        case BackendError.LABEL.TOO_MANY_CLIENTS: {\n          resetAuthError();\n          navigate(ROUTE.CLIENTS);\n          break;\n        }\n        case BackendErrorLabel.CUSTOM_BACKEND_NOT_FOUND: {\n          setSsoError(error);\n          break;\n        }\n        case BackendError.LABEL.SSO_USER_CANCELLED_ERROR:\n        case BackendError.LABEL.SSO_NOT_FOUND: {\n          break;\n        }\n        default: {\n          setSsoError(error);\n          const isValidationError = Object.values(ValidationError.ERROR).some(\n            errorType => error.label && error.label.endsWith(errorType),\n          );\n          if (!isValidationError) {\n            console.warn('SSO authentication error', JSON.stringify(Object.entries(error)), error);\n          }\n          break;\n        }\n      }\n    }\n  };\n\n  const stripPrefix = (prefixedCode: string) =>\n    prefixedCode && prefixedCode.trim().toLowerCase().replace(SSO_CODE_PREFIX, '');\n\n  const enableDomainDiscovery = Config.getConfig().FEATURE.ENABLE_DOMAIN_DISCOVERY;\n\n  const inputName = enableDomainDiscovery\n    ? ValidationError.FIELD.SSO_EMAIL_CODE.name\n    : ValidationError.FIELD.SSO_CODE.name;\n\n  const inputPlaceholder = enableDomainDiscovery\n    ? ssoLoginStrings.codeOrMailInputPlaceholder\n    : ssoLoginStrings.codeInputPlaceholder;\n\n  const inputPattern = enableDomainDiscovery\n    ? `(${SSO_CODE_PREFIX_REGEX}${PATTERN.UUID_V4}|${PATTERN.EMAIL})`\n    : `${SSO_CODE_PREFIX_REGEX}${PATTERN.UUID_V4}`;\n\n  return isLoading ? (\n    <Loading style={{marginTop: '24px'}} />\n  ) : (\n    <Form style={{marginTop: 30}} data-uie-name=\"sso\" onSubmit={handleSubmit}>\n      {!isValidLink && <Navigate to={ROUTE.CONVERSATION_JOIN_INVALID} replace />}\n      <InputBlock>\n        <InputSubmitCombo>\n          <Input\n            id={inputName}\n            name={inputName}\n            onChange={onCodeChange}\n            ref={codeOrMailInput}\n            markInvalid={!isCodeOrMailInputValid}\n            placeholder={_(inputPlaceholder)}\n            value={codeOrMail}\n            autoComplete=\"section-login sso-code\"\n            maxLength={1024}\n            pattern={inputPattern}\n            type=\"text\"\n            required\n            disabled={disableInput}\n            data-uie-name=\"enter-code\"\n          />\n          <RoundIconButton disabled={!codeOrMail} type=\"submit\" formNoValidate data-uie-name=\"do-sso-sign-in\">\n            <ArrowIcon />\n          </RoundIconButton>\n        </InputSubmitCombo>\n      </InputBlock>\n      {validationError ? (\n        parseValidationErrors([validationError])\n      ) : authError ? (\n        parseError(authError)\n      ) : ssoError ? (\n        parseError(ssoError)\n      ) : logoutReason ? (\n        <ErrorMessage data-uie-name=\"status-logout-reason\">\n          <FormattedMessage\n            {...logoutReasonStrings[logoutReason]}\n            values={{\n              newline: <br />,\n            }}\n          />\n        </ErrorMessage>\n      ) : (\n        <span style={{marginBottom: '4px'}}>&nbsp;</span>\n      )}\n      {!Runtime.isDesktopApp() && (\n        <Checkbox\n          name=\"enter-public-computer-sso-sign-in\"\n          id=\"enter-public-computer-sso-sign-in\"\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n            setClientType(event.target.checked ? ClientType.TEMPORARY : ClientType.PERMANENT)\n          }\n          checked={clientType === ClientType.TEMPORARY}\n          data-uie-name=\"enter-public-computer-sso-sign-in\"\n          aligncenter\n          style={{justifyContent: 'center', marginTop: '36px'}}\n        >\n          <CheckboxLabel htmlFor=\"\">{_(loginStrings.publicComputer)}</CheckboxLabel>\n        </Checkbox>\n      )}\n    </Form>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isFetching: AuthSelector.isFetching(state),\n  authError: AuthSelector.getError(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doCheckConversationCode: ROOT_ACTIONS.conversationAction.doCheckConversationCode,\n      doFinalizeSSOLogin: ROOT_ACTIONS.authAction.doFinalizeSSOLogin,\n      doGetDomainInfo: ROOT_ACTIONS.authAction.doGetDomainInfo,\n      doJoinConversationByCode: ROOT_ACTIONS.conversationAction.doJoinConversationByCode,\n      doNavigate: ROOT_ACTIONS.navigationAction.doNavigate,\n      resetAuthError: ROOT_ACTIONS.authAction.resetAuthError,\n      validateSSOCode: ROOT_ACTIONS.authAction.validateSSOCode,\n    },\n    dispatch,\n  );\n\nconst SingleSignOnForm = connect(mapStateToProps, mapDispatchToProps)(SingleSignOnFormComponent);\n\nexport {SingleSignOnForm};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useRef, useState} from 'react';\n\nimport {amplify} from 'amplify';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useParams} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {\n  ArrowIcon,\n  COLOR,\n  Column,\n  Columns,\n  Container,\n  ContainerXS,\n  H1,\n  IsMobile,\n  Link,\n  Logo,\n  Muted,\n  Overlay,\n  Text,\n} from '@wireapp/react-ui-kit';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {getLogger} from 'Util/Logger';\n\nimport {Page} from './Page';\nimport {SingleSignOnForm} from './SingleSignOnForm';\n\nimport {Config} from '../../Config';\nimport {ssoLoginStrings} from '../../strings';\nimport {AppAlreadyOpen} from '../component/AppAlreadyOpen';\nimport {RouterLink} from '../component/RouterLink';\nimport {BackendError} from '../module/action/BackendError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLAttributes<HTMLDivElement>;\n\nconst logger = getLogger('SingleSignOn');\n\nconst SingleSignOnComponent = ({hasDefaultSSOCode}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const ssoWindowRef = useRef<Window>();\n  const params = useParams<{code?: string}>();\n  const [isOverlayOpen, setIsOverlayOpen] = useState(false);\n\n  const handleSSOWindow = (code: string): Promise<void> => {\n    const POPUP_HEIGHT = 520;\n    const POPUP_WIDTH = 480;\n    const SSO_WINDOW_CLOSE_POLLING_INTERVAL = 1000;\n\n    return new Promise<void>((resolve, reject) => {\n      let timerId: number = undefined;\n      let onReceiveChildWindowMessage: (event: MessageEvent) => void = undefined;\n      let onParentWindowClose: (event: Event) => void = undefined;\n\n      const onChildWindowClose = () => {\n        clearInterval(timerId);\n        window.removeEventListener('message', onReceiveChildWindowMessage);\n        window.removeEventListener('unload', onParentWindowClose);\n        setIsOverlayOpen(false);\n      };\n\n      onReceiveChildWindowMessage = (event: MessageEvent) => {\n        // We need to copy properties to `JSON.stringify` because `event` is not serializable\n        const serializedEvent = JSON.stringify({data: event.data, origin: event.origin});\n        logger.log(`Received SSO login event from wrapper: ${serializedEvent}`, event);\n        const isExpectedOrigin = event.origin === Config.getConfig().BACKEND_REST;\n        if (!isExpectedOrigin) {\n          onChildWindowClose();\n          closeSSOWindow();\n          return reject(\n            new BackendError({\n              code: HTTP_STATUS.INTERNAL_SERVER_ERROR,\n              label: BackendError.LABEL.SSO_GENERIC_ERROR,\n              message: `Origin \"${event.origin}\" of event \"${serializedEvent}\" not matching \"${\n                Config.getConfig().BACKEND_REST\n              }\"`,\n            }),\n          );\n        }\n\n        const eventType = event.data && event.data.type;\n        switch (eventType) {\n          case 'AUTH_SUCCESS': {\n            onChildWindowClose();\n            closeSSOWindow();\n            return resolve();\n          }\n          case 'AUTH_ERROR':\n          case 'AUTH_ERROR_COOKIE': {\n            onChildWindowClose();\n            closeSSOWindow();\n            return reject(\n              new BackendError({\n                code: HTTP_STATUS.UNAUTHORIZED,\n                label: event.data.payload.label || BackendError.LABEL.SSO_GENERIC_ERROR,\n                message: `Authentication error: \"${JSON.stringify(event.data.payload)}\"`,\n              }),\n            );\n          }\n          default: {\n            logger.warn(`Received unmatched event type: \"${eventType}\"`);\n          }\n        }\n      };\n      window.addEventListener('message', onReceiveChildWindowMessage, {once: false});\n\n      const childPosition = calculateChildPosition(POPUP_HEIGHT, POPUP_WIDTH);\n\n      ssoWindowRef.current = window.open(\n        `${Config.getConfig().BACKEND_REST}/sso/initiate-login/${code}`,\n        'WIRE_SSO',\n        `\n          height=${POPUP_HEIGHT},\n          left=${childPosition.left}\n          location=no,\n          menubar=no,\n          resizable=no,\n          status=no,\n          toolbar=no,\n          top=${childPosition.top},\n          width=${POPUP_WIDTH}\n        `,\n      );\n\n      setIsOverlayOpen(true);\n\n      const closeSSOWindow = () => {\n        amplify.publish(WebAppEvents.LIFECYCLE.SSO_WINDOW_CLOSE);\n        ssoWindowRef.current?.close();\n      };\n\n      amplify.subscribe(WebAppEvents.LIFECYCLE.SSO_WINDOW_CLOSED, () => {\n        onChildWindowClose();\n        reject(new BackendError({code: 500, label: BackendError.LABEL.SSO_USER_CANCELLED_ERROR}));\n      });\n\n      if (ssoWindowRef.current) {\n        timerId = window.setInterval(() => {\n          if (ssoWindowRef.current && ssoWindowRef.current.closed) {\n            onChildWindowClose();\n            reject(new BackendError({code: 500, label: BackendError.LABEL.SSO_USER_CANCELLED_ERROR}));\n          }\n        }, SSO_WINDOW_CLOSE_POLLING_INTERVAL);\n\n        onParentWindowClose = () => {\n          closeSSOWindow();\n          reject(new BackendError({code: 500, label: BackendError.LABEL.SSO_USER_CANCELLED_ERROR}));\n        };\n        window.addEventListener('unload', onParentWindowClose);\n      }\n    });\n  };\n\n  const calculateChildPosition = (childHeight: number, childWidth: number) => {\n    const screenLeft = window.screenLeft || window.screenX;\n    const screenTop = window.screenTop || window.screenY;\n\n    const hasInnerMeasurements = window.innerHeight && window.innerWidth;\n\n    const parentHeight = hasInnerMeasurements\n      ? window.innerHeight\n      : document.documentElement.clientHeight || window.screen.height;\n    const parentWidth = hasInnerMeasurements\n      ? window.innerWidth\n      : document.documentElement.clientWidth || window.screen.width;\n\n    const left = parentWidth / 2 - childWidth / 2 + screenLeft;\n    const top = parentHeight / 2 - childHeight / 2 + screenTop;\n    return {left, top};\n  };\n\n  const focusChildWindow = () => {\n    amplify.publish(WebAppEvents.LIFECYCLE.SSO_WINDOW_FOCUS);\n    ssoWindowRef.current?.focus();\n  };\n\n  const backArrow = (\n    <RouterLink to={ROUTE.INDEX} data-uie-name=\"go-login\">\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n\n  return (\n    <Page>\n      {isOverlayOpen && (\n        <Overlay>\n          <Container centerText style={{color: COLOR.WHITE, maxWidth: '330px'}}>\n            <div style={{alignItems: 'center', display: 'flex', justifyContent: 'center', marginBottom: '30px'}}>\n              <Logo height={24} color={COLOR.WHITE} />\n            </div>\n            <Text\n              style={{fontSize: '0.875rem', fontWeight: 400, marginTop: '32px'}}\n              color={COLOR.WHITE}\n              data-uie-name=\"status-overlay-description\"\n            >\n              {_(ssoLoginStrings.overlayDescription)}\n            </Text>\n            <Link\n              block\n              center\n              style={{\n                color: COLOR.WHITE,\n                fontSize: '0.875rem',\n                fontWeight: 600,\n                marginTop: '24px',\n                textDecoration: 'underline',\n                textTransform: 'none',\n              }}\n              onClick={focusChildWindow}\n              data-uie-name=\"do-focus-child-window\"\n            >\n              {_(ssoLoginStrings.overlayFocusLink)}\n            </Link>\n          </Container>\n        </Overlay>\n      )}\n      {!hasDefaultSSOCode && (\n        <IsMobile>\n          <div style={{margin: 16}}>{backArrow}</div>\n        </IsMobile>\n      )}\n      <Container centerText verticalCenter style={{width: '100%'}}>\n        <AppAlreadyOpen />\n        <Columns>\n          <IsMobile not>\n            <Column style={{display: 'flex'}}>\n              {!hasDefaultSSOCode && <div style={{margin: 'auto'}}>{backArrow}</div>}\n            </Column>\n          </IsMobile>\n          <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n            <ContainerXS\n              centerText\n              style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n            >\n              <div>\n                <H1 center>{_(ssoLoginStrings.headline)}</H1>\n                {Config.getConfig().FEATURE.ENABLE_DOMAIN_DISCOVERY ? (\n                  <>\n                    <Muted center style={{display: 'block'}} data-uie-name=\"status-email-or-sso-code\">\n                      {_(ssoLoginStrings.subheadCodeOrEmail)}\n                    </Muted>\n                    <Muted center style={{display: 'block'}} data-uie-name=\"status-email-environment-switch-warning\">\n                      {_(ssoLoginStrings.subheadEmailEnvironmentSwitchWarning, {\n                        brandName: Config.getConfig().BRAND_NAME,\n                      })}\n                    </Muted>\n                  </>\n                ) : (\n                  <Muted data-uie-name=\"status-sso-code\">{_(ssoLoginStrings.subheadCode)}</Muted>\n                )}\n                <SingleSignOnForm doLogin={handleSSOWindow} initialCode={params.code} />\n              </div>\n            </ContainerXS>\n          </Column>\n          <Column />\n        </Columns>\n      </Container>\n      {!hasDefaultSSOCode && (\n        <IsMobile>\n          <div style={{minWidth: 48}} />\n        </IsMobile>\n      )}\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasDefaultSSOCode: AuthSelector.hasDefaultSSOCode(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) => bindActionCreators({}, dispatch);\n\nconst SingleSignOn = connect(mapStateToProps, mapDispatchToProps)(SingleSignOnComponent);\n\nexport {SingleSignOn};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef, useState} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {\n  ArrowIcon,\n  COLOR,\n  Column,\n  Columns,\n  Container,\n  ContainerXS,\n  Form,\n  H1,\n  Input,\n  InputBlock,\n  InputSubmitCombo,\n  IsMobile,\n  Link,\n  Muted,\n  RoundIconButton,\n} from '@wireapp/react-ui-kit';\n\nimport {getLogger} from 'Util/Logger';\n\nimport {Page} from './Page';\n\nimport {addLocaleToUrl} from '../../externalRoute';\nimport {teamNameStrings} from '../../strings';\nimport {RouterLink} from '../component/RouterLink';\nimport {EXTERNAL_ROUTE} from '../externalRoute';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\nimport {parseError, parseValidationErrors} from '../util/errorUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst TeamNameComponent = ({\n  teamName,\n  enterTeamCreationFlow,\n  resetInviteErrors,\n  pushAccountRegistrationData,\n  authError,\n}: Props & ConnectedProps & DispatchProps) => {\n  const logger = getLogger('TeamName');\n\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n  const [enteredTeamName, setEnteredTeamName] = useState(teamName || '');\n  const [error, setError] = useState<ValidationError | null>(null);\n  const [isValidTeamName, setIsValidTeamName] = useState(!!teamName);\n  const teamNameInput = useRef<HTMLInputElement | null>(null);\n\n  useEffect(() => {\n    enterTeamCreationFlow();\n  }, []);\n\n  const resetErrors = () => {\n    setError(null);\n    setIsValidTeamName(true);\n    resetInviteErrors();\n  };\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n\n    if (!teamNameInput.current) {\n      return;\n    }\n\n    teamNameInput.current.value = teamNameInput.current.value.trim();\n\n    if (!teamNameInput.current.checkValidity()) {\n      setError(ValidationError.handleValidationState('name', teamNameInput.current.validity));\n      setIsValidTeamName(false);\n    } else {\n      try {\n        await pushAccountRegistrationData({\n          team: {\n            creator: '',\n            icon: '',\n            id: '',\n            name: teamNameInput.current.value,\n          },\n        });\n        return navigate(ROUTE.CREATE_TEAM_ACCOUNT);\n      } catch (error) {\n        logger.error('Unable to push account data', error);\n      }\n    }\n\n    teamNameInput.current.focus();\n  };\n\n  const onTeamNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    resetErrors();\n    setEnteredTeamName(event.target.value);\n  };\n\n  const backArrow = (\n    <RouterLink to={ROUTE.SET_ACCOUNT_TYPE} data-uie-name=\"go-register-team\">\n      <ArrowIcon direction=\"left\" color={COLOR.TEXT} style={{opacity: 0.56}} />\n    </RouterLink>\n  );\n\n  return (\n    <Page>\n      <IsMobile>\n        <div style={{margin: 16}}>{backArrow}</div>\n      </IsMobile>\n      <Container centerText verticalCenter style={{width: '100%'}}>\n        <Columns>\n          <IsMobile not>\n            <Column style={{display: 'flex'}}>\n              <div style={{margin: 'auto'}}>{backArrow}</div>\n            </Column>\n          </IsMobile>\n          <Column style={{flexBasis: 384, flexGrow: 0, padding: 0}}>\n            <ContainerXS\n              centerText\n              style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n            >\n              <div>\n                <H1 center>{_(teamNameStrings.headline)}</H1>\n                <Muted>{_(teamNameStrings.subhead)}</Muted>\n                <Form style={{marginTop: 30}}>\n                  <InputBlock>\n                    <InputSubmitCombo>\n                      <Input\n                        id=\"enter-team-name\"\n                        value={enteredTeamName}\n                        ref={teamNameInput}\n                        onChange={onTeamNameChange}\n                        placeholder={_(teamNameStrings.teamNamePlaceholder)}\n                        pattern=\".{2,256}\"\n                        maxLength={256}\n                        minLength={2}\n                        required\n                        data-uie-name=\"enter-team-name\"\n                      />\n                      <RoundIconButton\n                        disabled={!enteredTeamName || !isValidTeamName}\n                        type=\"submit\"\n                        formNoValidate\n                        onClick={handleSubmit}\n                        data-uie-name=\"do-next\"\n                      >\n                        <ArrowIcon />\n                      </RoundIconButton>\n                    </InputSubmitCombo>\n                  </InputBlock>\n                  {error ? parseValidationErrors(error) : parseError(authError)}\n                </Form>\n              </div>\n              <div>\n                <Link\n                  href={addLocaleToUrl(EXTERNAL_ROUTE.WIRE_TEAM_FEATURES)}\n                  target=\"_blank\"\n                  data-uie-name=\"go-what-is\"\n                >\n                  {_(teamNameStrings.whatIsWireTeamsLink)}\n                </Link>\n              </div>\n            </ContainerXS>\n          </Column>\n          <Column />\n        </Columns>\n      </Container>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  authError: AuthSelector.getError(state),\n  teamName: AuthSelector.getAccountTeamName(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      enterTeamCreationFlow: ROOT_ACTIONS.authAction.enterTeamCreationFlow,\n      pushAccountRegistrationData: ROOT_ACTIONS.authAction.pushAccountRegistrationData,\n      resetInviteErrors: ROOT_ACTIONS.invitationAction.resetInviteErrors,\n    },\n    dispatch,\n  );\n\nconst TeamName = connect(mapStateToProps, mapDispatchToProps)(TeamNameComponent);\n\nexport {TeamName};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {LinkProps, linkStyle, Theme} from '@wireapp/react-ui-kit';\n\nconst linkButtonStyle = {\n  background: 'none',\n  border: 'none',\n  margin: 0,\n  padding: 0,\n};\n\nconst LinkButton = (props: React.ButtonHTMLAttributes<HTMLButtonElement>) => (\n  <button\n    type=\"button\"\n    css={(theme: Theme) => linkStyle(theme, props as unknown as LinkProps)}\n    style={linkButtonStyle}\n    {...props}\n  />\n);\n\nexport {LinkButton};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {FormattedMessage, useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {CodeInput, ContainerXS, H1, Muted} from '@wireapp/react-ui-kit';\n\nimport {getLogger} from 'Util/Logger';\n\nimport {Page} from './Page';\n\nimport {verifyStrings} from '../../strings';\nimport {LinkButton} from '../component/LinkButton';\nimport {RouterLink} from '../component/RouterLink';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action';\nimport {RootState, bindActionCreators} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\nimport {parseError} from '../util/errorUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst changeEmailRedirect = {\n  [AuthSelector.REGISTER_FLOW.PERSONAL]: ROUTE.CREATE_ACCOUNT,\n  [AuthSelector.REGISTER_FLOW.GENERIC_INVITATION]: ROUTE.CREATE_ACCOUNT,\n  [AuthSelector.REGISTER_FLOW.TEAM]: ROUTE.CREATE_TEAM_ACCOUNT,\n};\n\nconst VerifyEmailCodeComponent = ({\n  account,\n  authError,\n  currentFlow,\n  entropyData,\n  doRegisterPersonal,\n  doRegisterTeam,\n  doSendActivationCode,\n}: Props & ConnectedProps & DispatchProps) => {\n  const navigate = useNavigate();\n  const {formatMessage: _} = useIntl();\n\n  const logger = getLogger('VerifyEmailCode');\n  const createAccount = async (email_code: string) => {\n    switch (currentFlow) {\n      case AuthSelector.REGISTER_FLOW.TEAM: {\n        try {\n          await doRegisterTeam({...account, email_code});\n          navigate(ROUTE.SET_HANDLE);\n        } catch (error) {\n          logger.error('Failed to create team account', error);\n        }\n        break;\n      }\n\n      case AuthSelector.REGISTER_FLOW.PERSONAL:\n      case AuthSelector.REGISTER_FLOW.GENERIC_INVITATION: {\n        try {\n          await doRegisterPersonal({...account, email_code}, entropyData);\n          navigate(ROUTE.SET_HANDLE);\n        } catch (error) {\n          logger.error('Failed to create personal account', error);\n        }\n      }\n    }\n  };\n\n  const resendCode = async (event: React.MouseEvent) => {\n    event.preventDefault();\n    try {\n      await doSendActivationCode(account.email);\n    } catch (error) {\n      logger.error('Failed to send email code', error);\n    }\n  };\n\n  return (\n    <Page hasAccountData>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n      >\n        <div>\n          <H1 center>{_(verifyStrings.headline)}</H1>\n          <Muted data-uie-name=\"label-with-email\">\n            <FormattedMessage\n              {...verifyStrings.subhead}\n              values={{\n                email: account.email,\n                newline: <br />,\n              }}\n            />\n          </Muted>\n          <CodeInput style={{marginTop: 10}} onCodeComplete={createAccount} data-uie-name=\"enter-code\" />\n          {parseError(authError)}\n        </div>\n        <div>\n          <LinkButton onClick={resendCode} data-uie-name=\"do-resend-code\">\n            {_(verifyStrings.resendCode)}\n          </LinkButton>\n          <RouterLink to={changeEmailRedirect[currentFlow]} style={{marginLeft: 35}} data-uie-name=\"go-change-email\">\n            {_(verifyStrings.changeEmail)}\n          </RouterLink>\n        </div>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  account: AuthSelector.getAccount(state),\n  authError: AuthSelector.getError(state),\n  currentFlow: AuthSelector.getCurrentFlow(state),\n  entropyData: AuthSelector.getEntropy(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doRegisterPersonal: ROOT_ACTIONS.authAction.doRegisterPersonal,\n      doRegisterTeam: ROOT_ACTIONS.authAction.doRegisterTeam,\n      doSendActivationCode: ROOT_ACTIONS.userAction.doSendActivationCode,\n    },\n    dispatch,\n  );\n\nconst VerifyEmailCode = connect(mapStateToProps, mapDispatchToProps)(VerifyEmailCodeComponent);\n\nexport {VerifyEmailCode};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect} from 'react';\n\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\n\nimport {ContainerXS, H1, H3, Muted} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {setEmailStrings} from '../../strings';\nimport {RouterLink} from '../component/RouterLink';\nimport {RootState} from '../module/reducer';\nimport * as SelfSelector from '../module/selector/SelfSelector';\nimport {ROUTE} from '../route';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst VerifyEmailLinkComponent = ({hasSelfEmail}: Props & ConnectedProps) => {\n  const {formatMessage: _} = useIntl();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (hasSelfEmail) {\n      navigate(ROUTE.SET_PASSWORD);\n    }\n  }, [hasSelfEmail]);\n\n  if (hasSelfEmail) {\n    return null;\n  }\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n      >\n        <div>\n          <H1 center data-uie-name=\"verify-email-headline\">\n            {_(setEmailStrings.verifyHeadline)}\n          </H1>\n          <H3 center block data-uie-name=\"verify-email-subhead\">\n            {_(setEmailStrings.verifySubhead)}\n          </H3>\n          <Muted center block style={{marginTop: 64}} data-uie-name=\"verify-email-no-mail\">\n            {_(setEmailStrings.noMailHeadline)}\n          </Muted>\n          <RouterLink to={ROUTE.SET_EMAIL} data-uie-name=\"go-set-email\">\n            {_(setEmailStrings.tryAgain)}\n          </RouterLink>\n        </div>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  hasSelfEmail: SelfSelector.hasSelfEmail(state),\n});\n\nconst VerifyEmailLink = connect(mapStateToProps)(VerifyEmailLinkComponent);\n\nexport {VerifyEmailLink};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {LoginData} from '@wireapp/api-client/lib/auth';\nimport {useIntl} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {useNavigate} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {CodeInput, Column, Columns, ContainerXS, H1} from '@wireapp/react-ui-kit';\n\nimport {Page} from './Page';\n\nimport {phoneLoginStrings} from '../../strings';\nimport {LinkButton} from '../component/LinkButton';\nimport {RouterLink} from '../component/RouterLink';\nimport {actionRoot} from '../module/action';\nimport {BackendError} from '../module/action/BackendError';\nimport {LabeledError} from '../module/action/LabeledError';\nimport {ValidationError} from '../module/action/ValidationError';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport {ROUTE} from '../route';\nimport {parseError} from '../util/errorUtil';\n\ntype Props = React.HTMLProps<HTMLDivElement>;\n\nconst VerifyPhoneCodeComponent = ({\n  doLogin,\n  resetAuthError,\n  loginData,\n  doSendPhoneLoginCode,\n}: Props & ConnectedProps & DispatchProps) => {\n  const {formatMessage: _} = useIntl();\n  const [error, setError] = useState<ValidationError | null>(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (!loginData.phone) {\n      navigate(ROUTE.LOGIN_PHONE);\n    }\n  }, []);\n\n  const resendCode = async () => {\n    try {\n      await doSendPhoneLoginCode({phone: loginData.phone});\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        setError(error);\n      } else if (error.hasOwnProperty('label')) {\n        switch (error.label) {\n          case BackendError.LABEL.PASSWORD_EXISTS: {\n            return navigate(ROUTE.CHECK_PASSWORD);\n          }\n          default: {\n            setError(error);\n            throw error;\n          }\n        }\n      } else {\n        throw error;\n      }\n    }\n  };\n\n  const handleLogin = async (code: string) => {\n    try {\n      const login: LoginData = {clientType: loginData.clientType, code, phone: loginData.phone};\n      await doLogin(login);\n      return navigate(ROUTE.HISTORY_INFO);\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        setError(error);\n        return;\n      }\n\n      switch (error.label) {\n        case BackendError.LABEL.TOO_MANY_CLIENTS: {\n          resetAuthError();\n          return navigate(ROUTE.CLIENTS);\n        }\n        case BackendError.LABEL.INVALID_CREDENTIALS:\n        case LabeledError.GENERAL_ERRORS.LOW_DISK_SPACE:\n        case BackendError.LABEL.BAD_REQUEST: {\n          setError(error);\n          return;\n        }\n        default: {\n          setError(error);\n          throw error;\n        }\n      }\n    }\n  };\n  return (\n    <Page>\n      <ContainerXS\n        centerText\n        verticalCenter\n        style={{display: 'flex', flexDirection: 'column', height: 428, justifyContent: 'space-between'}}\n        css\n      >\n        <div>\n          <H1 center>{_(phoneLoginStrings.verifyCodeDescription, {number: loginData.phone})}</H1>\n          <CodeInput style={{marginTop: 10}} onCodeComplete={handleLogin} data-uie-name=\"enter-code\" />\n          {parseError(error)}\n        </div>\n        <Columns>\n          <Column>\n            <LinkButton onClick={resendCode} data-uie-name=\"do-resend-code\">\n              {_(phoneLoginStrings.verifyCodeResend)}\n            </LinkButton>\n          </Column>\n          <Column>\n            <RouterLink to={ROUTE.LOGIN_PHONE} data-uie-name=\"go-change-phone\">\n              {_(phoneLoginStrings.verifyCodeChangePhone)}\n            </RouterLink>\n          </Column>\n        </Columns>\n      </ContainerXS>\n    </Page>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isFetching: AuthSelector.isFetching(state),\n  loginData: AuthSelector.getLoginData(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doLogin: actionRoot.authAction.doLogin,\n      doSendPhoneLoginCode: actionRoot.authAction.doSendPhoneLoginCode,\n      resetAuthError: actionRoot.authAction.resetAuthError,\n    },\n    dispatch,\n  );\n\nconst VerifyPhoneCode = connect(mapStateToProps, mapDispatchToProps)(VerifyPhoneCodeComponent);\n\nexport {VerifyPhoneCode};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FC, useEffect} from 'react';\n\nimport {pathWithParams} from '@wireapp/commons/lib/util/UrlUtil';\nimport {IntlProvider} from 'react-intl';\nimport {connect} from 'react-redux';\nimport {HashRouter as Router, Navigate, Route, Routes} from 'react-router-dom';\nimport {AnyAction, Dispatch} from 'redux';\n\nimport {ContainerXS, Loading, StyledApp, THEME_ID} from '@wireapp/react-ui-kit';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {CheckPassword} from './CheckPassword';\nimport {ClientManager} from './ClientManager';\nimport {ConversationJoin} from './ConversationJoin';\nimport {ConversationJoinInvalid} from './ConversationJoinInvalid';\nimport {CreateAccount} from './CreateAccount';\nimport {CreatePersonalAccount} from './CreatePersonalAccount';\nimport {CustomEnvironmentRedirect} from './CustomEnvironmentRedirect';\nimport {HistoryInfo} from './HistoryInfo';\nimport {Index} from './Index';\nimport {InitialInvite} from './InitialInvite';\nimport {Login} from './Login';\nimport {PhoneLogin} from './PhoneLogin';\nimport {SetAccountType} from './SetAccountType';\nimport {SetEmail} from './SetEmail';\nimport {SetEntropyPage} from './SetEntropyPage';\nimport {SetHandle} from './SetHandle';\nimport {SetPassword} from './SetPassword';\nimport {SingleSignOn} from './SingleSignOn';\nimport {TeamName} from './TeamName';\nimport {VerifyEmailCode} from './VerifyEmailCode';\nimport {VerifyEmailLink} from './VerifyEmailLink';\nimport {VerifyPhoneCode} from './VerifyPhoneCode';\n\nimport {Config} from '../../Config';\nimport {mapLanguage, normalizeLanguage} from '../localeConfig';\nimport {actionRoot as ROOT_ACTIONS} from '../module/action/';\nimport {bindActionCreators, RootState} from '../module/reducer';\nimport * as AuthSelector from '../module/selector/AuthSelector';\nimport * as LanguageSelector from '../module/selector/LanguageSelector';\nimport {ROUTE} from '../route';\n\ninterface RootProps {}\n\nconst Title: FC<{title: string; children: React.ReactNode}> = ({title, children}) => {\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n  return <>{children}</>;\n};\n\nconst RootComponent: FC<RootProps & ConnectedProps & DispatchProps> = ({\n  isAuthenticated,\n  language,\n  isFetchingSSOSettings,\n  doGetSSOSettings,\n}) => {\n  useEffect(() => {\n    // Force the hash url to have a initial `/` (see https://stackoverflow.com/a/71864506)\n    const forceSlashAfterHash = () => {\n      const hash = window.location.hash;\n      if (!hash.startsWith('#/')) {\n        window.location.hash = `#/${hash.slice(1)}`;\n      }\n    };\n\n    forceSlashAfterHash();\n\n    window.addEventListener('hashchange', forceSlashAfterHash);\n    return () => {\n      window.removeEventListener('hashchange', forceSlashAfterHash);\n    };\n  }, []);\n\n  useEffect(() => {\n    doGetSSOSettings();\n  }, []);\n\n  const loadLanguage = (language: string) => {\n    return require(`I18n/${mapLanguage(language)}.json`);\n  };\n\n  const navigate = (route: string): null => {\n    window.location.assign(pathWithParams(route));\n    return null;\n  };\n\n  const isAuthenticatedCheck = (page: any): any => (page ? (isAuthenticated ? page : navigate('/auth')) : null);\n\n  const ProtectedHistoryInfo = () => isAuthenticatedCheck(<HistoryInfo />);\n  const ProtectedInitialInvite = () => isAuthenticatedCheck(<InitialInvite />);\n  const ProtectedClientManager = () => isAuthenticatedCheck(<ClientManager />);\n\n  const ProtectedSetHandle = () => isAuthenticatedCheck(<SetHandle />);\n  const ProtectedSetEmail = () => isAuthenticatedCheck(<SetEmail />);\n  const ProtectedSetPassword = () => isAuthenticatedCheck(<SetPassword />);\n\n  const brandName = Config.getConfig().BRAND_NAME;\n  return (\n    <IntlProvider locale={normalizeLanguage(language)} messages={loadLanguage(language)}>\n      <StyledApp themeId={THEME_ID.DEFAULT} style={{display: 'flex', height: '100%', minHeight: '100vh'}}>\n        {isFetchingSSOSettings ? (\n          <ContainerXS centerText verticalCenter style={{justifyContent: 'center'}}>\n            <Loading />\n          </ContainerXS>\n        ) : (\n          <Router>\n            <Routes>\n              <Route\n                path={ROUTE.INDEX}\n                element={\n                  <Title title={`${t('authLandingPageTitleP1')} ${brandName} . ${t('authLandingPageTitleP2')}`}>\n                    <Index />\n                  </Title>\n                }\n              />\n              <Route path={ROUTE.CHECK_PASSWORD} element={<CheckPassword />} />\n              <Route path={ROUTE.CLIENTS} element={<ProtectedClientManager />} />\n              <Route path={ROUTE.CONVERSATION_JOIN_INVALID} element={<ConversationJoinInvalid />} />\n              <Route path={ROUTE.CONVERSATION_JOIN} element={<ConversationJoin />} />\n              {Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && (\n                <Route path={ROUTE.CREATE_TEAM} element={<TeamName />} />\n              )}\n              <Route path={ROUTE.HISTORY_INFO} element={<ProtectedHistoryInfo />} />\n              <Route path={ROUTE.INITIAL_INVITE} element={<ProtectedInitialInvite />} />\n              <Route\n                path={`${ROUTE.LOGIN}/*`}\n                element={\n                  <Title title={`${t('authLoginTitle')} . ${brandName}`}>\n                    <Login />\n                  </Title>\n                }\n              />\n              <Route path={ROUTE.LOGIN_PHONE} element={<PhoneLogin />} />\n              <Route\n                path={ROUTE.SET_ACCOUNT_TYPE}\n                element={\n                  <Title title={`${t('authAccCreationTitle')} . ${brandName}`}>\n                    <SetAccountType />\n                  </Title>\n                }\n              />\n              <Route path={ROUTE.SET_EMAIL} element={<ProtectedSetEmail />} />\n              <Route path={ROUTE.SET_HANDLE} element={<ProtectedSetHandle />} />\n              <Route\n                path={ROUTE.SET_PASSWORD}\n                element={\n                  <Title title={`${t('authForgotPasswordTitle')} . ${brandName}`}>\n                    <ProtectedSetPassword />\n                  </Title>\n                }\n              />\n              <Route path={`${ROUTE.SSO}`}>\n                <Route\n                  path=\"\"\n                  element={\n                    <Title title={`${t('authSSOLoginTitle')} . ${brandName}`}>\n                      <SingleSignOn />\n                    </Title>\n                  }\n                />\n                <Route\n                  path=\":code\"\n                  element={\n                    <Title title={`${t('authSSOLoginTitle')} . ${brandName}`}>\n                      <SingleSignOn />\n                    </Title>\n                  }\n                />\n              </Route>\n              <Route path={ROUTE.VERIFY_EMAIL_LINK} element={<VerifyEmailLink />} />\n              <Route path={ROUTE.VERIFY_PHONE_CODE} element={<VerifyPhoneCode />} />\n              <Route path={ROUTE.CUSTOM_ENV_REDIRECT} element={<CustomEnvironmentRedirect />} />\n              {Config.getConfig().FEATURE.ENABLE_EXTRA_CLIENT_ENTROPY && (\n                <Route path={ROUTE.SET_ENTROPY} element={<SetEntropyPage />} />\n              )}\n              {Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && (\n                <Route path={ROUTE.VERIFY_EMAIL_CODE} element={<VerifyEmailCode />} />\n              )}\n              {Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && (\n                <Route path={ROUTE.CREATE_ACCOUNT} element={<CreatePersonalAccount />} />\n              )}\n              {Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && (\n                <Route path={ROUTE.CREATE_TEAM_ACCOUNT} element={<CreateAccount />} />\n              )}\n              <Route path=\"*\" element={<Navigate to={ROUTE.INDEX} replace />} />\n            </Routes>\n          </Router>\n        )}\n      </StyledApp>\n    </IntlProvider>\n  );\n};\n\ntype ConnectedProps = ReturnType<typeof mapStateToProps>;\nconst mapStateToProps = (state: RootState) => ({\n  isAuthenticated: AuthSelector.isAuthenticated(state),\n  isFetchingSSOSettings: AuthSelector.isFetchingSSOSettings(state),\n  language: LanguageSelector.getLanguage(state),\n});\n\ntype DispatchProps = ReturnType<typeof mapDispatchToProps>;\nconst mapDispatchToProps = (dispatch: Dispatch<AnyAction>) =>\n  bindActionCreators(\n    {\n      doGetSSOSettings: ROOT_ACTIONS.authAction.doGetSSOSettings,\n    },\n    dispatch,\n  );\n\nconst Root = connect(mapStateToProps, mapDispatchToProps)(RootComponent);\n\nexport {Root};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n// Polyfill \"Object.entries\" & \"Object.values\"\nimport 'core-js/full/object';\nimport 'core-js/full/reflect';\n\n// eslint-disable-next-line import/order\nimport {FC} from 'react';\n\nimport {createRoot} from 'react-dom/client';\nimport {Provider} from 'react-redux';\nimport {container} from 'tsyringe';\n\nimport {enableLogging} from 'Util/LoggerUtil';\nimport {exposeWrapperGlobals} from 'Util/wrapper';\n\nimport './configureEnvironment';\nimport {configureStore} from './configureStore';\nimport {actionRoot} from './module/action';\nimport {Root} from './page/Root';\n\nimport {Config} from '../Config';\nimport {APIClient} from '../service/APIClientSingleton';\nimport {Core} from '../service/CoreSingleton';\n\nexposeWrapperGlobals();\n\nconst mainId = 'main';\n\nconst apiClient = container.resolve(APIClient);\nconst core = container.resolve(Core);\n\nlet localStorage;\ntry {\n  localStorage = window.localStorage;\n} catch (error) {}\n\nconst store = configureStore({\n  actions: actionRoot,\n  apiClient,\n  core,\n  getConfig: Config.getConfig,\n  localStorage,\n});\n\nconst render = (Component: FC): void => {\n  const container = document.getElementById(mainId);\n  if (!container) {\n    throw new Error(`No container '${mainId}' found to render application`);\n  }\n  createRoot(container).render(\n    <Provider store={store}>\n      <Component />\n    </Provider>,\n  );\n};\n\nfunction runApp(): void {\n  render(Root);\n  if (module.hot) {\n    module.hot.accept('./page/Root', () => {\n      render(require('./page/Root').Root);\n    });\n  }\n}\n\nenableLogging(Config.getConfig().FEATURE.ENABLE_DEBUG);\nrunApp();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport const QUERY_KEY = {\n  ACCOUNT_ID: 'id', // account ID passed from the wrapper to the webview\n  CLIENT_TYPE: 'clienttype',\n  CONVERSATION_CODE: 'join_code',\n  CONVERSATION_KEY: 'join_key',\n  CURRENCY: 'currency',\n  DESTINATION_URL: 'destination_url',\n  ENVIRONMENT: 'env',\n  IMMEDIATE_LOGIN: 'immediate_login',\n  JOIN_EXPIRES: 'expires_in',\n  LANGUAGE: 'hl',\n  LOCALE: 'hl',\n  LOGOUT_REASON: 'reason',\n  PERSIST_TEMPORARY_CLIENTS: 'persist_temporary_clients',\n  PWA_AWARE: 'pwa_aware',\n  SSO_AUTO_LOGIN: 'sso_auto_login',\n  TRACKING: 'tracking',\n};\n\nexport const FORWARDED_QUERY_KEYS = [\n  QUERY_KEY.ACCOUNT_ID,\n  QUERY_KEY.ENVIRONMENT,\n  QUERY_KEY.LOCALE,\n  QUERY_KEY.PERSIST_TEMPORARY_CLIENTS,\n  QUERY_KEY.TRACKING,\n];\n\nexport const LOGOUT_REASON = {\n  ACCOUNT_REMOVED: 'deleted',\n  CLIENT_REMOVED: 'client_removed',\n  NO_APP_CONFIG: 'no_app_config',\n  SESSION_EXPIRED: 'expired',\n};\n\nexport const ROUTE = {\n  CHECK_PASSWORD: '/checkpassword',\n  CLIENTS: '/clients',\n  CONVERSATION_JOIN: '/join-conversation',\n  CONVERSATION_JOIN_INVALID: '/join-conversation-invalid',\n  CREATE_ACCOUNT: '/createaccount',\n  CREATE_TEAM: '/createteam',\n  CREATE_TEAM_ACCOUNT: '/createteamaccount',\n  CUSTOM_ENV_REDIRECT: '/custom-env-redirect',\n  HISTORY_INFO: '/historyinfo',\n  INDEX: '/',\n  INITIAL_INVITE: '/teaminvite',\n  LOGIN: '/login',\n  LOGIN_PHONE: '/phonelogin',\n  SET_ACCOUNT_TYPE: '/setaccounttype',\n  SET_EMAIL: '/setemail',\n  SET_ENTROPY: '/setentropy',\n  SET_HANDLE: '/sethandle',\n  SET_PASSWORD: '/setpassword',\n  SSO: '/sso',\n  VERIFY_EMAIL_CODE: '/verifyemailcode',\n  VERIFY_EMAIL_LINK: '/verifyemaillink',\n  VERIFY_PHONE_CODE: '/verifyphonecode',\n};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nconst fileList = require.context('Resource/image/icon', true, /.+\\.svg$/);\nexport type SVGProvider = {[index: string]: Document};\n\nconst svgs: SVGProvider = {};\n\nconst parser = new DOMParser();\nfileList.keys().forEach(iconFileName => {\n  const iconPath = iconFileName.replace(/^\\.\\//, '');\n  const iconName = iconFileName.substring(iconFileName.lastIndexOf('/') + 1).replace(/\\.svg$/i, '');\n  const svgString = require(`Resource/image/icon/${iconPath}`);\n  svgs[iconName] = parser.parseFromString(svgString, 'image/svg+xml');\n});\n\nconst getAllSVGs = () => svgs;\nconst getSVG = (iconName: string) => svgs[iconName];\n\nexport {getAllSVGs, getSVG};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum LEAVE_CALL_REASON {\n  USER_TURNED_UNVERIFIED = 'user_turned_unverified',\n  REMOTE_KICK = 'remote_kick',\n  ELECTRON_TRAY_MENU_MESSAGE = 'electron_tray_menu_message',\n  MEDIA_STREAM_ERROR = 'media_stream_error',\n  MANUAL_LEAVE_TO_JOIN_ANOTHER_CALL = 'manual_leave_to_join_another_call',\n  MANUAL_LEAVE_BY_UI_CLICK = 'manual_leave_by_ui_click',\n  USER_MANUALY_LEFT_CONVERSATION = 'user_manualy_left_conversation',\n  USER_IS_REMOVED_BY_AN_ADMIN_OR_LEFT_ON_ANOTHER_CLIENT = 'user_is_removed_by_an_admin_or_left_on_another_client',\n  ABORTED_BECAUSE_FAILED_TO_UPDATE_MISSING_CLIENTS = 'abort_failed_to_update_missing_clients',\n  ABORTED_BECAUSE_FAILED_TO_SEND_CALLING_MESSAGE = 'abort_failed_to_update_missing_clients',\n  ABORTED_BECAUSE_USER_CANCELLED_MESSAGE_SENDING_BECAUSE_OF_A_DEGRADATION_WARNING = 'abort_failed_because_user_cancelled_message_sending_because_of_a_degradation_warning',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum TERMINATION_REASON {\n  COMPLETED = 'completed',\n  CONCURRENT_CALL = 'concurrent',\n  CONNECTION_DROP = 'drop',\n  CONNECTION_FAILED = 'failed_ice',\n  GROUP_CHECK = 'group_check',\n  MEMBER_LEAVE = 'member_leave',\n  MISSED = 'missed',\n  OTHER_USER = 'other',\n  PAGE_NAVIGATION = 'page_navigation',\n  RENEGOTIATION = 'renegotiation',\n  SDP_FAILED = 'failed_sdp',\n  SELF_USER = 'self',\n  TIMEOUT = 'timeout',\n  UNKNOWN = 'unknown',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientClassification, ClientType} from '@wireapp/api-client/lib/client/';\nimport ko from 'knockout';\n\nimport {splitFingerprint} from 'Util/StringUtil';\n\nimport {ClientMapper} from './ClientMapper';\n\nimport {ClientRecord} from '../storage';\n\nexport class ClientEntity {\n  static CONFIG = {\n    DEFAULT_VALUE: '?',\n  };\n\n  address?: string;\n  class: ClientClassification | '?';\n  cookie?: string;\n  domain?: string;\n  id: string;\n  isSelfClient: boolean;\n  label?: string;\n  location?: {\n    lat?: number;\n    lon?: number;\n  };\n  meta: {\n    isVerified?: ko.Observable<boolean>;\n    primaryKey?: string;\n    userId?: string;\n  };\n  model?: string;\n  time?: string;\n  type?: ClientType.PERMANENT | ClientType.TEMPORARY;\n\n  constructor(isSelfClient: boolean, domain: string | null, id = '') {\n    this.isSelfClient = isSelfClient;\n\n    this.class = '?';\n    this.id = id;\n    this.domain = domain;\n\n    if (this.isSelfClient) {\n      this.address = '';\n      this.cookie = '';\n      this.label = ClientEntity.CONFIG.DEFAULT_VALUE;\n      this.location = {};\n      this.model = ClientEntity.CONFIG.DEFAULT_VALUE;\n      this.time = ClientEntity.CONFIG.DEFAULT_VALUE;\n      this.type = ClientType.TEMPORARY;\n    }\n\n    // Metadata maintained by us\n    this.meta = {\n      isVerified: ko.observable(false),\n      primaryKey: undefined,\n    };\n  }\n\n  /**\n   * Returns the ID of a client in a format suitable for UI display in user preferences.\n   * @returns Client ID in pairs of two as an array\n   */\n  formatId(): string[] {\n    return splitFingerprint(this.id);\n  }\n\n  isLegalHold(): boolean {\n    return this.class === ClientClassification.LEGAL_HOLD;\n  }\n\n  isPermanent(): boolean {\n    return this.type === ClientType.PERMANENT;\n  }\n\n  isTemporary(): boolean {\n    return this.type === ClientType.TEMPORARY;\n  }\n\n  getName(): string {\n    const hasModel = this.model && this.model !== ClientEntity.CONFIG.DEFAULT_VALUE;\n    return hasModel ? this.model : this.class.toUpperCase();\n  }\n\n  /**\n   * This method returns an object which can be stored in our local database.\n   */\n  toJson(): ClientRecord {\n    const jsonObject = JSON.parse(ko.toJSON(this));\n    delete jsonObject.isSelfClient;\n\n    ClientMapper.CONFIG.CLIENT_PAYLOAD.forEach(name => this.removeDefaultValues(jsonObject, name));\n\n    if (this.isSelfClient) {\n      ClientMapper.CONFIG.SELF_CLIENT_PAYLOAD.forEach(name => this.removeDefaultValues(jsonObject, name));\n    }\n\n    jsonObject.meta.is_verified = jsonObject.meta.isVerified;\n    delete jsonObject.meta.isVerified;\n\n    if (jsonObject.meta.primaryKey) {\n      jsonObject.meta.primary_key = jsonObject.meta.primaryKey;\n      delete jsonObject.meta.primaryKey;\n    }\n\n    return jsonObject;\n  }\n\n  private removeDefaultValues(jsonObject: Record<string, any>, memberName: string): void {\n    if (jsonObject.hasOwnProperty(memberName)) {\n      const isDefaultValue = jsonObject[memberName] === ClientEntity.CONFIG.DEFAULT_VALUE;\n      if (isDefaultValue) {\n        jsonObject[memberName] = '';\n      }\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user/';\n\nexport function constructClientId(userId: QualifiedId, clientId: string): string {\n  const id = typeof userId === 'string' ? userId : userId.id;\n  const baseId = `${id}@${clientId}`;\n  return userId.domain ? `${userId.domain}@${baseId}` : baseId;\n}\n\n/**\n * Splits an ID into user ID, client ID & domain (if any).\n */\nexport function parseClientId(id: string): {clientId: string; domain?: string; userId: string} {\n  // see https://regex101.com/r/c8FtCw/1\n  const regex = /((?<domain>.+)@)?(?<userId>.+)@(?<clientId>.+)$/g;\n  const match = regex.exec(id);\n  const {domain, userId, clientId} = match?.groups || {};\n  return {clientId, domain, userId};\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {PublicClient, RegisteredClient} from '@wireapp/api-client/lib/client';\n\nimport {ClientEntity} from './ClientEntity';\nimport {parseClientId} from './ClientIdUtil';\n\nimport {ClientRecord} from '../storage';\nimport {isClientRecord} from '../util/TypePredicateUtil';\n\nexport class ClientMapper {\n  static get CONFIG() {\n    return {\n      CLIENT_PAYLOAD: ['class', 'id', 'domain'],\n      SELF_CLIENT_PAYLOAD: ['address', 'cookie', 'label', 'location', 'model', 'time', 'type'],\n    };\n  }\n\n  /**\n   * Maps a JSON into a Client entity.\n   *\n   * @param isSelfClient Creating self client\n   * @returns Mapped client entity\n   */\n  static mapClient(\n    clientPayload: ClientRecord | PublicClient | RegisteredClient,\n    isSelfClient: boolean,\n    domain: string = '',\n  ): ClientEntity {\n    const clientEntity = new ClientEntity(isSelfClient, domain);\n\n    ClientMapper.CONFIG.CLIENT_PAYLOAD.forEach(name => ClientMapper._mapMember(clientEntity, clientPayload, name));\n\n    if (isSelfClient) {\n      ClientMapper.CONFIG.SELF_CLIENT_PAYLOAD.forEach(name =>\n        ClientMapper._mapMember(clientEntity, clientPayload, name),\n      );\n    }\n\n    if (isClientRecord(clientPayload)) {\n      const {userId} = parseClientId(clientPayload.meta.primary_key);\n\n      clientEntity.meta.isVerified(clientPayload.meta.is_verified);\n      clientEntity.meta.primaryKey = clientPayload.meta.primary_key;\n      clientEntity.meta.userId = userId;\n    }\n\n    return clientEntity;\n  }\n\n  /**\n   * Maps an object of client IDs with their payloads to client entities.\n   *\n   * @param clientRecords Clients data\n   * @param isSelfClient Creating self client\n   * @returns Mapped client entities\n   */\n  static mapClients(\n    clientRecords: ClientRecord[] | PublicClient[] | RegisteredClient[],\n    isSelfClient: boolean,\n    domain: string | null = null,\n  ): ClientEntity[] {\n    return clientRecords.map(clientRecord => ClientMapper.mapClient(clientRecord, isSelfClient, domain));\n  }\n\n  /**\n   * Update a client entity or object from JSON.\n   *\n   * @param clientData Client data as entity or object\n   * @param updatePayload JSON possibly containing updates\n   * @returns Contains the client and whether there was a change\n   */\n  static updateClient<T extends ClientRecord | ClientEntity>(\n    clientData: T,\n    updatePayload: Partial<T>,\n  ): {client: T; wasUpdated: boolean} {\n    let containsUpdate = false;\n\n    for (const member in updatePayload) {\n      const isDataChange = JSON.stringify(clientData[member]) !== JSON.stringify(updatePayload[member]);\n\n      if (isDataChange) {\n        containsUpdate = true;\n        clientData[member] = updatePayload[member];\n      }\n    }\n\n    return {client: clientData, wasUpdated: containsUpdate};\n  }\n\n  static _mapMember(clientEntity: any, clientPayload: any, memberName: string): void {\n    const payloadValue = clientPayload[memberName];\n    const isMemberUndefined = payloadValue === undefined;\n    if (!isMemberUndefined) {\n      clientEntity[memberName] = payloadValue;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\nimport {singleton} from 'tsyringe';\n\nimport {ClientEntity} from './ClientEntity';\n\n@singleton()\nexport class ClientState {\n  clients: ko.PureComputed<ClientEntity[]>;\n  currentClient: ko.Observable<ClientEntity>;\n  isTemporaryClient: ko.PureComputed<boolean>;\n\n  constructor() {\n    this.currentClient = ko.observable();\n    this.isTemporaryClient = ko.pureComputed(() => this.currentClient()?.isTemporary());\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientCapability, ClientType, PublicClient, RegisteredClient} from '@wireapp/api-client/lib/client/';\nimport {UserClientAddEvent, UserClientRemoveEvent, USER_EVENT} from '@wireapp/api-client/lib/event';\nimport {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {amplify} from 'amplify';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\nimport ko from 'knockout';\nimport murmurhash from 'murmurhash';\nimport {container} from 'tsyringe';\n\nimport {Runtime} from '@wireapp/commons';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {loadValue} from 'Util/StorageUtil';\n\nimport {ClientEntity} from './ClientEntity';\nimport {constructClientId, parseClientId} from './ClientIdUtil';\nimport {ClientMapper} from './ClientMapper';\nimport type {ClientService} from './ClientService';\nimport {ClientState} from './ClientState';\n\nimport {SIGN_OUT_REASON} from '../auth/SignOutReason';\nimport {PrimaryModal} from '../components/Modals/PrimaryModal';\nimport type {CryptographyRepository} from '../cryptography/CryptographyRepository';\nimport type {User} from '../entity/User';\nimport {ClientError} from '../error/ClientError';\nimport {Core} from '../service/CoreSingleton';\nimport {ClientRecord, StorageRepository} from '../storage';\nimport {StorageKey} from '../storage/StorageKey';\n\nexport type UserClientEntityMap = {[userId: string]: ClientEntity[]};\nexport type QualifiedUserClientEntityMap = {[domain: string]: UserClientEntityMap};\n\nexport class ClientRepository {\n  private readonly logger: Logger;\n  public selfUser: ko.Observable<User>;\n\n  static get CONFIG() {\n    return {\n      AVERAGE_NUMBER_OF_CLIENTS: 4,\n    };\n  }\n\n  static get PRIMARY_KEY_CURRENT_CLIENT() {\n    return 'local_identity';\n  }\n\n  constructor(\n    public readonly clientService: ClientService,\n    public readonly cryptographyRepository: CryptographyRepository,\n    private readonly storageRepository: StorageRepository,\n    private readonly clientState = container.resolve(ClientState),\n    private readonly core = container.resolve(Core),\n  ) {\n    this.cryptographyRepository = cryptographyRepository;\n    this.selfUser = ko.observable(undefined);\n    this.logger = getLogger('ClientRepository');\n\n    this.clientState.clients = ko.pureComputed(() => (this.selfUser() ? this.selfUser().devices() : []));\n\n    amplify.subscribe(WebAppEvents.LIFECYCLE.ASK_TO_CLEAR_DATA, this.logoutClient);\n    amplify.subscribe(WebAppEvents.USER.EVENT_FROM_BACKEND, this.onUserEvent);\n  }\n\n  init(selfUser: User): void {\n    this.selfUser(selfUser);\n    this.logger.info(`Initialized repository with user ID '${this.selfUser().id}'`);\n  }\n\n  //##############################################################################\n  // Service interactions\n  //##############################################################################\n\n  private deleteClientFromDb(userId: QualifiedId, clientId: string): Promise<string> {\n    return this.clientService.deleteClientFromDb(constructClientId(userId, clientId));\n  }\n\n  /**\n   * Delete the temporary client on the backend.\n   * @returns Resolves when the temporary client was deleted on the backend\n   */\n  private deleteLocalTemporaryClient() {\n    return this.core.service!.client.deleteLocalClient();\n  }\n\n  /**\n   * Load all known clients from the database.\n   * @returns Resolves with all the clients found in the local database\n   */\n  getAllClientsFromDb(): Promise<{[userId: string]: ClientEntity[]}> {\n    return this.clientService.loadAllClientsFromDb().then(clientRecords => {\n      // TODO(Federation): Add domain to identifier\n      const recipients: {[userId: string]: ClientEntity[]} = {};\n      const skippedUserIds = [this.selfUser().id, ClientRepository.PRIMARY_KEY_CURRENT_CLIENT];\n\n      for (const clientRecord of clientRecords) {\n        const {userId} = parseClientId(clientRecord.meta.primary_key);\n        if (userId && !skippedUserIds.includes(userId)) {\n          recipients[userId] ||= [];\n          recipients[userId].push(ClientMapper.mapClient(clientRecord, false, clientRecord.domain));\n        }\n      }\n      return recipients;\n    });\n  }\n\n  /**\n   * Retrieves meta information about specific client of the self user.\n   * @param clientId ID of client to be retrieved\n   * @returns Resolves with the retrieved client information\n   */\n  private getClientByIdFromBackend(clientId: string): Promise<RegisteredClient> {\n    return this.clientService.getClientById(clientId).catch(error => {\n      const status = error.response?.status;\n      const clientNotFoundBackend = status === HTTP_STATUS.NOT_FOUND;\n      if (clientNotFoundBackend) {\n        this.logger.warn(`Local client '${clientId}' no longer exists on the backend`, error);\n        throw new ClientError(ClientError.TYPE.NO_VALID_CLIENT, ClientError.MESSAGE.NO_VALID_CLIENT);\n      }\n\n      throw error;\n    });\n  }\n\n  /**\n   * Loads a client from the database (if it exists).\n   * @returns Resolves with the local client\n   */\n  private getCurrentClientFromDb(): Promise<ClientEntity> {\n    return this.clientService\n      .loadClientFromDb(ClientRepository.PRIMARY_KEY_CURRENT_CLIENT)\n      .catch(() => {\n        throw new ClientError(ClientError.TYPE.DATABASE_FAILURE, ClientError.MESSAGE.DATABASE_FAILURE);\n      })\n      .then(clientRecord => {\n        if (typeof clientRecord === 'string') {\n          this.logger.info('No local client found in database');\n          throw new ClientError(ClientError.TYPE.NO_VALID_CLIENT, ClientError.MESSAGE.NO_VALID_CLIENT);\n        }\n\n        const currentClient = ClientMapper.mapClient(clientRecord, true, clientRecord.domain);\n        this.clientState.currentClient(currentClient);\n        this.logger.info(`Loaded local client '${currentClient.id}'`, this.clientState.currentClient());\n        return this.clientState.currentClient();\n      });\n  }\n\n  /**\n   * Save a client into the database.\n   *\n   * @param userId ID of user client to be stored belongs to\n   * @param clientPayload Client data to be stored in database\n   * @returns Resolves with the record stored in database\n   */\n  saveClientInDb(userId: QualifiedId, clientPayload: ClientRecord): Promise<ClientRecord> {\n    const primaryKey = constructClientId(userId, clientPayload.id);\n    return this.clientService.saveClientInDb(primaryKey, clientPayload);\n  }\n\n  /**\n   * Updates properties for a client record in database.\n   *\n   * @todo Merge \"meta\" property before updating it, Object.assign(payload.meta, changes.meta)\n   * @param userId Qualified User ID of the client owner\n   * @param clientId Client ID which needs to get updated\n   * @param changes New values which should be updated on the client\n   * @returns Number of updated records\n   */\n  private updateClientInDb(primaryKey: string, changes: Partial<ClientRecord>): Promise<number> {\n    // Preserve primary key on update\n    changes.meta.primary_key = primaryKey;\n    return this.clientService.updateClientInDb(primaryKey, changes);\n  }\n\n  /**\n   * Change verification state of client.\n   *\n   * @param userId User ID of the client owner\n   * @param clientEntity Client which needs to get updated\n   * @param isVerified New state to apply\n   * @returns Resolves when the verification state has been updated\n   */\n  async verifyClient(userId: QualifiedId, clientEntity: ClientEntity, isVerified: boolean): Promise<void> {\n    const primaryKey = clientEntity.meta.primaryKey ?? constructClientId(userId, clientEntity.id);\n    await this.updateClientInDb(primaryKey, {meta: {is_verified: isVerified}});\n    clientEntity.meta.isVerified(isVerified);\n    amplify.publish(WebAppEvents.CLIENT.VERIFICATION_STATE_CHANGED, userId, clientEntity, isVerified);\n  }\n\n  /**\n   * Updates a client payload if it does not fit the current database structure.\n   *\n   * @param userId User ID of the client owner\n   * @param clientPayload Client data to be stored in database\n   * @returns Resolves with the record stored in database\n   */\n  private updateClientSchemaInDb(userId: QualifiedId, clientPayload: PublicClient): Promise<ClientRecord> {\n    const clientRecord: ClientRecord = {\n      ...clientPayload,\n      domain: this.core.backendFeatures.federationEndpoints ? userId.domain : undefined,\n      meta: {\n        is_verified: false,\n        primary_key: constructClientId(userId, clientPayload.id),\n      },\n    };\n    return this.saveClientInDb(userId, clientRecord);\n  }\n\n  //##############################################################################\n  // Login and registration\n  //##############################################################################\n\n  /**\n   * Constructs the key for a cookie label.\n   * @param login Email or phone number of the user\n   * @param clientType Temporary or permanent client type\n   * @returns Cookie label key\n   */\n  constructCookieLabelKey(login: string, clientType: ClientType = this.loadCurrentClientType()): string {\n    const loginHash = murmurhash.v3(login || this.selfUser().id, 42);\n    return `${StorageKey.AUTH.COOKIE_LABEL}@${loginHash}@${clientType}`;\n  }\n\n  /**\n   * Get and validate the local client.\n   * @returns Resolves with an observable containing the client if valid\n   */\n  async getValidLocalClient(): Promise<ko.Observable<ClientEntity>> {\n    try {\n      const clientEntity = await this.getCurrentClientFromDb();\n      const clientPayload = await this.getClientByIdFromBackend(clientEntity.id);\n      this.logger.info(`Client with ID '${clientPayload.id}' (${clientPayload.type}) validated on backend`);\n      const currentClient = this.clientState.currentClient;\n\n      await this.clientService.putClientCapabilities(currentClient().id, {\n        capabilities: [ClientCapability.LEGAL_HOLD_IMPLICIT_CONSENT],\n      });\n\n      return currentClient;\n    } catch (error) {\n      const clientNotValidated = error.type === ClientError.TYPE.NO_VALID_CLIENT;\n      if (!clientNotValidated) {\n        this.logger.error(`Getting valid local client failed: ${error.code || error.message}`, error);\n      }\n\n      throw error;\n    }\n  }\n\n  /**\n   * Load current client type from amplify store.\n   * @returns Type of current client\n   */\n  private loadCurrentClientType(): ClientType.PERMANENT | ClientType.TEMPORARY {\n    if (this.clientState.currentClient()) {\n      return this.clientState.currentClient().type;\n    }\n    const isPermanent = loadValue(StorageKey.AUTH.PERSIST);\n    const type = isPermanent ? ClientType.PERMANENT : ClientType.TEMPORARY;\n    return Runtime.isDesktopApp() ? ClientType.PERMANENT : type;\n  }\n\n  //##############################################################################\n  // Client handling\n  //##############################################################################\n\n  /**\n   * Delete client of a user on backend and removes it locally.\n   *\n   * @param clientId ID of the client that should be deleted\n   * @param password Password entered by user\n   * @returns Resolves with the remaining user devices\n   */\n  async deleteClient(clientId: string, password?: string): Promise<ClientEntity[]> {\n    const selfUser = this.selfUser();\n    await this.core.service!.client.deleteClient(clientId, password);\n    selfUser.removeClient(clientId);\n    amplify.publish(WebAppEvents.USER.CLIENT_REMOVED, selfUser.qualifiedId, clientId);\n    return this.clientState.clients();\n  }\n\n  removeLocalClient(): void {\n    this.storageRepository.deleteCryptographyStores().then(() => {\n      const shouldClearData = this.clientState.currentClient().isTemporary();\n      amplify.publish(WebAppEvents.LIFECYCLE.SIGN_OUT, SIGN_OUT_REASON.CLIENT_REMOVED, shouldClearData);\n    });\n  }\n\n  logoutClient = async (): Promise<void> => {\n    if (this.clientState.currentClient()) {\n      if (this.clientState.isTemporaryClient()) {\n        await this.deleteLocalTemporaryClient();\n        amplify.publish(WebAppEvents.LIFECYCLE.SIGN_OUT, SIGN_OUT_REASON.USER_REQUESTED, true);\n      } else {\n        PrimaryModal.show(PrimaryModal.type.OPTION, {\n          preventClose: true,\n          primaryAction: {\n            action: (clearData: boolean) => {\n              return amplify.publish(WebAppEvents.LIFECYCLE.SIGN_OUT, SIGN_OUT_REASON.USER_REQUESTED, clearData);\n            },\n            text: t('modalAccountLogoutAction'),\n          },\n          text: {\n            option: t('modalAccountLogoutOption'),\n            title: t('modalAccountLogoutHeadline'),\n          },\n        });\n      }\n    }\n  };\n\n  /**\n   * Removes a stored client and the session connected with it.\n   *\n   * @param userId ID of user\n   * @param clientId ID of client to be deleted\n   * @returns Resolves when a client and its session have been deleted\n   */\n  async removeClient(userId: QualifiedId, clientId: string): Promise<string> {\n    await this.cryptographyRepository.deleteSession(userId, clientId);\n    return this.deleteClientFromDb(userId, clientId);\n  }\n\n  /**\n   * Retrieves meta information about all the clients of a given user.\n   * @note If you want to get very detailed information about the devices from the own user, then use `getClients()`.\n   *\n   * @param userIds User IDs to retrieve client information for\n   * @param updateClients Automatically update the clients\n   * @returns Resolves with an array of client entities\n   */\n  async getClientsByUserIds(userIds: QualifiedId[], updateClients: boolean): Promise<QualifiedUserClientEntityMap> {\n    const clientEntityMap: QualifiedUserClientEntityMap = {};\n    const qualifiedUserClientsMap = await this.clientService.getClientsByUserIds(userIds);\n\n    await Promise.all(\n      Object.entries(qualifiedUserClientsMap).map(([domain, userClientMap]) =>\n        Promise.all(\n          Object.entries(userClientMap).map(async ([userId, clients]) => {\n            const isSelfClient = matchQualifiedIds({domain, id: userId}, this.selfUser().qualifiedId);\n            clientEntityMap[domain] ||= {};\n            clientEntityMap[domain][userId] = updateClients\n              ? await this.updateClientsOfUserById({domain, id: userId}, clients, true)\n              : ClientMapper.mapClients(clients, isSelfClient, domain);\n          }),\n        ),\n      ),\n    );\n\n    return clientEntityMap;\n  }\n\n  private async getClientByUserIdFromDb(userQualifiedId: QualifiedId): Promise<ClientRecord[]> {\n    const clients = await this.clientService.loadAllClientsFromDb();\n    return clients.filter(client => {\n      const {userId, domain} = parseClientId(client.meta.primary_key);\n      return matchQualifiedIds({domain, id: userId}, userQualifiedId);\n    });\n  }\n\n  /**\n   * Retrieves meta information about all other locally known clients of the self user.\n   * @returns Resolves with all locally known clients except the current one\n   */\n  async getClientsForSelf(): Promise<ClientEntity[]> {\n    this.logger.info('Retrieving all clients of the self user from database');\n    const {domain, id} = this.selfUser();\n    const clientRecords = await this.getClientByUserIdFromDb({domain, id});\n    const clientEntities = ClientMapper.mapClients(clientRecords, true, domain);\n    clientEntities.forEach(clientEntity => this.selfUser().addClient(clientEntity));\n    return this.selfUser().devices();\n  }\n\n  /**\n   * Is the current client permanent.\n   * @returns Type of current client is permanent\n   */\n  isCurrentClientPermanent(): boolean {\n    if (!this.clientState.currentClient()) {\n      throw new ClientError(ClientError.TYPE.CLIENT_NOT_SET, ClientError.MESSAGE.CLIENT_NOT_SET);\n    }\n    return Runtime.isDesktopApp() || this.clientState.currentClient().isPermanent();\n  }\n\n  /**\n   * Update clients of the self user.\n   * @returns Resolves when the clients have been updated\n   */\n  async updateClientsForSelf(): Promise<ClientEntity[]> {\n    const clientsData = await this.clientService.getClients();\n    const {domain, id} = this.selfUser();\n    return this.updateClientsOfUserById({domain, id}, clientsData, false);\n  }\n\n  /**\n   * Update clients of a user with the given backend data.\n   * @note This function matches clients retrieved from the backend with the data stored in the local database.\n   *   Clients will then be updated with the backend payload in the database and mapped into entities.\n   *\n   * @param userId ID of user whose clients are updated\n   * @param clientsData Clients data from backend\n   * @param publish Change clients using amplify\n   * @returns Resolves with the entities once clients have been updated\n   */\n  private updateClientsOfUserById(\n    userId: QualifiedId,\n    clientsData: RegisteredClient[] | PublicClient[],\n    publish: boolean = true,\n  ): Promise<ClientEntity[]> {\n    const clientsFromBackend: {[clientId: string]: RegisteredClient | PublicClient} = {};\n    const clientsStoredInDb: ClientRecord[] = [];\n    const isSelfUser = matchQualifiedIds(userId, this.selfUser());\n\n    for (const client of clientsData) {\n      clientsFromBackend[client.id] = client;\n    }\n\n    // Find clients in database\n    return this.getClientByUserIdFromDb(userId)\n      .then(clientsFromDatabase => {\n        const promises = [];\n\n        for (const databaseClient of clientsFromDatabase) {\n          const clientId = databaseClient.id;\n          const backendClient = clientsFromBackend[clientId];\n\n          if (backendClient) {\n            const {client, wasUpdated} = ClientMapper.updateClient(databaseClient, {\n              ...backendClient,\n              domain: this.core.backendFeatures.federationEndpoints ? userId.domain : undefined,\n            });\n\n            delete clientsFromBackend[clientId];\n\n            if (this.clientState.currentClient() && this.isCurrentClient(userId, clientId)) {\n              this.logger.warn(`Removing duplicate self client '${clientId}' locally`);\n              this.removeClient(userId, clientId);\n            }\n\n            // Locally known client changed on backend\n            if (wasUpdated) {\n              // Clear the previous client in DB (in case the domain changes the primary key will also change, thus invalidating the previous client)\n              this.clientService.deleteClientFromDb(client.meta.primary_key);\n              this.logger.info(`Updating client '${clientId}' of user '${userId}' locally`);\n              promises.push(this.saveClientInDb(userId, client));\n              continue;\n            }\n\n            // Locally known client unchanged on backend\n            clientsStoredInDb.push(client);\n            continue;\n          }\n\n          // Locally known client deleted on backend\n          this.logger.warn(`Removing client '${clientId}' of user '${userId}' locally`);\n          this.removeClient(userId, clientId);\n        }\n\n        for (const clientId in clientsFromBackend) {\n          const clientPayload = clientsFromBackend[clientId];\n\n          if (this.clientState.currentClient() && this.isCurrentClient(userId, clientId)) {\n            continue;\n          }\n\n          // Locally unknown client new on backend\n          this.logger.info(`New client '${clientId}' of user '${userId}' will be stored locally`);\n          if (matchQualifiedIds(this.selfUser(), userId)) {\n            this.onClientAdd({client: clientPayload as RegisteredClient});\n          }\n          promises.push(this.updateClientSchemaInDb(userId, clientPayload));\n        }\n\n        return Promise.all(promises);\n      })\n      .then(newRecords => ClientMapper.mapClients(clientsStoredInDb.concat(newRecords), isSelfUser, userId.domain))\n      .then(clientEntities => {\n        if (publish) {\n          amplify.publish(WebAppEvents.CLIENT.UPDATE, userId, clientEntities);\n        }\n        return clientEntities;\n      })\n      .catch(error => {\n        this.logger.error(`Unable to retrieve clients for user '${userId}': ${error.message}`, error);\n        throw error;\n      });\n  }\n\n  /**\n   * Check if client is current local client.\n   *\n   * @param userId User ID to be checked\n   * @param clientId ID of client to be checked\n   * @returns Is the client the current local client\n   */\n  private isCurrentClient(userId: QualifiedId, clientId: string): boolean {\n    if (!this.clientState.currentClient()) {\n      throw new ClientError(ClientError.TYPE.CLIENT_NOT_SET, ClientError.MESSAGE.CLIENT_NOT_SET);\n    }\n    if (!userId) {\n      throw new ClientError(ClientError.TYPE.NO_USER_ID, ClientError.MESSAGE.NO_USER_ID);\n    }\n    if (!clientId) {\n      throw new ClientError(ClientError.TYPE.NO_CLIENT_ID, ClientError.MESSAGE.NO_CLIENT_ID);\n    }\n    return matchQualifiedIds(userId, this.selfUser()) && clientId === this.clientState.currentClient().id;\n  }\n\n  //##############################################################################\n  // Conversation Events\n  //##############################################################################\n\n  /**\n   * Listener for incoming user events.\n   *\n   * @param eventJson JSON data for event\n   */\n  private readonly onUserEvent = (eventJson: UserClientAddEvent | UserClientRemoveEvent): void => {\n    if (eventJson.type === USER_EVENT.CLIENT_ADD) {\n      return this.onClientAdd(eventJson);\n    }\n\n    if (eventJson.type === USER_EVENT.CLIENT_REMOVE) {\n      this.onClientRemove(eventJson);\n    }\n  };\n\n  /**\n   * A client was added by the self user.\n   * @param eventJson JSON data of 'user.client-add' event\n   */\n  private onClientAdd(eventJson: Pick<UserClientAddEvent, 'client'>): void {\n    this.logger.info('Client of self user added', eventJson);\n    amplify.publish(WebAppEvents.CLIENT.ADD, this.selfUser().qualifiedId, eventJson.client, true);\n  }\n\n  /**\n   * A client was removed by the self user.\n   * @param JSON data of 'user.client-remove' event\n   * @returns Resolves when the event has been handled\n   */\n  private async onClientRemove(eventJson?: UserClientRemoveEvent): Promise<void> {\n    const clientId = eventJson?.client ? eventJson.client.id : undefined;\n    if (!clientId) {\n      return;\n    }\n\n    const isCurrentClient = clientId === this.clientState.currentClient().id;\n    if (isCurrentClient) {\n      return this.removeLocalClient();\n    }\n    const localClients = await this.getClientsForSelf();\n    const removedClient = localClients.find(client => client.id === clientId);\n    if (removedClient?.isLegalHold()) {\n      PrimaryModal.show(\n        PrimaryModal.type.ACKNOWLEDGE,\n        {\n          text: {\n            message: t('modalLegalHoldDeactivatedMessage'),\n            title: t('modalLegalHoldDeactivatedTitle'),\n          },\n        },\n        'legalHoldDeactivated',\n      );\n    }\n    amplify.publish(WebAppEvents.CLIENT.REMOVE, this.selfUser().qualifiedId, clientId);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {\n  CreateClientPayload,\n  RegisteredClient,\n  QualifiedUserClientMap,\n  ClientCapabilityData,\n  PublicClient,\n} from '@wireapp/api-client/lib/client';\nimport type {QualifiedId} from '@wireapp/api-client/lib/user';\nimport {container} from 'tsyringe';\n\nimport {Logger, getLogger} from 'Util/Logger';\n\nimport {APIClient} from '../service/APIClientSingleton';\nimport type {ClientRecord} from '../storage';\nimport {StorageService} from '../storage';\nimport {StorageSchemata} from '../storage/StorageSchemata';\n\nexport class ClientService {\n  private readonly logger: Logger;\n  private readonly CLIENT_STORE_NAME: string;\n\n  static get URL_CLIENTS(): string {\n    return '/clients';\n  }\n\n  static get URL_USERS(): string {\n    return '/users';\n  }\n\n  constructor(\n    private readonly storageService = container.resolve(StorageService),\n    private readonly apiClient = container.resolve(APIClient),\n  ) {\n    this.logger = getLogger('ClientService');\n\n    this.CLIENT_STORE_NAME = StorageSchemata.OBJECT_STORE.CLIENTS;\n  }\n\n  //##############################################################################\n  // Backend requests\n  //##############################################################################\n\n  /**\n   * Deletes a specific client from a user.\n   * @see https://staging-nginz-https.zinfra.io/swagger-ui/#!/users/deleteClient\n   *\n   * @param clientId ID of client to be deleted\n   * @param password User password\n   * @returns Resolves once the deletion of the client is complete\n   */\n  deleteClient(clientId: string, password: string): Promise<void> {\n    return this.apiClient.api.client.deleteClient(clientId, password);\n  }\n\n  /**\n   * Updates capabilities of a client.\n   *\n   * @param clientId ID of client to be updated\n   * @param clientCapabilities New capabilities of the client\n   * @returns Resolves once the update of the client is complete\n   */\n  putClientCapabilities(clientId: string, clientCapabilities: ClientCapabilityData): Promise<void> {\n    return this.apiClient.api.client.putClient(clientId, clientCapabilities);\n  }\n\n  /**\n   * Retrieves meta information about a specific client.\n   * @see https://staging-nginz-https.zinfra.io/swagger-ui/#!/users/getClients\n   *\n   * @param clientId ID of client to be retrieved\n   * @returns Resolves with the requested client\n   */\n  getClientById(clientId: string): Promise<RegisteredClient> {\n    return this.apiClient.api.client.getClient(clientId);\n  }\n\n  /**\n   * Retrieves meta information about all the clients self user.\n   * @see https://staging-nginz-https.zinfra.io/swagger-ui/#!/users/listClients\n   * @returns Resolves with the clients of the self user\n   */\n  getClients(): Promise<RegisteredClient[]> {\n    return this.apiClient.api.client.getClients();\n  }\n\n  /**\n   * Retrieves meta information about all the clients of a specific user.\n   * @see https://staging-nginz-https.zinfra.io/swagger-ui/#!/users/getClients\n   */\n  async getClientsByUserIds(userIds: QualifiedId[]): Promise<QualifiedUserClientMap> {\n    if (!this.apiClient.backendFeatures.federationEndpoints) {\n      const clientsMap: {[userId: string]: PublicClient[]} = {};\n      for (const {id} of userIds) {\n        clientsMap[id] = await this.apiClient.api.user.getClients(id);\n      }\n      return {'': clientsMap};\n    }\n    const listedClients = await this.apiClient.api.user.postListClients({qualified_users: userIds});\n    return listedClients.qualified_user_map;\n  }\n\n  /**\n   * Register a new client.\n   * @param newClient Client payload\n   * @returns Resolves with the registered client information\n   */\n  postClients(newClient: CreateClientPayload): Promise<RegisteredClient> {\n    return this.apiClient.api.client.postClient(newClient);\n  }\n\n  //##############################################################################\n  // Database requests\n  //##############################################################################\n\n  /**\n   * Removes a client from the database.\n   * @param primaryKey Primary key used to find the client for deletion in the database\n   * @returns Resolves once the client is deleted\n   */\n  deleteClientFromDb(primaryKey: string): Promise<string> {\n    return this.storageService.delete(this.CLIENT_STORE_NAME, primaryKey);\n  }\n\n  /**\n   * Load all clients we have stored in the database.\n   * @returns Resolves with all the clients payloads\n   */\n  loadAllClientsFromDb(): Promise<ClientRecord[]> {\n    return this.storageService.getAll(this.CLIENT_STORE_NAME);\n  }\n\n  /**\n   * Loads a persisted client from the database.\n   * @param primaryKey Primary key used to find a client in the database\n   * @returns Resolves with the client's payload or the primary key if not found\n   */\n  async loadClientFromDb(primaryKey: string): Promise<ClientRecord | string> {\n    let clientRecord;\n\n    if (this.storageService.db) {\n      clientRecord = await this.storageService.db\n        .table(this.CLIENT_STORE_NAME)\n        .where('meta.primary_key')\n        .equals(primaryKey)\n        .first();\n    } else {\n      clientRecord = await this.storageService.load<ClientRecord>(this.CLIENT_STORE_NAME, primaryKey);\n    }\n\n    if (clientRecord === undefined) {\n      this.logger.info(`Client with primary key '${primaryKey}' not found in database`);\n      return primaryKey;\n    }\n\n    this.logger.info(`Loaded client record from database '${primaryKey}'`, clientRecord);\n    return clientRecord;\n  }\n\n  /**\n   * Persists a client.\n   *\n   * @param primaryKey Primary key used to find a client in the database\n   * @param clientPayload Client payload\n   * @returns Resolves with the client payload stored in database\n   */\n  saveClientInDb(primaryKey: string, clientPayload: ClientRecord): Promise<ClientRecord> {\n    if (!clientPayload.meta) {\n      clientPayload.meta = {};\n    }\n\n    clientPayload.meta.primary_key = primaryKey;\n\n    return this.storageService.save(this.CLIENT_STORE_NAME, primaryKey, clientPayload).then(() => {\n      this.logger.info(`Client '${clientPayload.id}' stored with primary key '${primaryKey}'`, clientPayload);\n      return clientPayload;\n    });\n  }\n\n  /**\n   * Updates a persisted client in the database.\n   *\n   * @param primaryKey Primary key used to find a client in the database\n   * @param changes Incremental update changes of the client JSON\n   * @returns Number of updated records (1 if an object was updated, otherwise 0)\n   */\n  updateClientInDb(primaryKey: string, changes: Partial<ClientRecord>): Promise<number> {\n    return this.storageService.update(this.CLIENT_STORE_NAME, primaryKey, changes);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSSObject} from '@emotion/react';\nimport cx from 'classnames';\n\nimport {Availability} from '@wireapp/protocol-messaging';\n\nimport {CSS_SQUARE} from 'Util/CSSMixin';\nimport {KEY} from 'Util/KeyboardUtil';\n\nimport {Icon} from './Icon';\n\nexport interface AvailabilityStateProps {\n  availability: Availability.Type;\n  className?: string;\n  dataUieName: string;\n  label: string;\n  onClick?: (event: React.MouseEvent | React.KeyboardEvent) => void;\n  showArrow?: boolean;\n  theme?: boolean;\n}\n\nconst iconStyles: CSSObject = {\n  ...CSS_SQUARE(10),\n  fill: 'currentColor',\n  margin: '0 6px 1px 0',\n  minWidth: 10,\n  stroke: 'currentColor',\n};\n\nconst buttonCommonStyles: CSSObject = {\n  background: 'none',\n  border: 'none',\n  textTransform: 'uppercase',\n};\n\nconst AvailabilityState: React.FC<AvailabilityStateProps> = ({\n  availability,\n  className,\n  dataUieName,\n  label,\n  showArrow = false,\n  theme = false,\n  onClick,\n}) => {\n  const isAvailable = availability === Availability.Type.AVAILABLE;\n  const isAway = availability === Availability.Type.AWAY;\n  const isBusy = availability === Availability.Type.BUSY;\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLButtonElement>) => {\n    const {key} = event;\n    if (key === KEY.ENTER || key === KEY.SPACE) {\n      const {top, left, height} = (event.target as Element).getBoundingClientRect();\n      const newEvent = new MouseEvent('MouseEvent', {\n        ...event.nativeEvent,\n        clientX: left,\n        clientY: top + height,\n      });\n\n      onClick?.({\n        ...event,\n        nativeEvent: newEvent,\n      } as unknown as React.MouseEvent<Element, MouseEvent>);\n    }\n  };\n\n  const content = (\n    <span data-uie-name={dataUieName} css={{alignItems: 'center', display: 'flex', overflow: 'hidden'}}>\n      {isAvailable && (\n        <Icon.AvailabilityAvailable\n          className=\"availability-state-icon\"\n          css={iconStyles}\n          data-uie-name=\"status-availability-icon\"\n          data-uie-value=\"available\"\n        />\n      )}\n\n      {isAway && (\n        <Icon.AvailabilityAway\n          className=\"availability-state-icon\"\n          css={iconStyles}\n          data-uie-name=\"status-availability-icon\"\n          data-uie-value=\"away\"\n        />\n      )}\n\n      {isBusy && (\n        <Icon.AvailabilityBusy\n          className=\"availability-state-icon\"\n          css={iconStyles}\n          data-uie-name=\"status-availability-icon\"\n          data-uie-value=\"busy\"\n        />\n      )}\n\n      {label && (\n        <span\n          className={cx('availability-state-label', {'availability-state-label--active': theme})}\n          css={{userSelect: 'none'}}\n          data-uie-name=\"status-label\"\n          title={label}\n        >\n          {label}\n        </span>\n      )}\n\n      {showArrow && (\n        <span\n          data-uie-name=\"availability-arrow\"\n          css={{\n            '&::before': {\n              borderLeft: '4px solid transparent',\n              borderRight: '4px solid transparent',\n              borderTop: '4px solid currentColor',\n              content: \"''\",\n              height: 0,\n              width: 0,\n            },\n            alignItems: 'center',\n            display: 'inline-flex',\n            marginLeft: 4,\n            marginTop: 4,\n            paddingBottom: 4,\n            ...CSS_SQUARE(16),\n          }}\n        />\n      )}\n    </span>\n  );\n\n  const wrappedContent = onClick ? (\n    <button\n      type=\"button\"\n      className=\"availability-state-label\"\n      css={\n        theme\n          ? {...buttonCommonStyles, color: 'var(--accent-color)', userSelect: 'none'}\n          : {...buttonCommonStyles, userSelect: 'none'}\n      }\n      data-uie-name=\"status-label\"\n      onClick={onClick}\n      onKeyDown={handleKeyDown}\n    >\n      {content}\n    </button>\n  ) : (\n    content\n  );\n\n  if (className) {\n    return <span className={`availability-state ${className}`}>{wrappedContent}</span>;\n  }\n\n  return wrappedContent;\n};\n\nexport {AvailabilityState};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\n\nexport interface AvatarBackgroundProps {\n  backgroundColor?: string;\n  borderRadius?: string;\n}\n\nconst AvatarBackground: React.FunctionComponent<AvatarBackgroundProps> = ({\n  borderRadius = '50%',\n  backgroundColor = 'currentColor',\n}) => (\n  <div\n    css={{\n      ...CSS_FILL_PARENT,\n      backgroundColor,\n      borderRadius,\n      transform: 'scale(0.9916)',\n    }}\n  />\n);\n\nexport {AvatarBackground};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\n\nexport interface AvatarBorderProps {\n  borderRadius?: string;\n}\n\nconst AvatarBorder: React.FunctionComponent<AvatarBorderProps> = ({borderRadius = '50%'}) => (\n  <div\n    css={{\n      ...CSS_FILL_PARENT,\n      border: '1px solid rgba(0, 0, 0, 0.08)',\n      borderRadius,\n    }}\n  />\n);\n\nexport {AvatarBorder};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {CSSObject} from '@emotion/serialize';\nimport {Transition} from 'react-transition-group';\nimport {container} from 'tsyringe';\n\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\n\nimport {AssetRemoteData} from '../../assets/AssetRemoteData';\nimport {AssetRepository} from '../../assets/AssetRepository';\nimport {AVATAR_SIZE} from '../Avatar';\n\nexport interface AvatarImageProps {\n  assetRepository?: AssetRepository;\n  avatarAlt: string;\n  avatarSize: AVATAR_SIZE;\n  backgroundColor?: string;\n  borderRadius?: string;\n  devicePixelRatio?: number;\n  isGrey?: boolean;\n  mediumPicture: AssetRemoteData;\n  previewPicture: AssetRemoteData;\n}\n\nconst AvatarImage: React.FunctionComponent<AvatarImageProps> = ({\n  assetRepository = container.resolve(AssetRepository),\n  avatarAlt,\n  avatarSize,\n  backgroundColor = 'currentColor',\n  borderRadius = '50%',\n  devicePixelRatio = window.devicePixelRatio,\n  isGrey = false,\n  mediumPicture,\n  previewPicture,\n}) => {\n  const [avatarImage, setAvatarImage] = useState('');\n  const [showTransition, setShowTransition] = useState(false);\n  const [avatarLoadingBlocked, setAvatarLoadingBlocked] = useState(false);\n\n  useEffect(() => {\n    if (!avatarLoadingBlocked) {\n      setAvatarLoadingBlocked(true);\n\n      const isSmall = ![AVATAR_SIZE.LARGE, AVATAR_SIZE.X_LARGE].includes(avatarSize);\n      const loadHiRes = !isSmall && devicePixelRatio > 1;\n      const pictureResource: AssetRemoteData = loadHiRes ? mediumPicture : previewPicture;\n\n      (async () => {\n        if (pictureResource) {\n          const isCached = pictureResource.downloadProgress() === 100;\n          setShowTransition(!isCached && !isSmall);\n          try {\n            const url = await assetRepository.getObjectUrl(pictureResource);\n            if (url) {\n              setAvatarImage(url);\n            }\n            setAvatarLoadingBlocked(false);\n          } catch (error) {\n            console.warn('Failed to load avatar picture.', error);\n          }\n        } else {\n          setAvatarLoadingBlocked(false);\n        }\n      })();\n    }\n  }, [previewPicture, mediumPicture, avatarSize]);\n\n  const transitionImageStyles: Record<string, CSSObject> = {\n    entered: {opacity: 1, transform: 'scale(1)'},\n    entering: {opacity: 1, transform: 'scale(1)'},\n  };\n\n  return (\n    <Transition in={!!avatarImage} timeout={showTransition ? 700 : 0}>\n      {(state: string) => {\n        return (\n          <img\n            css={{\n              ...CSS_FILL_PARENT,\n              backgroundColor,\n              borderRadius,\n              filter: isGrey ? 'grayscale(100%)' : 'none',\n              height: '100%',\n              objectFit: 'cover',\n              opacity: 0,\n              overflow: 'hidden',\n              transform: 'scale(0.88)',\n              transition: showTransition ? 'all 0.55s cubic-bezier(0.165, 0.84, 0.44, 1) 0.15s' : 'none',\n              width: '100%',\n              ...transitionImageStyles[state],\n            }}\n            src={avatarImage}\n            alt={avatarAlt}\n          />\n        );\n      }}\n    </Transition>\n  );\n};\n\nexport {AvatarImage};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSS_SQUARE} from 'Util/CSSMixin';\n\nimport {DIAMETER, AVATAR_SIZE} from '../Avatar';\n\nexport interface AvatarWrapperProps extends React.HTMLProps<HTMLDivElement> {\n  avatarSize: AVATAR_SIZE;\n  color: string;\n  isResponsive?: boolean;\n}\n\nconst AvatarWrapper: React.FunctionComponent<AvatarWrapperProps> = ({\n  color,\n  avatarSize,\n  isResponsive = false,\n  ...props\n}) => {\n  const avatarDiameter = isResponsive ? `${DIAMETER[avatarSize] / 16}rem` : DIAMETER[avatarSize];\n  return (\n    <div\n      css={{\n        ...CSS_SQUARE(avatarDiameter),\n        color,\n        display: 'inline-block',\n        overflow: 'hidden',\n        position: 'relative',\n        transform: 'translateZ(0)',\n        userSelect: 'none',\n      }}\n      role=\"button\"\n      {...props}\n    />\n  );\n};\n\nexport {AvatarWrapper};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport ko from 'knockout';\n\nimport {Icon} from 'Components/Icon';\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\n\nimport {AvatarBackground} from './AvatarBackground';\nimport {AvatarBorder} from './AvatarBorder';\nimport {AvatarImage} from './AvatarImage';\nimport {AvatarWrapper} from './AvatarWrapper';\n\nimport {ServiceEntity} from '../../integration/ServiceEntity';\nimport {AVATAR_SIZE} from '../Avatar';\n\nexport interface ServiceAvatarProps extends React.HTMLProps<HTMLDivElement> {\n  avatarSize: AVATAR_SIZE;\n  onClick?: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  participant: ServiceEntity;\n}\n\nconst ServiceAvatar: React.FunctionComponent<ServiceAvatarProps> = ({participant, avatarSize, onClick, ...props}) => {\n  return (\n    <AvatarWrapper\n      color=\"#fff\"\n      title={ko.unwrap(participant.name)}\n      avatarSize={avatarSize}\n      onClick={onClick}\n      data-uie-name=\"element-avatar-service\"\n      data-uie-value={participant.id}\n      {...props}\n    >\n      <AvatarBackground borderRadius=\"20%\" />\n      <div\n        css={{\n          ...CSS_FILL_PARENT,\n          alignItems: 'center',\n          borderRadius: '20%',\n          display: 'flex',\n          justifyContent: 'center',\n        }}\n        data-uie-name=\"element-avatar-service-icon\"\n      >\n        <Icon.Service\n          css={{\n            '& > path': {\n              fill: 'rgba(141, 152, 159, 0.24)',\n            },\n            width: [AVATAR_SIZE.LARGE, AVATAR_SIZE.X_LARGE].includes(avatarSize) ? '32px' : '60%',\n          }}\n        />\n      </div>\n      <AvatarImage\n        avatarSize={avatarSize}\n        avatarAlt={ko.unwrap(participant.name)}\n        borderRadius=\"20%\"\n        mediumPicture={participant.mediumPictureResource()}\n        previewPicture={participant.previewPictureResource()}\n      />\n      <AvatarBorder borderRadius=\"20%\" />\n    </AvatarWrapper>\n  );\n};\n\nexport {ServiceAvatar};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSS_FILL_PARENT, CSS_FLEX_CENTER, CSS_ICON} from 'Util/CSSMixin';\n\nimport {STATE} from '../Avatar';\n\nexport interface AvatarBadgeProps {\n  state: STATE;\n}\n\nconst AvatarBadge: React.FunctionComponent<AvatarBadgeProps> = ({state}) => {\n  const icons: Record<string, string> = {\n    [STATE.PENDING]: '\\\\e165',\n    [STATE.BLOCKED]: '\\\\e104',\n  };\n  return (\n    <div\n      css={{\n        ...CSS_FILL_PARENT,\n        ...CSS_FLEX_CENTER,\n        '&::before': {\n          ...CSS_ICON(icons[state]),\n        },\n        backgroundColor: 'rgba(0, 0, 0, .56)',\n        borderRadius: '50%',\n        color: '#fff',\n      }}\n      data-uie-name=\"element-avatar-user-badge-icon\"\n      data-uie-value={state}\n    />\n  );\n};\n\nexport {AvatarBadge};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FC} from 'react';\n\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\nimport {getFirstChar} from 'Util/StringUtil';\n\nimport {AVATAR_SIZE, INITIALS_SIZE, DIAMETER} from '../Avatar';\n\nexport interface AvatarInitialsProps {\n  avatarSize: AVATAR_SIZE;\n  initials: string;\n  color?: string;\n  isResponsive?: boolean;\n}\n\nconst AvatarInitials: FC<AvatarInitialsProps> = ({avatarSize, initials, color = '#fff', isResponsive = false}) => (\n  <div\n    css={{\n      ...CSS_FILL_PARENT,\n      color,\n      fontSize: isResponsive ? `${INITIALS_SIZE[avatarSize] / 16}rem` : `${INITIALS_SIZE[avatarSize]}px`,\n      lineHeight: isResponsive ? `${DIAMETER[avatarSize] / 16}rem` : `${DIAMETER[avatarSize]}px`,\n      textAlign: 'center',\n      userSelect: 'none',\n    }}\n    data-uie-name=\"element-avatar-initials\"\n  >\n    {avatarSize === AVATAR_SIZE.X_SMALL ? getFirstChar(initials) : initials}\n  </div>\n);\n\nexport {AvatarInitials};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {MouseEvent as ReactMouseEvent, KeyboardEvent as ReactKeyBoardEvent} from 'react';\n\nimport {COLOR} from '@wireapp/react-ui-kit';\n\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {AvatarBackground} from './AvatarBackground';\nimport {AvatarBadge} from './AvatarBadge';\nimport {AvatarBorder} from './AvatarBorder';\nimport {AvatarImage} from './AvatarImage';\nimport {AvatarInitials} from './AvatarInitials';\nimport {AvatarWrapper} from './AvatarWrapper';\n\nimport {User} from '../../entity/User';\nimport {AVATAR_SIZE, STATE} from '../Avatar';\n\nexport interface UserAvatarProps extends React.HTMLProps<HTMLDivElement> {\n  avatarSize: AVATAR_SIZE;\n  avatarAlt?: string;\n  noBadge?: boolean;\n  noFilter?: boolean;\n  isResponsive?: boolean;\n  onAvatarInteraction?: (\n    event: ReactMouseEvent<HTMLDivElement, MouseEvent> | ReactKeyBoardEvent<HTMLDivElement>,\n  ) => void;\n  participant: User;\n  state: STATE;\n}\n\nexport const shouldShowBadge = (size: AVATAR_SIZE, state: STATE): boolean => {\n  const isTooSmall = [AVATAR_SIZE.X_SMALL, AVATAR_SIZE.XX_SMALL, AVATAR_SIZE.XXX_SMALL].includes(size);\n  const isBadgeState = [STATE.PENDING, STATE.BLOCKED].includes(state);\n  return !isTooSmall && isBadgeState;\n};\n\nconst UserAvatar: React.FunctionComponent<UserAvatarProps> = ({\n  participant,\n  avatarSize,\n  avatarAlt = '',\n  noBadge,\n  noFilter,\n  isResponsive = false,\n  state,\n  onAvatarInteraction,\n  ...props\n}) => {\n  const isImageGrey = !noFilter && [STATE.BLOCKED, STATE.IGNORED, STATE.PENDING, STATE.UNKNOWN].includes(state);\n  const backgroundColor = state === STATE.UNKNOWN ? COLOR.GRAY : undefined;\n  const {\n    mediumPictureResource,\n    previewPictureResource,\n    accent_color: accentColor,\n    name,\n    initials,\n  } = useKoSubscribableChildren(participant, [\n    'mediumPictureResource',\n    'previewPictureResource',\n    'accent_color',\n    'name',\n    'initials',\n  ]);\n  const avatarImgAlt = avatarAlt ? avatarAlt : `${t('userProfileImageAlt')} ${name}`;\n\n  return (\n    <AvatarWrapper\n      avatarSize={avatarSize}\n      color={accentColor}\n      data-uie-name=\"element-avatar-user\"\n      data-uie-value={participant.id}\n      data-uie-status={state}\n      onClick={onAvatarInteraction}\n      onKeyDown={onAvatarInteraction}\n      title={name}\n      isResponsive\n      {...props}\n    >\n      <AvatarBackground backgroundColor={backgroundColor} />\n\n      {initials && <AvatarInitials avatarSize={avatarSize} initials={initials} />}\n      <AvatarImage\n        avatarSize={avatarSize}\n        avatarAlt={avatarImgAlt}\n        backgroundColor={backgroundColor}\n        isGrey={isImageGrey}\n        mediumPicture={mediumPictureResource}\n        previewPicture={previewPictureResource}\n      />\n      {!noBadge && shouldShowBadge(avatarSize, state) && <AvatarBadge state={state} />}\n\n      {!isImageGrey && <AvatarBorder />}\n    </AvatarWrapper>\n  );\n};\n\nexport {UserAvatar};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {CSS_FILL_PARENT} from 'Util/CSSMixin';\n\nimport {AvatarBackground} from './AvatarBackground';\nimport {AvatarBadge} from './AvatarBadge';\nimport {AvatarBorder} from './AvatarBorder';\nimport {AvatarInitials} from './AvatarInitials';\nimport {AvatarWrapper} from './AvatarWrapper';\nimport {shouldShowBadge} from './UserAvatar';\n\nimport {User} from '../../entity/User';\nimport {AVATAR_SIZE, STATE, DIAMETER} from '../Avatar';\n\nexport interface TemporaryGuestAvatarProps extends React.HTMLProps<HTMLDivElement> {\n  avatarSize: AVATAR_SIZE;\n  noBadge?: boolean;\n  onClick?: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  participant: User;\n  isResponsive?: boolean;\n  state: STATE;\n}\n\nconst TemporaryGuestAvatar: React.FunctionComponent<TemporaryGuestAvatarProps> = ({\n  avatarSize,\n  noBadge,\n  onClick,\n  participant,\n  isResponsive = false,\n  state,\n  ...props\n}) => {\n  const borderScale = 0.9916;\n  const finalBorderWidth = avatarSize === AVATAR_SIZE.X_LARGE ? 4 : 1;\n  const remainingTime = participant.expirationRemaining();\n  const normalizedRemainingTime = remainingTime / User.CONFIG.TEMPORARY_GUEST.LIFETIME;\n\n  const borderWidth = (finalBorderWidth / DIAMETER[avatarSize]) * 32;\n  const borderRadius = (16 - borderWidth / 2) * borderScale;\n  const timerLength = borderRadius * Math.PI * 2;\n  const timerOffset = timerLength * (normalizedRemainingTime - 1);\n\n  return (\n    <AvatarWrapper\n      avatarSize={avatarSize}\n      color=\"rgba(50,54,57,0.08)\"\n      data-uie-name=\"element-avatar-temporary-guest\"\n      data-uie-value={participant.id}\n      data-uie-status={state}\n      onClick={onClick}\n      title={participant.name()}\n      isResponsive\n      {...props}\n    >\n      <AvatarBackground />\n      <AvatarInitials\n        color=\"var(--background)\"\n        avatarSize={avatarSize}\n        initials={participant.initials()}\n        isResponsive\n      />\n      {!noBadge && shouldShowBadge(avatarSize, state) && <AvatarBadge state={state} />}\n      <AvatarBorder />\n      <svg\n        aria-hidden=\"true\"\n        css={{\n          ...CSS_FILL_PARENT,\n          position: 'absolute',\n        }}\n        data-uie-name=\"element-avatar-guest-expiration-circle\"\n        viewBox=\"0 0 32 32\"\n        stroke={participant.accent_color()}\n      >\n        <circle\n          cx=\"16\"\n          cy=\"16\"\n          transform=\"rotate(-90 16 16)\"\n          fill=\"none\"\n          strokeDasharray={timerLength}\n          strokeDashoffset={timerOffset}\n          r={borderRadius}\n          strokeWidth={borderWidth}\n        />\n      </svg>\n    </AvatarWrapper>\n  );\n};\n\nexport {TemporaryGuestAvatar};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FC, HTMLProps, MouseEvent as ReactMouseEvent, KeyboardEvent as ReactKeyBoardEvent} from 'react';\n\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {handleKeyDown} from 'Util/KeyboardUtil';\n\nimport {ServiceAvatar} from './avatar/ServiceAvatar';\nimport {TemporaryGuestAvatar} from './avatar/TemporaryGuestAvatar';\nimport {UserAvatar} from './avatar/UserAvatar';\n\nimport {User} from '../entity/User';\nimport {isServiceEntity} from '../guards/Service';\nimport {ServiceEntity} from '../integration/ServiceEntity';\n\nexport enum AVATAR_SIZE {\n  LARGE = 'avatar-l',\n  MEDIUM = 'avatar-m',\n  SMALL = 'avatar-s',\n  X_LARGE = 'avatar-xl',\n  X_SMALL = 'avatar-xs',\n  XX_SMALL = 'avatar-xxs',\n  XXX_SMALL = 'avatar-xxxs',\n}\n\nexport enum STATE {\n  BLOCKED = 'blocked',\n  IGNORED = 'ignored',\n  NONE = '',\n  PENDING = 'pending',\n  SELECTED = 'selected',\n  SELF = 'self',\n  UNKNOWN = 'unknown',\n}\n\nexport const DIAMETER = {\n  [AVATAR_SIZE.LARGE]: 72,\n  [AVATAR_SIZE.MEDIUM]: 40,\n  [AVATAR_SIZE.SMALL]: 28,\n  [AVATAR_SIZE.X_LARGE]: 200,\n  [AVATAR_SIZE.X_SMALL]: 24,\n  [AVATAR_SIZE.XX_SMALL]: 20,\n  [AVATAR_SIZE.XXX_SMALL]: 16,\n};\n\nexport const INITIALS_SIZE = {\n  [AVATAR_SIZE.LARGE]: 24,\n  [AVATAR_SIZE.MEDIUM]: 16,\n  [AVATAR_SIZE.SMALL]: 11,\n  [AVATAR_SIZE.X_LARGE]: 32,\n  [AVATAR_SIZE.X_SMALL]: 11,\n  [AVATAR_SIZE.XX_SMALL]: 11,\n  [AVATAR_SIZE.XXX_SMALL]: 8,\n};\n\nexport interface AvatarProps extends HTMLProps<HTMLDivElement> {\n  participant: User | ServiceEntity;\n  avatarSize?: AVATAR_SIZE;\n  avatarAlt?: string;\n  noBadge?: boolean;\n  noFilter?: boolean;\n  isResponsive?: boolean;\n  onAvatarClick?: (participant: User | ServiceEntity, target: Node) => void;\n}\n\nconst Avatar: FC<AvatarProps> = ({\n  avatarSize = AVATAR_SIZE.LARGE,\n  noBadge = false,\n  noFilter = false,\n  onAvatarClick,\n  participant,\n  isResponsive = false,\n  ...props\n}) => {\n  const handleAvatarInteraction = (\n    event: ReactMouseEvent<HTMLDivElement, MouseEvent> | ReactKeyBoardEvent<HTMLDivElement>,\n  ) => {\n    const parentNode = event.currentTarget.parentNode;\n    if (parentNode) {\n      if ('key' in event) {\n        handleKeyDown(event, () => onAvatarClick?.(participant, parentNode));\n        return;\n      }\n      onAvatarClick?.(participant, parentNode);\n    }\n  };\n\n  const {isTemporaryGuest, isTeamMember, isBlocked, isRequest, isIgnored, isCanceled, isUnknown} =\n    // @ts-ignore\n    useKoSubscribableChildren(participant, [\n      'isTemporaryGuest',\n      'isTeamMember',\n      'isBlocked',\n      'isRequest',\n      'isIgnored',\n      'isCanceled',\n      'isUnknown',\n    ]);\n\n  if (isServiceEntity(participant)) {\n    return (\n      <ServiceAvatar avatarSize={avatarSize} participant={participant} onClick={handleAvatarInteraction} {...props} />\n    );\n  }\n\n  const isMe = participant?.isMe;\n\n  let avatarState = STATE.NONE;\n\n  if (isMe) {\n    avatarState = STATE.SELF;\n  } else if (isTeamMember) {\n    avatarState = STATE.NONE;\n  } else if (isBlocked) {\n    avatarState = STATE.BLOCKED;\n  } else if (isRequest) {\n    avatarState = STATE.PENDING;\n  } else if (isIgnored) {\n    avatarState = STATE.IGNORED;\n  } else if (isCanceled || isUnknown) {\n    avatarState = STATE.UNKNOWN;\n  }\n\n  if (isTemporaryGuest) {\n    return (\n      <TemporaryGuestAvatar\n        avatarSize={avatarSize}\n        noBadge={noBadge}\n        onClick={handleAvatarInteraction}\n        participant={participant}\n        isResponsive\n        state={avatarState}\n        {...props}\n      />\n    );\n  }\n\n  return (\n    <UserAvatar\n      avatarSize={avatarSize}\n      noBadge={noBadge}\n      noFilter={noFilter}\n      onAvatarInteraction={handleAvatarInteraction}\n      participant={participant}\n      isResponsive\n      state={avatarState}\n      {...props}\n    />\n  );\n};\n\nexport {Avatar};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {splitFingerprint} from 'Util/StringUtil';\n\nexport interface DeviceIdProps {\n  deviceId: string;\n}\n\nconst DeviceId: React.FC<DeviceIdProps> = ({deviceId}) => {\n  return (\n    <>\n      {splitFingerprint(deviceId).map((id, index) => (\n        <span key={`${index}-${id}`} className=\"device-id-part\" data-uie-name=\"element-device-id-part\">\n          {id}\n        </span>\n      ))}\n    </>\n  );\n};\n\nexport {DeviceId};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {getAllSVGs} from '../auth/util/SVGProvider';\n\ntype IconProps = React.SVGProps<SVGSVGElement>;\n\ntype IconList = Record<string, React.FC<IconProps>>;\n\ninterface NamedIconProps extends IconProps {\n  name: string;\n}\n\nconst normalizeIconName = (name: string) =>\n  name\n    .replace(/-icon$/, '')\n    .replace(/\\b\\w/g, found => found.toUpperCase())\n    .replace(/-/g, '');\n\nconst createSvgComponent = (svg: HTMLElement, displayName: string): React.FC<IconProps> => {\n  const SVGComponent: React.FC<IconProps> = oProps => {\n    const viewBox = svg.getAttribute('viewBox');\n    if (!viewBox) {\n      console.error('Svg icon must have a viewBox attribute');\n    }\n    const regex = /0 0 (?<width>\\d+) (?<height>\\d+)/;\n    const {width, height} = regex.exec(viewBox).groups;\n\n    const props = {\n      height: oProps.height ?? height,\n      viewBox,\n      width: oProps.width ?? width,\n      ...oProps,\n    };\n\n    return <svg {...props} aria-hidden=\"true\" dangerouslySetInnerHTML={{__html: svg.innerHTML}} />;\n  };\n  SVGComponent.displayName = displayName;\n  return SVGComponent;\n};\n\nconst icons = Object.entries(getAllSVGs()).reduce<IconList>((list, [key, svg]) => {\n  const name = normalizeIconName(key);\n  return Object.assign(list, {[name]: createSvgComponent(svg.documentElement, `Icon.${name}`)});\n}, {});\n\nconst IconComponent: React.FC<NamedIconProps> = ({name, ...props}) => {\n  const componentName = normalizeIconName(name);\n  const Component = icons[componentName];\n  if (!Component) {\n    return null;\n  }\n  return <Component {...props} />;\n};\n\nconst Icon = Object.assign(IconComponent, icons);\n\nexport {Icon};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport create from 'zustand';\n\nimport {User} from '../../../../entity/User';\n\ntype TypingUser = {\n  conversationId: string;\n  user: User;\n  timerId: number;\n};\n\ntype TypingIndicatorState = {\n  typingUsers: TypingUser[];\n  addTypingUser: (user: TypingUser) => void;\n  removeTypingUser: (user: User, conversationId: string) => void;\n  getTypingUsersInConversation: (conversationId: string) => User[];\n  clearTypingUsers: () => void;\n  getTypingUser: (user: User, conversationId: string) => TypingUser | undefined;\n};\n\nconst useTypingIndicatorState = create<TypingIndicatorState>((set, get) => ({\n  typingUsers: [],\n  addTypingUser: ({conversationId, user, timerId}) =>\n    set(state => {\n      if (\n        state.typingUsers.find(\n          typingUser => typingUser.conversationId === conversationId && typingUser.user.id === user.id,\n        )\n      ) {\n        return state;\n      }\n      return {typingUsers: [...state.typingUsers, {conversationId, user, timerId}]};\n    }),\n  getTypingUser: (user, conversationId) =>\n    get().typingUsers.find(\n      typingUser => typingUser.conversationId === conversationId && typingUser.user.id === user.id,\n    ),\n  removeTypingUser: (user, conversationId) =>\n    set(state => ({\n      typingUsers: state.typingUsers.filter(\n        typingUser => !(typingUser.conversationId === conversationId && typingUser.user.id === user.id),\n      ),\n    })),\n  getTypingUsersInConversation: conversationId =>\n    get()\n      .typingUsers.filter(typingUser => typingUser.conversationId === conversationId)\n      .map(typingUser => typingUser.user),\n  clearTypingUsers: () => set({typingUsers: []}),\n}));\n\nexport {useTypingIndicatorState};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {css, CSSObject, keyframes} from '@emotion/react';\n\nexport const wrapperStyles: CSSObject = {\n  display: 'flex',\n  alignItems: 'center',\n  marginLeft: 15,\n  color: 'var(--text-input-placeholder)',\n  fontSize: 'var(--font-size-xsmall)',\n  fontWeight: 500,\n  paddingTop: '0.125rem',\n  backgroundColor: 'var(--app-bg)',\n  padding: '0.3125rem',\n  position: 'absolute',\n  top: '-1.625rem',\n  borderTopLeftRadius: 4,\n  borderTopRightRadius: 4,\n  'div:first-of-type': {\n    img: {\n      border: '1px solid var(--gray-40)',\n    },\n  },\n};\n\nexport const indicatorAnimationWrapperStyles: CSSObject = {\n  width: '2.375rem',\n  height: '1rem',\n  marginLeft: 2,\n  position: 'relative',\n  bottom: '0.1875rem',\n};\n\nconst animationStyles: CSSObject = {\n  animationFillMode: 'forwards',\n  animationDirection: 'normal',\n  animationIterationCount: 'infinite',\n  animationTimingFunction: 'linear',\n  animationDuration: '1.4s',\n};\n\nconst dotStyles: CSSObject = {\n  ...animationStyles,\n  position: 'absolute',\n  width: 2,\n  height: 2,\n  backgroundColor: 'var(--text-input-placeholder)',\n  borderRadius: '100%',\n  bottom: 0,\n  transformBox: 'fill-box',\n  transformOrigin: '50% 50%',\n};\n\nconst editIconKeyFrams = keyframes({\n  '0%': {\n    transform: 'translateX(0px) rotate(0deg)',\n  },\n  '9%': {transform: 'translateX(2px) rotate(-5deg)'},\n  '34%': {transform: 'translateX(5px) rotate(5deg)'},\n  '59%': {transform: 'translateX(7px) rotate(-5deg)'},\n  '84%': {transform: 'translateX(12px) rotate(5deg)'},\n  '100%': {transform: 'translateX(12px) rotate(5deg)'},\n});\n\nconst dot1KeyFrames = keyframes({\n  '0%': {opacity: 0},\n  '4%': {opacity: 0},\n  '84%': {opacity: 1},\n  '100%': {opacity: 1},\n});\n\nconst dot2KeyFrames = keyframes({\n  '0%': {opacity: 0},\n  '29%': {opacity: 0},\n  '84%': {opacity: 1},\n  '100%': {opacity: 1},\n});\n\nconst dot3KeyFrames = keyframes({\n  '0%': {opacity: 0},\n  '54%': {opacity: 0},\n  '84%': {opacity: 1},\n  '100%': {opacity: 1},\n});\n\nexport const editIconStyles = css`\n  animation: ${editIconKeyFrams};\n  bottom: 0;\n  fill: var(--text-input-placeholder);\n  ${animationStyles}\n  position: absolute;\n`;\n\nexport const dotOneStyles = css`\n  animation: ${dot1KeyFrames};\n  left: 0;\n  ${dotStyles};\n`;\n\nexport const dotTwoStyles = css`\n  animation: ${dot2KeyFrames};\n  left: 4px;\n  ${dotStyles};\n`;\n\nexport const dotThreeStyles = css`\n  animation: ${dot3KeyFrames};\n  left: 8px;\n  ${dotStyles};\n`;\n\nexport const indicatorTitleStyles = css`\n  height: var(--icon-size-sm);\n  position: relative;\n  top: 1px;\n`;\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FC} from 'react';\n\nimport {Avatar, AVATAR_SIZE} from 'Components/Avatar';\nimport {Icon} from 'Components/Icon';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {useTypingIndicatorState} from './TypingIndicator.state';\nimport {\n  dotOneStyles,\n  dotThreeStyles,\n  dotTwoStyles,\n  editIconStyles,\n  indicatorAnimationWrapperStyles,\n  indicatorTitleStyles,\n  wrapperStyles,\n} from './TypingIndicator.styles';\n\nexport interface TypingIndicatorProps {\n  conversationId: string;\n}\n\nconst TypingIndicator: FC<TypingIndicatorProps> = ({conversationId}) => {\n  const users = useTypingIndicatorState(state => state.getTypingUsersInConversation(conversationId));\n  const usersCount = users.length;\n\n  if (usersCount === 0) {\n    return null;\n  }\n\n  return (\n    <div css={wrapperStyles} data-uie-name=\"typing-indicator\">\n      <div aria-hidden css={{display: 'flex', marginRight: 8}}>\n        {users.slice(0, 3).map((user, index) => (\n          <Avatar\n            key={user.id}\n            className=\"cursor-default\"\n            style={index > 0 ? {marginLeft: -8} : {}}\n            participant={user}\n            avatarSize={AVATAR_SIZE.XXX_SMALL}\n            isResponsive\n          />\n        ))}\n      </div>\n      <p css={indicatorTitleStyles} data-uie-name=\"typing-indicator-title\">\n        {usersCount === 1 && t('tooltipConversationInputOneUserTyping', {user1: users[0].name()}, undefined, true)}\n        {usersCount === 2 &&\n          t(\n            'tooltipConversationInputTwoUserTyping',\n            {\n              user1: users[0].name(),\n              user2: users[1].name(),\n            },\n            undefined,\n            true,\n          )}\n        {usersCount > 2 &&\n          t(\n            'tooltipConversationInputMoreThanTwoUserTyping',\n            {\n              user1: users[0].name(),\n              count: (usersCount - 1).toString(),\n            },\n            undefined,\n            true,\n          )}\n      </p>\n      <div css={indicatorAnimationWrapperStyles}>\n        <div css={dotOneStyles} />\n        <div css={dotTwoStyles} />\n        <div css={dotThreeStyles} />\n        <Icon.Edit width={10} height={10} css={editIconStyles} />\n      </div>\n    </div>\n  );\n};\n\nexport {TypingIndicator};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nexport * from './TypingIndicator';\n\nexport {useTypingIndicatorState} from './TypingIndicator.state';\n\nexport const TYPING_TIMEOUT = TIME_IN_MILLIS.SECOND * 10;\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\n\nimport {Icon} from 'Components/Icon';\nimport {useLegalHoldModalState} from 'Components/Modals/LegalHoldModal/LegalHoldModal.state';\nimport {t} from 'Util/LocalizerUtil';\n\nimport type {Conversation} from '../entity/Conversation';\n\nexport interface LegalHoldDotProps {\n  isInteractive?: boolean;\n  className?: string;\n  conversation?: Conversation;\n  dataUieName?: string;\n  isPending?: boolean;\n  isMessage?: boolean;\n  large?: boolean;\n  showText?: boolean;\n}\n\nconst LegalHoldDot: React.FC<LegalHoldDotProps> = ({\n  isInteractive = false,\n  conversation,\n  isPending,\n  isMessage = false,\n  large,\n  showText = false,\n  className = '',\n  dataUieName = 'legal-hold-dot-pending-icon',\n}) => {\n  const {showRequestModal, showUsers} = useLegalHoldModalState(state => state);\n\n  const onClick = (event: React.MouseEvent) => {\n    event.stopPropagation();\n\n    if (isPending) {\n      showRequestModal(false, true);\n\n      return;\n    }\n\n    showUsers(false, conversation);\n  };\n\n  return (\n    <button\n      id=\"legal-hold-button-interactive\"\n      type=\"button\"\n      className=\"legal-hold-dot-button legal-hold-dot-button--interactive\"\n      onClick={onClick}\n      data-uie-name={dataUieName}\n      disabled={!isInteractive}\n    >\n      <span\n        className={cx(\n          'legal-hold-dot',\n          {\n            'legal-hold-dot--active': !isPending,\n            'legal-hold-dot--interactive': isInteractive,\n            'legal-hold-dot--large': large,\n            'legal-hold-dot--message': isMessage,\n          },\n          className,\n        )}\n      >\n        {isPending && <Icon.Pending className=\"pending-icon\" />}\n      </span>\n\n      {showText && <span className=\"visibility-hidden legal-hold-dot--text\">{t('legalHoldHeadline')}</span>}\n    </button>\n  );\n};\n\nexport {LegalHoldDot};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useMemo} from 'react';\n\nimport {TabIndex} from '@wireapp/react-ui-kit/lib/types/enums';\n\nconst useMessageFocusedTabIndex = (isMessageFocused: boolean) => {\n  const tabIndex = useMemo(() => (isMessageFocused ? TabIndex.FOCUSABLE : TabIndex.UNFOCUSABLE), [isMessageFocused]);\n\n  return tabIndex;\n};\n\nexport {useMessageFocusedTabIndex};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useId, useRef, useState, useCallback} from 'react';\n\nimport {CSSObject} from '@emotion/react';\nimport {TabIndex} from '@wireapp/react-ui-kit/lib/types/enums';\n\nimport {noop, preventFocusOutside} from 'Util/util';\n\nimport {Icon} from './Icon';\n\ninterface ModalComponentProps {\n  children: React.ReactNode;\n  isShown: boolean;\n  id?: string;\n  className?: string;\n  onBgClick?: () => void;\n  onClosed?: () => void;\n  showLoading?: boolean;\n  wrapperCSS?: CSSObject;\n}\n\nconst ModalOverlayStyles: CSSObject = {\n  alignItems: 'center',\n  backgroundColor: 'rgba(0,0,0, 0.64)',\n  bottom: 0,\n  justifyContent: 'center',\n  left: 0,\n  opacity: 0,\n  overflowX: 'hidden',\n  overflowY: 'auto',\n  position: 'fixed',\n  right: 0,\n  top: 0,\n  transition: 'opacity 0.15s cubic-bezier(0.165, 0.84, 0.44, 1)',\n  zIndex: 10000000,\n};\n\nconst ModalOverlayVisibleStyles: CSSObject = {\n  ...ModalOverlayStyles,\n  opacity: 1,\n  transition: 'opacity 0.25s cubic-bezier(0.165, 0.84, 0.44, 1)',\n};\n\nconst ModalContentStyles: CSSObject = {\n  animation: 'scaleIn 0.35s cubic-bezier(0.165, 0.84, 0.44, 1)',\n  backgroundColor: 'var(--modal-bg)',\n  border: 'var(--modal-border-color)',\n  borderRadius: 4,\n  cursor: 'default',\n  display: 'flex',\n  flexDirection: 'column',\n  fontSize: '0.875rem',\n  margin: 'auto',\n  maxHeight: 615,\n  overflow: 'hidden',\n  overflowY: 'auto',\n  padding: 16,\n  position: 'relative',\n  transform: 'scale(0.8)',\n  transition: 'transform 0.35s cubic-bezier(0.165, 0.84, 0.44, 1)',\n  width: 384,\n};\n\nconst ModalContentVisibleStyles: CSSObject = {\n  ...ModalContentStyles,\n  transform: 'scale(1)',\n};\n\nconst ModalComponent: React.FC<ModalComponentProps> = ({\n  id,\n  className = '',\n  isShown,\n  onBgClick = noop,\n  onClosed = noop,\n  showLoading = false,\n  wrapperCSS,\n  children,\n  ...rest\n}) => {\n  const [displayNone, setDisplayNone] = useState<boolean>(!isShown);\n  const hasVisibleClass = isShown && !displayNone;\n  const isMounting = useRef<boolean>(true);\n  const trapId = useId();\n\n  const trapFocus = useCallback(\n    (event: KeyboardEvent): void => {\n      preventFocusOutside(event, trapId);\n    },\n    [trapId],\n  );\n\n  useEffect(() => {\n    if (isShown) {\n      document.addEventListener('keydown', trapFocus);\n    } else {\n      document.removeEventListener('keydown', trapFocus);\n    }\n    return () => {\n      document.removeEventListener('keydown', trapFocus);\n    };\n  }, [isShown, onkeydown]);\n\n  useEffect(() => {\n    let timeoutId = 0;\n    const mounting = isMounting.current;\n    isMounting.current = false;\n    if (isShown) {\n      return setDisplayNone(false);\n    }\n\n    if (mounting) {\n      // Avoid triggering the onClose event when component is mounting\n      return;\n    }\n\n    timeoutId = window.setTimeout(() => {\n      setDisplayNone(true);\n      onClosed();\n    }, 150);\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [isShown]);\n\n  return (\n    <div\n      onClick={onBgClick}\n      css={hasVisibleClass ? ModalOverlayVisibleStyles : ModalOverlayStyles}\n      style={{display: displayNone ? 'none' : 'flex'}}\n      tabIndex={TabIndex.FOCUSABLE}\n      role=\"button\"\n      onKeyDown={noop}\n      id={id}\n      className={className}\n      {...rest}\n    >\n      {showLoading ? (\n        <Icon.Loading width=\"48\" height=\"48\" css={{path: {fill: 'var(--modal-bg)'}}} />\n      ) : (\n        <div\n          id={trapId}\n          onClick={event => event.stopPropagation()}\n          role=\"button\"\n          tabIndex={TabIndex.UNFOCUSABLE}\n          onKeyDown={noop}\n          css={{...(hasVisibleClass ? ModalContentVisibleStyles : ModalContentStyles), ...wrapperCSS}}\n        >\n          {hasVisibleClass ? children : null}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport {ModalComponent};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport create from 'zustand';\n\nimport {LegalHoldModalType} from 'Components/Modals/LegalHoldModal/LegalHoldModal';\nimport {splitFingerprint} from 'Util/StringUtil';\n\nimport {Conversation} from '../../../entity/Conversation';\nimport {User} from '../../../entity/User';\n\ntype LegalHoldModalState = {\n  type: LegalHoldModalType | null;\n  isOpen: boolean;\n  isLoading: boolean;\n  users: User[];\n  isSelfInfo: boolean;\n  isInitialized: boolean;\n  closeModal: () => void;\n  setType: (type: LegalHoldModalType | null) => void;\n  setUsers: (users: User[]) => void;\n  setIsModalOpen: (isOpen: boolean) => void;\n  setIsLoading: (isLoading: boolean) => void;\n  showRequestModal: (initialize?: boolean, showLoading?: boolean, fingerprint?: string) => void;\n  setFingerprint: (fingerprint?: string) => void;\n  closeRequestModal: (conversationId?: string) => void;\n  showUsers: (initialize?: boolean, conversation?: Conversation | null) => void;\n  conversationId?: string;\n  fingerprint?: string;\n  conversation?: Conversation | null;\n};\n\nconst legalHoldModalDefaultState: Partial<LegalHoldModalState> = {\n  conversation: null,\n  conversationId: '',\n  fingerprint: '',\n  isLoading: false,\n  isOpen: false,\n  isSelfInfo: false,\n  type: null,\n  users: [],\n};\n\nconst useLegalHoldModalState = create<LegalHoldModalState>((set, get) => ({\n  closeModal: () =>\n    set(state => ({\n      ...state,\n      ...legalHoldModalDefaultState,\n    })),\n  closeRequestModal: (conversationId = '') => {\n    if (conversationId !== get().conversationId) {\n      return;\n    }\n\n    return set(state => ({\n      ...state,\n      ...legalHoldModalDefaultState,\n    }));\n  },\n  conversation: null,\n  conversationId: '',\n  fingerprint: '',\n  isInitialized: false,\n  isLoading: false,\n  isOpen: false,\n  isSelfInfo: false,\n  setFingerprint: fingerprint => {\n    const formattedFingerprint = fingerprint\n      ? splitFingerprint(fingerprint)\n          .map(part => `<span>${part} </span>`)\n          .join('')\n      : '';\n\n    return set(state => ({\n      ...state,\n      fingerprint: formattedFingerprint,\n      isOpen: !!formattedFingerprint,\n    }));\n  },\n  setIsLoading: isLoading =>\n    set(state => ({\n      ...state,\n      isLoading,\n    })),\n  setIsModalOpen: isOpen =>\n    set(state => ({\n      ...state,\n      isOpen,\n    })),\n  setType: type =>\n    set(state => ({\n      ...state,\n      type,\n    })),\n  setUsers: users =>\n    set(state => ({\n      ...state,\n      users,\n    })),\n  showRequestModal: (initialize = false, showLoading = false, fingerprint) => {\n    const formattedFingerprint = fingerprint\n      ? splitFingerprint(fingerprint)\n          .map(part => `<span>${part} </span>`)\n          .join('')\n      : '';\n\n    return set(state => ({\n      ...state,\n      fingerprint: formattedFingerprint,\n      isInitialized: initialize,\n      isLoading: showLoading,\n      isOpen: showLoading || !!formattedFingerprint,\n      type: LegalHoldModalType.REQUEST,\n    }));\n  },\n  showUsers: (initialize = false, conversation) =>\n    set(state => ({\n      ...state,\n      conversation,\n      conversationId: conversation?.id || 'self',\n      isInitialized: initialize,\n      isLoading: true,\n      isOpen: true,\n      isSelfInfo: !conversation,\n      type: LegalHoldModalType.USERS,\n    })),\n  type: null,\n  users: [],\n}));\n\nexport {useLegalHoldModalState};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FC, useCallback, useEffect, useRef, useState} from 'react';\n\nimport {LegalHoldMemberStatus} from '@wireapp/api-client/lib/team/legalhold/';\nimport cx from 'classnames';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\n\nimport {Icon} from 'Components/Icon';\nimport {LegalHoldDot} from 'Components/LegalHoldDot';\nimport {ModalComponent} from 'Components/ModalComponent';\nimport {useUserDevicesHistory, UserDevicesState, UserDevices} from 'Components/UserDevices';\nimport {UserSearchableList} from 'Components/UserSearchableList';\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {handleEnterDown} from 'Util/KeyboardUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {useLegalHoldModalState} from './LegalHoldModal.state';\n\nimport {ClientRepository} from '../../../client';\nimport {ConversationRepository} from '../../../conversation/ConversationRepository';\nimport {MessageRepository} from '../../../conversation/MessageRepository';\nimport {CryptographyRepository} from '../../../cryptography/CryptographyRepository';\nimport {User} from '../../../entity/User';\nimport {SearchRepository} from '../../../search/SearchRepository';\nimport {TeamRepository} from '../../../team/TeamRepository';\nimport {UserState} from '../../../user/UserState';\n\nconst DISABLE_SUBMIT_TEXT_LENGTH = 1;\n\nexport enum LegalHoldModalType {\n  REQUEST = 'request',\n  USERS = 'users',\n}\n\nexport interface LegalHoldModalProps {\n  clientRepository: ClientRepository;\n  conversationRepository: ConversationRepository;\n  cryptographyRepository: CryptographyRepository;\n  messageRepository: MessageRepository;\n  searchRepository: SearchRepository;\n  teamRepository: TeamRepository;\n  userState: UserState;\n}\n\nconst LegalHoldModal: FC<LegalHoldModalProps> = ({\n  userState,\n  conversationRepository,\n  searchRepository,\n  teamRepository,\n  clientRepository,\n  cryptographyRepository,\n  messageRepository,\n}) => {\n  const skipShowUsersRef = useRef(false);\n\n  const {\n    fingerprint,\n    setFingerprint,\n    closeModal,\n    closeRequestModal,\n    type,\n    setType,\n    isLoading,\n    isOpen,\n    setIsLoading,\n    isInitialized,\n    setIsModalOpen,\n    conversation: currentConversation,\n    isSelfInfo,\n    users,\n    setUsers,\n  } = useLegalHoldModalState();\n\n  const isRequest = type === LegalHoldModalType.REQUEST;\n  const isUsers = type === LegalHoldModalType.USERS;\n\n  const [isPending, setIsPending] = useState<boolean>(false);\n  const [isSendingApprove, setIsSendingApprove] = useState<boolean>(false);\n  const [passwordValue, setPasswordValue] = useState<string>('');\n  const [requestError, setRequestError] = useState<string>('');\n  const [userDevices, setUserDevices] = useState<User | undefined>(undefined);\n\n  const {self: selfUser} = useKoSubscribableChildren(userState, ['self']);\n\n  const requiresPassword = isRequest && !selfUser.isNoPasswordSSO;\n  const disableSubmit = requiresPassword && passwordValue.length < DISABLE_SUBMIT_TEXT_LENGTH;\n\n  const userDevicesHistory = useUserDevicesHistory();\n  const showDeviceList = userDevicesHistory.current.state === UserDevicesState.DEVICE_LIST;\n\n  const onClose = useCallback(() => {\n    closeModal();\n\n    setUserDevices(undefined);\n    setPasswordValue('');\n    setRequestError('');\n  }, []);\n\n  const onBgClick = useCallback(() => {\n    if (!isRequest) {\n      onClose();\n    }\n  }, [isRequest]);\n\n  const onBackClick = () => {\n    if (!showDeviceList) {\n      return userDevicesHistory.goBack();\n    }\n\n    setUserDevices(undefined);\n  };\n\n  const closeRequest = () => {\n    if (isRequest) {\n      closeRequestModal();\n    }\n  };\n\n  const acceptRequest = async () => {\n    if (disableSubmit) {\n      return;\n    }\n\n    setRequestError('');\n    setIsSendingApprove(true);\n\n    try {\n      if (!selfUser.teamId) {\n        return;\n      }\n\n      const password = requiresPassword ? passwordValue : undefined;\n      // @ts-ignore Need to check if it will work with undefined password for SSO login\n      await teamRepository.teamService.sendLegalHoldApproval(selfUser.teamId, selfUser.id, password);\n      selfUser.hasPendingLegalHold(false);\n\n      await clientRepository.updateClientsForSelf();\n\n      setIsSendingApprove(false);\n      skipShowUsersRef.current = true;\n      closeRequest();\n      setUserDevices(undefined);\n      setPasswordValue('');\n      setRequestError('');\n    } catch ({code, message}) {\n      switch (code) {\n        case HTTP_STATUS.BAD_REQUEST: {\n          setRequestError(t('BackendError.LABEL.BAD_REQUEST'));\n          break;\n        }\n        case HTTP_STATUS.FORBIDDEN: {\n          setRequestError(t('BackendError.LABEL.ACCESS_DENIED'));\n          break;\n        }\n        default: {\n          setRequestError(message as string);\n        }\n      }\n\n      setIsSendingApprove(false);\n    }\n  };\n\n  const showRequestModal = useCallback(async () => {\n    const setModalParams = (value: boolean) => {\n      setIsModalOpen(value);\n      setIsLoading(value);\n\n      if (!value) {\n        setType(null);\n      }\n    };\n\n    if (isLoading) {\n      setModalParams(true);\n    }\n\n    if (!selfUser.inTeam()) {\n      setModalParams(false);\n\n      return;\n    }\n\n    if (!fingerprint && selfUser.teamId) {\n      const response = await teamRepository.teamService.getLegalHoldState(selfUser.teamId, selfUser.id);\n      if (response.status === LegalHoldMemberStatus.PENDING) {\n        const newFingerprint = await cryptographyRepository.getRemoteFingerprint(\n          selfUser,\n          response.client.id,\n          response.last_prekey,\n        );\n        selfUser.hasPendingLegalHold(true);\n        setFingerprint(newFingerprint);\n        setIsModalOpen(true);\n        setIsLoading(false);\n      } else {\n        setModalParams(false);\n\n        if (!isInitialized) {\n          setType(LegalHoldModalType.USERS);\n        }\n      }\n    }\n  }, [\n    isInitialized,\n    cryptographyRepository,\n    fingerprint,\n    isLoading,\n    selfUser,\n    setFingerprint,\n    setIsLoading,\n    setIsModalOpen,\n    teamRepository.teamService,\n  ]);\n\n  const checkLegalHoldState = useCallback(async () => {\n    if (!selfUser.teamId) {\n      return;\n    }\n\n    const response = await teamRepository.teamService.getLegalHoldState(selfUser.teamId, selfUser.id);\n    const isPendingStatus = response.status === LegalHoldMemberStatus.PENDING;\n\n    if (isPendingStatus) {\n      setIsPending(isPendingStatus);\n      setIsModalOpen(true);\n    }\n  }, [selfUser.id, selfUser.teamId, teamRepository.teamService]);\n\n  useEffect(() => {\n    if (type) {\n      checkLegalHoldState();\n    }\n  }, [type, checkLegalHoldState]);\n\n  useEffect(() => {\n    if (isPending && isOpen && isRequest) {\n      showRequestModal();\n    }\n  }, [isPending, showRequestModal, isOpen, isRequest]);\n\n  // Show users\n  const getLegalHoldUsers = useCallback(async () => {\n    if (skipShowUsersRef.current) {\n      skipShowUsersRef.current = false;\n\n      closeModal();\n\n      return;\n    }\n\n    if (currentConversation) {\n      await messageRepository.updateAllClients(currentConversation, false);\n      const allUsers = await conversationRepository.getAllUsersInConversation(currentConversation);\n      const legalHoldUsers = allUsers.filter(user => user.isOnLegalHold());\n\n      if (!legalHoldUsers.length) {\n        setIsModalOpen(false);\n\n        return;\n      }\n\n      setUsers(legalHoldUsers);\n    } else {\n      setUsers([selfUser]);\n    }\n\n    setIsLoading(false);\n    setIsModalOpen(true);\n  }, [conversationRepository, currentConversation, messageRepository, selfUser]);\n\n  useEffect(() => {\n    if (isOpen && isUsers) {\n      getLegalHoldUsers();\n    }\n  }, [getLegalHoldUsers, isOpen, isUsers]);\n\n  return (\n    <ModalComponent\n      isShown={isOpen}\n      onBgClick={onBgClick}\n      onClosed={onClose}\n      data-uie-name=\"legal-hold-modal\"\n      showLoading={isLoading}\n      id=\"legal-hold-modal\"\n      className=\"legal-hold-modal\"\n    >\n      <div className=\"modal__header\">\n        {userDevices && (\n          <button\n            className=\"button-reset-default modal__header__button modal__header__button__left\"\n            type=\"button\"\n            onClick={onBackClick}\n            data-uie-name=\"go-back-participant-devices\"\n          >\n            <Icon.ArrowLeft />\n          </button>\n        )}\n\n        {isRequest ? (\n          <h2 className=\"modal__header__title\" data-uie-name=\"status-modal-title\">\n            {t('legalHoldModalTitle')}\n          </h2>\n        ) : (\n          <button className=\"button-reset-default modal__header__button\" data-uie-name=\"do-close\" onClick={onBgClick}>\n            <Icon.Close />\n          </button>\n        )}\n      </div>\n\n      <div className={cx('modal__body legal-hold-modal__wrapper', {'legal-hold-modal__wrapper--request': isRequest})}>\n        {isRequest && (\n          <>\n            <div className=\"modal__text\" data-uie-name=\"status-modal-text\">\n              <p\n                dangerouslySetInnerHTML={{\n                  __html: t(\n                    'legalHoldModalText',\n                    {},\n                    {\n                      br: '<br>',\n                      fingerprint: `<span class=\"legal-hold-modal__fingerprint\" data-uie-name=\"status-modal-fingerprint\">${fingerprint}</span>`,\n                    },\n                  ),\n                }}\n              />\n\n              {requiresPassword && <div>{t('legalHoldModalTextPassword')}</div>}\n            </div>\n\n            {requiresPassword && (\n              <input\n                className=\"modal__input\"\n                type=\"password\"\n                value={passwordValue}\n                placeholder={t('login.passwordPlaceholder')}\n                onChange={ev => setPasswordValue(ev.target.value)}\n                onKeyDown={ev => handleEnterDown(ev, acceptRequest)}\n              />\n            )}\n\n            {requestError && (\n              <div className=\"modal__input__error\" data-uie-name=\"status-error\">\n                {requestError}\n              </div>\n            )}\n\n            <div className=\"modal__buttons\">\n              <button\n                type=\"button\"\n                className=\"modal__button modal__button--secondary\"\n                data-uie-name=\"do-secondary\"\n                onClick={closeRequest}\n              >\n                {t('legalHoldModalSecondaryAction')}\n              </button>\n\n              {!isSendingApprove ? (\n                <button\n                  type=\"button\"\n                  className={cx('modal__button modal__button--primary', {'modal__button--disabled': disableSubmit})}\n                  data-uie-name=\"do-action\"\n                  onClick={acceptRequest}\n                >\n                  {t('legalHoldModalPrimaryAction')}\n                </button>\n              ) : (\n                <div className=\"modal__button modal__button--primary legal-hold-modal__loading-button\">\n                  <Icon.Loading />\n                </div>\n              )}\n            </div>\n          </>\n        )}\n\n        {!isRequest && (\n          <>\n            {!userDevices ? (\n              <>\n                <div className=\"legal-hold-modal__logo\">\n                  <LegalHoldDot large dataUieName=\"status-modal-legal-hold-icon\" />\n                </div>\n\n                <div className=\"legal-hold-modal__headline\" data-uie-name=\"status-modal-title\">\n                  {t('legalHoldHeadline')}\n                </div>\n\n                <p\n                  className=\"legal-hold-modal__info\"\n                  data-uie-name=\"status-modal-text\"\n                  dangerouslySetInnerHTML={{\n                    __html: isSelfInfo ? t('legalHoldDescriptionSelf') : t('legalHoldDescriptionOthers'),\n                  }}\n                />\n\n                <div className=\"legal-hold-modal__subjects\">{t('legalHoldSubjects')}</div>\n\n                <UserSearchableList\n                  users={users}\n                  userState={userState}\n                  conversationRepository={conversationRepository}\n                  searchRepository={searchRepository}\n                  teamRepository={teamRepository}\n                  onClick={setUserDevices}\n                  noUnderline\n                />\n              </>\n            ) : (\n              <UserDevices\n                clientRepository={clientRepository}\n                cryptographyRepository={cryptographyRepository}\n                messageRepository={messageRepository}\n                user={userDevices as User}\n                current={userDevicesHistory.current}\n                goTo={userDevicesHistory.goTo}\n                noPadding\n              />\n            )}\n          </>\n        )}\n      </div>\n    </ModalComponent>\n  );\n};\n\nexport {LegalHoldModal};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {isValid} from 'date-fns';\nimport create from 'zustand';\n\nimport {replaceLink, t} from 'Util/LocalizerUtil';\nimport {getLogger} from 'Util/Logger';\nimport {formatLocale} from 'Util/TimeUtil';\nimport {noop, createRandomUuid} from 'Util/util';\n\nimport {Action, ModalContent, ModalItem, ModalOptions, ModalQueue, PrimaryModalType, Text} from './PrimaryModalTypes';\n\nimport {Config} from '../../../Config';\nimport {ClientNotificationData} from '../../../notification/PreferenceNotificationRepository';\n\ntype PrimaryModalState = {\n  errorMessage: string | null;\n  queue: ModalQueue;\n  currentModalContent: ModalContent;\n  currentModalId: string | null;\n  existsInQueue: (modalItem: ModalItem) => boolean;\n  addToQueue: (modalItem: ModalItem) => void;\n  removeFirstItemInQueue: () => void;\n  replaceInQueue: (modalItem: ModalItem) => void;\n  updateCurrentModalId: (nextCurrentModalId: string | null) => void;\n  updateErrorMessage: (nextErrorMessage: string | null) => void;\n  updateCurrentModalContent: (nextCurrentModaContent: ModalContent) => void;\n};\n\nconst defaultContent: ModalContent = {\n  checkboxLabel: '',\n  closeBtnTitle: '',\n  closeFn: noop,\n  currentType: '',\n  inputPlaceholder: '',\n  messageHtml: '',\n  messageText: '',\n  modalUie: '',\n  onBgClick: noop,\n  primaryAction: {} as Action,\n  secondaryAction: [],\n  titleText: '',\n};\n\nconst logger = getLogger('PrimaryModalState');\n\nconst usePrimaryModalState = create<PrimaryModalState>((set, get) => ({\n  addToQueue: (modalItem: ModalItem) => set(state => ({...state, queue: [...state.queue, modalItem]})),\n  currentModalContent: defaultContent,\n  currentModalId: null,\n  errorMessage: null,\n  existsInQueue: (modalItem: ModalItem): boolean =>\n    get().queue.findIndex(queueItem => queueItem.id === modalItem.id) !== -1,\n  queue: [],\n  removeFirstItemInQueue: () => set(state => ({...state, queue: state.queue.slice(1)})),\n  replaceInQueue: (modalItem: ModalItem) =>\n    set(state => ({\n      ...state,\n      queue: state.queue.map(queueItem => (queueItem.id === modalItem.id ? modalItem : queueItem)),\n    })),\n  updateCurrentModalContent: nextCurrentModaContent =>\n    set(state => ({...state, currentModalContent: nextCurrentModaContent})),\n  updateCurrentModalId: (nextCurrentModalId: string | null) =>\n    set(state => ({...state, currentModalId: nextCurrentModalId})),\n  updateErrorMessage: nextErrorMessage => set(state => ({...state, errorMessage: nextErrorMessage})),\n}));\n\nconst addNewModalToQueue = (type: PrimaryModalType, options: ModalOptions, modalId = createRandomUuid()): void => {\n  const {currentModalId, existsInQueue, addToQueue, replaceInQueue} = usePrimaryModalState.getState();\n\n  const alreadyOpen = modalId === currentModalId;\n  if (alreadyOpen) {\n    return showNextModalInQueue();\n  }\n  const newModal = {id: modalId, options, type};\n  const found = modalId && existsInQueue(newModal);\n  if (found) {\n    replaceInQueue(newModal);\n  } else {\n    addToQueue(newModal);\n  }\n\n  showNextModalInQueue();\n};\n\nconst showNextModalInQueue = (): void => {\n  const {queue, currentModalId, removeFirstItemInQueue} = usePrimaryModalState.getState();\n  if (currentModalId) {\n    // we already have a modal open which is awaiting a manual user action\n    return;\n  }\n  if (queue.length > 0) {\n    const nextModalToShow = queue[0];\n    const {type, options, id} = nextModalToShow;\n    updateCurrentModalContent(type, options, id);\n    removeFirstItemInQueue();\n  }\n};\n\nconst updateCurrentModalContent = (type: PrimaryModalType, options: ModalOptions = {}, id?: string): void => {\n  if (!Object.values(PrimaryModalType).includes(type)) {\n    return logger.warn(`Modal of type '${type}' is not supported`);\n  }\n\n  const {\n    closeOnConfirm = true,\n    close = noop,\n    data,\n    preventClose = false,\n    primaryAction,\n    secondaryAction,\n    hideSecondary,\n    showClose = false,\n    text = {} as Text,\n  } = options;\n\n  const content = {\n    checkboxLabel: text.option ?? '',\n    closeBtnTitle: text.closeBtnLabel,\n    closeFn: close,\n    closeOnConfirm,\n    currentType: type,\n    inputPlaceholder: text.input ?? '',\n    messageHtml: text.htmlMessage ?? '',\n    messageText: text.message ?? '',\n    modalUie: type,\n    onBgClick: preventClose ? noop : removeCurrentModal,\n    primaryAction: primaryAction ?? null,\n    secondaryAction: secondaryAction ?? null,\n    showClose,\n    titleText: text.title ?? '',\n  };\n\n  switch (type) {\n    case PrimaryModalType.ACCOUNT_NEW_DEVICES: {\n      content.titleText = t('modalAccountNewDevicesHeadline');\n      content.primaryAction = {...primaryAction, text: t('modalAcknowledgeAction')};\n      content.secondaryAction = {...secondaryAction, text: t('modalAccountNewDevicesSecondary')};\n      content.messageText = t('modalAccountNewDevicesMessage');\n      const deviceList = (data as ClientNotificationData[])\n        .map(device => {\n          const deviceDate = new Date(device.time);\n          const deviceTime = isValid(deviceDate) ? new Date(deviceDate) : new Date();\n          const formattedDate = formatLocale(deviceTime, 'PP, p');\n          const deviceModel = `${t('modalAccountNewDevicesFrom')} ${escape(device.model)}`;\n          return `<div>${formattedDate} - UTC</div><div>${deviceModel}</div>`;\n        })\n        .join('');\n      content.messageHtml = `<div class=\"modal__content__device-list\">${deviceList}</div>`;\n      break;\n    }\n    case PrimaryModalType.ACCOUNT_READ_RECEIPTS_CHANGED: {\n      content.primaryAction = {...primaryAction, text: t('modalAcknowledgeAction')};\n      content.titleText = data\n        ? t('modalAccountReadReceiptsChangedOnHeadline')\n        : t('modalAccountReadReceiptsChangedOffHeadline');\n      content.messageText = t('modalAccountReadReceiptsChangedMessage');\n      break;\n    }\n    case PrimaryModalType.ACKNOWLEDGE: {\n      content.primaryAction = {text: t('modalAcknowledgeAction'), ...primaryAction};\n      content.titleText = text.title || t('modalAcknowledgeHeadline');\n      content.messageText = (!text.htmlMessage && text.message) || '';\n      break;\n    }\n    case PrimaryModalType.CONFIRM: {\n      content.secondaryAction = {text: t('modalConfirmSecondary'), ...content.secondaryAction};\n      break;\n    }\n    case PrimaryModalType.INPUT:\n    case PrimaryModalType.PASSWORD:\n    case PrimaryModalType.OPTION: {\n      if (!hideSecondary) {\n        content.secondaryAction = {text: t('modalOptionSecondary'), ...content.secondaryAction};\n      }\n      break;\n    }\n    case PrimaryModalType.SESSION_RESET: {\n      content.titleText = t('modalSessionResetHeadline');\n      content.primaryAction = {...primaryAction, text: t('modalAcknowledgeAction')};\n      content.messageHtml = t('modalSessionResetMessage', {}, replaceLink(Config.getConfig().URL.SUPPORT.BUG_REPORT));\n      break;\n    }\n  }\n  if (content.secondaryAction) {\n    const updatedSecondaryAction = Array.isArray(content.secondaryAction)\n      ? content.secondaryAction\n      : [content.secondaryAction];\n    // force it into array format\n    const uieNames = ['do-secondary', 'do-tertiary', 'do-quaternary'];\n    content.secondaryAction = updatedSecondaryAction.map((action, index) => {\n      const uieName = uieNames[index] || 'do-remaining';\n      return {...action, uieName};\n    });\n  }\n\n  const {updateCurrentModalContent, updateCurrentModalId} = usePrimaryModalState.getState();\n  updateCurrentModalContent(content);\n  updateCurrentModalId(id ?? null);\n};\n\nconst removeCurrentModal = (): void => {\n  const {currentModalContent, updateCurrentModalId} = usePrimaryModalState.getState();\n\n  currentModalContent?.closeFn();\n  updateCurrentModalId(null);\n};\n\nexport {usePrimaryModalState, defaultContent, addNewModalToQueue, showNextModalInQueue, removeCurrentModal};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientNotificationData} from '../../../notification/PreferenceNotificationRepository';\n\nexport interface Action {\n  action?: Function;\n  uieName?: string;\n  text?: string;\n}\n\nexport interface Text {\n  htmlMessage?: string;\n  input?: string;\n  message?: string;\n  option?: string;\n  title?: string;\n  closeBtnLabel?: string;\n}\n\nexport interface ModalOptions {\n  close?: () => void;\n  closeOnConfirm?: boolean;\n  /** Content needed for visualization on modal */\n  data?: ClientNotificationData[] | boolean;\n  hideSecondary?: boolean;\n  /** Set to `true` to disable autoclose behavior */\n  preventClose?: boolean;\n  /** Called when action in modal is triggered */\n  primaryAction?: Action;\n  /** Called when secondary action in modal is triggered */\n  secondaryAction?: Action[] | Action;\n  showClose?: boolean;\n  text?: Text;\n}\n\nexport enum PrimaryModalType {\n  ACCOUNT_NEW_DEVICES = 'modal-account-new-devices',\n  ACCOUNT_READ_RECEIPTS_CHANGED = 'modal-account-read-receipts-changed',\n  ACKNOWLEDGE = 'modal-template-acknowledge',\n  CONFIRM = 'modal-template-confirm',\n  INPUT = 'modal-template-input',\n  MULTI_ACTIONS = 'modal-multi-actions',\n  OPTION = 'modal-template-option',\n  PASSWORD = 'modal-template-password',\n  SESSION_RESET = 'modal-session-reset',\n}\n\nexport interface ModalContent {\n  checkboxLabel: string;\n  closeFn: () => void;\n  closeOnConfirm?: boolean;\n  currentType: string;\n  inputPlaceholder: string;\n  messageHtml: string;\n  messageText: string;\n  modalUie: string;\n  onBgClick: () => void;\n  primaryAction: Action | null;\n  secondaryAction: Action[] | Action | null;\n  titleText: string;\n  closeBtnTitle?: string;\n}\n\nexport type ModalItem = {id: string; options: ModalOptions; type: PrimaryModalType};\n\nexport type ModalQueue = ModalItem[];\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {addNewModalToQueue, showNextModalInQueue} from './PrimaryModalState';\nimport {PrimaryModalType} from './PrimaryModalTypes';\n\nexport {removeCurrentModal, usePrimaryModalState} from './PrimaryModalState';\nexport {PrimaryModal};\n\nconst PrimaryModal = {\n  init: (): void => {\n    showNextModalInQueue();\n  },\n  show: addNewModalToQueue,\n  type: PrimaryModalType,\n};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {ClientClassification} from '@wireapp/api-client/lib/client';\nimport cx from 'classnames';\n\nimport {DeviceId} from 'Components/DeviceId';\nimport {useMessageFocusedTabIndex} from 'Components/MessagesList/Message/util';\nimport {handleKeyDown} from 'Util/KeyboardUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport type {ClientEntity} from '../../client/ClientEntity';\nimport {Icon} from '../Icon';\nimport {LegalHoldDot} from '../LegalHoldDot';\nimport {VerifiedIcon} from '../VerifiedIcon';\n\nexport interface DeviceCardProps {\n  click?: (device: ClientEntity) => void;\n  device: ClientEntity;\n  showIcon?: boolean;\n  showVerified?: boolean;\n}\n\nconst DeviceCard: React.FC<DeviceCardProps> = ({\n  click,\n  device: clientEntity,\n  showVerified = false,\n  showIcon = false,\n}) => {\n  const messageFocusedTabIndex = useMessageFocusedTabIndex(!!click);\n  const {class: deviceClass = '?', id = '', label = '?', meta} = clientEntity;\n  const name = clientEntity.getName();\n  const clickable = !!click;\n  const isVerified = meta.isVerified;\n  const showLegalHoldIcon = showIcon && deviceClass === ClientClassification.LEGAL_HOLD;\n  const showDesktopIcon = showIcon && deviceClass === ClientClassification.DESKTOP;\n  const showMobileIcon = showIcon && !showLegalHoldIcon && !showDesktopIcon;\n\n  const clickOnDevice = () => {\n    if (clickable) {\n      click(clientEntity);\n    }\n  };\n\n  return (\n    <div\n      role={clickable ? 'button' : undefined}\n      tabIndex={messageFocusedTabIndex}\n      className={cx('device-card', {'device-card__no-hover': !clickable})}\n      onClick={clickOnDevice}\n      onKeyDown={e => handleKeyDown(e, clickOnDevice)}\n      data-uie-uid={id}\n      data-uie-name=\"device-card\"\n    >\n      {showLegalHoldIcon && (\n        <LegalHoldDot\n          className=\"device-card__icon device-card__legal_hold_icon\"\n          dataUieName=\"status-legal-hold-device\"\n        />\n      )}\n      {showDesktopIcon && <Icon.Desktop className=\"device-card__icon\" data-uie-name=\"status-desktop-device\" />}\n      {showMobileIcon && <Icon.Devices className=\"device-card__icon\" data-uie-name=\"status-mobile-device\" />}\n      <div className=\"device-card__info\" data-uie-name=\"device-card-info\" data-uie-value={label}>\n        <div className=\"label-xs\">\n          <span className=\"device-card__model\">{name}</span>\n        </div>\n        <p className=\"text-background label-xs\">\n          <span>{t('preferencesDevicesId')}</span>\n          <span data-uie-name=\"device-id\">\n            <DeviceId deviceId={id} />\n          </span>\n        </p>\n      </div>\n      {showVerified && <VerifiedIcon isVerified={!!isVerified && isVerified()} />}\n      {clickable && <Icon.ChevronRight className=\"disclose-icon\" data-uie-name=\"disclose-icon\" />}\n    </div>\n  );\n};\n\nexport {DeviceCard};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useMemo, useState} from 'react';\n\nimport cx from 'classnames';\nimport type {DexieError} from 'dexie';\nimport {container} from 'tsyringe';\n\nimport {Icon} from 'Components/Icon';\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport type {Logger} from 'Util/Logger';\n\nimport {DeviceCard} from './DeviceCard';\n\nimport type {ClientRepository, ClientEntity} from '../../client';\nimport {Config} from '../../Config';\nimport {ConversationState} from '../../conversation/ConversationState';\nimport type {MessageRepository} from '../../conversation/MessageRepository';\nimport type {CryptographyRepository} from '../../cryptography/CryptographyRepository';\nimport type {User} from '../../entity/User';\nimport {MotionDuration} from '../../motion/MotionDuration';\nimport {DeviceId} from '../DeviceId';\n\ninterface DeviceDetailsProps {\n  clickToShowSelfFingerprint: () => void;\n  clientRepository: ClientRepository;\n  conversationState?: ConversationState;\n  cryptographyRepository: CryptographyRepository;\n  logger: Logger;\n  messageRepository: MessageRepository;\n  noPadding: boolean;\n  selectedClient: ClientEntity;\n  user: User;\n}\n\nconst DeviceDetails: React.FC<DeviceDetailsProps> = ({\n  selectedClient,\n  cryptographyRepository,\n  user,\n  clickToShowSelfFingerprint,\n  clientRepository,\n  messageRepository,\n  noPadding,\n  logger,\n  conversationState = container.resolve(ConversationState),\n}) => {\n  const [fingerprintRemote, setFingerprintRemote] = useState<string>();\n  const [isResettingSession, setIsResettingSession] = useState(false);\n\n  const clientMeta = useMemo(() => selectedClient?.meta, [selectedClient]);\n\n  const {isVerified} = useKoSubscribableChildren(clientMeta, ['isVerified']);\n  const {name: userName} = useKoSubscribableChildren(user, ['name']);\n\n  useEffect(() => {\n    setFingerprintRemote(undefined);\n    if (selectedClient) {\n      cryptographyRepository\n        .getRemoteFingerprint(user.qualifiedId, selectedClient.id)\n        .then(remoteFingerprint => setFingerprintRemote(remoteFingerprint));\n    }\n  }, [selectedClient]);\n\n  const clickToToggleDeviceVerification = () => {\n    const toggleVerified = !isVerified;\n    clientRepository\n      .verifyClient(user.qualifiedId, selectedClient, toggleVerified)\n      .catch((error: DexieError) => logger.warn(`Failed to toggle client verification: ${error.message}`));\n  };\n\n  const clickToResetSession = () => {\n    const _resetProgress = () => window.setTimeout(() => setIsResettingSession(false), MotionDuration.LONG);\n    const conversation = user.isMe\n      ? conversationState.getSelfProteusConversation()\n      : conversationState.activeConversation();\n    setIsResettingSession(true);\n    if (conversation) {\n      messageRepository\n        .resetSession(user.qualifiedId, selectedClient.id, conversation)\n        .then(_resetProgress)\n        .catch(_resetProgress);\n    }\n  };\n\n  const isMLSConversation = !!conversationState.activeConversation()?.isUsingMLSProtocol;\n\n  return (\n    <div className={cx('participant-devices__header', {'participant-devices__header--padding': !noPadding})}>\n      <button\n        type=\"button\"\n        className=\"button-reset-default participant-devices__link participant-devices__show-self-fingerprint accent-text\"\n        onClick={clickToShowSelfFingerprint}\n      >\n        {t('participantDevicesDetailShowMyDevice')}\n      </button>\n      <p\n        className=\"panel__info-text\"\n        dangerouslySetInnerHTML={{\n          __html: user ? t('participantDevicesDetailHeadline', {user: userName}) : '',\n        }}\n      />\n      <a\n        className=\"participant-devices__link accent-text\"\n        href={Config.getConfig().URL.SUPPORT.PRIVACY_VERIFY_FINGERPRINT}\n        rel=\"nofollow noopener noreferrer\"\n        target=\"_blank\"\n      >\n        {t('participantDevicesDetailHowTo')}\n      </a>\n      <div className=\"participant-devices__single-client\">\n        <DeviceCard device={selectedClient} />\n      </div>\n      {fingerprintRemote && (\n        <div className=\"participant-devices__fingerprint\" data-uie-name=\"status-fingerprint\">\n          <DeviceId deviceId={fingerprintRemote} />\n        </div>\n      )}\n\n      <div className=\"participant-devices__verify\">\n        <div className=\"slider\" data-uie-name=\"do-toggle-verified\">\n          <input\n            className=\"slider-input\"\n            type=\"checkbox\"\n            name=\"toggle\"\n            id=\"toggle\"\n            defaultChecked={isVerified}\n            onChange={clickToToggleDeviceVerification}\n          />\n\n          <label className=\"button-label\" htmlFor=\"toggle\">\n            <span className=\"button-label__switch\" />\n            <span className=\"button-label__text\">{t('participantDevicesDetailVerify')}</span>\n          </label>\n        </div>\n\n        <div className=\"participant-devices__actions\">\n          <Icon.Loading\n            className=\"accent-fill\"\n            style={{display: isResettingSession ? 'initial' : 'none'}}\n            data-uie-name=\"status-loading\"\n          />\n          {!isMLSConversation && (\n            <button\n              type=\"button\"\n              className=\"button-reset-default button-label participant-devices__reset-session accent-text ellipsis\"\n              onClick={clickToResetSession}\n              style={{display: isResettingSession ? 'none' : 'initial'}}\n              data-uie-name=\"do-reset-session\"\n            >\n              {t('participantDevicesDetailResetSession')}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport {DeviceDetails};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\n\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {DeviceCard} from './DeviceCard';\n\nimport type {ClientEntity} from '../../client/ClientEntity';\nimport {Config} from '../../Config';\nimport type {User} from '../../entity/User';\nimport {getPrivacyWhyUrl} from '../../externalRoute';\n\ninterface DeviceListProps {\n  clickOnDevice: (client: ClientEntity) => void;\n  clients: ClientEntity[];\n  noPadding: boolean;\n  user: User;\n}\n\nconst DeviceList: React.FC<DeviceListProps> = ({user, noPadding, clients, clickOnDevice}) => {\n  const {name: userName} = useKoSubscribableChildren(user, ['name']);\n\n  return (\n    <>\n      <div className={cx('participant-devices__header', {'participant-devices__header--padding': !noPadding})}>\n        <p className=\"participant-devices__text-block panel__info-text\" data-uie-name=\"status-devices-headline\">\n          {user ? t('participantDevicesHeadline', {brandName: Config.getConfig().BRAND_NAME, user: userName}) : ''}\n        </p>\n\n        <a\n          className=\"participant-devices__link accent-text\"\n          href={getPrivacyWhyUrl()}\n          rel=\"nofollow noopener noreferrer\"\n          target=\"_blank\"\n        >\n          {t('participantDevicesWhyVerify')}\n        </a>\n      </div>\n\n      <ul className=\"participant-devices__device-list\">\n        {clients.map(client => (\n          <li\n            key={client.id}\n            className={cx('participant-devices__device-item', {\n              'participant-devices__device-item--padding': !noPadding,\n            })}\n            data-uie-name=\"item-device\"\n          >\n            <DeviceCard device={client} click={() => clickOnDevice(client)} showVerified showIcon />\n          </li>\n        ))}\n      </ul>\n    </>\n  );\n};\n\nexport {DeviceList};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\n\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {Config} from '../../Config';\nimport type {User} from '../../entity/User';\nimport {getPrivacyPolicyUrl} from '../../externalRoute';\n\ninterface NoDevicesFoundProps {\n  noPadding: boolean;\n  user: User;\n}\n\nconst NoDevicesFound: React.FC<NoDevicesFoundProps> = ({user, noPadding}) => {\n  const {name: userName} = useKoSubscribableChildren(user, ['name']);\n\n  return (\n    <div className={cx('participant-devices__header', {'participant-devices__header--padding': !noPadding})}>\n      <p className=\"participant-devices__text-block panel__info-text\" data-uie-name=\"status-devices-headline\">\n        {user\n          ? t('participantDevicesOutdatedClientMessage', {\n              brandName: Config.getConfig().BRAND_NAME,\n              user: userName,\n            })\n          : ''}\n      </p>\n      <a\n        className=\"participant-devices__link accent-text\"\n        href={getPrivacyPolicyUrl()}\n        rel=\"nofollow noopener noreferrer\"\n        target=\"_blank\"\n      >\n        {t('participantDevicesLearnMore')}\n      </a>\n    </div>\n  );\n};\n\nexport {NoDevicesFound};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useState} from 'react';\n\nimport {amplify} from 'amplify';\nimport cx from 'classnames';\nimport {container} from 'tsyringe';\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {DeviceCard} from './DeviceCard';\n\nimport {ClientState} from '../../client/ClientState';\nimport type {CryptographyRepository} from '../../cryptography/CryptographyRepository';\nimport {DeviceId} from '../DeviceId';\n\ninterface SelfFingerprintProps {\n  clientState?: ClientState;\n  cryptographyRepository: CryptographyRepository;\n  noPadding: boolean;\n}\n\nconst SelfFingerprint: React.FC<SelfFingerprintProps> = ({\n  cryptographyRepository,\n  noPadding,\n  clientState = container.resolve(ClientState),\n}) => {\n  const [localFingerprint, setLocalFingerprint] = useState<string>('');\n  useEffect(() => {\n    cryptographyRepository.getLocalFingerprint().then(setLocalFingerprint);\n  }, [cryptographyRepository]);\n\n  const {currentClient} = useKoSubscribableChildren(clientState, ['currentClient']);\n\n  return (\n    <div className={cx('participant-devices__header', {'participant-devices__header--padding': !noPadding})}>\n      <DeviceCard device={currentClient} />\n      <div className=\"participant-devices__fingerprint\">\n        <DeviceId deviceId={localFingerprint} />\n      </div>\n      <div>\n        <button\n          type=\"button\"\n          className=\"button-reset-default participant-devices__link accent-text\"\n          onClick={() => amplify.publish(WebAppEvents.PREFERENCES.MANAGE_DEVICES)}\n        >\n          {t('participantDevicesSelfAllDevices')}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport {SelfFingerprint};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useMemo, useState} from 'react';\n\nimport {ClientClassification} from '@wireapp/api-client/lib/client/';\n\nimport {partition} from 'Util/ArrayUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger} from 'Util/Logger';\nimport {capitalizeFirstChar} from 'Util/StringUtil';\n\nimport {DeviceDetails} from './userDevices/DeviceDetails';\nimport {DeviceList} from './userDevices/DeviceList';\nimport {NoDevicesFound} from './userDevices/NoDevicesFound';\nimport {SelfFingerprint} from './userDevices/SelfFingerprint';\n\nimport {ClientRepository, ClientEntity} from '../client';\nimport {ConversationState} from '../conversation/ConversationState';\nimport {MessageRepository} from '../conversation/MessageRepository';\nimport {CryptographyRepository} from '../cryptography/CryptographyRepository';\nimport {User} from '../entity/User';\n\nenum FIND_MODE {\n  FOUND = 'UserDevices.MODE.FOUND',\n  NOT_FOUND = 'UserDevices.MODE.NOT_FOUND',\n  REQUESTING = 'UserDevices.MODE.REQUESTING',\n}\n\nexport enum UserDevicesState {\n  DEVICE_DETAILS = 'UserDevices.DEVICE_DETAILS',\n  DEVICE_LIST = 'UserDevices.DEVICE_LIST',\n  SELF_FINGERPRINT = 'UserDevices.SELF_FINGERPRINT',\n}\n\nexport interface UserDevicesHistoryEntry {\n  headline: string;\n  state: UserDevicesState;\n}\n\nexport const useUserDevicesHistory = () => {\n  const [history, setHistory] = useState<UserDevicesHistoryEntry[]>([\n    {headline: '', state: UserDevicesState.DEVICE_LIST},\n  ]);\n  const current = useMemo<UserDevicesHistoryEntry>(() => history[history.length - 1], [history]);\n  return {\n    current,\n    goBack: () => {\n      setHistory(history.slice(0, -1));\n    },\n    goTo: (state: UserDevicesState, headline: string) => {\n      setHistory([...history, {headline, state}]);\n    },\n  };\n};\n\nexport const sortUserDevices = (devices: ClientEntity[]): ClientEntity[] => {\n  const [legalholdDevices, otherDevices] = partition(\n    devices,\n    device => device.class === ClientClassification.LEGAL_HOLD,\n  );\n  return legalholdDevices.concat(otherDevices);\n};\n\ninterface UserDevicesProps {\n  clientRepository: ClientRepository;\n  conversationState?: ConversationState;\n  cryptographyRepository: CryptographyRepository;\n  current: UserDevicesHistoryEntry;\n  goTo: (state: UserDevicesState, headline: string) => void;\n  messageRepository: MessageRepository;\n  noPadding?: boolean;\n  user: User;\n}\n\nconst UserDevices: React.FC<UserDevicesProps> = ({\n  noPadding = false,\n  current,\n  user,\n  clientRepository,\n  goTo,\n  messageRepository,\n  cryptographyRepository,\n}) => {\n  const [selectedClient, setSelectedClient] = useState<ClientEntity>();\n  const [deviceMode, setDeviceMode] = useState(FIND_MODE.REQUESTING);\n  const [clients, setClients] = useState<ClientEntity[]>([]);\n  const logger = useMemo(() => getLogger('UserDevicesComponent'), []);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const qualifiedUsersMap = Object.values(await clientRepository.getClientsByUserIds([user], true));\n        for (const qualifiedUsersMaps of qualifiedUsersMap) {\n          for (const clientEntities of Object.values(qualifiedUsersMaps)) {\n            setClients(sortUserDevices(clientEntities));\n            const hasDevices = clientEntities.length > 0;\n            const deviceMode = hasDevices ? FIND_MODE.FOUND : FIND_MODE.NOT_FOUND;\n            setDeviceMode(deviceMode);\n          }\n        }\n      } catch (error) {\n        logger.error(`Unable to retrieve clients for user '${user.id}': ${error.message || error}`);\n      }\n    })();\n  }, [user]);\n\n  const clickOnDevice = (clientEntity: ClientEntity) => {\n    setSelectedClient(clientEntity);\n    const headline = user.isMe ? clientEntity.label || clientEntity.model : capitalizeFirstChar(clientEntity.class);\n    goTo(UserDevicesState.DEVICE_DETAILS, headline || '');\n  };\n\n  const clickToShowSelfFingerprint = () => {\n    goTo(UserDevicesState.SELF_FINGERPRINT, t('participantDevicesSelfFingerprint'));\n  };\n\n  const showDeviceList = current.state === UserDevicesState.DEVICE_LIST;\n\n  return (\n    <div>\n      {showDeviceList && deviceMode === FIND_MODE.FOUND && (\n        <DeviceList {...{clickOnDevice, clients, noPadding, user}} />\n      )}\n\n      {showDeviceList && deviceMode === FIND_MODE.NOT_FOUND && <NoDevicesFound {...{noPadding, user}} />}\n\n      {current.state === UserDevicesState.DEVICE_DETAILS && (\n        <DeviceDetails\n          {...{\n            clickToShowSelfFingerprint,\n            clientRepository,\n            cryptographyRepository,\n            logger,\n            messageRepository,\n            noPadding,\n            selectedClient,\n            user,\n          }}\n        />\n      )}\n\n      {current.state === UserDevicesState.SELF_FINGERPRINT && (\n        <SelfFingerprint {...{cryptographyRepository, noPadding}} />\n      )}\n    </div>\n  );\n};\n\nexport {UserDevices};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {ChangeEvent, useState} from 'react';\n\nimport cx from 'classnames';\nimport {container} from 'tsyringe';\n\nimport {ParticipantItem} from 'Components/list/ParticipantItem';\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {isEnterKey, isSpaceKey} from 'Util/KeyboardUtil';\nimport {t} from 'Util/LocalizerUtil';\n\nimport {InViewport} from './utils/InViewport';\n\nimport type {ConversationRepository} from '../conversation/ConversationRepository';\nimport {ConversationState} from '../conversation/ConversationState';\nimport type {Conversation} from '../entity/Conversation';\nimport type {User} from '../entity/User';\nimport {TeamState} from '../team/TeamState';\nimport {UserState} from '../user/UserState';\n\nexport enum UserlistMode {\n  COMPACT = 'UserlistMode.COMPACT',\n  DEFAULT = 'UserlistMode.DEFAULT',\n  OTHERS = 'UserlistMode.OTHERS',\n}\n\nconst USER_CHUNK_SIZE = 64;\n\nexport interface UserListProps {\n  conversation?: Conversation;\n  conversationRepository: ConversationRepository;\n  conversationState?: ConversationState;\n  highlightedUsers?: User[];\n  infos?: Record<string, string>;\n  maxVisibleUsers?: number;\n  mode?: UserlistMode;\n  noSelfInteraction?: boolean;\n  noUnderline?: boolean;\n  showArrow?: boolean;\n  onClick?: (userEntity: User, event: MouseEvent | KeyboardEvent | ChangeEvent) => void;\n  onSelectUser?: (user: User) => void;\n  reducedUserCount?: number;\n  selectedUsers?: User[];\n  showEmptyAdmin?: boolean;\n  teamState?: TeamState;\n  truncate?: boolean;\n  users: User[];\n  userState?: UserState;\n}\n\nconst UserList: React.FC<UserListProps> = ({\n  onClick,\n  conversationRepository,\n  users,\n  infos,\n  highlightedUsers = [],\n  noUnderline = false,\n  mode = UserlistMode.DEFAULT,\n  conversation,\n  truncate = false,\n  selectedUsers = [],\n  maxVisibleUsers = 7,\n  reducedUserCount = 5,\n  showEmptyAdmin = false,\n  noSelfInteraction = false,\n  showArrow = false,\n  userState = container.resolve(UserState),\n  teamState = container.resolve(TeamState),\n  onSelectUser,\n}) => {\n  const [maxShownUsers, setMaxShownUsers] = useState(USER_CHUNK_SIZE);\n\n  const hasMoreUsers = !truncate && users.length > maxShownUsers;\n\n  const highlightedUserIds = highlightedUsers.map(user => user.id);\n  const selfInTeam = userState.self().inTeam();\n  const {self} = useKoSubscribableChildren(userState, ['self']);\n  const {is_verified: isSelfVerified} = useKoSubscribableChildren(self, ['is_verified']);\n  const isSelectEnabled = !!onSelectUser;\n\n  // subscribe to roles changes in order to react to them\n  useKoSubscribableChildren(conversation, ['roles']);\n\n  const isCompactMode = mode === UserlistMode.COMPACT;\n  const cssClasses = isCompactMode ? 'search-list-sm' : 'search-list-lg';\n\n  const onUserKeyPressed = (userEntity: User, event: KeyboardEvent) => {\n    if (isSpaceKey(event) || isEnterKey(event)) {\n      onClickOrKeyPressed(userEntity, event);\n    }\n    return true;\n  };\n\n  const onClickOrKeyPressed = (userEntity: User, event: MouseEvent | KeyboardEvent | ChangeEvent) => {\n    onSelectUser?.(userEntity);\n    onClick?.(userEntity, event);\n  };\n\n  const isSelected = (userEntity: User): boolean =>\n    isSelectEnabled && selectedUsers.some(user => user.id === userEntity.id);\n\n  let content;\n\n  const showRoles = !!conversation;\n  if (showRoles) {\n    let members: User[] = [];\n    let admins: User[] = [];\n    let adminCount = 0;\n    let memberCount = 0;\n\n    users.forEach((userEntity: User) => {\n      if (userEntity.isService) {\n        return;\n      }\n      if (conversationRepository.conversationRoleRepository.isUserGroupAdmin(conversation, userEntity)) {\n        admins.push(userEntity);\n      } else {\n        members.push(userEntity);\n      }\n    });\n    adminCount = admins.length;\n    memberCount = members.length;\n\n    if (truncate && admins.length + members.length > maxVisibleUsers) {\n      admins = admins.slice(0, reducedUserCount);\n      members = members.slice(0, reducedUserCount - admins.length);\n    }\n\n    content = (\n      <>\n        {(admins.length > 0 || showEmptyAdmin) && (\n          <>\n            <h3 className=\"user-list__header\" data-uie-name=\"label-conversation-admins\">\n              {t('searchListAdmins', adminCount)}\n            </h3>\n\n            {admins.length > 0 && (\n              <ul className={cx('search-list', cssClasses)} data-uie-name=\"list-admins\">\n                {admins.slice(0, maxShownUsers).map(user => (\n                  <li key={user.id}>\n                    <ParticipantItem\n                      noInteraction={noSelfInteraction && user.isMe}\n                      participant={user}\n                      noUnderline={noUnderline}\n                      highlighted={highlightedUserIds.includes(user.id)}\n                      customInfo={infos && infos[user.id]}\n                      canSelect={isSelectEnabled}\n                      isSelected={isSelected(user)}\n                      mode={mode}\n                      external={teamState.isExternal(user.id)}\n                      selfInTeam={selfInTeam}\n                      isSelfVerified={isSelfVerified}\n                      onClick={onClickOrKeyPressed}\n                      onKeyDown={onUserKeyPressed}\n                      showArrow={showArrow}\n                    />\n                  </li>\n                ))}\n              </ul>\n            )}\n            {!(admins.length > 0) && (\n              <div className=\"user-list__no-admin\" data-uie-name=\"status-no-admins\">\n                {t('searchListNoAdmins')}\n              </div>\n            )}\n          </>\n        )}\n\n        {members.length > 0 && maxShownUsers > admins.length && (\n          <>\n            <h3 className=\"user-list__header\" data-uie-name=\"label-conversation-members\">\n              {t('searchListMembers', memberCount)}\n            </h3>\n\n            <ul className={cx('search-list', cssClasses)} data-uie-name=\"list-members\">\n              {members.slice(0, maxShownUsers - admins.length).map(user => (\n                <li key={user.id}>\n                  <ParticipantItem\n                    noInteraction={noSelfInteraction && user.isMe}\n                    participant={user}\n                    noUnderline={noUnderline}\n                    highlighted={highlightedUserIds.includes(user.id)}\n                    customInfo={infos && infos[user.id]}\n                    canSelect={isSelectEnabled}\n                    isSelected={isSelected(user)}\n                    mode={mode}\n                    external={teamState.isExternal(user.id)}\n                    selfInTeam={selfInTeam}\n                    isSelfVerified={isSelfVerified}\n                    onClick={onClickOrKeyPressed}\n                    onKeyDown={onUserKeyPressed}\n                    showArrow={showArrow}\n                  />\n                </li>\n              ))}\n            </ul>\n          </>\n        )}\n      </>\n    );\n  } else {\n    const truncatedUsers = truncate ? users.slice(0, reducedUserCount) : users;\n\n    content = (\n      <ul className={cx('search-list', cssClasses)}>\n        {truncatedUsers.slice(0, maxShownUsers).map(user => (\n          <li key={user.id}>\n            <ParticipantItem\n              noInteraction={noSelfInteraction && user.isMe}\n              participant={user}\n              noUnderline={noUnderline}\n              highlighted={highlightedUserIds.includes(user.id)}\n              customInfo={infos && infos[user.id]}\n              canSelect={isSelectEnabled}\n              isSelected={isSelected(user)}\n              mode={mode}\n              external={teamState.isExternal(user.id)}\n              selfInTeam={selfInTeam}\n              isSelfVerified={isSelfVerified}\n              onClick={onClickOrKeyPressed}\n              onKeyDown={onUserKeyPressed}\n              showArrow={showArrow}\n            />\n          </li>\n        ))}\n      </ul>\n    );\n  }\n\n  return (\n    <>\n      {content}\n      {hasMoreUsers && (\n        <InViewport\n          onVisible={() => setMaxShownUsers(maxShownUsers + USER_CHUNK_SIZE)}\n          key={`in-viewport-${Math.random()}`}\n          style={{height: 10, transform: 'translateY(-60px)', width: 10}}\n        />\n      )}\n    </>\n  );\n};\n\nexport {UserList};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useCallback, useEffect, useState} from 'react';\n\nimport {container} from 'tsyringe';\nimport {debounce} from 'underscore';\n\nimport {partition} from 'Util/ArrayUtil';\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport {sortByPriority} from 'Util/StringUtil';\n\nimport {UserList} from './UserList';\n\nimport {ConversationState} from '../conversation/ConversationState';\nimport type {User} from '../entity/User';\nimport {SearchRepository} from '../search/SearchRepository';\nimport type {TeamRepository} from '../team/TeamRepository';\nimport {TeamState} from '../team/TeamState';\nimport {validateHandle} from '../user/UserHandleGenerator';\nimport {UserState} from '../user/UserState';\n\nexport type UserListProps = React.ComponentProps<typeof UserList> & {\n  conversationState?: ConversationState;\n  highlightedUsers?: User[];\n  users: User[];\n  filter?: string;\n  selected?: User[];\n  onUpdateSelectedUsers?: (updatedUsers: User[]) => void;\n  searchRepository: SearchRepository;\n  selfFirst?: boolean;\n  teamRepository: TeamRepository;\n  teamState?: TeamState;\n  truncate?: boolean;\n  userState?: UserState;\n  dataUieName?: string;\n};\n\nconst UserSearchableList: React.FC<UserListProps> = ({\n  onUpdateSelectedUsers,\n  dataUieName = '',\n  filter = '',\n  highlightedUsers,\n  selected: selectedUsers,\n  users,\n  ...props\n}) => {\n  const {searchRepository, teamRepository, selfFirst, ...userListProps} = props;\n  const {userState = container.resolve(UserState), conversationState = container.resolve(ConversationState)} = props;\n\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\n  const [remoteTeamMembers, setRemoteTeamMembers] = useState<User[]>([]);\n\n  const {self: selfUser} = useKoSubscribableChildren(userState, ['self']);\n  const {inTeam: selfInTeam} = useKoSubscribableChildren(selfUser, ['inTeam']);\n\n  /**\n   * Try to load additional members from the backend.\n   * This is needed for large teams (>= 2000 members)\n   */\n  const fetchMembersFromBackend = useCallback(\n    debounce(async (query: string, isHandle: boolean, ignoreMembers: User[]) => {\n      const resultUsers = await searchRepository!.searchByName(query, isHandle);\n      const selfTeamId = selfUser.teamId;\n      const foundMembers = resultUsers.filter(user => user.teamId === selfTeamId);\n      const ignoreIds = ignoreMembers.map(member => member.id);\n      const uniqueMembers = foundMembers.filter(member => !ignoreIds.includes(member.id));\n\n      // We shouldn't show any members that have the 'external' role and are not already locally known.\n      const nonExternalMembers = await teamRepository.filterExternals(uniqueMembers);\n      setRemoteTeamMembers(nonExternalMembers);\n    }, 300),\n    [],\n  );\n\n  // Filter all list items if a filter is provided\n\n  useEffect(() => {\n    const connectedUsers = conversationState.connectedUsers();\n    let resultUsers = users.slice();\n    const normalizedQuery = SearchRepository.normalizeQuery(filter);\n    if (normalizedQuery) {\n      const trimmedQuery = filter.trim();\n      const isHandle = trimmedQuery.startsWith('@') && validateHandle(normalizedQuery);\n      if (searchRepository) {\n        const SEARCHABLE_FIELDS = SearchRepository.CONFIG.SEARCHABLE_FIELDS;\n        const properties = isHandle ? [SEARCHABLE_FIELDS.USERNAME] : undefined;\n        resultUsers = searchRepository.searchUserInSet(normalizedQuery, users, properties);\n      }\n      resultUsers = resultUsers.filter(\n        user =>\n          user.isMe ||\n          connectedUsers.includes(user) ||\n          teamRepository.isSelfConnectedTo(user.id) ||\n          user.username() === normalizedQuery,\n      );\n      if (searchRepository && selfInTeam) {\n        fetchMembersFromBackend(trimmedQuery, isHandle, resultUsers);\n      }\n    } else {\n      resultUsers = users.filter(\n        user => user.isMe || connectedUsers.includes(user) || teamRepository.isSelfConnectedTo(user.id),\n      );\n    }\n\n    if (!selfFirst) {\n      setFilteredUsers(resultUsers);\n      return;\n    }\n\n    // make sure the self user is the first one in the list\n    const [selfUser, otherUsers] = partition(resultUsers, user => user.isMe);\n    setFilteredUsers(selfUser.concat(otherUsers));\n  }, [filter, users.length]);\n\n  const foundUserEntities = () => {\n    if (!remoteTeamMembers.length) {\n      return filteredUsers;\n    }\n    const normalizedQuery = SearchRepository.normalizeQuery(filter);\n    return [...filteredUsers, ...remoteTeamMembers].sort((userA, userB) =>\n      sortByPriority(userA.name(), userB.name(), normalizedQuery),\n    );\n  };\n\n  const toggleUserSelection = selectedUsers\n    ? (user: User) => {\n        if (selectedUsers.find(selectedUser => selectedUser.id === user.id)) {\n          onUpdateSelectedUsers?.([...selectedUsers].filter(selectedUser => selectedUser.id !== user.id));\n        } else {\n          onUpdateSelectedUsers?.([...selectedUsers, user]);\n        }\n      }\n    : undefined;\n\n  const userList = foundUserEntities();\n  const isEmptyUserList = userList.length === 0;\n  const hasUsers = users.length === 0;\n  const noResultsDataUieName = hasUsers ? 'status-all-added' : 'status-no-matches';\n  const noResultsTranslationText = hasUsers ? 'searchListEveryoneParticipates' : 'searchListNoMatches';\n\n  return (\n    <div className=\"user-list-wrapper\" data-uie-name={dataUieName} role=\"list\">\n      {isEmptyUserList ? (\n        <p className=\"user-list__no-results\" data-uie-name={noResultsDataUieName}>\n          {t(noResultsTranslationText)}\n        </p>\n      ) : (\n        <UserList\n          {...userListProps}\n          users={userList}\n          selectedUsers={selectedUsers}\n          highlightedUsers={highlightedUsers}\n          onSelectUser={toggleUserSelection}\n        />\n      )}\n    </div>\n  );\n};\n\nexport {UserSearchableList};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {Icon} from './Icon';\n\nexport interface VerifiedIconProps {\n  className?: string;\n  dataUieName?: string;\n  isVerified: boolean;\n}\n\nconst VerifiedIcon: React.FC<VerifiedIconProps> = ({isVerified, dataUieName, className}) => {\n  return isVerified ? (\n    <Icon.Verified className={className ?? 'verified-icon'} data-uie-name={dataUieName ?? 'user-device-verified'} />\n  ) : (\n    <Icon.NotVerified\n      className={className ?? 'not-verified-icon'}\n      data-uie-name={dataUieName ?? 'user-device-not-verified'}\n    />\n  );\n};\n\nexport {VerifiedIcon};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React from 'react';\n\nimport {keyframes} from '@emotion/react';\n\nimport {getSVG} from '../../auth/util/SVGProvider';\n\nconst fadeAnimation = keyframes`\n  0%   { opacity: 0.2; }\n  100% { opacity: 1; }\n`;\n\ninterface ParticipantMicOnIconProps {\n  className?: string;\n  color?: string;\n  isActive?: boolean;\n}\n\nconst ParticipantMicOnIcon: React.FC<ParticipantMicOnIconProps> = ({\n  className,\n  isActive = false,\n  color = isActive ? 'var(--accent-color)' : 'currentColor',\n  ...props\n}) => {\n  return (\n    <span\n      css={{\n        animation: isActive ? `${fadeAnimation} 0.7s steps(7) infinite alternate` : 'initial',\n        border: isActive ? '1px solid var(--accent-color)' : '1px solid transparent',\n        borderRadius: '50%',\n        padding: '2px',\n      }}\n      className={className}\n      {...props}\n    >\n      <svg\n        data-uie-name=\"mic-icon-on\"\n        data-uie-active={isActive ? 'active' : 'inactive'}\n        css={{\n          '> path': {\n            fill: color,\n          },\n        }}\n        viewBox=\"0 0 16 16\"\n        dangerouslySetInnerHTML={{__html: getSVG('mic-on-icon')?.documentElement?.innerHTML}}\n      ></svg>\n    </span>\n  );\n};\n\nexport {ParticipantMicOnIcon};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {ChangeEvent, useId, useState} from 'react';\n\nimport {TabIndex} from '@wireapp/react-ui-kit/lib/types/enums';\nimport cx from 'classnames';\n\nimport {Checkbox, CheckboxLabel} from '@wireapp/react-ui-kit';\n\nimport {AvailabilityState} from 'Components/AvailabilityState';\nimport {Avatar, AVATAR_SIZE} from 'Components/Avatar';\nimport {ParticipantMicOnIcon} from 'Components/calling/ParticipantMicOnIcon';\nimport {Icon} from 'Components/Icon';\nimport {UserlistMode} from 'Components/UserList';\nimport {InViewport} from 'Components/utils/InViewport';\nimport {useKoSubscribableChildren} from 'Util/ComponentUtil';\nimport {KEY} from 'Util/KeyboardUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport {capitalizeFirstChar} from 'Util/StringUtil';\nimport {noop, setContextMenuPosition} from 'Util/util';\n\nimport {Participant} from '../../calling/Participant';\nimport {User} from '../../entity/User';\nimport {ServiceEntity} from '../../integration/ServiceEntity';\n\nexport interface ParticipantItemProps<UserType> extends Omit<React.HTMLProps<HTMLDivElement>, 'onClick' | 'onKeyDown'> {\n  badge?: boolean;\n  callParticipant?: Participant;\n  canSelect?: boolean;\n  customInfo?: string;\n  external?: boolean;\n  hideInfo?: boolean;\n  highlighted?: boolean;\n  isSelected?: boolean;\n  isSelfVerified?: boolean;\n  mode?: UserlistMode;\n  noInteraction?: boolean;\n  noUnderline?: boolean;\n  onClick?: (user: UserType, event: MouseEvent | ChangeEvent) => void;\n  onKeyDown?: (user: UserType, event: KeyboardEvent) => void;\n  participant: UserType;\n  selfInTeam?: boolean;\n  showArrow?: boolean;\n  showDropdown?: boolean;\n}\n\nconst ParticipantItem = <UserType extends User | ServiceEntity>(\n  props: React.PropsWithChildren<ParticipantItemProps<UserType>>,\n): React.ReactElement | null => {\n  const {\n    badge,\n    callParticipant,\n    canSelect,\n    customInfo,\n    external,\n    hideInfo,\n    highlighted = false,\n    isSelected,\n    isSelfVerified = false,\n    mode = UserlistMode.DEFAULT,\n    noInteraction = false,\n    noUnderline = false,\n    participant,\n    selfInTeam,\n    showDropdown = false,\n    onContextMenu = noop,\n    onClick = noop,\n    onKeyDown = noop,\n  } = props;\n  const checkboxId = useId();\n\n  const [isInViewport, setIsInViewport] = useState(false);\n  const isUser = participant instanceof User && !participant.isService;\n  const isService = participant instanceof ServiceEntity || participant.isService;\n  const isSelf = !!(participant as User).isMe;\n  const selfString = `(${capitalizeFirstChar(t('conversationYouNominative'))})`;\n  const hasCustomInfo = !!customInfo;\n  const isTemporaryGuest = isUser && (participant as User).isTemporaryGuest();\n  const hasUsernameInfo = isUser && !hideInfo && !hasCustomInfo && !isTemporaryGuest;\n  const isOthersMode = mode === UserlistMode.OTHERS;\n\n  const {\n    is_verified: isVerified,\n    isDirectGuest,\n    availability,\n    expirationText,\n    name: participantName,\n  } = useKoSubscribableChildren(\n    // We need to make TS believe that this is a User, otherwise it will complain about\n    // the fields in the array that don't exist on ServiceEntity\n    participant as User,\n    participant instanceof User ? ['isDirectGuest', 'is_verified', 'availability', 'expirationText', 'name'] : ['name'],\n  );\n\n  const isFederated = participant instanceof User && participant.isFederated;\n\n  const {sharesCamera, sharesScreen, isActivelySpeaking, isMuted} = useKoSubscribableChildren(callParticipant, [\n    'sharesCamera',\n    'sharesScreen',\n    'isActivelySpeaking',\n    'isMuted',\n  ]);\n\n  const contentInfoText = (() => {\n    if (hasCustomInfo) {\n      return customInfo;\n    }\n    if (hideInfo) {\n      return '';\n    }\n    if (isService) {\n      return (participant as ServiceEntity).summary;\n    }\n    if (isTemporaryGuest) {\n      return expirationText;\n    }\n    return (participant as User).handle;\n  })();\n\n  const handleContextKeyDown = (event: React.KeyboardEvent) => {\n    if ([KEY.SPACE, KEY.ENTER].includes(event.key)) {\n      const newEvent = setContextMenuPosition(event);\n      onContextMenu(newEvent as unknown as React.MouseEvent<HTMLDivElement>);\n    }\n  };\n\n  const RenderParticipant = () => {\n    return (\n      <InViewport className=\"participant-item\" onVisible={() => setIsInViewport(true)}>\n        {isInViewport && (\n          <>\n            <div className=\"participant-item__image\">\n              <Avatar avatarSize={AVATAR_SIZE.SMALL} participant={participant} aria-hidden=\"true\" />\n            </div>\n\n            <div className=\"participant-item__content\">\n              <div className=\"participant-item__content__text\">\n                <div className=\"participant-item__content__name-wrapper\">\n                  {isUser && selfInTeam && (\n                    <AvailabilityState\n                      availability={availability}\n                      className=\"participant-item__content__availability participant-item__content__name\"\n                      dataUieName=\"status-name\"\n                      label={participantName}\n                    />\n                  )}\n\n                  {(isService || !selfInTeam) && (\n                    <div className=\"participant-item__content__name\" data-uie-name=\"status-name\">\n                      {participantName}\n                    </div>\n                  )}\n                  {isSelf && <div className=\"participant-item__content__self-indicator\">{selfString}</div>}\n                </div>\n                {contentInfoText && (\n                  <div className=\"participant-item__content__info\">\n                    <span\n                      className={cx('participant-item__content__username label-username-notext', {\n                        'label-username': hasUsernameInfo,\n                      })}\n                      data-uie-name=\"status-username\"\n                    >\n                      {contentInfoText}\n                    </span>\n                    {hasUsernameInfo && badge && (\n                      <span className=\"participant-item__content__badge\" data-uie-name=\"status-partner\">\n                        {badge}\n                      </span>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              {showDropdown && (\n                <button\n                  tabIndex={TabIndex.UNFOCUSABLE}\n                  className=\"participant-item__content__chevron\"\n                  onClick={event => onContextMenu(event as unknown as React.MouseEvent<HTMLDivElement>)}\n                  type=\"button\"\n                  data-uie-name=\"participant-menu-icon\"\n                >\n                  <Icon.Chevron />\n                </button>\n              )}\n            </div>\n\n            {!isOthersMode && isDirectGuest && (\n              <span\n                className=\"guest-icon with-tooltip with-tooltip--external\"\n                data-tooltip={t('conversationGuestIndicator')}\n              >\n                <Icon.Guest data-uie-name=\"status-guest\" />\n              </span>\n            )}\n\n            {isFederated && (\n              <span\n                className=\"federation-icon with-tooltip with-tooltip--external\"\n                data-tooltip={t('conversationFederationIndicator')}\n              >\n                <Icon.Federation data-uie-name=\"status-federated-user\" />\n              </span>\n            )}\n\n            {external && (\n              <span className=\"partner-icon with-tooltip with-tooltip--external\" data-tooltip={t('rolePartner')}>\n                <Icon.External data-uie-name=\"status-external\" />\n              </span>\n            )}\n\n            {isUser && isSelfVerified && isVerified && (\n              <span className=\"verified-icon\">\n                <Icon.Verified data-uie-name=\"status-verified\" />\n              </span>\n            )}\n\n            {callParticipant && (\n              <>\n                {sharesScreen && <Icon.Screenshare className=\"screenshare-icon\" data-uie-name=\"status-screenshare\" />}\n\n                {sharesCamera && <Icon.Camera className=\"camera-icon\" data-uie-name=\"status-video\" />}\n\n                {!isMuted && (\n                  <ParticipantMicOnIcon\n                    className=\"participant-mic-on-icon\"\n                    isActive={isActivelySpeaking}\n                    data-uie-name={isActivelySpeaking ? 'status-active-speaking' : 'status-audio-on'}\n                  />\n                )}\n\n                {isMuted && (\n                  <Icon.MicOff\n                    className=\"mic-off-icon\"\n                    data-uie-name=\"status-audio-off\"\n                    style={{height: 12, width: 12}}\n                  />\n                )}\n              </>\n            )}\n          </>\n        )}\n      </InViewport>\n    );\n  };\n\n  const dataUieValues = {\n    'data-uie-name': isUser ? 'item-user' : 'item-service',\n    'data-uie-value': participantName,\n  };\n\n  const commonClassName = cx('participant-item-wrapper', {\n    highlighted,\n    'no-interaction': noInteraction,\n    'no-underline': noUnderline,\n  });\n\n  return (\n    <>\n      {canSelect ? (\n        <div\n          onContextMenu={onContextMenu}\n          aria-label={t('accessibility.openConversation', participantName)}\n          className={commonClassName}\n        >\n          <Checkbox\n            checked={isSelected}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>) => onClick(participant, event)}\n            id={checkboxId}\n            labelBeforeCheckbox={true}\n            aligncenter={false}\n            outlineOffset=\"0\"\n          >\n            <CheckboxLabel htmlFor={checkboxId}>\n              <div {...dataUieValues}>\n                <RenderParticipant />\n              </div>\n            </CheckboxLabel>\n          </Checkbox>\n        </div>\n      ) : (\n        <div\n          tabIndex={TabIndex.FOCUSABLE}\n          role=\"button\"\n          onContextMenu={onContextMenu}\n          onClick={noInteraction ? onContextMenu : event => onClick(participant, event.nativeEvent)}\n          onKeyDown={noInteraction ? handleContextKeyDown : event => onKeyDown(participant, event.nativeEvent)}\n          {...dataUieValues}\n          aria-label={t('accessibility.openConversation', participantName)}\n          className={commonClassName}\n        >\n          <RenderParticipant />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport {ParticipantItem};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\ninterface OverlayElement {\n  onChange?: (isChanged: boolean) => void;\n  onVisible?: () => void;\n}\n\n/**\n * Keeps track of elements that are overlayed by other elements (thus not visible on screen).\n */\nconst overlayedElements = new Map<HTMLElement, OverlayElement>();\nlet overlayCheckerInterval: number = undefined;\n\nfunction checkOverlayedElements() {\n  overlayedElements.forEach(({onVisible, onChange}, element) => {\n    const isVisible = !isOverlayed(element);\n    if (onChange) {\n      return onChange(isVisible);\n    }\n    if (isVisible) {\n      onVisible();\n      removeElement(element);\n    }\n  });\n}\n\n/**\n * Returns `true` if an element is above the element being watched.\n *\n * @param domElement the element we want to check.\n */\nconst isOverlayed = (domElement: HTMLElement): boolean => {\n  const box = domElement.getBoundingClientRect();\n  if (isNaN(box.right + box.left + box.bottom + box.top)) {\n    return true;\n  }\n  const middlePointX = (box.right + box.left) / 2;\n  const middlePointY = (box.bottom + box.top) / 2;\n  const elementAtPoint = document.elementFromPoint(middlePointX, middlePointY);\n  return elementAtPoint && domElement !== elementAtPoint && !domElement.contains(elementAtPoint);\n};\n\nconst onElementVisible = (element: HTMLElement, onVisible: () => void) => {\n  if (!isOverlayed(element)) {\n    return onVisible();\n  }\n  if (!overlayCheckerInterval) {\n    overlayCheckerInterval = window.setInterval(checkOverlayedElements, 300);\n  }\n  overlayedElements.set(element, {onVisible});\n};\n\nconst trackElement = (element: HTMLElement, onChange: (isChanged: boolean) => void) => {\n  onChange(!isOverlayed(element));\n  if (!overlayCheckerInterval) {\n    overlayCheckerInterval = window.setInterval(checkOverlayedElements, 300);\n  }\n  overlayedElements.set(element, {onChange});\n};\n\nconst removeElement = (element: HTMLElement) => {\n  overlayedElements.delete(element);\n  if (overlayedElements.size < 1 && overlayCheckerInterval) {\n    clearInterval(overlayCheckerInterval);\n    overlayCheckerInterval = undefined;\n  }\n};\n\nexport const overlayedObserver = {\n  onElementVisible,\n  removeElement,\n  trackElement,\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nconst observedElements = new Map();\nconst tolerance = 0.8;\n\nconst onIntersect: IntersectionObserverCallback = entries => {\n  entries.forEach(({intersectionRatio, intersectionRect, isIntersecting, target: element, rootBounds}) => {\n    const {onVisible, onChange, requireFullyInView, container, allowBiggerThanViewport} =\n      observedElements.get(element) || {};\n    const isFullyInView = () => {\n      if (container) {\n        const minHeight = Math.min(container.clientHeight, element.clientHeight) * tolerance;\n        return intersectionRect.height >= minHeight;\n      }\n      return intersectionRatio >= tolerance;\n    };\n\n    const isBiggerThanRoot = () => {\n      return (\n        allowBiggerThanViewport &&\n        !!rootBounds &&\n        (element.clientHeight > rootBounds.height || element.clientWidth > rootBounds.width)\n      );\n    };\n\n    const isVisible = isIntersecting && (!requireFullyInView || isFullyInView() || isBiggerThanRoot());\n\n    if (onChange) {\n      onChange(isVisible);\n    } else if (isVisible) {\n      removeElement(element);\n      return onVisible && onVisible();\n    }\n  });\n};\n\nconst stepCount = 100;\nconst thresholdSteps = Array.from({length: stepCount + 1}, (_, index) => index / stepCount);\n\nconst options: IntersectionObserverInit = {root: null, rootMargin: '0px', threshold: thresholdSteps};\nconst observer = new IntersectionObserver(onIntersect, options);\n\n/**\n * Will track an element and trigger the callback only once when the element appears in viewport.\n *\n * @param element the element to observe\n * @param onVisible the callback to call when the element appears\n * @param requireFullyInView should the element be fully in view\n * @param allowBiggerThanViewport should fire when element is bigger than viewport\n * @param container the element containing the element\n */\nconst onElementInViewport = (\n  element: HTMLElement,\n  onVisible: Function,\n  requireFullyInView?: boolean,\n  allowBiggerThanViewport?: boolean,\n  container?: HTMLElement,\n): void => {\n  observedElements.set(element, {allowBiggerThanViewport, container, onVisible, requireFullyInView});\n  return observer.observe(element);\n};\n\n/**\n * Will track an element and trigger the callback whenever the intersecting state changes\n *\n * @param element the element to observe\n * @param onChange the callback to call when the element intersects or not\n * @param requireFullyInView should the element be fully in view\n * @param allowBiggerThanViewport should fire when element is bigger than viewport\n * @param container the element containing the element\n */\nconst trackElement = (\n  element: HTMLElement,\n  onChange: Function,\n  container?: HTMLElement,\n  requireFullyInView = false,\n  allowBiggerThanViewport = false,\n): void => {\n  if (element) {\n    observedElements.set(element, {allowBiggerThanViewport, container, onChange, requireFullyInView});\n    return observer.observe(element);\n  }\n};\n\nconst removeElement = (element: Element) => {\n  if (element) {\n    observedElements.delete(element);\n    observer.unobserve(element);\n  }\n};\n\nexport const viewportObserver = {\n  onElementInViewport,\n  removeElement,\n  trackElement,\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect, useRef} from 'react';\n\nimport {overlayedObserver} from 'Util/DOM/overlayedObserver';\nimport {viewportObserver} from 'Util/DOM/viewportObserver';\n\ninterface InViewportParams {\n  onVisible: () => void;\n  requireFullyInView?: boolean;\n  allowBiggerThanViewport?: boolean;\n  /** Will check if the element is overlayed by something else. Can be used to be sure the user could actually see the element. Should not be used to do lazy loading as the overlayObserver has quite a long debounce time */\n  checkOverlay?: boolean;\n}\n\nconst InViewport: React.FC<InViewportParams & React.HTMLProps<HTMLDivElement>> = ({\n  children,\n  onVisible,\n  requireFullyInView = false,\n  checkOverlay = false,\n  allowBiggerThanViewport = false,\n  ...props\n}) => {\n  const domNode = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const element = domNode.current;\n    if (!element) {\n      return undefined;\n    }\n\n    let inViewport = false;\n    let visible = !checkOverlay;\n    const releaseTrackers = () => {\n      if (checkOverlay) {\n        overlayedObserver.removeElement(element);\n      }\n      viewportObserver.removeElement(element);\n    };\n\n    const triggerCallbackIfVisible = () => {\n      if (inViewport && visible) {\n        onVisible();\n        releaseTrackers();\n      }\n    };\n\n    viewportObserver.trackElement(\n      element,\n      (isInViewport: boolean) => {\n        inViewport = isInViewport;\n        triggerCallbackIfVisible();\n      },\n      element.parentElement || undefined,\n      requireFullyInView,\n      allowBiggerThanViewport,\n    );\n    if (checkOverlay) {\n      overlayedObserver.trackElement(element, isVisible => {\n        visible = isVisible;\n        triggerCallbackIfVisible();\n      });\n    }\n    return () => releaseTrackers();\n  }, [allowBiggerThanViewport, requireFullyInView, checkOverlay, onVisible]);\n\n  return (\n    <div ref={domNode} {...props} css={{minHeight: '1px'}}>\n      {children}\n    </div>\n  );\n};\n\nexport {InViewport};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ConnectionStatus} from '@wireapp/api-client/lib/connection/';\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport ko from 'knockout';\n\nexport class ConnectionEntity {\n  conversationId: QualifiedId;\n  from: string;\n  isBlocked: ko.PureComputed<boolean>;\n  isCanceled: ko.PureComputed<boolean>;\n  isConnected: ko.PureComputed<boolean>;\n  isIgnored: ko.PureComputed<boolean>;\n  isIncomingRequest: ko.PureComputed<boolean>;\n  isMissingLegalHoldConsent: ko.PureComputed<boolean>;\n  isOutgoingRequest: ko.PureComputed<boolean>;\n  isRequest: ko.PureComputed<boolean>;\n  isUnknown: ko.PureComputed<boolean>;\n  lastUpdate: string;\n  message: string;\n  status: ko.Observable<ConnectionStatus>;\n  userId: QualifiedId;\n\n  constructor() {\n    this.conversationId = null;\n    this.from = null;\n    this.lastUpdate = null;\n    this.message = null;\n    this.status = ko.observable(ConnectionStatus.UNKNOWN);\n    this.userId = null;\n\n    this.isBlocked = ko.pureComputed(() => this.status() === ConnectionStatus.BLOCKED);\n    this.isMissingLegalHoldConsent = ko.pureComputed(\n      () => this.status() === ConnectionStatus.MISSING_LEGAL_HOLD_CONSENT,\n    );\n    this.isCanceled = ko.pureComputed(() => this.status() === ConnectionStatus.CANCELLED);\n    this.isConnected = ko.pureComputed(() => this.status() === ConnectionStatus.ACCEPTED);\n    this.isIgnored = ko.pureComputed(() => this.status() === ConnectionStatus.IGNORED);\n    this.isIncomingRequest = ko.pureComputed(() => this.status() === ConnectionStatus.PENDING);\n    this.isOutgoingRequest = ko.pureComputed(() => this.status() === ConnectionStatus.SENT);\n    this.isUnknown = ko.pureComputed(() =>\n      [ConnectionStatus.CANCELLED, ConnectionStatus.UNKNOWN].includes(this.status()),\n    );\n\n    this.isRequest = ko.pureComputed(() => this.isIncomingRequest() || this.isOutgoingRequest());\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ConversationEvent} from '@wireapp/api-client/lib/event';\n\nimport {ClientConversationEvent} from './EventBuilder';\n\nimport type {Conversation} from '../entity/Conversation';\n\nexport type EventHandlingConfig = {[eventId: string]: (conversationEntity: Conversation) => void | Promise<void>};\n\n/**\n * Abstract class that represents an entity that can react to a conversation event.\n */\nexport class AbstractConversationEventHandler {\n  private eventHandlingConfig: EventHandlingConfig;\n\n  constructor() {\n    this.eventHandlingConfig = {};\n  }\n\n  /**\n   * Adds an event handling config to the current instance.\n   *\n   * @param eventHandlingConfig Config containing events name and the associated callback\n   */\n  setEventHandlingConfig(eventHandlingConfig: EventHandlingConfig): void {\n    this.eventHandlingConfig = eventHandlingConfig;\n  }\n\n  /**\n   * Handles a conversation event.\n   *\n   * @param conversationEntity the conversation the event relates to\n   * @param eventJson JSON data for the event\n   */\n  handleConversationEvent(\n    conversationEntity: Conversation,\n    eventJson: ConversationEvent | ClientConversationEvent,\n  ): Promise<void> {\n    const handler = this.eventHandlingConfig[eventJson.type] || (() => Promise.resolve());\n    return handler.bind(this)(conversationEntity, eventJson);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum PERSONAL {\n  GROUP = 'z.conversation.ACCESS_STATE.PERSONAL.GROUP',\n  ONE2ONE = 'z.conversation.ACCESS_STATE.PERSONAL.ONE2ONE',\n}\n\nexport enum TEAM {\n  GUEST_ROOM = 'z.conversation.ACCESS_STATE.TEAM.GUEST_ROOM',\n  GUEST_FEATURES = 'z.conversation.ACCESS_STATE.TEAM.GUEST_FEATURES',\n  GUESTS_SERVICES = 'z.conversation.ACCESS_STATE.TEAM.GUESTS_SERVICES',\n  LEGACY = 'z.conversation.ACCESS_STATE.TEAM.LEGACY',\n  ONE2ONE = 'z.conversation.ACCESS_STATE.TEAM.ONE2ONE',\n  SERVICES = 'z.conversation.ACCESS_STATE.TEAM.SERVICES',\n  TEAM_ONLY = 'z.conversation.ACCESS_STATE.TEAM.TEAM_ONLY',\n}\n\nexport enum OTHER {\n  SELF = 'z.conversation.ACCESS_STATE.SELF',\n  UNKNOWN = 'z.conversation.ACCESS_STATE.UNKNOWN',\n}\nexport const ACCESS_STATE = {OTHER, PERSONAL, TEAM};\nexport type ACCESS_STATE = PERSONAL | TEAM | OTHER;\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {\n  ClientMismatch,\n  MessageSendingStatus,\n  QualifiedUserClients,\n  UserClients,\n} from '@wireapp/api-client/lib/conversation/';\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport {flattenQualifiedUserClients, flattenUserClients} from '@wireapp/core/lib/conversation/message/UserClientsUtil';\nimport {isQualifiedUserClients} from '@wireapp/core/lib/util';\nimport {difference, intersection} from 'underscore';\n\nimport {matchQualifiedIds} from 'Util/QualifiedId';\n\nimport {User} from '../entity/User';\n\ntype UserClient = {clients: string[]; userId: QualifiedId};\n\ntype ClientDiff = {\n  /** List of clients that do not exist on backend anymore  */\n  deletedClients: UserClient[];\n  /** List users that do not have any clients left (only computed if a user list is given as input) */\n  emptyUsers: User[];\n  /** List of clients that are missing (only the unknown clients if a list of users is given as input) */\n  missingClients: UserClient[];\n  /** List of users that are missing (only computed if a user list is given as input) */\n  missingUserIds: QualifiedId[];\n};\n\n/**\n * Extracts missingClients, deletedClients, deletedUsers and missingUsers from a server clients mismatch return.\n * The missingUsers and deletedUsers can only be computed is a list of users is given as input\n *\n * @param clientMismatch The client mismatch returned by the server\n * @param users? A list a users against which to match the mismatch. (if not given will dumbly flatten the given mismatch)\n */\nexport function extractClientDiff(\n  {deleted = {}, redundant = {}, missing = {}}: Partial<ClientMismatch> | Partial<MessageSendingStatus>,\n  users?: User[],\n  defaultDomain: string = '',\n): ClientDiff {\n  const allDeleted = {...deleted, ...redundant} as QualifiedUserClients | UserClients;\n  const deletedClients = isQualifiedUserClients(allDeleted)\n    ? flattenQualifiedUserClients(allDeleted)\n    : flattenUserClients(allDeleted, defaultDomain);\n  const missingClients = isQualifiedUserClients(missing)\n    ? flattenQualifiedUserClients(missing)\n    : flattenUserClients(missing, defaultDomain);\n\n  const toClientDiff = ({userId, data}: {data: string[]; userId: QualifiedId}) => ({clients: data, userId});\n\n  const clientDiff: ClientDiff = {\n    deletedClients: deletedClients.map(toClientDiff),\n    emptyUsers: [],\n    missingClients: missingClients.map(toClientDiff),\n    missingUserIds: [],\n  };\n  if (!users) {\n    return clientDiff;\n  }\n\n  const emptyUsers = users\n    .filter(user => !user.isMe)\n    .filter(user => {\n      const userClients = user.devices().map(({id}) => id);\n      const userDeletedClients =\n        deletedClients.find(({userId}) => matchQualifiedIds(user.qualifiedId, userId))?.data || [];\n      const commonDevices = intersection(userClients, userDeletedClients);\n      return commonDevices.length === userClients.length;\n    });\n\n  const missingUserIds = missingClients\n    .filter(({userId}) => !users.some(user => matchQualifiedIds(userId, user.qualifiedId)))\n    .map(({userId}) => userId);\n\n  const unknownMissingClients = missingClients\n    .map(({userId, data}) => {\n      const userDevices =\n        users\n          .find(user => matchQualifiedIds(user.qualifiedId, userId))\n          ?.devices()\n          .map(device => device.id) ?? [];\n      const unknownDevices = difference(data, userDevices);\n      return {data: unknownDevices, userId};\n    })\n    .filter(({data}) => data.length > 0);\n\n  return {\n    ...clientDiff,\n    emptyUsers,\n    missingClients: unknownMissingClients.map(toClientDiff),\n    missingUserIds,\n  };\n}\n\ntype Recipients = UserClients | QualifiedUserClients;\n\nexport function findDeletedClients<T extends Recipients>(referenceRecipients: T, localRecipients: T): Recipients {\n  const filterKnownClients = (clients: UserClients, knownClients: UserClients) => {\n    return Object.entries(clients).reduce<UserClients>((missing, [userId, clients]) => {\n      const missingClients = difference(knownClients[userId] || [], clients);\n      return missingClients.length ? {...missing, [userId]: missingClients} : missing;\n    }, {});\n  };\n\n  const filterKnownQualifiedClients = (clients: QualifiedUserClients, knownClients: QualifiedUserClients) => {\n    return Object.entries(clients).reduce<QualifiedUserClients>((missing, [domain, userClients]) => {\n      const missingUserClients = filterKnownClients(userClients, knownClients[domain]);\n      return Object.keys(missingUserClients).length ? {...missing, [domain]: missingUserClients} : missing;\n    }, {});\n  };\n\n  return isQualifiedUserClients(referenceRecipients)\n    ? filterKnownQualifiedClients(referenceRecipients, localRecipients as QualifiedUserClients)\n    : filterKnownClients(referenceRecipients, localRecipients as UserClients);\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_ACCESS_ROLE, CONVERSATION_ACCESS} from '@wireapp/api-client/lib/conversation/';\n\nimport {ACCESS_STATE, TEAM} from './AccessState';\n\nimport {combinePermissions, hasPermissions} from '../user/UserPermission';\n\nexport const ACCESS_TYPES = {\n  GUEST: 1 << 0,\n  NON_TEAM_MEMBER: 1 << 1,\n  TEAM_MEMBER: 1 << 2,\n  SERVICE: 1 << 3,\n};\n\nexport const ACCESS_MODES = {\n  INVITE: 1 << 4,\n  CODE: 1 << 5,\n};\n\nexport const ACCESS = {...ACCESS_TYPES, ...ACCESS_MODES};\n\nexport function teamPermissionsForAccessState(state: ACCESS_STATE): number {\n  switch (state) {\n    case ACCESS_STATE.TEAM.GUESTS_SERVICES: {\n      return combinePermissions([teamPermissionsForAccessState(ACCESS_STATE.TEAM.GUEST_ROOM), ACCESS_TYPES.SERVICE]);\n    }\n    case ACCESS_STATE.TEAM.GUEST_ROOM: {\n      return combinePermissions([\n        teamPermissionsForAccessState(ACCESS_STATE.TEAM.TEAM_ONLY),\n        teamPermissionsForAccessState(ACCESS_STATE.TEAM.GUEST_FEATURES),\n      ]);\n    }\n    case ACCESS_STATE.TEAM.GUEST_FEATURES: {\n      return combinePermissions([ACCESS_TYPES.GUEST, ACCESS_MODES.CODE, ACCESS_TYPES.NON_TEAM_MEMBER]);\n    }\n    case ACCESS_STATE.TEAM.SERVICES: {\n      return combinePermissions([teamPermissionsForAccessState(ACCESS_STATE.TEAM.TEAM_ONLY), ACCESS_TYPES.SERVICE]);\n    }\n    case ACCESS_STATE.TEAM.TEAM_ONLY: {\n      return combinePermissions([ACCESS_MODES.INVITE, ACCESS_TYPES.TEAM_MEMBER]);\n    }\n    default: {\n      return 0;\n    }\n  }\n}\n\nexport function hasAccessToFeature(feature: number, state: ACCESS_STATE): boolean {\n  const permissions = teamPermissionsForAccessState(state);\n  return !!(feature & permissions);\n}\n\nexport function isGettingAccessToFeature(feature: number, prevState: ACCESS_STATE, current: ACCESS_STATE) {\n  return !hasAccessToFeature(feature, prevState) && hasAccessToFeature(feature, current);\n}\n\nexport function featureFromStateChange(prevState: ACCESS_STATE, current: ACCESS_STATE) {\n  if (prevState === current) {\n    return {feature: undefined, featureName: undefined, isAvailable: undefined, bitmask: 0};\n  }\n  const [featureName, featureBitmask] = Object.entries(ACCESS).find(\n    ([, bitmask]) => bitmask & (teamPermissionsForAccessState(prevState) ^ teamPermissionsForAccessState(current)),\n  );\n  const featString = CONVERSATION_ACCESS_ROLE[featureName as keyof typeof CONVERSATION_ACCESS_ROLE];\n  return {\n    feature: featString,\n    featureName: (featString?.[0].toUpperCase() + featString?.slice(1)) as 'Guest' | 'Service',\n    isAvailable: hasAccessToFeature(featureBitmask, current),\n    bitmask: featureBitmask,\n  };\n}\n\n/** AccessStates sorted by permissions. most first */\nconst AccessStatesByPerm = [\n  ACCESS_STATE.TEAM.GUESTS_SERVICES,\n  ACCESS_STATE.TEAM.GUEST_ROOM,\n  ACCESS_STATE.TEAM.SERVICES,\n  ACCESS_STATE.TEAM.TEAM_ONLY,\n  ACCESS_STATE.TEAM.ONE2ONE,\n  ACCESS_STATE.TEAM.LEGACY,\n];\n\nexport function accessFromPermissions(permissions: number): TEAM {\n  const invalidRoles = [ACCESS_STATE.TEAM.LEGACY, ACCESS_STATE.TEAM.ONE2ONE];\n  const detectedRole = AccessStatesByPerm.filter(role => !invalidRoles.includes(role)).find(role =>\n    hasPermissionForRole(permissions, role),\n  );\n  return detectedRole || ACCESS_STATE.TEAM.LEGACY;\n}\n\nfunction hasPermissionForRole(memberPermissions: number, state: ACCESS_STATE): boolean {\n  const rolePermissions = teamPermissionsForAccessState(state);\n  return hasPermissions(memberPermissions, rolePermissions);\n}\n\nexport function toggleFeature(feature: number, state: ACCESS_STATE): TEAM {\n  let permissions = teamPermissionsForAccessState(state);\n  return accessFromPermissions((permissions ^= feature));\n}\n\nexport interface UpdatedAccessRights {\n  accessModes: CONVERSATION_ACCESS[];\n  accessRole: CONVERSATION_ACCESS_ROLE[];\n}\n\n/**\n * This function returns arrays of the names of the new features to be turned on in the backend for each change in access state.\n * @param accessState the new access state\n * @returns {UpdatedAccessRights} UpdatedAccessRights\n */\nexport function updateAccessRights(accessState: ACCESS_STATE): UpdatedAccessRights {\n  const newAccessRights: UpdatedAccessRights = {accessModes: [], accessRole: []};\n\n  teamPermissionsForAccessState(accessState)\n    //turn the permissions into a bitwise value ie. 11011\n    .toString(2)\n    .split('')\n    //reverse so that the index reflects the number of significant figures for finding the feature\n    .reverse()\n    //find the name of the feature with the correct sigfigs\n    .map((bit: '1' | '0', i) => Object.entries(ACCESS).find(([, bitmask]) => bitmask === +bit << i)?.[0])\n    .forEach(feature => {\n      const accessRole = CONVERSATION_ACCESS_ROLE[feature as keyof typeof CONVERSATION_ACCESS_ROLE];\n      const accessModes = CONVERSATION_ACCESS[feature as keyof typeof CONVERSATION_ACCESS];\n      if (accessRole) {\n        newAccessRights.accessRole.push(accessRole);\n      } else if (accessModes) {\n        newAccessRights.accessModes.push(accessModes);\n      }\n    });\n\n  return newAccessRights;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ConversationMessageTimerUpdateEvent, CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport ko from 'knockout';\n\nimport {Article, LinkPreview} from '@wireapp/protocol-messaging';\n\nimport {getLogger, Logger} from 'Util/Logger';\nimport {clamp} from 'Util/NumberUtil';\nimport {obfuscate} from 'Util/StringUtil';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\nimport {arrayToBase64, noop} from 'Util/util';\n\nimport {AbstractConversationEventHandler} from './AbstractConversationEventHandler';\nimport {ConversationMapper} from './ConversationMapper';\n\nimport type {Conversation} from '../entity/Conversation';\nimport type {ContentMessage} from '../entity/message/ContentMessage';\nimport {MediumImage} from '../entity/message/MediumImage';\nimport type {Message} from '../entity/message/Message';\nimport {Text} from '../entity/message/Text';\nimport type {EventService} from '../event/EventService';\nimport {EphemeralStatusType} from '../message/EphemeralStatusType';\nimport {StatusType} from '../message/StatusType';\nimport type {EventRecord} from '../storage';\n\nexport class ConversationEphemeralHandler extends AbstractConversationEventHandler {\n  eventListeners: Record<string, (...args: any[]) => void>;\n  eventService: EventService;\n  logger: Logger;\n  timedMessages: ko.ObservableArray<ContentMessage>;\n  timedMessagesSubscription: ko.Subscription;\n\n  static get CONFIG() {\n    return {\n      INTERVAL_TIME: TIME_IN_MILLIS.SECOND,\n      TIMER_RANGE: {\n        MAX: TIME_IN_MILLIS.YEAR,\n        MIN: TIME_IN_MILLIS.SECOND,\n      },\n    };\n  }\n\n  static validateTimer(messageTimer: number | null): number {\n    const TIMER_RANGE = ConversationEphemeralHandler.CONFIG.TIMER_RANGE;\n    const isTimerReset = messageTimer === null;\n    return isTimerReset ? messageTimer : clamp(messageTimer, TIMER_RANGE.MIN, TIMER_RANGE.MAX);\n  }\n\n  constructor(eventService: EventService, eventListeners: Record<string, (...args: any[]) => void>) {\n    super();\n\n    const defaultEventListeners = {onMessageTimeout: noop};\n    this.eventListeners = {...defaultEventListeners, ...eventListeners};\n    this.eventService = eventService;\n\n    this.setEventHandlingConfig({\n      [CONVERSATION_EVENT.MESSAGE_TIMER_UPDATE]: this._updateEphemeralTimer.bind(this),\n    });\n\n    this.logger = getLogger('ConversationEphemeralHandler');\n\n    this.timedMessages = ko.observableArray([]);\n\n    let updateIntervalId: number | null = null;\n\n    this.timedMessagesSubscription = this.timedMessages.subscribe(messageEntities => {\n      const shouldClearInterval = messageEntities.length === 0 && updateIntervalId;\n      if (shouldClearInterval) {\n        window.clearInterval(updateIntervalId);\n        updateIntervalId = null;\n        return this.logger.info('Cleared ephemeral message check interval');\n      }\n\n      const shouldSetInterval = messageEntities.length !== 0 && !updateIntervalId;\n      if (shouldSetInterval) {\n        const INTERVAL_TIME = ConversationEphemeralHandler.CONFIG.INTERVAL_TIME;\n        updateIntervalId = window.setInterval(() => this._updateTimedMessages(), INTERVAL_TIME);\n        this.logger.info('Started ephemeral message check interval');\n      }\n    });\n  }\n\n  /**\n   * Check the remaining lifetime for a given ephemeral message.\n   *\n   * @param messageEntity Message to check\n   * @param timeOffset Approximate time different to backend in milliseconds\n   */\n  checkMessageTimer = async (messageEntity: ContentMessage, timeOffset: number): Promise<void> => {\n    const hasHitBackend = messageEntity.status() > StatusType.SENDING;\n    if (!hasHitBackend) {\n      return;\n    }\n\n    switch (messageEntity.ephemeral_status()) {\n      case EphemeralStatusType.TIMED_OUT: {\n        await this._timeoutEphemeralMessage(messageEntity);\n        break;\n      }\n\n      case EphemeralStatusType.ACTIVE: {\n        messageEntity.startMessageTimer(timeOffset);\n        break;\n      }\n\n      case EphemeralStatusType.INACTIVE: {\n        messageEntity.startMessageTimer(timeOffset);\n\n        const changes: Pick<Partial<EventRecord>, 'ephemeral_expires' | 'ephemeral_started'> = {\n          ephemeral_expires: messageEntity.ephemeral_expires(),\n          ephemeral_started: Number(messageEntity.ephemeral_started()),\n        };\n\n        this.eventService.updateEvent(messageEntity.primary_key, changes);\n        break;\n      }\n    }\n  };\n\n  async validateMessage(messageEntity: ContentMessage): Promise<Message | void> {\n    const isEphemeralMessage = messageEntity.ephemeral_status() !== EphemeralStatusType.NONE;\n    if (!isEphemeralMessage) {\n      return messageEntity;\n    }\n\n    const isExpired = !!(await this._updateTimedMessage(messageEntity));\n    if (!isExpired) {\n      const {id, conversation_id: conversationId} = messageEntity;\n      const matchingMessageEntity = this.timedMessages().find(timedMessageEntity => {\n        const {conversation_id: timedConversationId, id: timedMessageId} = timedMessageEntity;\n        return timedMessageId === id && timedConversationId === conversationId;\n      });\n\n      if (matchingMessageEntity) {\n        this.timedMessages.replace(matchingMessageEntity, messageEntity);\n      } else {\n        this.timedMessages.push(messageEntity);\n      }\n\n      return messageEntity;\n    }\n  }\n\n  async validateMessages(messageEntities: ContentMessage[]): Promise<Message[]> {\n    const validatedMessages = await Promise.all(\n      messageEntities.map(messageEntity => this.validateMessage(messageEntity)),\n    );\n    return validatedMessages.filter(messageEntity => !!messageEntity) as Message[];\n  }\n\n  private _obfuscateAssetMessage(messageEntity: ContentMessage): void {\n    messageEntity.ephemeral_expires(true);\n\n    const assetEntity = messageEntity.getFirstAsset();\n    const changes: Pick<Partial<EventRecord>, 'data' | 'ephemeral_expires'> = {\n      data: {\n        content_type: assetEntity.file_type,\n        meta: {},\n      },\n      ephemeral_expires: true,\n    };\n\n    this.eventService.updateEvent(messageEntity.primary_key, changes);\n    this.logger.info(`Obfuscated asset message '${messageEntity.id}'`);\n  }\n\n  private _obfuscateImageMessage(messageEntity: ContentMessage): void {\n    messageEntity.ephemeral_expires(true);\n\n    const assetEntity = messageEntity.getFirstAsset() as MediumImage;\n    const changes: Pick<Partial<EventRecord>, 'data' | 'ephemeral_expires'> = {\n      data: {\n        info: {\n          height: assetEntity.size,\n          tag: 'medium',\n          width: assetEntity.width,\n        },\n      },\n      ephemeral_expires: true,\n    };\n\n    this.eventService.updateEvent(messageEntity.primary_key, changes);\n    this.logger.info(`Obfuscated image message '${messageEntity.id}'`);\n  }\n\n  async _obfuscateMessage(messageEntity: ContentMessage): Promise<void> {\n    if (messageEntity.hasAssetText()) {\n      await this._obfuscateTextMessage(messageEntity);\n    } else if (messageEntity.hasAsset()) {\n      this._obfuscateAssetMessage(messageEntity);\n    } else if (messageEntity.hasAssetImage()) {\n      this._obfuscateImageMessage(messageEntity);\n    } else {\n      this.logger.warn(`Ephemeral message of unsupported type: ${messageEntity.type}`, messageEntity);\n    }\n  }\n\n  async _obfuscateTextMessage(messageEntity: ContentMessage): Promise<void> {\n    messageEntity.ephemeral_expires(true);\n\n    const assetEntity = messageEntity.getFirstAsset() as Text;\n    const obfuscatedAsset = new Text(messageEntity.id);\n    const obfuscatedPreviews = await Promise.all(\n      assetEntity.previews().map(linkPreview => {\n        linkPreview.obfuscate();\n        const protoArticle = new Article({permanentUrl: linkPreview.url, title: linkPreview.title}); // deprecated format\n        const linkPreviewProto = new LinkPreview({\n          article: protoArticle,\n          permanentUrl: linkPreview.url,\n          title: linkPreview.title,\n          url: linkPreview.url,\n          urlOffset: 0,\n        });\n        return arrayToBase64(LinkPreview.encode(linkPreviewProto).finish());\n      }),\n    );\n\n    obfuscatedAsset.text = obfuscate(assetEntity.text);\n    obfuscatedAsset.previews(assetEntity.previews());\n\n    messageEntity.assets([obfuscatedAsset]);\n    const changes: Pick<Partial<EventRecord>, 'data' | 'ephemeral_expires'> = {\n      data: {\n        content: obfuscatedAsset.text,\n        previews: obfuscatedPreviews,\n      },\n      ephemeral_expires: true,\n    };\n\n    this.eventService.updateEvent(messageEntity.primary_key, changes);\n    this.logger.info(`Obfuscated text message '${messageEntity.id}'`);\n  }\n\n  async _timeoutEphemeralMessage(messageEntity: ContentMessage): Promise<void> {\n    if (!messageEntity.isExpired()) {\n      if (messageEntity.user().isMe) {\n        await this._obfuscateMessage(messageEntity);\n      }\n\n      this.eventListeners.onMessageTimeout(messageEntity);\n    }\n  }\n\n  /**\n   * Updates the ephemeral timer of a conversation when an timer-update message is received.\n   *\n   * @param conversationEntity Conversation entity which message timer was changed\n   * @param eventJson JSON data of 'conversation.message-timer-update' event\n   * @returns Resolves when the event was handled\n   */\n  private _updateEphemeralTimer(\n    conversationEntity: Conversation,\n    eventJson: ConversationMessageTimerUpdateEvent,\n  ): Promise<Conversation> {\n    const updates = {globalMessageTimer: ConversationEphemeralHandler.validateTimer(eventJson.data.message_timer)};\n    ConversationMapper.updateProperties(conversationEntity, updates);\n    return Promise.resolve(conversationEntity);\n  }\n\n  async _updateTimedMessage(messageEntity: ContentMessage): Promise<ContentMessage | void> {\n    if (typeof messageEntity.ephemeral_expires() === 'string') {\n      const remainingTime = Math.max(0, (messageEntity.ephemeral_expires() as number) - Date.now());\n      messageEntity.ephemeral_remaining(remainingTime);\n\n      const isExpired = remainingTime === 0;\n      if (isExpired) {\n        await this._timeoutEphemeralMessage(messageEntity);\n        return messageEntity;\n      }\n    }\n  }\n\n  async _updateTimedMessages(): Promise<void> {\n    const updatedMessages = await Promise.all(\n      this.timedMessages().map(messageEntity => this._updateTimedMessage(messageEntity)),\n    );\n    const expiredMessages = updatedMessages.filter(messageEntity => !!messageEntity) as ContentMessage[];\n\n    if (expiredMessages.length !== 0) {\n      this.timedMessages.remove(messageEntity => {\n        for (const expiredMessage of expiredMessages) {\n          const {conversation_id: conversationId, id: messageId} = expiredMessage;\n          const isExpiredMessage = messageEntity.id === messageId && messageEntity.conversation_id === conversationId;\n          if (isExpiredMessage) {\n            return true;\n          }\n        }\n\n        return false;\n      });\n    }\n  }\n\n  dispose(): void {\n    this.timedMessagesSubscription.dispose();\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {matchQualifiedIds} from 'Util/QualifiedId';\n\nimport type {Conversation} from '../entity/Conversation';\nimport type {User} from '../entity/User';\n\nexport class ConversationFilter {\n  static is1To1WithUser(conversationEntity: Conversation, userEntity: User): boolean {\n    const [user] = conversationEntity.participating_user_ids();\n    return matchQualifiedIds(userEntity, user);\n  }\n\n  static isInTeam(conversationEntity: Conversation, userEntity: User): boolean {\n    return userEntity.teamId === conversationEntity.team_id && conversationEntity.domain === userEntity.domain;\n  }\n\n  static showCallControls(conversationEntity: Conversation, hasCall: boolean): boolean {\n    const isSupportedConversation = conversationEntity.isGroup() || conversationEntity.is1to1();\n    const hasParticipants = !!conversationEntity.participating_user_ids().length;\n    const isActiveConversation = hasParticipants && !conversationEntity.removed_from_conversation();\n    return !hasCall && isSupportedConversation && isActiveConversation;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport class TypedEventTarget<EventDef extends {type: any}> extends EventTarget {\n  public dispatch(event: EventDef): boolean {\n    return this.dispatchEvent(new Event(event.type));\n  }\n\n  public addEventListener<T extends EventDef['type']>(type: T, listener: ((e: Event & EventDef) => void) | null) {\n    super.addEventListener(type, listener);\n  }\n\n  public removeEventListener(type: EventDef['type'], listener: (e: Event & EventDef) => void) {\n    super.removeEventListener(type, listener);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {USER_EVENT} from '@wireapp/api-client/lib/event/';\nimport {amplify} from 'amplify';\nimport ko from 'knockout';\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {TypedEventTarget} from 'Util/TypedEventTarget';\nimport {createRandomUuid} from 'Util/util';\n\nimport {PrimaryModal} from '../components/Modals/PrimaryModal';\nimport type {Conversation} from '../entity/Conversation';\nimport type {PropertiesService} from '../properties/PropertiesService';\n\nexport enum LabelType {\n  Custom = 0,\n  Favorite = 1,\n}\n\nexport enum DefaultLabelIds {\n  Contacts = 'contacts',\n  Favorites = 'favorites',\n  Groups = 'groups',\n}\n\nexport interface ConversationLabel {\n  conversations: ko.ObservableArray<Conversation>;\n  id: string;\n  name: string;\n  type: LabelType;\n}\n\ninterface ConversationLabelJson extends Omit<ConversationLabel, 'conversations'> {\n  conversations: string[];\n}\n\ninterface LabelProperty {\n  labels: ConversationLabelJson[];\n}\n\nconst propertiesKey = 'labels';\n\nexport const createLabel = (\n  name: string,\n  conversations: Conversation[] = [],\n  id: string = createRandomUuid(),\n  type: LabelType = LabelType.Custom,\n): ConversationLabel => ({\n  conversations: ko.observableArray(conversations),\n  id,\n  name,\n  type,\n});\n\nexport const createLabelGroups = (groups: Conversation[] = []) =>\n  createLabel(t('conversationLabelGroups'), groups, DefaultLabelIds.Groups);\n\nexport const createLabelPeople = (contacts: Conversation[] = []) =>\n  createLabel(t('conversationLabelPeople'), contacts, DefaultLabelIds.Contacts);\n\nexport const createLabelFavorites = (favorites: Conversation[] = []) =>\n  createLabel(t('conversationLabelFavorites'), favorites, DefaultLabelIds.Favorites);\n\nexport class ConversationLabelRepository extends TypedEventTarget<{type: 'conversation-favorited'}> {\n  labels: ko.ObservableArray<ConversationLabel>;\n  private allLabeledConversations: ko.Computed<Conversation[]>;\n  private logger: Logger;\n\n  constructor(\n    private readonly allConversations: ko.ObservableArray<Conversation>,\n    private readonly conversations: ko.PureComputed<Conversation[]>,\n    private readonly propertiesService: PropertiesService,\n  ) {\n    super();\n    this.labels = ko.observableArray([]);\n    this.allLabeledConversations = ko.pureComputed(() =>\n      this.labels().reduce(\n        (accumulated: Conversation[], {conversations, type}) =>\n          type === LabelType.Custom ? accumulated.concat(conversations()) : accumulated,\n        [],\n      ),\n    );\n    this.logger = getLogger('ConversationLabelRepository');\n    amplify.subscribe(WebAppEvents.USER.EVENT_FROM_BACKEND, this.onUserEvent);\n  }\n\n  readonly marshal = (): LabelProperty => {\n    const labelJson = this.labels().map(({id, type, name, conversations}) => ({\n      conversations: conversations().map(({id}) => id),\n      id,\n      name,\n      type,\n    }));\n    return {labels: labelJson};\n  };\n\n  readonly unmarshal = (labelJson: LabelProperty) => {\n    const labels = labelJson.labels.map(\n      ({id, type, name, conversations}): ConversationLabel => ({\n        conversations: ko.observableArray(\n          conversations\n            .map(conversationId =>\n              this.allConversations().find(({id}) => id.toLowerCase() === conversationId.toLowerCase()),\n            )\n            .filter(conversation => !!conversation),\n        ),\n        id,\n        name,\n        type,\n      }),\n    );\n    this.labels(labels);\n  };\n\n  readonly saveLabels = () => {\n    this.propertiesService.putPropertiesByKey(propertiesKey, this.marshal());\n  };\n\n  loadLabels = async () => {\n    try {\n      const labelProperties = await this.propertiesService.getPropertiesByKey(propertiesKey);\n      this.unmarshal(labelProperties);\n    } catch (error) {\n      this.logger.warn(`No labels were loaded: ${error.message}`);\n    }\n  };\n\n  readonly onUserEvent = (event: any) => {\n    if (event.type === USER_EVENT.PROPERTIES_SET && event.key === propertiesKey) {\n      this.unmarshal(event.value);\n    }\n  };\n\n  readonly getGroupsWithoutLabel = (conversations = this.conversations()) => {\n    return conversations.filter(\n      conversation => conversation.isGroup() && !this.allLabeledConversations().includes(conversation),\n    );\n  };\n\n  readonly getContactsWithoutLabel = (conversations = this.conversations()) => {\n    return conversations.filter(\n      conversation => !conversation.isGroup() && !this.allLabeledConversations().includes(conversation),\n    );\n  };\n\n  readonly getFavoriteLabel = (): ConversationLabel => this.labels().find(({type}) => type === LabelType.Favorite);\n  readonly getLabelById = (labelId: string): ConversationLabel => this.labels().find(({id}) => id === labelId);\n\n  readonly getFavorites = (conversations = this.conversations()): Conversation[] =>\n    this.getLabelConversations(this.getFavoriteLabel(), conversations);\n\n  readonly getLabelConversations = (label: ConversationLabel, conversations = this.conversations()): Conversation[] =>\n    label ? conversations.filter(conversation => label.conversations().includes(conversation)) : [];\n\n  readonly isFavorite = (conversation: Conversation): boolean => this.getFavorites().includes(conversation);\n\n  readonly addConversationToFavorites = (addedConversation: Conversation): void => {\n    let favoriteLabel = this.getFavoriteLabel();\n    if (!favoriteLabel) {\n      // The favorite label doesn't need a name since it is set at runtime for i18n compatibility\n      favoriteLabel = createLabel('', undefined, undefined, LabelType.Favorite);\n      this.labels.push(favoriteLabel);\n    }\n    favoriteLabel.conversations.push(addedConversation);\n    this.dispatch({type: 'conversation-favorited'});\n    this.saveLabels();\n  };\n\n  readonly removeConversationFromFavorites = (removedConversation: Conversation): void => {\n    const favoriteLabel = this.getFavoriteLabel();\n    if (favoriteLabel) {\n      favoriteLabel.conversations(\n        favoriteLabel.conversations().filter(conversation => conversation !== removedConversation),\n      );\n    }\n    this.saveLabels();\n  };\n\n  readonly getConversationLabelIds = (conversation: Conversation): string[] => {\n    const ids: string[] = [];\n\n    if (this.getFavorites().includes(conversation)) {\n      ids.push(DefaultLabelIds.Favorites);\n    }\n\n    const isInCustomFolder = this.allLabeledConversations().includes(conversation);\n\n    if (isInCustomFolder) {\n      ids.push(this.getConversationCustomLabel(conversation).id);\n    } else if (conversation.isGroup()) {\n      ids.push(DefaultLabelIds.Groups);\n    } else {\n      ids.push(DefaultLabelIds.Contacts);\n    }\n\n    return ids;\n  };\n\n  readonly getConversationCustomLabel = (conversation: Conversation, includeFavorites: boolean = false) =>\n    this.labels().find(\n      ({type, conversations}) =>\n        (includeFavorites || type === LabelType.Custom) && conversations().includes(conversation),\n    );\n\n  readonly getLabels = (): ConversationLabel[] =>\n    this.labels()\n      .filter(({type}) => type === LabelType.Custom)\n      .sort(({name: nameA}, {name: nameB}) => nameA.localeCompare(nameB, undefined, {sensitivity: 'base'}));\n\n  readonly removeConversationFromLabel = (label: ConversationLabel, removeConversation: Conversation): void => {\n    label.conversations(label.conversations().filter(conversation => conversation !== removeConversation));\n    if (!label.conversations().length) {\n      this.labels.remove(label);\n    }\n    this.saveLabels();\n  };\n\n  readonly removeConversationFromAllLabels = (\n    removeConversation: Conversation,\n    removeFromFavorites: boolean = false,\n  ): void => {\n    this.labels().forEach(label => {\n      const isCustom = label.type === LabelType.Custom;\n      if (removeFromFavorites || isCustom) {\n        label.conversations(label.conversations().filter(conversation => conversation !== removeConversation));\n      }\n      if (isCustom && !label.conversations().length) {\n        this.labels.remove(label);\n      }\n    });\n  };\n\n  readonly addConversationToLabel = (label: ConversationLabel, conversation: Conversation): void => {\n    if (!label.conversations().includes(conversation)) {\n      this.removeConversationFromAllLabels(conversation);\n      label.conversations.push(conversation);\n      amplify.publish(WebAppEvents.CONTENT.EXPAND_FOLDER, label.id);\n      this.saveLabels();\n    }\n  };\n\n  readonly addConversationToNewLabel = (conversation: Conversation) => {\n    PrimaryModal.show(PrimaryModal.type.INPUT, {\n      primaryAction: {\n        action: (name: string) => {\n          this.removeConversationFromAllLabels(conversation);\n          const newFolder = createLabel(name, [conversation]);\n          this.labels.push(newFolder);\n          amplify.publish(WebAppEvents.CONTENT.EXPAND_FOLDER, newFolder.id);\n          this.saveLabels();\n        },\n        text: t('modalCreateFolderAction'),\n      },\n      text: {\n        closeBtnLabel: t('modalNewFolderCloseBtn'),\n        input: t('modalCreateFolderPlaceholder'),\n        message: t('modalCreateFolderMessage'),\n        title: t('modalCreateFolderHeadline'),\n      },\n    });\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  CONVERSATION_ACCESS_ROLE,\n  Conversation as ConversationBackendData,\n  ConversationCode,\n  CONVERSATION_ACCESS,\n  CONVERSATION_LEGACY_ACCESS_ROLE,\n  CONVERSATION_TYPE,\n  DefaultConversationRoleName,\n  RemoteConversations,\n} from '@wireapp/api-client/lib/conversation';\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport ko from 'knockout';\nimport {isObject} from 'underscore';\n\nimport {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport {matchQualifiedIds, QualifiedEntity} from 'Util/QualifiedId';\n\nimport {ACCESS_STATE} from './AccessState';\nimport {ConversationStatus} from './ConversationStatus';\n\nimport {Conversation} from '../entity/Conversation';\nimport {BaseError, BASE_ERROR_TYPE} from '../error/BaseError';\nimport {ConversationError} from '../error/ConversationError';\nimport {ConversationRecord} from '../storage/record/ConversationRecord';\n\n/** Conversation self data from the database. */\nexport interface SelfStatusUpdateDatabaseData {\n  archived_state: boolean;\n  archived_timestamp: number;\n  cleared_timestamp: number;\n  ephemeral_timer: number;\n  last_event_timestamp: number;\n  last_read_timestamp: number;\n  last_server_timestamp: number;\n  legal_hold_status: LegalHoldStatus;\n  message_timer: number;\n  muted_state: number;\n  muted_timestamp: number;\n  otr_archived: boolean;\n  otr_archived_ref: string;\n  otr_muted: boolean;\n  otr_muted_ref: string;\n  otr_muted_status: number;\n  receipt_mode: number;\n  status: number;\n  verification_state: number;\n}\n\nexport type ConversationDatabaseData = ConversationRecord &\n  Partial<ConversationBackendData> & {\n    accessModes?: CONVERSATION_ACCESS[];\n    //CONVERSATION_LEGACY_ACCESS_ROLE for api <= v2, CONVERSATION_ACCESS_ROLE[] since api v3\n    accessRole?: CONVERSATION_LEGACY_ACCESS_ROLE | CONVERSATION_ACCESS_ROLE[];\n    accessRoleV2?: CONVERSATION_ACCESS_ROLE[];\n    roles: {[userId: string]: DefaultConversationRoleName | string};\n    status: ConversationStatus;\n    team_id: string;\n  };\n\nexport class ConversationMapper {\n  static mapConversations(conversationsData: ConversationDatabaseData[], timestamp: number = 1): Conversation[] {\n    if (conversationsData === undefined) {\n      throw new ConversationError(BASE_ERROR_TYPE.MISSING_PARAMETER, BaseError.MESSAGE.MISSING_PARAMETER);\n    }\n    if (!Array.isArray(conversationsData) || !conversationsData.length) {\n      throw new ConversationError(BASE_ERROR_TYPE.INVALID_PARAMETER, BaseError.MESSAGE.INVALID_PARAMETER);\n    }\n    return conversationsData.map((conversationData: ConversationDatabaseData, index: number) => {\n      return ConversationMapper.createConversationEntity(conversationData, timestamp + index);\n    });\n  }\n\n  static updateProperties(\n    conversationEntity: Conversation,\n    conversationData: Partial<Record<keyof Conversation, any>>,\n  ): Conversation {\n    Object.entries(conversationData).forEach(([key, value]: [keyof Conversation, string]) => {\n      if (key !== 'id') {\n        if (value !== undefined && conversationEntity.hasOwnProperty(key)) {\n          if (ko.isObservable(conversationEntity[key])) {\n            (conversationEntity[key] as ko.Observable)(value);\n          } else {\n            (conversationEntity[key] as any) = value;\n          }\n        }\n      }\n    });\n\n    return conversationEntity;\n  }\n\n  static updateSelfStatus(\n    conversationEntity: Conversation,\n    selfState: Partial<SelfStatusUpdateDatabaseData>,\n    disablePersistence: boolean = false,\n  ): Conversation {\n    if (disablePersistence) {\n      conversationEntity.setStateChangePersistence(false);\n    }\n\n    // Database states\n    const {\n      archived_timestamp,\n      cleared_timestamp,\n      ephemeral_timer,\n      message_timer,\n      last_event_timestamp,\n      last_read_timestamp,\n      last_server_timestamp,\n      legal_hold_status,\n      muted_timestamp,\n      receipt_mode,\n      status,\n      verification_state,\n    } = selfState;\n\n    if (archived_timestamp) {\n      conversationEntity.setTimestamp(archived_timestamp, Conversation.TIMESTAMP_TYPE.ARCHIVED);\n      conversationEntity.archivedState(selfState.archived_state ?? false);\n    }\n\n    if (cleared_timestamp !== undefined) {\n      conversationEntity.setTimestamp(cleared_timestamp, Conversation.TIMESTAMP_TYPE.CLEARED, true);\n    }\n\n    if (ephemeral_timer !== undefined) {\n      conversationEntity.localMessageTimer(ephemeral_timer);\n    }\n\n    if (message_timer !== undefined) {\n      conversationEntity.globalMessageTimer(message_timer);\n    }\n\n    if (receipt_mode !== undefined) {\n      conversationEntity.receiptMode(receipt_mode);\n    }\n\n    if (last_event_timestamp) {\n      conversationEntity.setTimestamp(last_event_timestamp, Conversation.TIMESTAMP_TYPE.LAST_EVENT);\n    }\n\n    if (last_read_timestamp) {\n      conversationEntity.setTimestamp(last_read_timestamp, Conversation.TIMESTAMP_TYPE.LAST_READ);\n    }\n\n    if (last_server_timestamp) {\n      conversationEntity.setTimestamp(last_server_timestamp, Conversation.TIMESTAMP_TYPE.LAST_SERVER);\n    }\n\n    if (muted_timestamp) {\n      conversationEntity.setTimestamp(muted_timestamp, Conversation.TIMESTAMP_TYPE.MUTED);\n      conversationEntity.mutedState(selfState.muted_state);\n    }\n\n    if (status !== undefined) {\n      conversationEntity.status(status);\n    }\n\n    if (verification_state !== undefined) {\n      conversationEntity.verification_state(verification_state);\n    }\n\n    if (legal_hold_status) {\n      conversationEntity.legalHoldStatus(legal_hold_status);\n    }\n\n    // Backend states\n    const {otr_archived, otr_muted_status: mutedState} = selfState;\n\n    if (otr_archived !== undefined) {\n      const archivedTimestamp = new Date(selfState.otr_archived_ref).getTime();\n      conversationEntity.setTimestamp(archivedTimestamp, Conversation.TIMESTAMP_TYPE.ARCHIVED);\n      conversationEntity.archivedState(otr_archived);\n    }\n\n    if (mutedState !== undefined) {\n      const mutedTimestamp = new Date(selfState.otr_muted_ref).getTime();\n      conversationEntity.setTimestamp(mutedTimestamp, Conversation.TIMESTAMP_TYPE.MUTED);\n      conversationEntity.mutedState(mutedState);\n    }\n\n    if (disablePersistence) {\n      conversationEntity.setStateChangePersistence(true);\n    }\n\n    return conversationEntity;\n  }\n\n  private static createConversationEntity(\n    conversationData: ConversationDatabaseData,\n    initialTimestamp?: number,\n  ): Conversation {\n    if (conversationData === undefined) {\n      throw new ConversationError(BASE_ERROR_TYPE.MISSING_PARAMETER, BaseError.MESSAGE.MISSING_PARAMETER);\n    }\n    if (!isObject(conversationData) || !Object.keys(conversationData).length) {\n      throw new ConversationError(BASE_ERROR_TYPE.INVALID_PARAMETER, BaseError.MESSAGE.INVALID_PARAMETER);\n    }\n\n    const {creator, id, members, name, others, qualified_others, type, group_id, epoch, protocol, cipher_suite} =\n      conversationData;\n\n    let conversationEntity = new Conversation(\n      id,\n      conversationData.domain || conversationData.qualified_id?.domain,\n      protocol,\n    );\n    conversationEntity.roles(conversationData.roles || {});\n\n    conversationEntity.creator = creator;\n    conversationEntity.groupId = group_id;\n    conversationEntity.epoch = epoch ?? -1;\n    conversationEntity.cipherSuite = cipher_suite;\n    conversationEntity.type(type);\n    conversationEntity.name(name || '');\n\n    const selfState = members?.self || conversationData;\n    conversationEntity = ConversationMapper.updateSelfStatus(conversationEntity, selfState as any);\n\n    if (!conversationEntity.last_event_timestamp() && initialTimestamp) {\n      conversationEntity.last_event_timestamp(initialTimestamp);\n      conversationEntity.last_server_timestamp(initialTimestamp);\n    }\n\n    // Active participants from database or backend payload\n    const participatingUserIds =\n      qualified_others ||\n      (members?.others\n        ? members.others.map(other => ({domain: other.qualified_id?.domain || '', id: other.id}))\n        : others.map(userId => ({domain: '', id: userId})));\n\n    conversationEntity.participating_user_ids(participatingUserIds);\n\n    // Team ID from database or backend payload\n    const teamId = conversationData.team_id || conversationData.team;\n    if (teamId) {\n      conversationEntity.team_id = teamId;\n    }\n\n    if (conversationData.is_guest) {\n      conversationEntity.isGuest(conversationData.is_guest);\n    }\n\n    // Access related data\n    const accessModes = conversationData.accessModes || conversationData.access;\n    const accessRole = conversationData.accessRole || conversationData.access_role;\n    const accessRoleV2 = conversationData.accessRoleV2 || conversationData.access_role_v2;\n    if (accessModes && (accessRole || accessRoleV2)) {\n      conversationEntity.accessModes = accessModes;\n      conversationEntity.accessRole = accessRoleV2 || accessRole;\n\n      ConversationMapper.mapAccessState(conversationEntity, accessModes, accessRole, accessRoleV2);\n    }\n\n    conversationEntity.receiptMode(conversationData.receipt_mode);\n\n    return conversationEntity;\n  }\n\n  static mergeConversation(\n    localConversations: ConversationDatabaseData[],\n    remoteConversations: RemoteConversations,\n  ): ConversationDatabaseData[] {\n    localConversations = localConversations.filter(conversationData => conversationData);\n\n    const failedConversations = (remoteConversations.failed ?? []).reduce(\n      (prev: ConversationDatabaseData[], curr: QualifiedId) => {\n        const convo = localConversations.find(conversationId => matchQualifiedIds(conversationId, curr));\n        return convo ? [...prev, convo] : prev;\n      },\n      [],\n    );\n\n    const localArchives = localConversations.filter(\n      conversationData =>\n        conversationData.archived_state &&\n        remoteConversations.found?.findIndex(remote => remote.qualified_id.id === conversationData.id) === -1,\n    );\n\n    const foundRemoteConversations = remoteConversations.found.map(\n      (remoteConversationData: ConversationBackendData, index: number) => {\n        const remoteConversationId: QualifiedEntity = remoteConversationData.qualified_id || {\n          domain: '',\n          id: remoteConversationData.id,\n        };\n        const localConversationData =\n          localConversations.find(conversationId => matchQualifiedIds(conversationId, remoteConversationId)) ||\n          (remoteConversationId as ConversationDatabaseData);\n\n        const {\n          access,\n          access_role,\n          access_role_v2,\n          creator,\n          members,\n          message_timer,\n          qualified_id,\n          receipt_mode,\n          name,\n          team,\n          type,\n          group_id,\n          epoch,\n          cipher_suite,\n          protocol,\n        } = remoteConversationData;\n        const {others: othersStates, self: selfState} = members;\n\n        const updates: Partial<ConversationDatabaseData> = {\n          accessModes: access,\n          accessRole: access_role,\n          accessRoleV2: access_role_v2,\n          cipher_suite,\n          creator,\n          domain: qualified_id?.domain,\n          group_id,\n          message_timer,\n          name,\n          protocol,\n          receipt_mode,\n          roles: {},\n          status: (selfState as any).status,\n          team_id: team,\n          type,\n        };\n\n        const qualified_others = othersStates\n          ?.filter(other => !!other.qualified_id)\n          .map(({qualified_id}) => qualified_id);\n\n        if (qualified_others.length) {\n          updates.qualified_others = qualified_others;\n        }\n\n        if (typeof epoch === 'number') {\n          updates.epoch = epoch;\n        }\n\n        // Add roles for self\n        if (selfState.conversation_role && !(selfState.id in updates.roles)) {\n          updates.roles[selfState.id] = selfState.conversation_role;\n        }\n\n        // Add roles for others\n        othersStates.map(other => {\n          if (other.conversation_role && !(other.conversation_role in updates.roles)) {\n            updates.roles[other.id] = other.conversation_role;\n          }\n        });\n\n        if (typeof localConversationData.receipt_mode === 'number') {\n          updates.receipt_mode = localConversationData.receipt_mode;\n        }\n\n        const mergedConversation: ConversationDatabaseData = {...localConversationData, ...updates};\n\n        const isGroup = type === CONVERSATION_TYPE.REGULAR;\n        const noOthers = !mergedConversation.others || !mergedConversation.others.length;\n        if (isGroup || noOthers) {\n          mergedConversation.others = othersStates\n            .filter(otherState => (otherState.status as number) === (ConversationStatus.CURRENT_MEMBER as number))\n            .map(otherState => otherState.id);\n        }\n\n        // This should ensure a proper order\n        if (!mergedConversation.last_event_timestamp) {\n          mergedConversation.last_event_timestamp = index + 1;\n        }\n\n        // Set initially or correct server timestamp\n        const wrongServerTimestamp = mergedConversation.last_server_timestamp < mergedConversation.last_event_timestamp;\n        if (!mergedConversation.last_server_timestamp || wrongServerTimestamp) {\n          mergedConversation.last_server_timestamp = mergedConversation.last_event_timestamp;\n        }\n\n        const isRemoteTimestampNewer = (localTimestamp: number | undefined, remoteTimestamp: number): boolean => {\n          return localTimestamp !== undefined && remoteTimestamp > localTimestamp;\n        };\n\n        // Some archived timestamp were not properly stored in the database.\n        // To fix this we check if the remote one is newer and update our local timestamp.\n        const {archived_state: archivedState, archived_timestamp: archivedTimestamp} = localConversationData;\n        const remoteArchivedTimestamp = new Date(selfState.otr_archived_ref).getTime();\n        const isRemoteArchivedTimestampNewer = isRemoteTimestampNewer(archivedTimestamp, remoteArchivedTimestamp);\n\n        if (isRemoteArchivedTimestampNewer || archivedState === undefined) {\n          mergedConversation.archived_state = selfState.otr_archived;\n          mergedConversation.archived_timestamp = remoteArchivedTimestamp;\n        }\n\n        const {muted_state: mutedState, muted_timestamp: mutedTimestamp} = localConversationData;\n        const remoteMutedTimestamp = new Date(selfState.otr_muted_ref).getTime();\n        const isRemoteMutedTimestampNewer = isRemoteTimestampNewer(mutedTimestamp, remoteMutedTimestamp);\n\n        if (isRemoteMutedTimestampNewer || mutedState === undefined) {\n          const remoteMutedState = selfState.otr_muted_status;\n          mergedConversation.muted_state = remoteMutedState;\n          mergedConversation.muted_timestamp = remoteMutedTimestamp;\n        }\n\n        return mergedConversation;\n      },\n    );\n    return [...foundRemoteConversations, ...failedConversations, ...localArchives];\n  }\n\n  static mapAccessCode(conversation: Conversation, accessCode: ConversationCode): void {\n    const isTeamConversation = conversation && conversation.team_id;\n\n    if (accessCode.uri && isTeamConversation) {\n      const baseUrl = `${window.wire.env.URL.ACCOUNT_BASE}/conversation-join/?key=${accessCode.key}&code=${accessCode.code}`;\n      const accessCodeUrl = conversation.domain ? `${baseUrl}&domain=${conversation.domain}` : baseUrl;\n      conversation.accessCode(accessCodeUrl);\n    }\n  }\n\n  static mapAccessState(\n    conversationEntity: Conversation,\n    accessModes: CONVERSATION_ACCESS[],\n    accessRole: CONVERSATION_LEGACY_ACCESS_ROLE | CONVERSATION_ACCESS_ROLE[],\n    accessRoleV2?: CONVERSATION_ACCESS_ROLE[],\n  ): typeof ACCESS_STATE {\n    if (conversationEntity.team_id) {\n      if (conversationEntity.is1to1()) {\n        return conversationEntity.accessState(ACCESS_STATE.TEAM.ONE2ONE);\n      }\n\n      let accessState: ACCESS_STATE | undefined;\n\n      //api <= v2/v3\n      //this is important to check this one first (backwards compatibility)\n      if (Array.isArray(accessRoleV2)) {\n        accessState = this.mapAccessStateV2(accessRoleV2);\n\n        //api v3\n      } else if (Array.isArray(accessRole)) {\n        accessState = this.mapAccessStateV2(accessRole);\n      }\n\n      if (accessState) {\n        return conversationEntity.accessState(accessState);\n      }\n\n      //api <= v2 legacy\n      if (!Array.isArray(accessRole)) {\n        return conversationEntity.accessState(this.mapLegacyAccessState(accessModes, accessRole));\n      }\n    }\n\n    if (conversationEntity.isSelf()) {\n      return conversationEntity.accessState(ACCESS_STATE.OTHER.SELF);\n    }\n\n    const personalAccessState = conversationEntity.isGroup()\n      ? ACCESS_STATE.PERSONAL.GROUP\n      : ACCESS_STATE.PERSONAL.ONE2ONE;\n\n    return conversationEntity.accessState(personalAccessState);\n  }\n\n  private static mapAccessStateV2(accessRole: CONVERSATION_ACCESS_ROLE[]) {\n    if (!accessRole.includes(CONVERSATION_ACCESS_ROLE.TEAM_MEMBER)) {\n      return undefined;\n    }\n\n    if (\n      accessRole.includes(CONVERSATION_ACCESS_ROLE.GUEST) ||\n      accessRole.includes(CONVERSATION_ACCESS_ROLE.NON_TEAM_MEMBER)\n    ) {\n      if (accessRole.includes(CONVERSATION_ACCESS_ROLE.SERVICE)) {\n        return ACCESS_STATE.TEAM.GUESTS_SERVICES;\n      }\n      return ACCESS_STATE.TEAM.GUEST_ROOM;\n    } else if (accessRole.includes(CONVERSATION_ACCESS_ROLE.SERVICE)) {\n      return ACCESS_STATE.TEAM.SERVICES;\n    }\n    return ACCESS_STATE.TEAM.TEAM_ONLY;\n  }\n\n  private static mapLegacyAccessState(\n    accessModes: CONVERSATION_ACCESS[],\n    accessRole: CONVERSATION_LEGACY_ACCESS_ROLE,\n  ): ACCESS_STATE {\n    const isTeamRole = accessRole === CONVERSATION_LEGACY_ACCESS_ROLE.TEAM;\n\n    const includesInviteMode = accessModes.includes(CONVERSATION_ACCESS.INVITE);\n    const isInviteModeOnly = includesInviteMode && accessModes.length === 1;\n\n    const isTeamOnlyMode = isTeamRole && isInviteModeOnly;\n    if (isTeamOnlyMode) {\n      return ACCESS_STATE.TEAM.TEAM_ONLY;\n    }\n\n    const isActivatedRole = accessRole === CONVERSATION_LEGACY_ACCESS_ROLE.ACTIVATED;\n    if (isActivatedRole) {\n      return ACCESS_STATE.TEAM.GUEST_ROOM;\n    }\n    const isNonActivatedRole = accessRole === CONVERSATION_LEGACY_ACCESS_ROLE.NON_ACTIVATED;\n\n    const includesCodeMode = accessModes.includes(CONVERSATION_ACCESS.CODE);\n    const isExpectedModes = includesCodeMode && includesInviteMode && accessModes.length === 2;\n\n    const isGuestRoomMode = isNonActivatedRole && isExpectedModes;\n\n    return isGuestRoomMode ? ACCESS_STATE.TEAM.GUESTS_SERVICES : ACCESS_STATE.TEAM.LEGACY;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Logger, getLogger} from 'Util/Logger';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\ninterface PromiseQueueOptions {\n  /** Concurrent promise execution. Default is 1. */\n  concurrent?: number;\n  /** Name for Promise queue */\n  name: string;\n  /** Initial paused state. Default is `false`. */\n  paused?: boolean;\n  /** Timeout in ms. Default is 1000 (1 minute). */\n  timeout?: number;\n}\n\nexport type PromiseFn<T> = (...args: any[]) => Promise<T>;\nexport type PromiseResolveFn = (value?: unknown) => void;\nexport type PromiseRejectFn = (reason?: any) => void;\n\nexport interface QueueEntry<T> {\n  fn: PromiseFn<T>;\n  rejectFn: PromiseRejectFn;\n  resolveFn?: PromiseResolveFn;\n}\n\nexport class PromiseQueue {\n  private blocked: boolean;\n  private current: number;\n  private interval?: number;\n  private paused: boolean;\n  private readonly concurrent: number;\n  private readonly logger: Logger;\n  private readonly queue: QueueEntry<any>[];\n  private readonly timeout: number;\n\n  static get CONFIG() {\n    return {\n      UNBLOCK_INTERVAL: TIME_IN_MILLIS.MINUTE,\n    };\n  }\n\n  constructor(options?: PromiseQueueOptions) {\n    const loggerName = `PromiseQueue`;\n    this.logger = getLogger(loggerName);\n\n    this.blocked = false;\n    this.concurrent = options.concurrent ?? 1;\n    this.current = 0;\n    this.interval = undefined;\n    this.paused = options.paused ?? false;\n    this.queue = [];\n    this.timeout = options.timeout ?? PromiseQueue.CONFIG.UNBLOCK_INTERVAL;\n  }\n\n  /**\n   * Executes first function in the queue.\n   */\n  execute(): void {\n    if (this.paused || this.blocked) {\n      return;\n    }\n\n    const queueEntry = this.queue.shift();\n    if (queueEntry) {\n      this.clearInterval();\n\n      this.current++;\n\n      if (this.current >= this.concurrent) {\n        this.blocked = true;\n      }\n\n      this.interval = window.setInterval(() => {\n        if (!this.paused) {\n          const logObject = {pendingEntry: queueEntry, queueState: this.queue};\n          this.logger.warn(`Promise queue timed-out after ${this.timeout}ms, unblocking queue`, logObject);\n          this.resume();\n        }\n      }, this.timeout);\n\n      queueEntry\n        .fn()\n        .catch(error => {\n          queueEntry.resolveFn = undefined;\n          queueEntry.rejectFn(error);\n        })\n        .then(response => {\n          if (queueEntry.resolveFn) {\n            queueEntry.resolveFn(response);\n          }\n\n          this.clearInterval();\n\n          this.current--;\n\n          if (this.current < this.concurrent) {\n            this.blocked = false;\n          }\n\n          window.setTimeout(() => this.execute(), 0);\n        });\n    }\n  }\n\n  /**\n   * Get the number of queued functions.\n   * @returns Number of queued functions\n   */\n  getLength(): number {\n    return this.queue.length;\n  }\n\n  /**\n   * Pause or resume the execution.\n   */\n  pause(shouldPause: boolean = true): PromiseQueue {\n    this.paused = shouldPause;\n\n    if (!this.paused) {\n      this.execute();\n    }\n\n    return this;\n  }\n\n  /**\n   * Queued function is executed when queue is empty or previous functions are executed.\n   * @param fn Function to be executed in queue order\n   * @returns Resolves when function was executed\n   */\n  push<T>(fn: PromiseFn<T>): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const queueEntry: QueueEntry<T> = {\n        fn,\n        rejectFn: reject,\n        resolveFn: resolve,\n      };\n\n      this.queue.push(queueEntry);\n      this.execute();\n    });\n  }\n\n  /**\n   * Resume execution of queue.\n   */\n  private resume(): void {\n    this.clearInterval();\n    this.blocked = false;\n    this.pause(false);\n  }\n\n  /**\n   * Queued function is executed.\n   * @param fn Function to be executed in queue order\n   * @returns Resolves when function was executed\n   */\n  unshift<T>(fn: PromiseFn<T>): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const queueEntry = {\n        fn: fn,\n        rejectFn: reject,\n        resolveFn: resolve,\n      };\n\n      this.queue.unshift(queueEntry);\n      this.execute();\n    });\n  }\n\n  private clearInterval(): void {\n    if (this.interval) {\n      window.clearInterval(this.interval);\n      this.interval = undefined;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {DefaultConversationRoleName as DefaultRole, ConversationRole} from '@wireapp/api-client/lib/conversation/';\nimport {container} from 'tsyringe';\n\nimport {Logger, getLogger} from 'Util/Logger';\n\nimport type {ConversationService} from './ConversationService';\n\nimport type {Conversation} from '../entity/Conversation';\nimport type {User} from '../entity/User';\nimport type {TeamRepository} from '../team/TeamRepository';\nimport {TeamState} from '../team/TeamState';\nimport {UserState} from '../user/UserState';\n\nexport enum Permissions {\n  addParticipants = 'add_conversation_member',\n  changeParticipantRoles = 'modify_other_conversation_member',\n  deleteConversation = 'delete_conversation',\n  leaveConversation = 'leave_conversation',\n  removeParticipants = 'remove_conversation_member',\n  renameConversation = 'modify_conversation_name',\n  toggleEphemeralTimer = 'modify_conversation_message_timer',\n  toggleGuestsAndServices = 'modify_conversation_access',\n  toggleReadReceipts = 'modify_conversation_receipt_mode',\n}\n\nconst defaultAdminRole: ConversationRole = {\n  actions: [\n    Permissions.renameConversation,\n    Permissions.addParticipants,\n    Permissions.removeParticipants,\n    Permissions.changeParticipantRoles,\n    Permissions.toggleEphemeralTimer,\n    Permissions.toggleGuestsAndServices,\n    Permissions.toggleReadReceipts,\n    Permissions.deleteConversation,\n    Permissions.leaveConversation,\n  ],\n  conversation_role: DefaultRole.WIRE_ADMIN,\n};\n\nconst defaultMemberRole: ConversationRole = {\n  actions: [Permissions.leaveConversation],\n  conversation_role: DefaultRole.WIRE_MEMBER,\n};\n\nexport class ConversationRoleRepository {\n  readonly conversationRoles: Record<string, ConversationRole[]>;\n  readonly logger: Logger;\n  teamRoles: ConversationRole[];\n\n  constructor(\n    private readonly teamRepository: TeamRepository,\n    private readonly conversationService: ConversationService,\n    private readonly userState = container.resolve(UserState),\n    private readonly teamState = container.resolve(TeamState),\n  ) {\n    this.logger = getLogger('ConversationRoleRepository');\n    this.conversationRoles = {};\n    this.teamRoles = [defaultAdminRole, defaultMemberRole];\n  }\n\n  loadTeamRoles = async (): Promise<void> => {\n    if (this.teamState.isTeam()) {\n      try {\n        const response = await this.teamRepository.getTeamConversationRoles();\n        this.teamRoles = response.conversation_roles;\n      } catch (error) {\n        this.logger.warn('Could not load team conversation roles', error);\n      }\n    }\n  };\n\n  readonly setConversationRoles = (conversation: Conversation, newRoles: ConversationRole[]): void => {\n    this.conversationRoles[conversation.id] = newRoles;\n  };\n\n  updateConversationRoles = async (conversation: Conversation): Promise<void> => {\n    const remoteConversationData = await this.conversationService.getConversationById(conversation);\n    const roleUpdates: Record<string, string> = {};\n\n    // Add role for self participant\n    if (remoteConversationData.members.self.conversation_role) {\n      roleUpdates[remoteConversationData.members.self.id] = remoteConversationData.members.self.conversation_role;\n    }\n\n    // Add roles for other participants\n    remoteConversationData.members.others.forEach(other => {\n      if (other.conversation_role) {\n        roleUpdates[other.id] = other.conversation_role;\n      }\n    });\n\n    conversation.roles(roleUpdates);\n  };\n\n  readonly setMemberConversationRole = (\n    conversation: Conversation,\n    userId: string,\n    conversationRole: string,\n  ): Promise<void> => {\n    return this.conversationService.putMembers(conversation.id, userId, {\n      conversation_role: conversationRole,\n    });\n  };\n\n  readonly getUserRole = (conversation: Conversation, userEntity: User): string => {\n    return conversation.roles()[userEntity.id];\n  };\n\n  readonly isUserGroupAdmin = (conversation: Conversation, userEntity: User): boolean => {\n    return this.getUserRole(conversation, userEntity) === DefaultRole.WIRE_ADMIN;\n  };\n\n  readonly isSelfGroupAdmin = (conversation: Conversation): boolean => {\n    return this.isUserGroupAdmin(conversation, this.userState.self());\n  };\n\n  readonly getConversationRoles = (conversation: Conversation): ConversationRole[] => {\n    if (this.teamState.isTeam() && this.teamState.team()?.id === conversation.team_id) {\n      return this.teamRoles;\n    }\n    return this.conversationRoles[conversation.id] || this.teamRoles;\n  };\n\n  readonly getUserPermissions = (conversation: Conversation, user: User): ConversationRole => {\n    const conversationRoles = this.getConversationRoles(conversation);\n    const userRole: string = this.getUserRole(conversation, user);\n    return conversationRoles?.find(({conversation_role}) => conversation_role === userRole) || defaultMemberRole;\n  };\n\n  readonly hasPermission = (conversation: Conversation, user: User, permissionName: Permissions): boolean => {\n    const userRole = this.getUserPermissions(conversation, user);\n    return userRole.actions.includes(permissionName);\n  };\n\n  readonly canRenameGroup = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.renameConversation);\n  };\n\n  readonly canAddParticipants = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.addParticipants);\n  };\n\n  readonly canRemoveParticipants = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.removeParticipants);\n  };\n\n  readonly canChangeParticipantRoles = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.changeParticipantRoles);\n  };\n\n  readonly canToggleTimeout = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.toggleEphemeralTimer);\n  };\n\n  readonly canToggleGuests = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.toggleGuestsAndServices);\n  };\n\n  readonly canToggleReadReceipts = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.toggleReadReceipts);\n  };\n\n  readonly canDeleteGroup = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.deleteConversation);\n  };\n\n  readonly canLeaveGroup = (conversation: Conversation, user: User = this.userState.self()): boolean => {\n    return this.hasPermission(conversation, user, Permissions.leaveConversation);\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ConversationCode} from '@wireapp/api-client/lib/conversation/';\nimport {ConversationAccessUpdateData} from '@wireapp/api-client/lib/conversation/data/';\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {AbstractConversationEventHandler, EventHandlingConfig} from './AbstractConversationEventHandler';\nimport {ACCESS_STATE} from './AccessState';\nimport {\n  ACCESS_MODES,\n  featureFromStateChange,\n  isGettingAccessToFeature,\n  updateAccessRights,\n} from './ConversationAccessPermission';\nimport {ConversationMapper} from './ConversationMapper';\nimport type {ConversationService} from './ConversationService';\nimport {ConversationEvent} from './EventBuilder';\n\nimport {PrimaryModal} from '../components/Modals/PrimaryModal';\nimport type {Conversation} from '../entity/Conversation';\n\nexport class ConversationStateHandler extends AbstractConversationEventHandler {\n  private readonly conversationService: ConversationService;\n\n  constructor(conversationService: ConversationService) {\n    super();\n    const eventHandlingConfig: EventHandlingConfig = {\n      [CONVERSATION_EVENT.ACCESS_UPDATE]: this._mapConversationAccessState.bind(this),\n      [CONVERSATION_EVENT.CODE_DELETE]: this._resetConversationAccessCode.bind(this),\n      [CONVERSATION_EVENT.CODE_UPDATE]: this._updateConversationAccessCode.bind(this),\n    };\n    this.setEventHandlingConfig(eventHandlingConfig);\n    this.conversationService = conversationService;\n  }\n\n  async changeAccessState(conversationEntity: Conversation, accessState: ACCESS_STATE): Promise<void> {\n    const isConversationInTeam = conversationEntity && conversationEntity.inTeam();\n    const isStateChange = conversationEntity.accessState() !== accessState;\n    const prevAccessState = conversationEntity.accessState();\n\n    if (isConversationInTeam) {\n      if (isStateChange) {\n        const {accessModes, accessRole} = updateAccessRights(accessState);\n        if (accessModes && accessRole) {\n          try {\n            if (!isGettingAccessToFeature(ACCESS_MODES.CODE, prevAccessState, accessState)) {\n              conversationEntity.accessCode(undefined);\n              await this.revokeAccessCode(conversationEntity);\n            }\n\n            const {domain, id} = conversationEntity;\n            const conversationId = {id, domain};\n\n            await this.conversationService.putConversationAccess(conversationId, accessModes, accessRole);\n\n            conversationEntity.accessState(accessState);\n          } catch (e) {\n            let messageString: string;\n            const {featureName, ...featureInfo} = featureFromStateChange(prevAccessState, accessState);\n\n            if (featureInfo.isAvailable) {\n              messageString = t(`modalConversationOptionsAllow${featureName}Message`);\n            } else {\n              messageString = t(`modalConversationOptionsDisable${featureName}Message`);\n            }\n            this._showModal(messageString);\n          }\n          return;\n        }\n      }\n    }\n    const {featureName} = featureFromStateChange(prevAccessState, accessState);\n    this._showModal(t(`modalConversationOptionsToggle${featureName}Message`));\n  }\n\n  async getAccessCode(conversationEntity: Conversation): Promise<void> {\n    try {\n      const response = await this.conversationService.getConversationCode(conversationEntity.id);\n      return ConversationMapper.mapAccessCode(conversationEntity, response);\n    } catch (error) {\n      const isNotFound = error.code === HTTP_STATUS.NOT_FOUND;\n      if (!isNotFound) {\n        this._showModal(t('modalConversationGuestOptionsGetCodeMessage'));\n      }\n    }\n  }\n\n  async requestAccessCode(conversationEntity: Conversation): Promise<void> {\n    try {\n      const response = await this.conversationService.postConversationCode(conversationEntity.id);\n      const accessCode = response && response.data;\n      if (accessCode) {\n        ConversationMapper.mapAccessCode(conversationEntity, accessCode);\n      }\n    } catch (e) {\n      return this._showModal(t('modalConversationGuestOptionsRequestCodeMessage'));\n    }\n  }\n\n  async revokeAccessCode(conversationEntity: Conversation): Promise<void> {\n    try {\n      await this.conversationService.deleteConversationCode(conversationEntity.id);\n      conversationEntity.accessCode(undefined);\n    } catch (e) {\n      return this._showModal(t('modalConversationGuestOptionsRevokeCodeMessage'));\n    }\n  }\n\n  private _mapConversationAccessState(\n    conversationEntity: Conversation,\n    eventJson: ConversationEvent<ConversationAccessUpdateData>,\n  ): void {\n    const {access: accessModes, ...roles} = eventJson.data;\n    ConversationMapper.mapAccessState(conversationEntity, accessModes, roles?.access_role, roles?.access_role_v2);\n  }\n\n  private _resetConversationAccessCode(conversationEntity: Conversation): void {\n    conversationEntity.accessCode(undefined);\n  }\n\n  private _updateConversationAccessCode(\n    conversationEntity: Conversation,\n    eventJson: ConversationEvent<ConversationCode>,\n  ): void {\n    ConversationMapper.mapAccessCode(conversationEntity, eventJson.data);\n  }\n\n  private _showModal(message: string): void {\n    const modalOptions = {text: {message}};\n    PrimaryModal.show(PrimaryModal.type.ACKNOWLEDGE, modalOptions);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {amplify} from 'amplify';\nimport {container} from 'tsyringe';\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {getLogger, Logger} from 'Util/Logger';\nimport {matchQualifiedIds} from 'Util/QualifiedId';\n\nimport {ConversationState} from './ConversationState';\nimport {ConversationVerificationState} from './ConversationVerificationState';\n\nimport type {ClientEntity} from '../client/ClientEntity';\nimport {EventBuilder} from '../conversation/EventBuilder';\nimport type {Conversation} from '../entity/Conversation';\nimport type {EventRepository} from '../event/EventRepository';\nimport {VerificationMessageType} from '../message/VerificationMessageType';\nimport {EventRecord} from '../storage';\nimport {UserState} from '../user/UserState';\n\nexport class ConversationVerificationStateHandler {\n  private readonly logger: Logger;\n\n  constructor(\n    private readonly eventRepository: EventRepository,\n    private readonly userState = container.resolve(UserState),\n    private readonly conversationState = container.resolve(ConversationState),\n  ) {\n    this.logger = getLogger('ConversationVerificationStateHandler');\n\n    amplify.subscribe(WebAppEvents.USER.CLIENT_ADDED, this.onClientAdded);\n    amplify.subscribe(WebAppEvents.USER.CLIENT_REMOVED, this.onClientRemoved);\n    amplify.subscribe(WebAppEvents.USER.CLIENTS_UPDATED, this.onClientsUpdated);\n    amplify.subscribe(WebAppEvents.CLIENT.VERIFICATION_STATE_CHANGED, this.onClientVerificationChanged);\n  }\n\n  readonly onClientVerificationChanged = (userId: QualifiedId): void => {\n    this.getActiveConversationsWithUsers([userId]).forEach(({conversationEntity, userIds}) => {\n      const isStateChange = this.checkChangeToVerified(conversationEntity);\n      if (!isStateChange) {\n        this.checkChangeToDegraded(conversationEntity, userIds, VerificationMessageType.UNVERIFIED);\n      }\n    });\n  };\n\n  /**\n   * Self user or other participant added clients.\n   * @param userId ID of user that added client (can be self user ID)\n   */\n  readonly onClientAdded = (userId: QualifiedId, _clientEntity?: ClientEntity): void => {\n    this.onClientsAdded([userId]);\n  };\n\n  /**\n   * Multiple participants added clients.\n   * @param userIds Multiple user IDs (can include self user ID)\n   */\n  onClientsAdded(userIds: QualifiedId[]): void {\n    this.getActiveConversationsWithUsers(userIds).forEach(({conversationEntity, userIds: matchingUserIds}) => {\n      this.checkChangeToDegraded(conversationEntity, matchingUserIds, VerificationMessageType.NEW_DEVICE);\n    });\n  }\n\n  /**\n   * Self user removed a client or other participants deleted clients.\n   * @param userId ID of user that added client (can be self user ID)\n   */\n  readonly onClientRemoved = (userId: QualifiedId): void => {\n    this.getActiveConversationsWithUsers([userId]).forEach(({conversationEntity}) => {\n      this.checkChangeToVerified(conversationEntity);\n    });\n  };\n\n  /**\n   * A new conversation was created.\n   * @param conversationEntity New conversation entity\n   */\n  onConversationCreate(conversationEntity: Conversation): void {\n    this.checkChangeToVerified(conversationEntity);\n  }\n\n  /**\n   * Clients of a user were updated.\n   */\n  readonly onClientsUpdated = (userId: QualifiedId): void => {\n    this.getActiveConversationsWithUsers([userId]).forEach(({conversationEntity, userIds}) => {\n      const isStateChange = this.checkChangeToVerified(conversationEntity);\n      if (!isStateChange) {\n        this.checkChangeToDegraded(conversationEntity, userIds, VerificationMessageType.NEW_DEVICE);\n      }\n    });\n  };\n\n  /**\n   * New member(s) joined the conversation.\n   * @param conversationEntity Changed conversation entity\n   * @param userIds IDs of added members\n   */\n  onMemberJoined(conversationEntity: Conversation, userIds: QualifiedId[]): void {\n    this.checkChangeToDegraded(conversationEntity, userIds, VerificationMessageType.NEW_MEMBER);\n  }\n\n  /**\n   * Member(s) left the conversation.\n   * @param conversationEntity Changed conversation entity\n   */\n  onMemberLeft(conversationEntity: Conversation): void {\n    this.checkChangeToVerified(conversationEntity);\n  }\n\n  /**\n   * Change that could verify conversation.\n   *\n   * @param conversationEntity Changed conversation entity\n   * @returns `true` if state changed\n   */\n  private checkChangeToVerified(conversationEntity: Conversation): boolean {\n    if (this.willChangeToVerified(conversationEntity)) {\n      const allVerifiedEvent = EventBuilder.buildAllVerified(conversationEntity);\n      this.eventRepository.injectEvent(allVerifiedEvent as EventRecord);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Change that could degrade conversation.\n   *\n   * @param conversationEntity Changed conversation entity\n   * @param userIds IDs of affected users\n   * @param type Type of degradation\n   * @returns `true` if state changed\n   */\n  private checkChangeToDegraded(\n    conversationEntity: Conversation,\n    userIds: QualifiedId[],\n    type: VerificationMessageType,\n  ): boolean {\n    const shouldShowDegradationWarning = type !== VerificationMessageType.UNVERIFIED;\n    const isConversationDegraded = this.willChangeToDegraded(conversationEntity, shouldShowDegradationWarning);\n\n    if (isConversationDegraded) {\n      /**\n       * TEMPORARY DEBUGGING FIX:\n       * We have seen conversations in a degraded state without an unverified device in there.\n       * Previously the code would hide this fact, not create a system message and then fail when it tried to prompt\n       * the user to grant subsequent message sending - essentially blocking the conversation.\n       *\n       * As we are unsure of the trigger of the degradation we temporarily throw an error to get to the bottom of this.\n       * The conversation is also reset to the verified state to ensure we can continue to send messages.\n       */\n      if (!userIds.length) {\n        conversationEntity.verification_state(ConversationVerificationState.VERIFIED);\n        throw new Error('Conversation degraded without affected users');\n      }\n\n      const event = EventBuilder.buildDegraded(conversationEntity, userIds, type);\n      this.eventRepository.injectEvent(event as EventRecord);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Get all conversation where self user and the given users are active.\n   *\n   * @param userIds Multiple user IDs (can include self user ID)\n   * @returns Array of objects containing the conversation entities and matching user IDs\n   */\n  private getActiveConversationsWithUsers(\n    userIds: QualifiedId[],\n  ): {conversationEntity: Conversation; userIds: QualifiedId[]}[] {\n    return this.conversationState\n      .filteredConversations()\n      .map((conversationEntity: Conversation) => {\n        if (!conversationEntity.removed_from_conversation()) {\n          const userIdsInConversation = conversationEntity\n            .participating_user_ids()\n            .concat(this.userState.self().qualifiedId);\n          const matchingUserIds = userIdsInConversation.filter(userIdInConversation =>\n            userIds.find(userId => matchQualifiedIds(userId, userIdInConversation)),\n          );\n\n          if (!!matchingUserIds.length) {\n            return {conversationEntity, userIds: matchingUserIds};\n          }\n        }\n        return undefined;\n      })\n      .filter(activeConversationInfo => !!activeConversationInfo) as {\n      conversationEntity: Conversation;\n      userIds: QualifiedId[];\n    }[];\n  }\n\n  /**\n   * Check whether to degrade conversation and set corresponding state.\n   *\n   * @param conversationEntity Conversation entity to evaluate\n   * @param shouldShowDegradationWarning Should a modal warn about the degradation?\n   * @returns `true` if conversation state changed to degraded\n   */\n  private willChangeToDegraded(conversationEntity: Conversation, shouldShowDegradationWarning = true): boolean {\n    const state = conversationEntity.verification_state();\n    const isDegraded = state === ConversationVerificationState.DEGRADED;\n\n    if (isDegraded) {\n      return false;\n    }\n\n    // Explicit Boolean check to prevent state changes on undefined\n    const isStateVerified = state === ConversationVerificationState.VERIFIED;\n    const isConversationUnverified = conversationEntity.is_verified() === false;\n    if (isStateVerified && isConversationUnverified) {\n      conversationEntity.verification_state(\n        shouldShowDegradationWarning\n          ? ConversationVerificationState.DEGRADED\n          : ConversationVerificationState.UNVERIFIED,\n      );\n      this.logger.log(`Verification of conversation '${conversationEntity.id}' changed to degraded`);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Check whether to verify conversation and set corresponding state\n   *\n   * @param conversationEntity Conversation entity to evaluate\n   * @returns `true` if conversation state changed to verified\n   */\n  private willChangeToVerified(conversationEntity: Conversation): boolean {\n    const state = conversationEntity.verification_state();\n    const isStateVerified = state === ConversationVerificationState.VERIFIED;\n    if (isStateVerified) {\n      return false;\n    }\n\n    // Explicit Boolean check to prevent state changes on undefined\n    const isConversationVerified = conversationEntity.is_verified() === true;\n    if (isConversationVerified) {\n      conversationEntity.verification_state(ConversationVerificationState.VERIFIED);\n      this.logger.log(`Verification state of conversation '${conversationEntity.id}' changed to verified`);\n      return true;\n    }\n\n    return false;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {TEAM_EVENT} from '@wireapp/api-client/lib/event/TeamEvent';\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {SystemMessage} from './SystemMessage';\n\nimport {SystemMessageType} from '../../message/SystemMessageType';\nimport type {Conversation} from '../Conversation';\n\nexport class DeleteConversationMessage extends SystemMessage {\n  public readonly system_message_type: SystemMessageType;\n  public readonly caption: ko.PureComputed<string>;\n\n  constructor(conversationEntity: Conversation) {\n    super();\n\n    this.type = TEAM_EVENT.DELETE;\n    this.system_message_type = SystemMessageType.CONVERSATION_DELETE;\n\n    this.caption = ko.pureComputed(() =>\n      conversationEntity\n        ? t('notificationConversationDeletedNamed', conversationEntity.name())\n        : t('notificationConversationDeleted'),\n    );\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event';\n\nimport {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport type {Conversation} from '../entity/Conversation';\nimport type {User} from '../entity/User';\nimport {CONVERSATION} from '../event/Client';\n\nexport type MappedEvent = Record<string, any> & {\n  data?: MappedEventData | string;\n  type: CONVERSATION_EVENT | CONVERSATION;\n};\n\ntype MappedEventData = Record<string, any> & {\n  expects_read_confirmation?: boolean;\n  legal_hold_status?: LegalHoldStatus;\n};\n\nexport const isUserOnLegalHold = (user: User): boolean => {\n  return user.isOnLegalHold();\n};\n\nexport const areSomeUsersOnLegalHold = (users: User[]): boolean => {\n  return users.some(isUserOnLegalHold);\n};\n\nexport const isConversationOnLegalHold = (conversation: Conversation): boolean => {\n  const amIonLegalHold = isUserOnLegalHold(conversation.selfUser());\n  const areOthersOnLegalHold = areSomeUsersOnLegalHold(conversation.participating_user_ets());\n  return amIonLegalHold || areOthersOnLegalHold;\n};\n\nexport const hasMessageLegalHoldFlag = (mappedEvent: MappedEvent): boolean => {\n  const supportsLegalHoldFlag = [CONVERSATION.MESSAGE_ADD].includes(mappedEvent.type as CONVERSATION);\n  const hasLegalHoldFlag =\n    mappedEvent.data &&\n    typeof mappedEvent.data !== 'string' &&\n    typeof mappedEvent.data.legal_hold_status !== 'undefined' &&\n    mappedEvent.data.legal_hold_status !== LegalHoldStatus.UNKNOWN;\n  return supportsLegalHoldFlag && hasLegalHoldFlag;\n};\n\nexport const renderLegalHoldMessage = (mappedEvent: MappedEvent, localConversationState: LegalHoldStatus): boolean => {\n  if (hasMessageLegalHoldFlag(mappedEvent)) {\n    return typeof mappedEvent.data !== 'string' && mappedEvent.data.legal_hold_status !== localConversationState;\n  }\n  return false;\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\n\nimport {matchQualifiedIds} from 'Util/QualifiedId';\n\nimport {Conversation} from '../entity/Conversation';\nimport {User} from '../entity/User';\n\nexport class UserFilter {\n  static isParticipant(conversationEntity: Conversation, userId: QualifiedId) {\n    const index = conversationEntity\n      .participating_user_ets()\n      .findIndex((user: User) => matchQualifiedIds(userId, user));\n    return index !== -1;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  Conversation as BackendConversation,\n  ConversationProtocol,\n  CONVERSATION_TYPE,\n  DefaultConversationRoleName as DefaultRole,\n  NewConversation,\n} from '@wireapp/api-client/lib/conversation/';\nimport {ConversationReceiptModeUpdateData} from '@wireapp/api-client/lib/conversation/data/';\nimport {CONVERSATION_TYPING} from '@wireapp/api-client/lib/conversation/data/ConversationTypingData';\nimport {\n  ConversationCreateEvent,\n  ConversationEvent,\n  ConversationMemberJoinEvent,\n  ConversationMemberLeaveEvent,\n  ConversationMemberUpdateEvent,\n  ConversationMessageTimerUpdateEvent,\n  ConversationReceiptModeUpdateEvent,\n  ConversationRenameEvent,\n  ConversationTypingEvent,\n  CONVERSATION_EVENT,\n} from '@wireapp/api-client/lib/event';\nimport {BackendErrorLabel} from '@wireapp/api-client/lib/http/';\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {MLSReturnType} from '@wireapp/core/lib/conversation';\nimport {amplify} from 'amplify';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\nimport {container} from 'tsyringe';\nimport {flatten} from 'underscore';\n\nimport {Asset as ProtobufAsset, Confirmation, LegalHoldStatus} from '@wireapp/protocol-messaging';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {TYPING_TIMEOUT, useTypingIndicatorState} from 'Components/InputBar/components/TypingIndicator';\nimport {getNextItem} from 'Util/ArrayUtil';\nimport {allowsAllFiles, getFileExtensionOrName, isAllowedFile} from 'Util/FileTypeUtil';\nimport {replaceLink, t} from 'Util/LocalizerUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {PromiseQueue} from 'Util/PromiseQueue';\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {\n  compareTransliteration,\n  fixWebsocketString,\n  sortByPriority,\n  sortUsersByPriority,\n  startsWith,\n} from 'Util/StringUtil';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\nimport {base64ToArray, createRandomUuid, noop} from 'Util/util';\n\nimport {ACCESS_STATE} from './AccessState';\nimport {extractClientDiff} from './ClientMismatchUtil';\nimport {updateAccessRights} from './ConversationAccessPermission';\nimport {ConversationEphemeralHandler} from './ConversationEphemeralHandler';\nimport {ConversationFilter} from './ConversationFilter';\nimport {ConversationLabelRepository} from './ConversationLabelRepository';\nimport {ConversationDatabaseData, ConversationMapper} from './ConversationMapper';\nimport {ConversationRoleRepository} from './ConversationRoleRepository';\nimport {ConversationService} from './ConversationService';\nimport {ConversationState} from './ConversationState';\nimport {ConversationStateHandler} from './ConversationStateHandler';\nimport {ConversationStatus} from './ConversationStatus';\nimport {ConversationVerificationState} from './ConversationVerificationState';\nimport {ConversationVerificationStateHandler} from './ConversationVerificationStateHandler';\nimport {EventMapper} from './EventMapper';\nimport {MessageRepository} from './MessageRepository';\nimport {NOTIFICATION_STATE} from './NotificationSetting';\n\nimport {AssetTransferState} from '../assets/AssetTransferState';\nimport {LEAVE_CALL_REASON} from '../calling/enum/LeaveCallReason';\nimport {ClientState} from '../client/ClientState';\nimport {PrimaryModal} from '../components/Modals/PrimaryModal';\nimport {Config} from '../Config';\nimport {ConnectionEntity} from '../connection/ConnectionEntity';\nimport {ConnectionRepository} from '../connection/ConnectionRepository';\nimport {\n  AssetAddEvent,\n  ButtonActionConfirmationEvent,\n  ClientConversationEvent,\n  DeleteEvent,\n  EventBuilder,\n  GroupCreationEvent,\n  MessageHiddenEvent,\n  OneToOneCreationEvent,\n  ReactionEvent,\n  TeamMemberLeaveEvent,\n} from '../conversation/EventBuilder';\nimport {Conversation} from '../entity/Conversation';\nimport {ContentMessage} from '../entity/message/ContentMessage';\nimport {DeleteConversationMessage} from '../entity/message/DeleteConversationMessage';\nimport {FileAsset} from '../entity/message/FileAsset';\nimport {MemberMessage} from '../entity/message/MemberMessage';\nimport {Message} from '../entity/message/Message';\nimport {User} from '../entity/User';\nimport {BackendClientError} from '../error/BackendClientError';\nimport {BaseError, BASE_ERROR_TYPE} from '../error/BaseError';\nimport {ConversationError} from '../error/ConversationError';\nimport {ClientEvent, CONVERSATION as CLIENT_CONVERSATION_EVENT} from '../event/Client';\nimport {EventRepository} from '../event/EventRepository';\nimport {EventService} from '../event/EventService';\nimport {EventSource} from '../event/EventSource';\nimport {NOTIFICATION_HANDLING_STATE} from '../event/NotificationHandlingState';\nimport {isMemberMessage} from '../guards/Message';\nimport * as LegalHoldEvaluator from '../legal-hold/LegalHoldEvaluator';\nimport {MessageCategory} from '../message/MessageCategory';\nimport {SuperType} from '../message/SuperType';\nimport {SystemMessageType} from '../message/SystemMessageType';\nimport {mlsConversationState} from '../mls';\nimport {PropertiesRepository} from '../properties/PropertiesRepository';\nimport {Core} from '../service/CoreSingleton';\nimport type {EventRecord} from '../storage';\nimport {ConversationRecord} from '../storage/record/ConversationRecord';\nimport {TeamRepository} from '../team/TeamRepository';\nimport {TeamState} from '../team/TeamState';\nimport {ServerTimeHandler} from '../time/serverTimeHandler';\nimport {UserFilter} from '../user/UserFilter';\nimport {UserRepository} from '../user/UserRepository';\nimport {UserState} from '../user/UserState';\n\ntype ConversationDBChange = {obj: EventRecord; oldObj: EventRecord};\ntype FetchPromise = {rejectFn: (error: ConversationError) => void; resolveFn: (conversation: Conversation) => void};\ntype EntityObject = {conversationEntity: Conversation; messageEntity: Message};\ntype IncomingEvent = ConversationEvent | ClientConversationEvent;\n\nexport class ConversationRepository {\n  private isBlockingNotificationHandling: boolean;\n  private readonly conversationsWithNewEvents: Map<any, any>;\n  private readonly ephemeralHandler: ConversationEphemeralHandler;\n  public readonly conversationLabelRepository: ConversationLabelRepository;\n  public readonly conversationRoleRepository: ConversationRoleRepository;\n  private readonly event_mapper: EventMapper;\n  private readonly eventService: EventService;\n  public leaveCall: (conversationId: QualifiedId, reason: LEAVE_CALL_REASON) => void;\n  private readonly receiving_queue: PromiseQueue;\n  private readonly logger: Logger;\n  public readonly stateHandler: ConversationStateHandler;\n  public readonly verificationStateHandler: ConversationVerificationStateHandler;\n  static readonly eventFromStreamMessage = 'event from notification stream';\n\n  static get CONFIG() {\n    return {\n      CONFIRMATION_THRESHOLD: TIME_IN_MILLIS.WEEK,\n      EXTERNAL_MESSAGE_THRESHOLD: 200 * 1024,\n      GROUP: {\n        MAX_NAME_LENGTH: 64,\n        MAX_SIZE: Config.getConfig().MAX_GROUP_PARTICIPANTS,\n      },\n    };\n  }\n\n  constructor(\n    private readonly conversationService: ConversationService,\n    private readonly messageRepository: MessageRepository,\n    private readonly connectionRepository: ConnectionRepository,\n    private readonly eventRepository: EventRepository,\n    private readonly teamRepository: TeamRepository,\n    private readonly userRepository: UserRepository,\n    private readonly propertyRepository: PropertiesRepository,\n    private readonly serverTimeHandler: ServerTimeHandler,\n    private readonly userState = container.resolve(UserState),\n    private readonly teamState = container.resolve(TeamState),\n    private readonly conversationState = container.resolve(ConversationState),\n    private readonly core = container.resolve(Core),\n    private readonly clientState = container.resolve(ClientState),\n  ) {\n    this.eventService = eventRepository.eventService;\n    // we register a client mismatch handler agains the message repository so that we can react to missing members\n    // FIXME this should be temporary. In the near future we want the core to handle clients/mismatch/verification. So the webapp won't need this logic at all\n    this.messageRepository.setClientMismatchHandler(async (mismatch, conversation, silent, consentType) => {\n      const {missingClients, deletedClients, emptyUsers, missingUserIds} = extractClientDiff(\n        mismatch,\n        conversation?.allUserEntities,\n        this.core.backendFeatures.federationEndpoints ? userState.self().domain : '',\n      );\n\n      if (conversation && missingUserIds.length) {\n        // add/remove users from the conversation (if any)\n        await this.addMissingMember(conversation, missingUserIds, new Date(mismatch.time).getTime() - 1);\n      }\n\n      // Remove clients that are not needed anymore\n      await Promise.all(\n        deletedClients.map(({userId, clients}) =>\n          Promise.all(clients.map(client => this.userRepository.removeClientFromUser(userId, client))),\n        ),\n      );\n      const removedTeamUserIds = emptyUsers.filter(user => user.inTeam()).map(user => user.qualifiedId);\n\n      if (removedTeamUserIds.length) {\n        // If we have found some users that were removed from the conversation, we need to check if those users were also completely removed from the team\n        const usersWithoutClients = await this.userRepository.getUserListFromBackend(removedTeamUserIds);\n        await Promise.all(\n          usersWithoutClients\n            .filter(user => user.deleted)\n            .map(user =>\n              this.teamMemberLeave(\n                this.teamState.team().id,\n                {\n                  domain: this.teamState.teamDomain(),\n                  id: user.id,\n                },\n                new Date(mismatch.time).getTime() - 1,\n              ),\n            ),\n        );\n      }\n\n      let shouldWarnLegalHold = false;\n      if (missingClients.length) {\n        const wasVerified = conversation?.is_verified();\n        const legalHoldStatus = conversation?.legalHoldStatus();\n        const newDevices = await this.userRepository.updateMissingUsersClients(\n          missingClients.map(({userId}) => userId),\n        );\n        if (wasVerified && newDevices.length) {\n          // if the conversation is verified but some clients were missing, it means the conversation will degrade.\n          // We need to warn the user of the degradation and ask his permission to actually send the message\n          conversation.verification_state(ConversationVerificationState.DEGRADED);\n        }\n        if (conversation) {\n          const hasChangedLegalHoldStatus = conversation.legalHoldStatus() !== legalHoldStatus;\n          shouldWarnLegalHold = hasChangedLegalHoldStatus && newDevices.some(device => device.isLegalHold());\n        }\n      }\n      return !conversation || silent\n        ? false\n        : this.messageRepository.requestUserSendingPermission(conversation, shouldWarnLegalHold, consentType);\n    });\n\n    this.logger = getLogger('ConversationRepository');\n\n    this.event_mapper = new EventMapper();\n    this.verificationStateHandler = new ConversationVerificationStateHandler(\n      this.eventRepository,\n      this.userState,\n      this.conversationState,\n    );\n    this.isBlockingNotificationHandling = true;\n    this.conversationsWithNewEvents = new Map();\n\n    this.teamState.isTeam.subscribe(() => this.mapGuestStatusSelf());\n    this.receiving_queue = new PromiseQueue({name: 'ConversationRepository.Receiving'});\n\n    this.initSubscriptions();\n\n    this.stateHandler = new ConversationStateHandler(this.conversationService);\n    this.ephemeralHandler = new ConversationEphemeralHandler(this.eventService, {\n      onMessageTimeout: this.handleMessageExpiration,\n    });\n\n    this.userState.directlyConnectedUsers = this.conversationState.connectedUsers;\n\n    this.conversationLabelRepository = new ConversationLabelRepository(\n      this.conversationState.conversations,\n      this.conversationState.visibleConversations,\n      propertyRepository.propertiesService,\n    );\n\n    this.conversationRoleRepository = new ConversationRoleRepository(this.teamRepository, this.conversationService);\n    this.leaveCall = noop;\n  }\n\n  checkMessageTimer(messageEntity: ContentMessage): void {\n    this.ephemeralHandler.checkMessageTimer(messageEntity, this.serverTimeHandler.getTimeOffset());\n  }\n\n  private initSubscriptions(): void {\n    amplify.subscribe(WebAppEvents.CONVERSATION.DELETE, this.deleteConversationLocally);\n    amplify.subscribe(WebAppEvents.CONVERSATION.EVENT_FROM_BACKEND, this.onConversationEvent);\n    amplify.subscribe(WebAppEvents.CONVERSATION.MAP_CONNECTION, this.mapConnection);\n    amplify.subscribe(WebAppEvents.CONVERSATION.MISSED_EVENTS, this.onMissedEvents);\n    amplify.subscribe(WebAppEvents.CONVERSATION.PERSIST_STATE, this.saveConversationStateInDb);\n    amplify.subscribe(WebAppEvents.EVENT.NOTIFICATION_HANDLING_STATE, this.setNotificationHandlingState);\n    amplify.subscribe(WebAppEvents.TEAM.MEMBER_LEAVE, this.teamMemberLeave);\n    amplify.subscribe(WebAppEvents.USER.UNBLOCKED, this.onUnblockUser);\n    amplify.subscribe(WebAppEvents.CONVERSATION.INJECT_LEGAL_HOLD_MESSAGE, this.injectLegalHoldMessage);\n\n    this.eventService.addEventUpdatedListener(this.updateLocalMessageEntity);\n    this.eventService.addEventDeletedListener(this.deleteLocalMessageEntity);\n\n    window.addEventListener<any>(WebAppEvents.CONVERSATION.JOIN, this.onConversationJoin);\n  }\n\n  private readonly updateLocalMessageEntity = async ({\n    obj: updatedEvent,\n    oldObj: oldEvent,\n  }: ConversationDBChange): Promise<void> => {\n    const qualifiedId = updatedEvent.qualified_conversation || {domain: '', id: updatedEvent.conversation};\n    const conversationEntity = this.conversationState.findConversation(qualifiedId);\n    const replacedMessageEntity = await this.replaceMessageInConversation(\n      conversationEntity,\n      oldEvent.id,\n      updatedEvent,\n    );\n    if (replacedMessageEntity) {\n      const messageEntity = await this.updateMessageUserEntities(replacedMessageEntity);\n      amplify.publish(WebAppEvents.CONVERSATION.MESSAGE.UPDATED, oldEvent.id, messageEntity);\n    }\n  };\n\n  private readonly deleteLocalMessageEntity = ({oldObj: deletedEvent}: ConversationDBChange): void => {\n    const qualifiedId = deletedEvent.qualified_conversation || {domain: '', id: deletedEvent.conversation};\n    const conversationEntity = this.conversationState.findConversation(qualifiedId);\n    if (conversationEntity) {\n      conversationEntity.removeMessageById(deletedEvent.id);\n    }\n  };\n\n  /**\n   * Remove obsolete conversations locally.\n   */\n  cleanupConversations(): void {\n    this.conversationState.conversations().forEach(conversationEntity => {\n      if (\n        conversationEntity.isGroup() &&\n        conversationEntity.is_cleared() &&\n        conversationEntity.removed_from_conversation()\n      ) {\n        this.conversationService.deleteConversationFromDb(conversationEntity);\n        this.deleteConversationFromRepository(conversationEntity);\n      }\n    });\n\n    this.cleanupEphemeralMessages();\n  }\n\n  //##############################################################################\n  // Conversation service interactions\n  //##############################################################################\n\n  /**\n   * Create a group conversation.\n   * @note Do not include the requester among the users\n   *\n   * @param userEntities Users (excluding the creator) to be part of the conversation\n   * @param groupName Name for the conversation\n   * @param accessState State for conversation access\n   * @param options Additional conversation creation options (like \"receipt_mode\")\n   * @returns Resolves when the conversation was created\n   */\n  public async createGroupConversation(\n    userEntities: User[],\n    groupName?: string,\n    accessState?: ACCESS_STATE,\n    options: Partial<NewConversation> = {},\n  ): Promise<Conversation | undefined> {\n    const userIds = userEntities.map(user => user.qualifiedId);\n    const usersPayload = this.core.backendFeatures.federationEndpoints\n      ? {\n          qualified_users: userIds,\n          users: [] as string[],\n        }\n      : {\n          users: userIds.map(({id}) => id),\n        };\n\n    let payload: NewConversation & {conversation_role: string} = {\n      conversation_role: DefaultRole.WIRE_MEMBER,\n      name: groupName,\n      receipt_mode: null,\n      ...usersPayload,\n      ...options,\n    };\n\n    /**\n     * we need to add this creator_client to conversation creation payload\n     * for creating MLS conversations\n     */\n    if (options.protocol === ConversationProtocol.MLS) {\n      payload.creator_client = this.clientState.currentClient().id;\n      payload.selfUserId = this.userState.self().qualifiedId;\n    }\n\n    if (this.teamState.team().id) {\n      payload.team = {\n        managed: false,\n        teamid: this.teamState.team().id!,\n      };\n\n      if (accessState) {\n        const {accessModes: access, accessRole} = updateAccessRights(accessState);\n\n        const accessRoleField = this.core.backendFeatures.version >= 3 ? 'access_role' : 'access_role_v2';\n\n        payload = {\n          ...payload,\n          access,\n          [accessRoleField]: accessRole,\n        };\n      }\n    }\n\n    try {\n      /**\n       * ToDo: Fetch all MLS Events from backend before doing anything else\n       * Needs to be done to receive the latest epoch and avoid epoch mismatch errors\n       */\n      let response: MLSReturnType;\n      const isMLSConversation = payload.protocol === ConversationProtocol.MLS;\n      if (isMLSConversation) {\n        response = await this.core.service!.conversation.createMLSConversation(payload);\n      } else {\n        response = {conversation: await this.core.service!.conversation.createProteusConversation(payload), events: []};\n      }\n\n      const {conversationEntity} = await this.onCreate({\n        conversation: response.conversation.qualified_id.id,\n        data: {\n          last_event: '0.0',\n          last_event_time: '1970-01-01T00:00:00.000Z',\n          receipt_mode: undefined,\n          ...response.conversation,\n        },\n        from: this.userState.self().id,\n        qualified_conversation: response.conversation.qualified_id,\n        time: new Date().toISOString(),\n        type: CONVERSATION_EVENT.CREATE,\n      });\n      if (isMLSConversation && conversationEntity.groupId) {\n        // since we are the creator of the conversation, we can safely mark it as established\n        mlsConversationState.getState().markAsEstablished(conversationEntity.groupId);\n      }\n      return conversationEntity;\n    } catch (error) {\n      this.handleConversationCreateError(\n        error,\n        userEntities.map(user => user.qualifiedId),\n      );\n      return undefined;\n    }\n  }\n\n  /**\n   * Create a guest room.\n   */\n  public createGuestRoom(): Promise<Conversation | undefined> {\n    const groupName = t('guestRoomConversationName');\n    return this.createGroupConversation([], groupName, ACCESS_STATE.TEAM.GUESTS_SERVICES);\n  }\n\n  /**\n   * Get a conversation from the backend.\n   */\n  private async fetchConversationById({id: conversationId, domain}: QualifiedId): Promise<Conversation> {\n    const qualifiedId = {domain, id: conversationId};\n    const fetching_conversations: Record<string, FetchPromise[]> = {};\n    if (fetching_conversations.hasOwnProperty(conversationId)) {\n      return new Promise((resolve, reject) => {\n        fetching_conversations[conversationId].push({rejectFn: reject, resolveFn: resolve});\n      });\n    }\n\n    fetching_conversations[conversationId] = [];\n    try {\n      const response = await this.conversationService.getConversationById(qualifiedId);\n      const [conversationEntity] = this.mapConversations([response]);\n\n      this.logger.info(`Fetched conversation '${conversationId}' from backend`);\n      this.saveConversation(conversationEntity);\n\n      fetching_conversations[conversationId].forEach(({resolveFn}) => resolveFn(conversationEntity));\n      delete fetching_conversations[conversationId];\n\n      return conversationEntity;\n    } catch (originalError) {\n      if (originalError.code === HTTP_STATUS.NOT_FOUND) {\n        this.deleteConversationLocally(qualifiedId, false);\n      }\n      const error = new ConversationError(\n        ConversationError.TYPE.CONVERSATION_NOT_FOUND,\n        ConversationError.MESSAGE.CONVERSATION_NOT_FOUND,\n        originalError,\n      );\n      fetching_conversations[conversationId].forEach(({rejectFn}) => rejectFn(error));\n      delete fetching_conversations[conversationId];\n\n      throw error;\n    }\n  }\n\n  /**\n   * Will load all the conversations in memory\n   * @returns all the load conversations from backend merged with the locally stored conversations\n   */\n  public async loadConversations(): Promise<Conversation[]> {\n    const remoteConversationsPromise = this.conversationService.getAllConversations().catch(error => {\n      this.logger.error(`Failed to get all conversations from backend: ${error.message}`);\n      return {found: []};\n    });\n\n    const [localConversations, remoteConversations] = await Promise.all([\n      this.conversationService.loadConversationStatesFromDb<ConversationDatabaseData>(),\n      remoteConversationsPromise,\n    ]);\n    let conversationsData: any[];\n    if (!remoteConversations.found?.length) {\n      conversationsData = localConversations;\n    } else {\n      const data = ConversationMapper.mergeConversation(localConversations, remoteConversations);\n      conversationsData = (await this.conversationService.saveConversationsInDb(data)) as any[];\n    }\n    const conversationEntities = this.mapConversations(conversationsData);\n    this.saveConversations(conversationEntities);\n    return this.conversationState.conversations();\n  }\n\n  public async updateConversationStates(conversationsDataArray: ConversationRecord[]) {\n    const handledConversationEntities: Conversation[] = [];\n    const unknownConversations: ConversationRecord[] = [];\n\n    conversationsDataArray.forEach(conversationData => {\n      const localEntity = this.conversationState\n        .conversations()\n        .find(conversation => matchQualifiedIds(conversation, conversationData));\n\n      if (localEntity) {\n        const entity = ConversationMapper.updateSelfStatus(localEntity, conversationData as any, true);\n        handledConversationEntities.push(entity);\n        return;\n      }\n\n      unknownConversations.push(conversationData);\n    });\n\n    let conversationEntities: Conversation[] = [];\n\n    if (unknownConversations.length) {\n      conversationEntities = conversationEntities.concat(this.mapConversations(unknownConversations as any[]));\n      this.saveConversations(conversationEntities);\n    }\n\n    conversationEntities = conversationEntities.concat(handledConversationEntities);\n    const handledConversationData = conversationEntities.map(conversationEntity => conversationEntity.serialize());\n    this.conversationService.saveConversationsInDb(handledConversationData);\n    return conversationEntities;\n  }\n\n  /**\n   * Get preceding messages starting with the given message.\n   * @param conversationEntity Respective conversation\n   * @returns Resolves with the messages\n   */\n  public async getPrecedingMessages(conversationEntity: Conversation): Promise<ContentMessage[]> {\n    conversationEntity.is_pending(true);\n\n    const firstMessageEntity = conversationEntity.getOldestMessage();\n    const upperBound =\n      firstMessageEntity && firstMessageEntity.timestamp()\n        ? new Date(firstMessageEntity.timestamp())\n        : new Date(conversationEntity.getLatestTimestamp(this.serverTimeHandler.toServerTimestamp()) + 1);\n\n    const events = (await this.eventService.loadPrecedingEvents(\n      conversationEntity.id,\n      new Date(0),\n      upperBound,\n      Config.getConfig().MESSAGES_FETCH_LIMIT,\n    )) as EventRecord[];\n    const mappedMessageEntities = await this.addPrecedingEventsToConversation(events, conversationEntity);\n    conversationEntity.is_pending(false);\n    return mappedMessageEntities;\n  }\n\n  private async addPrecedingEventsToConversation(\n    events: EventRecord[],\n    conversationEntity: Conversation,\n  ): Promise<ContentMessage[]> {\n    const hasAdditionalMessages = events.length === Config.getConfig().MESSAGES_FETCH_LIMIT;\n\n    const mappedMessageEntities = await this.addEventsToConversation(events, conversationEntity);\n    conversationEntity.hasAdditionalMessages(hasAdditionalMessages);\n\n    if (!hasAdditionalMessages) {\n      const firstMessage = conversationEntity.getOldestMessage();\n      const checkCreationMessage = isMemberMessage(firstMessage) && firstMessage?.isCreation();\n      if (checkCreationMessage) {\n        const groupCreationMessageIn1to1 = conversationEntity.is1to1() && firstMessage?.isGroupCreation();\n        const one2oneConnectionMessageInGroup = conversationEntity.isGroup() && firstMessage?.isConnection();\n        const wrongMessageTypeForConversation = groupCreationMessageIn1to1 || one2oneConnectionMessageInGroup;\n\n        if (wrongMessageTypeForConversation) {\n          this.messageRepository.deleteMessage(conversationEntity, firstMessage);\n          conversationEntity.hasCreationMessage = false;\n        } else {\n          conversationEntity.hasCreationMessage = true;\n        }\n      }\n      const addCreationMessage = !conversationEntity.hasCreationMessage;\n      if (addCreationMessage) {\n        this.addCreationMessage(conversationEntity, this.userState.self().isTemporaryGuest());\n      }\n    }\n\n    return mappedMessageEntities;\n  }\n\n  private addCreationMessage(\n    conversationEntity: Conversation,\n    isTemporaryGuest: boolean,\n    timestamp?: number,\n    eventSource?: EventSource,\n  ): void {\n    conversationEntity.hasCreationMessage = true;\n\n    if (conversationEntity.inTeam()) {\n      const allTeamMembersParticipate = this.teamState.teamMembers().length\n        ? this.teamState\n            .teamMembers()\n            .every(\n              teamMember =>\n                !!conversationEntity.participating_user_ids().find(user => matchQualifiedIds(user, teamMember)),\n            )\n        : false;\n\n      conversationEntity.withAllTeamMembers(allTeamMembersParticipate);\n    }\n\n    const creationEvent = conversationEntity.isGroup()\n      ? EventBuilder.buildGroupCreation(conversationEntity, isTemporaryGuest, timestamp)\n      : EventBuilder.build1to1Creation(conversationEntity);\n\n    this.eventRepository.injectEvent(creationEvent, eventSource);\n  }\n\n  /**\n   * Get specified message and load number preceding and subsequent messages defined by padding.\n   *\n   * @param conversationEntity Conversation entity\n   * @param messageEntity Message entity\n   * @param padding Number of messages to load around the targeted message\n   * @returns Resolves with the messages\n   */\n  public async getMessagesWithOffset(\n    conversationEntity: Conversation,\n    messageEntity: Message,\n    padding = 30,\n  ): Promise<ContentMessage[]> {\n    const messageDate = new Date(messageEntity.timestamp());\n    const conversationId = conversationEntity.id;\n\n    conversationEntity.is_pending(true);\n\n    const precedingMessages = (await this.eventService.loadPrecedingEvents(\n      conversationId,\n      new Date(0),\n      messageDate,\n      Math.floor(padding / 2),\n    )) as EventRecord[];\n    const followingMessages = (await this.eventService.loadFollowingEvents(\n      conversationEntity.id,\n      messageDate,\n      padding - precedingMessages.length,\n    )) as EventRecord[];\n    const messages = precedingMessages.concat(followingMessages);\n    const mappedMessageEntities = await this.addEventsToConversation(messages, conversationEntity);\n    conversationEntity.is_pending(false);\n    return mappedMessageEntities;\n  }\n\n  /**\n   * Get subsequent messages starting with the given message.\n   * @returns Resolves with the messages\n   */\n  async getSubsequentMessages(conversationEntity: Conversation, messageEntity: ContentMessage) {\n    const messageDate = new Date(messageEntity.timestamp());\n    conversationEntity.is_pending(true);\n\n    const events = (await this.eventService.loadFollowingEvents(\n      conversationEntity.id,\n      messageDate,\n      Config.getConfig().MESSAGES_FETCH_LIMIT,\n    )) as EventRecord[];\n    const mappedMessageEntities = await this.addEventsToConversation(events, conversationEntity, false);\n    conversationEntity.is_pending(false);\n    return mappedMessageEntities;\n  }\n\n  /**\n   * Get messages for given category. Category param acts as lower bound.\n   */\n  async getEventsForCategory(conversationEntity: Conversation, category = MessageCategory.NONE): Promise<Message[]> {\n    const events = (await this.eventService.loadEventsWithCategory(conversationEntity.id, category)) as EventRecord[];\n    const messageEntities = (await this.event_mapper.mapJsonEvents(events, conversationEntity)) as Message[];\n    return this.updateMessagesUserEntities(messageEntities);\n  }\n\n  /**\n   * Search for given text in conversation.\n   */\n  public async searchInConversation(\n    conversationEntity: Conversation,\n    query: string,\n  ): Promise<{messageEntities: Message[]; query: string}> {\n    if (!conversationEntity || !query.length) {\n      return {messageEntities: [], query};\n    }\n\n    const events = await this.conversationService.searchInConversation(conversationEntity.id, query);\n    const mappedMessages = await this.event_mapper.mapJsonEvents(events, conversationEntity);\n    const messageEntities = await this.updateMessagesUserEntities(mappedMessages);\n    return {messageEntities, query};\n  }\n\n  /**\n   * Get conversation unread events.\n   *\n   * @param conversationEntity Conversation to start from\n   */\n  private async getUnreadEvents(conversationEntity: Conversation): Promise<void> {\n    const first_message = conversationEntity.getOldestMessage();\n    const lower_bound = new Date(conversationEntity.last_read_timestamp());\n    const upper_bound = first_message\n      ? new Date(first_message.timestamp())\n      : new Date(conversationEntity.getLatestTimestamp(this.serverTimeHandler.toServerTimestamp()) + 1);\n\n    if (lower_bound < upper_bound) {\n      conversationEntity.is_pending(true);\n\n      try {\n        const events = (await this.eventService.loadPrecedingEvents(\n          conversationEntity.id,\n          lower_bound,\n          upper_bound,\n        )) as EventRecord[];\n        if (events.length) {\n          this.addEventsToConversation(events, conversationEntity);\n        }\n      } catch (error) {\n        this.logger.info(`Could not load unread events for conversation: ${conversationEntity.id}`, error);\n      }\n      conversationEntity.is_pending(false);\n    }\n  }\n\n  /**\n   * Update conversation with a user you just unblocked\n   */\n  private readonly onUnblockUser = async (user_et: User): Promise<void> => {\n    const conversationEntity = await this.get1To1Conversation(user_et);\n    if (typeof conversationEntity !== 'boolean') {\n      conversationEntity.status(ConversationStatus.CURRENT_MEMBER);\n    }\n  };\n\n  /**\n   * Update all conversations on app init.\n   */\n  public async updateConversationsOnAppInit() {\n    this.logger.info('Updating group participants');\n    await this.updateUnarchivedConversations();\n    const updatePromises = this.conversationState.filteredConversations().map(conversationEntity => {\n      return this.updateParticipatingUserEntities(conversationEntity, true);\n    });\n    return Promise.all(updatePromises);\n  }\n\n  /**\n   * Update users and events for archived conversations currently visible.\n   */\n  public updateArchivedConversations() {\n    this.updateConversations(this.conversationState.archivedConversations());\n  }\n\n  /**\n   * Update users and events for all unarchived conversations.\n   */\n  private updateUnarchivedConversations() {\n    return this.updateConversations(this.conversationState.visibleConversations());\n  }\n\n  private async updateConversationFromBackend(conversationEntity: Conversation) {\n    const conversationData = await this.conversationService.getConversationById(conversationEntity);\n    const {name, message_timer, type} = conversationData;\n    ConversationMapper.updateProperties(conversationEntity, {name, type});\n    ConversationMapper.updateSelfStatus(conversationEntity, {message_timer});\n  }\n\n  /**\n   * Get users and events for conversations.\n   *\n   * @note To reduce the number of backend calls we merge the user IDs of all conversations first.\n   * @param conversationEntities Array of conversation entities to be updated\n   */\n  public async updateConversations(conversationEntities: Conversation[]): Promise<void> {\n    const mapOfUserIds = conversationEntities.map(conversationEntity => conversationEntity.participating_user_ids());\n    const userIds = flatten(mapOfUserIds);\n    await this.userRepository.getUsersById(userIds);\n    conversationEntities.forEach(conversationEntity => this.fetchUsersAndEvents(conversationEntity));\n  }\n\n  //##############################################################################\n  // Repository interactions\n  //##############################################################################\n\n  /**\n   * Deletes a conversation from the repository.\n   */\n  private deleteConversationFromRepository(conversationId: QualifiedId) {\n    this.conversationState.conversations.remove(conversation => {\n      return matchQualifiedIds(conversation, conversationId);\n    });\n  }\n\n  public deleteConversation(conversationEntity: Conversation) {\n    this.conversationService\n      .deleteConversation(this.teamState.team().id, conversationEntity.id)\n      .then(() => {\n        this.deleteConversationLocally(conversationEntity, true);\n      })\n      .catch(() => {\n        PrimaryModal.show(PrimaryModal.type.ACKNOWLEDGE, {\n          text: {\n            message: t('modalConversationDeleteErrorMessage', conversationEntity.name()),\n            title: t('modalConversationDeleteErrorHeadline'),\n          },\n        });\n      });\n  }\n\n  private readonly deleteConversationLocally = (conversationId: QualifiedId, skipNotification: boolean) => {\n    const conversationEntity = this.conversationState.findConversation(conversationId);\n    if (!conversationEntity) {\n      return;\n    }\n    if (this.conversationState.isActiveConversation(conversationEntity)) {\n      const nextConversation = this.getNextConversation(conversationEntity);\n      amplify.publish(WebAppEvents.CONVERSATION.SHOW, nextConversation, {});\n    }\n    if (!skipNotification) {\n      const deletionMessage = new DeleteConversationMessage(conversationEntity);\n      amplify.publish(WebAppEvents.NOTIFICATION.NOTIFY, deletionMessage);\n    }\n    if (this.conversationLabelRepository.getConversationCustomLabel(conversationEntity, true)) {\n      this.conversationLabelRepository.removeConversationFromAllLabels(conversationEntity, true);\n      this.conversationLabelRepository.saveLabels();\n    }\n    this.deleteConversationFromRepository(conversationId);\n    this.conversationService.deleteConversationFromDb(conversationId);\n  };\n\n  public async getAllUsersInConversation(conversationId: QualifiedId): Promise<User[]> {\n    const conversationEntity = await this.getConversationById(conversationId);\n    const users = [this.userState.self()].concat(conversationEntity.participating_user_ets());\n    return users;\n  }\n\n  /**\n   * Check for conversation locally and fetch it from the server otherwise.\n   * TODO(Federation): Remove \"optional\" from \"domain\"\n   */\n  async getConversationById(conversation_id: QualifiedId, searchInLocalDB = false): Promise<Conversation> {\n    if (typeof conversation_id.id !== 'string') {\n      throw new ConversationError(\n        ConversationError.TYPE.NO_CONVERSATION_ID,\n        ConversationError.MESSAGE.NO_CONVERSATION_ID,\n      );\n    }\n    const localStateConversation = this.conversationState.findConversation(conversation_id);\n    if (localStateConversation) {\n      return localStateConversation;\n    }\n\n    if (searchInLocalDB) {\n      const localDBConversation = await this.conversationService.loadConversation<BackendConversation>(\n        conversation_id.id,\n      );\n      if (localDBConversation) {\n        return this.mapConversations([localDBConversation])[0];\n      }\n    }\n\n    try {\n      return await this.fetchConversationById(conversation_id);\n    } catch (error) {\n      const isConversationNotFound = error.type === ConversationError.TYPE.CONVERSATION_NOT_FOUND;\n      if (isConversationNotFound) {\n        this.logger.warn(`Failed to get conversation '${conversation_id.id}': ${error.message}`, error);\n      }\n\n      throw error;\n    }\n  }\n\n  /**\n   * Get group conversations by name.\n   *\n   * @param query Query to be searched in group conversation names\n   * @param isHandle Query string is handle\n   * @returns Matching group conversations\n   */\n  getGroupsByName(query: string, isHandle: boolean) {\n    return this.conversationState\n      .filteredConversations()\n      .filter(conversationEntity => {\n        if (!conversationEntity.isGroup()) {\n          return false;\n        }\n\n        const queryString = isHandle ? `@${query}` : query;\n        if (compareTransliteration(conversationEntity.display_name(), queryString)) {\n          return true;\n        }\n\n        for (const userEntity of conversationEntity.participating_user_ets()) {\n          const nameString = isHandle ? userEntity.username() : userEntity.name();\n          if (startsWith(nameString, query)) {\n            return true;\n          }\n        }\n\n        return false;\n      })\n      .sort((conversationA, conversationB) => {\n        return sortByPriority(conversationA.display_name(), conversationB.display_name(), query);\n      })\n      .map(conversationEntity => {\n        this.updateParticipatingUserEntities(conversationEntity);\n        return conversationEntity;\n      });\n  }\n\n  /**\n   * Get the most recent event timestamp from any conversation.\n   * @param increment Increment by one for unique timestamp\n   * @returns Timestamp value\n   */\n  private getLatestEventTimestamp(increment = false) {\n    const mostRecentConversation = this.conversationState.getMostRecentConversation(true);\n    if (mostRecentConversation) {\n      const lastEventTimestamp = mostRecentConversation.last_event_timestamp();\n      return lastEventTimestamp + (increment ? 1 : 0);\n    }\n\n    return 1;\n  }\n\n  /**\n   * Get the next unarchived conversation.\n   *\n   * @param conversationEntity Conversation to start from\n   * @returns Next conversation\n   */\n  getNextConversation(conversationEntity: Conversation) {\n    return getNextItem(this.conversationState.visibleConversations(), conversationEntity);\n  }\n\n  /**\n   * @deprecated import the `ConversationState` wherever you need it and call `getMostRecentConversation` directly from there\n   */\n  public getMostRecentConversation() {\n    return this.conversationState.getMostRecentConversation();\n  }\n\n  /**\n   * Returns a list of sorted conversation ids based on the number of messages in the last 30 days.\n   * @returns Resolve with the most active conversations\n   */\n  getMostActiveConversations() {\n    return this.conversationService.getActiveConversationsFromDb().then(conversation_ids => {\n      return conversation_ids\n        .map(conversation_id => this.conversationState.findConversation(conversation_id))\n        .filter((conversationEntity): conversationEntity is Conversation => !!conversationEntity);\n    });\n  }\n\n  /**\n   * Get conversation with a user.\n   * @param userEntity User entity for whom to get the conversation\n   * @returns Resolves with the conversation with requested user\n   */\n  async get1To1Conversation(userEntity: User): Promise<Conversation | false> {\n    const inCurrentTeam = userEntity.inTeam() && userEntity.teamId === this.userState.self().teamId;\n\n    if (inCurrentTeam) {\n      const matchingConversationEntity = this.conversationState.conversations().find(conversationEntity => {\n        if (!conversationEntity.is1to1()) {\n          // Disregard conversations that are not 1:1\n          return false;\n        }\n\n        const inTeam = ConversationFilter.isInTeam(conversationEntity, userEntity);\n        if (!inTeam) {\n          // Disregard conversations that are not in the team\n          return false;\n        }\n\n        const isActiveConversation = !conversationEntity.removed_from_conversation();\n        if (!isActiveConversation) {\n          // Disregard conversations that self is no longer part of\n          return false;\n        }\n\n        return ConversationFilter.is1To1WithUser(conversationEntity, userEntity);\n      });\n\n      if (matchingConversationEntity) {\n        return matchingConversationEntity;\n      }\n      return this.createGroupConversation([userEntity]);\n    }\n\n    const conversationId = userEntity.connection().conversationId;\n    try {\n      const conversationEntity = await this.getConversationById(conversationId);\n      conversationEntity.connection(userEntity.connection());\n      this.updateParticipatingUserEntities(conversationEntity);\n      return conversationEntity;\n    } catch (error) {\n      const isConversationNotFound = error.type === ConversationError.TYPE.CONVERSATION_NOT_FOUND;\n      if (!isConversationNotFound) {\n        throw error;\n      }\n      return false;\n    }\n  }\n\n  /**\n   * Check whether message has been read.\n   *\n   * @param conversation_id Conversation ID\n   * @param message_id Message ID\n   * @returns Resolves with `true` if message is marked as read\n   */\n  async isMessageRead(conversation_id: QualifiedId, message_id: string): Promise<boolean> {\n    if (!conversation_id || !message_id) {\n      return false;\n    }\n\n    try {\n      const conversationEntity = await this.getConversationById(conversation_id);\n      const messageEntity = await this.messageRepository.getMessageInConversationById(conversationEntity, message_id);\n      return conversationEntity.last_read_timestamp() >= messageEntity.timestamp();\n    } catch (error) {\n      const messageNotFound = error.type === ConversationError.TYPE.MESSAGE_NOT_FOUND;\n      if (messageNotFound) {\n        return true;\n      }\n\n      throw error;\n    }\n  }\n\n  /**\n   * Starts the join public conversation flow.\n   * Opens conversation directly when it is already known.\n   *\n   * @param event Custom event containing join key/code\n   */\n  private readonly onConversationJoin = async (event: {detail: {code: string; key: string; domain?: string}}) => {\n    const {key, code, domain} = event.detail;\n\n    const showNoConversationModal = () => {\n      const titleText = t('modalConversationJoinNotFoundHeadline');\n      const messageText = t('modalConversationJoinNotFoundMessage');\n      this.showModal(messageText, titleText);\n    };\n    const showTooManyMembersModal = () => {\n      const titleText = t('modalConversationJoinFullHeadline');\n      const messageText = t('modalConversationJoinFullMessage');\n      this.showModal(messageText, titleText);\n    };\n\n    try {\n      const {id: conversationId, name: conversationName} = await this.conversationService.getConversationJoin(\n        key,\n        code,\n      );\n      const knownConversation = this.conversationState.findConversation({domain: null, id: conversationId});\n      if (knownConversation?.status() === ConversationStatus.CURRENT_MEMBER) {\n        amplify.publish(WebAppEvents.CONVERSATION.SHOW, knownConversation, {});\n        return;\n      }\n      PrimaryModal.show(PrimaryModal.type.CONFIRM, {\n        primaryAction: {\n          action: async () => {\n            try {\n              const response = await this.conversationService.postConversationJoin(key, code);\n              const conversationEntity = await this.getConversationById({\n                domain: domain ?? this.userState.self().domain,\n                id: conversationId,\n              });\n              if (response) {\n                await this.onMemberJoin(conversationEntity, response);\n              }\n              amplify.publish(WebAppEvents.CONVERSATION.SHOW, conversationEntity, {});\n            } catch (error) {\n              switch (error.label) {\n                case BackendErrorLabel.ACCESS_DENIED:\n                case BackendErrorLabel.NO_CONVERSATION:\n                case BackendErrorLabel.NO_CONVERSATION_CODE: {\n                  showNoConversationModal();\n                  break;\n                }\n                case BackendErrorLabel.TOO_MANY_MEMBERS: {\n                  showTooManyMembersModal();\n                  break;\n                }\n\n                default: {\n                  throw error;\n                }\n              }\n            }\n          },\n          text: t('modalConversationJoinConfirm'),\n        },\n        text: {\n          message: t('modalConversationJoinMessage', {conversationName}),\n          title: t('modalConversationJoinHeadline'),\n        },\n      });\n    } catch (error) {\n      switch (error.label) {\n        case BackendErrorLabel.NO_CONVERSATION:\n        case BackendErrorLabel.NO_CONVERSATION_CODE: {\n          showNoConversationModal();\n          break;\n        }\n        default: {\n          throw error;\n        }\n      }\n    }\n  };\n\n  /**\n   * Maps user connection to the corresponding conversation.\n   *\n   * @note If there is no conversation it will request it from the backend\n   * @returns Resolves when connection was mapped return value\n   */\n  private readonly mapConnection = (connectionEntity: ConnectionEntity): Promise<Conversation | undefined> => {\n    const qualifiedId: QualifiedId = connectionEntity.conversationId;\n    return Promise.resolve(this.conversationState.findConversation(qualifiedId))\n      .then(conversationEntity => {\n        if (!conversationEntity) {\n          if (connectionEntity.isConnected() || connectionEntity.isOutgoingRequest()) {\n            return this.fetchConversationById(qualifiedId);\n          }\n        }\n        return conversationEntity;\n      })\n      .then(conversationEntity => {\n        if (!conversationEntity) {\n          return undefined;\n        }\n        conversationEntity.connection(connectionEntity);\n\n        if (connectionEntity.isConnected()) {\n          conversationEntity.type(CONVERSATION_TYPE.ONE_TO_ONE);\n        }\n\n        return this.updateParticipatingUserEntities(conversationEntity);\n      })\n      .then(updatedConversationEntity => {\n        this.conversationState.conversations.notifySubscribers();\n        return updatedConversationEntity;\n      })\n      .catch(error => {\n        const isConversationNotFound = error.type === ConversationError.TYPE.CONVERSATION_NOT_FOUND;\n        if (!isConversationNotFound) {\n          throw error;\n        }\n        return undefined;\n      });\n  };\n\n  /**\n   * @returns resolves when deleted conversations are locally deleted, too.\n   */\n  checkForDeletedConversations() {\n    return Promise.all(\n      this.conversationState.conversations().map(async conversation => {\n        try {\n          await this.conversationService.getConversationById(conversation);\n        } catch ({code}) {\n          if (code === HTTP_STATUS.NOT_FOUND) {\n            this.deleteConversationLocally(conversation, true);\n          }\n        }\n      }),\n    );\n  }\n\n  /**\n   * Maps user connections to the corresponding conversations.\n   * @param connectionEntities Connections entities\n   */\n  mapConnections(connectionEntities: ConnectionEntity[]): Promise<Conversation>[] {\n    this.logger.info(`Mapping '${connectionEntities.length}' user connection(s) to conversations`, connectionEntities);\n\n    return connectionEntities.map(connectionEntity => this.mapConnection(connectionEntity));\n  }\n\n  /**\n   * Map conversation payload.\n   *\n   * @param payload Payload to map\n   * @param initialTimestamp Initial server and event timestamp\n   * @returns Mapped conversation/s\n   */\n  mapConversations(\n    payload: BackendConversation[],\n    initialTimestamp = this.getLatestEventTimestamp(true),\n  ): Conversation[] {\n    const entities = ConversationMapper.mapConversations(payload as ConversationDatabaseData[], initialTimestamp);\n    entities.forEach(conversationEntity => {\n      this._mapGuestStatusSelf(conversationEntity);\n      conversationEntity.selfUser(this.userState.self());\n      conversationEntity.setStateChangePersistence(true);\n    });\n\n    return entities;\n  }\n\n  private mapGuestStatusSelf() {\n    this.conversationState\n      .filteredConversations()\n      .forEach(conversationEntity => this._mapGuestStatusSelf(conversationEntity));\n\n    if (this.teamState.isTeam()) {\n      this.userState.self().inTeam(true);\n      this.userState.self().isTeamMember(true);\n    }\n  }\n\n  private _mapGuestStatusSelf(conversationEntity: Conversation) {\n    const conversationTeamId = conversationEntity.team_id;\n    const selfTeamId = this.teamState.team()?.id;\n    const isConversationGuest = !!(conversationTeamId && (!selfTeamId || selfTeamId !== conversationTeamId));\n    conversationEntity.isGuest(isConversationGuest);\n  }\n\n  /**\n   * Save a conversation in the repository and in the database.\n   * Will resolve with local conversation entity and do nothing if conversation already exists in state\n   *\n   * @param conversationEntity Conversation to be saved in the repository\n   * @returns Resolves when conversation was saved\n   */\n  saveConversation(conversationEntity: Conversation) {\n    const localEntity = this.conversationState.findConversation(conversationEntity);\n    if (!localEntity) {\n      this.conversationState.conversations.push(conversationEntity);\n      return this.saveConversationStateInDb(conversationEntity);\n    }\n    return Promise.resolve(localEntity);\n  }\n\n  /**\n   * Persists a conversation state in the database.\n   * @param conversationEntity Conversation of which the state should be persisted\n   * @returns Resolves when conversation was saved\n   */\n  private readonly saveConversationStateInDb = (conversationEntity: Conversation) => {\n    return this.conversationService.saveConversationStateInDb(conversationEntity);\n  };\n\n  /**\n   * Save conversations in the repository.\n   * @param conversationEntities Conversations to be saved in the repository\n   */\n  private saveConversations(conversationEntities: Conversation[]) {\n    this.conversationState.conversations.push(...conversationEntities);\n  }\n\n  /**\n   * Set the notification handling state.\n   *\n   * @note Temporarily do not unarchive conversations when handling the notification stream\n   * @param handlingState State of the notifications stream handling\n   */\n  private readonly setNotificationHandlingState = (handlingState: NOTIFICATION_HANDLING_STATE) => {\n    const isFetchingFromStream = handlingState !== NOTIFICATION_HANDLING_STATE.WEB_SOCKET;\n\n    if (this.isBlockingNotificationHandling !== isFetchingFromStream) {\n      if (!isFetchingFromStream) {\n        this.checkChangedConversations();\n      }\n      this.isBlockingNotificationHandling = isFetchingFromStream;\n      this.logger.info(`Block handling of conversation events: ${this.isBlockingNotificationHandling}`);\n    }\n  };\n\n  /**\n   * Update participating users in a conversation.\n   *\n   * @param conversationEntity Conversation to be updated\n   * @param offline Should we only look for cached contacts\n   * @param updateGuests Update conversation guests\n   * @returns Resolves when users have been updated\n   */\n  async updateParticipatingUserEntities(\n    conversationEntity: Conversation,\n    offline = false,\n    updateGuests = false,\n  ): Promise<Conversation> {\n    const userEntities = await this.userRepository.getUsersById(conversationEntity.participating_user_ids(), offline);\n    userEntities.sort(sortUsersByPriority);\n    conversationEntity.participating_user_ets(userEntities);\n\n    if (updateGuests) {\n      conversationEntity.updateGuests();\n    }\n\n    return conversationEntity;\n  }\n\n  //##############################################################################\n  // Send events\n  //##############################################################################\n\n  /**\n   * Add users to an existing conversation.\n   *\n   * @param conversationEntity Conversation to add users to\n   * @param userEntities Users to be added to the conversation\n   * @returns Resolves when members were added\n   */\n  async addUsers(conversation: Conversation, userEntities: User[]) {\n    /**\n     * ToDo: Fetch all MLS Events from backend before doing anything else\n     * Needs to be done to receive the latest epoch and avoid epoch mismatch errors\n     */\n\n    const qualifiedUserIds = userEntities.map(userEntity => userEntity.qualifiedId);\n\n    const {qualifiedId: conversationId, groupId} = conversation;\n\n    try {\n      if (conversation.isUsingMLSProtocol && groupId) {\n        const {events} = await this.core.service!.conversation.addUsersToMLSConversation({\n          conversationId,\n          groupId,\n          qualifiedUserIds,\n        });\n        if (!!events.length) {\n          events.forEach(event => this.eventRepository.injectEvent(event));\n        }\n      } else {\n        const conversationMemberJoinEvent = await this.core.service!.conversation.addUsersToProteusConversation({\n          conversationId,\n          qualifiedUserIds,\n        });\n        if (conversationMemberJoinEvent) {\n          this.eventRepository.injectEvent(conversationMemberJoinEvent, EventRepository.SOURCE.BACKEND_RESPONSE);\n        }\n      }\n    } catch (error) {\n      if (error) {\n        this.handleAddToConversationError(error as BackendClientError, conversation, qualifiedUserIds);\n      }\n    }\n  }\n\n  addMissingMember(conversationEntity: Conversation, users: QualifiedId[], timestamp: number) {\n    const [sender] = users;\n    const event = EventBuilder.buildMemberJoin(conversationEntity, sender, users, timestamp);\n    return this.eventRepository.injectEvent(event, EventRepository.SOURCE.INJECTED);\n  }\n\n  /**\n   * Add a service to an existing conversation.\n   *\n   * @param conversationEntity Conversation to add service to\n   * @param providerId ID of service provider\n   * @param serviceId ID of service\n   * @returns Resolves when service was added\n   */\n  addService(conversationEntity: Conversation, providerId: string, serviceId: string) {\n    return this.conversationService\n      .postBots(conversationEntity.id, providerId, serviceId)\n      .then((response: any) => {\n        const event = response?.event;\n        if (event) {\n          const logMessage = `Successfully added service to conversation '${conversationEntity.display_name()}'`;\n          this.logger.debug(logMessage, response);\n          return this.eventRepository.injectEvent(response.event, EventRepository.SOURCE.BACKEND_RESPONSE);\n        }\n\n        return event;\n      })\n      .catch(error => this.handleAddToConversationError(error, conversationEntity, [{domain: '', id: serviceId}]));\n  }\n\n  private handleAddToConversationError(\n    error: BackendClientError,\n    conversationEntity: Conversation,\n    userIds: QualifiedId[],\n  ) {\n    switch (error.label) {\n      case BackendErrorLabel.NOT_CONNECTED: {\n        this.handleUsersNotConnected(userIds);\n        break;\n      }\n\n      case BackendClientError.LABEL.BAD_GATEWAY:\n      case BackendClientError.LABEL.SERVER_ERROR:\n      case BackendClientError.LABEL.SERVICE_DISABLED:\n      case BackendClientError.LABEL.TOO_MANY_BOTS: {\n        const messageText = t('modalServiceUnavailableMessage');\n        const titleText = t('modalServiceUnavailableHeadline');\n\n        this.showModal(messageText, titleText);\n        break;\n      }\n\n      case BackendErrorLabel.TOO_MANY_MEMBERS: {\n        this.handleTooManyMembersError(conversationEntity.getNumberOfParticipants());\n        break;\n      }\n      case BackendErrorLabel.LEGAL_HOLD_MISSING_CONSENT: {\n        this.showLegalHoldConsentError();\n        break;\n      }\n\n      default: {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * Clear conversation content and archive the conversation.\n   *\n   * @note According to spec we archive a conversation when we clear it.\n   * It will be unarchived once it is opened through search. We use the archive flag to distinguish states.\n   *\n   * @param conversationEntity Conversation to clear\n   * @param leaveConversation Should we leave the conversation before clearing the content?\n   */\n  public clearConversation(conversationEntity: Conversation, leaveConversation = false) {\n    const isActiveConversation = this.conversationState.isActiveConversation(conversationEntity);\n    const nextConversationEntity = this.getNextConversation(conversationEntity);\n\n    if (leaveConversation) {\n      conversationEntity.status(ConversationStatus.PAST_MEMBER);\n      this.leaveCall(conversationEntity.qualifiedId, LEAVE_CALL_REASON.USER_MANUALY_LEFT_CONVERSATION);\n    }\n\n    this.messageRepository.updateClearedTimestamp(conversationEntity);\n    this._clearConversation(conversationEntity);\n\n    if (leaveConversation) {\n      this.removeMember(conversationEntity, this.userState.self().qualifiedId);\n    }\n\n    if (isActiveConversation) {\n      amplify.publish(WebAppEvents.CONVERSATION.SHOW, nextConversationEntity, {});\n    }\n  }\n\n  async leaveGuestRoom(): Promise<void> {\n    if (this.userState.self().isTemporaryGuest()) {\n      const conversation = this.conversationState.getMostRecentConversation(true);\n      if (conversation) {\n        await this.conversationService.deleteMembers(conversation.qualifiedId, this.userState.self().qualifiedId);\n      }\n    }\n  }\n\n  /**\n   * Remove a member from a MLS conversation\n   *\n   * @param conversationEntity Conversation to remove member from\n   * @param userId ID of member to be removed from the conversation\n   * @returns Resolves when member was removed from the conversation\n   */\n  private async removeMemberFromMLSConversation(conversationEntity: Conversation, userId: QualifiedId) {\n    const {groupId, qualifiedId} = conversationEntity;\n    const {events} = await this.core.service!.conversation.removeUsersFromMLSConversation({\n      conversationId: qualifiedId,\n      groupId,\n      qualifiedUserIds: [userId],\n    });\n\n    if (!!events.length) {\n      events.forEach(event => this.eventRepository.injectEvent(event));\n    }\n  }\n\n  /**\n   * Remove a member from a Proteus conversation\n   *\n   * @param conversationEntity Conversation to remove member from\n   * @param userId ID of member to be removed from the conversation\n   * @returns Resolves when member was removed from the conversation\n   */\n  private async removeMemberFromConversation(conversationEntity: Conversation, userId: QualifiedId) {\n    const response = await this.core.service!.conversation.removeUserFromConversation(\n      conversationEntity.qualifiedId,\n      userId,\n    );\n    const roles = conversationEntity.roles();\n    delete roles[userId.id];\n    conversationEntity.roles(roles);\n    const currentTimestamp = this.serverTimeHandler.toServerTimestamp();\n    const event = response || EventBuilder.buildMemberLeave(conversationEntity, userId, true, currentTimestamp);\n    await this.eventRepository.injectEvent(event, EventRepository.SOURCE.BACKEND_RESPONSE);\n    return event;\n  }\n\n  /**\n   * Remove the current user from a conversation.\n   *\n   * @param conversationEntity Conversation to remove user from\n   * @param clearContent Should we clear the conversation content from the database?\n   * @returns Resolves when user was removed from the conversation\n   */\n  private async leaveConversation(conversationEntity: Conversation, clearContent: boolean) {\n    if (clearContent) {\n      this.clearConversation(conversationEntity, false);\n    }\n\n    const userQualifiedId = this.userState.self().qualifiedId;\n    return this.removeMemberFromConversation(conversationEntity, userQualifiedId);\n  }\n\n  /**\n   * Umbrella function to remove a member from a conversation, no matter the protocol or type.\n   *\n   * @param conversationEntity Conversation to remove member from\n   * @param userId ID of member to be removed from the conversation\n   * @param clearContent Should we clear the conversation content from the database?\n   * @returns Resolves when member was removed from the conversation\n   */\n  public async removeMember(conversationEntity: Conversation, userId: QualifiedId, clearContent: boolean = false) {\n    const isUserLeaving = this.userState.self().qualifiedId.id === userId.id;\n    const isMLSConversation = conversationEntity.isUsingMLSProtocol;\n\n    if (isUserLeaving) {\n      return this.leaveConversation(conversationEntity, clearContent);\n    }\n\n    return isMLSConversation\n      ? this.removeMemberFromMLSConversation(conversationEntity, userId)\n      : this.removeMemberFromConversation(conversationEntity, userId);\n  }\n\n  /**\n   * Remove service from conversation.\n   *\n   * @param conversationEntity Conversation to remove service from\n   * @param user ID of service user to be removed from the conversation\n   * @returns Resolves when service was removed from the conversation\n   */\n  public removeService(conversationEntity: Conversation, user: QualifiedId) {\n    return this.conversationService.deleteBots(conversationEntity.id, user.id).then((response: any) => {\n      // TODO: Can this even have a response? in the API Client it look like it always returns `void`\n      const hasResponse = response?.event;\n      const currentTimestamp = this.serverTimeHandler.toServerTimestamp();\n      const event = hasResponse\n        ? response.event\n        : EventBuilder.buildMemberLeave(conversationEntity, user, true, currentTimestamp);\n\n      this.eventRepository.injectEvent(event, EventRepository.SOURCE.BACKEND_RESPONSE);\n      return event;\n    });\n  }\n\n  /**\n   * Rename conversation.\n   *\n   * @param conversationEntity Conversation to rename\n   * @param name New conversation name\n   * @returns Resolves when conversation was renamed\n   */\n  public async renameConversation(\n    conversationEntity: Conversation,\n    name: string,\n  ): Promise<ConversationRenameEvent | undefined> {\n    const response = await this.conversationService.updateConversationName(conversationEntity.id, name);\n    if (response) {\n      this.eventRepository.injectEvent(response, EventRepository.SOURCE.BACKEND_RESPONSE);\n      return response;\n    }\n    return undefined;\n  }\n\n  /**\n   * Set the global message timer\n   */\n  async updateConversationMessageTimer(\n    conversationEntity: Conversation,\n    messageTimer: number | null,\n  ): Promise<ConversationMessageTimerUpdateEvent> {\n    messageTimer = ConversationEphemeralHandler.validateTimer(messageTimer);\n\n    const response = await this.conversationService.updateConversationMessageTimer(conversationEntity.id, messageTimer);\n    if (response) {\n      this.eventRepository.injectEvent(response, EventRepository.SOURCE.BACKEND_RESPONSE);\n    }\n    return response;\n  }\n\n  public async updateConversationReceiptMode(\n    conversationEntity: Conversation,\n    receiptMode: ConversationReceiptModeUpdateData,\n  ) {\n    const response = await this.conversationService.updateConversationReceiptMode(conversationEntity.id, receiptMode);\n    if (response) {\n      this.eventRepository.injectEvent(response, EventRepository.SOURCE.BACKEND_RESPONSE);\n    }\n    return response;\n  }\n\n  /**\n   * Team member was removed.\n   * @param teamId ID of team that member was removed from\n   * @param userId ID of leaving user\n   * @param isoDate Date of member removal\n   */\n  readonly teamMemberLeave = async (\n    teamId: string,\n    userId: QualifiedId,\n    isoDate = this.serverTimeHandler.toServerTimestamp(),\n  ) => {\n    const userEntity = await this.userRepository.getUserById(userId);\n    const eventInjections = this.conversationState\n      .conversations()\n      .filter(conversationEntity => {\n        const conversationInTeam = conversationEntity.team_id === teamId;\n        const userIsParticipant = UserFilter.isParticipant(conversationEntity, userId);\n        return conversationInTeam && userIsParticipant && !conversationEntity.removed_from_conversation();\n      })\n      .map(conversationEntity => {\n        const leaveEvent = EventBuilder.buildTeamMemberLeave(conversationEntity, userEntity, isoDate);\n        return this.eventRepository.injectEvent(leaveEvent);\n      });\n    userEntity.isDeleted = true;\n    return Promise.all(eventInjections);\n  };\n\n  /**\n   * Set the notification state of a conversation.\n   *\n   * @param conversationEntity Conversation to change notification state off\n   * @param notificationState New notification state\n   * @returns Resolves when the notification stated was change\n   */\n  public async setNotificationState(conversationEntity: Conversation, notificationState: number) {\n    if (!conversationEntity || notificationState === undefined) {\n      return Promise.reject(\n        new ConversationError(BaseError.TYPE.MISSING_PARAMETER as BASE_ERROR_TYPE, BaseError.MESSAGE.MISSING_PARAMETER),\n      );\n    }\n\n    const validNotificationStates = Object.values(NOTIFICATION_STATE);\n    if (!validNotificationStates.includes(notificationState)) {\n      return Promise.reject(\n        new ConversationError(BaseError.TYPE.INVALID_PARAMETER as BASE_ERROR_TYPE, BaseError.MESSAGE.INVALID_PARAMETER),\n      );\n    }\n\n    const currentTimestamp = this.serverTimeHandler.toServerTimestamp();\n    const payload = {\n      otr_muted_ref: new Date(conversationEntity.getLastKnownTimestamp(currentTimestamp)).toISOString(),\n      otr_muted_status: notificationState,\n    };\n\n    try {\n      await this.conversationService.updateMemberProperties(conversationEntity.id, payload);\n      const response = {data: payload, from: this.userState.self().id};\n      this.onMemberUpdate(conversationEntity, response);\n\n      const {otr_muted_ref: mutedRef, otr_muted_status: mutedStatus} = payload;\n      const logMessage = `Changed notification state of conversation to '${mutedStatus}' on '${mutedRef}'`;\n      this.logger.info(logMessage);\n      return response;\n    } catch (error) {\n      const log = `Failed to change notification state of conversation '${conversationEntity.id}': ${error.message}`;\n      const rejectError = new Error(log);\n      this.logger.warn(rejectError.message, error);\n      throw rejectError;\n    }\n  }\n\n  /**\n   * Archive a conversation.\n   *\n   * @param conversationEntity Conversation to rename\n   * @returns Resolves when the conversation was archived\n   */\n  public async archiveConversation(conversationEntity: Conversation) {\n    await this.toggleArchiveConversation(conversationEntity, true);\n    this.logger.info(`Conversation '${conversationEntity.id}' archived`);\n  }\n\n  /**\n   * Un-archive a conversation.\n   *\n   * @param conversationEntity Conversation to unarchive\n   * @param forceChange Force state change without new message\n   * @param trigger Trigger for unarchive\n   * @returns Resolves when the conversation was unarchived\n   */\n  public async unarchiveConversation(conversationEntity: Conversation, forceChange = false, trigger = 'unknown') {\n    await this.toggleArchiveConversation(conversationEntity, false, forceChange);\n    this.logger.info(`Conversation '${conversationEntity.id}' unarchived by trigger '${trigger}'`);\n  }\n\n  public async sendTypingStart(conversationEntity: Conversation) {\n    this.core.service!.conversation.sendTypingStart(conversationEntity.qualifiedId);\n  }\n\n  public async sendTypingStop(conversationEntity: Conversation) {\n    this.core.service!.conversation.sendTypingStop(conversationEntity.qualifiedId);\n  }\n\n  private async toggleArchiveConversation(\n    conversationEntity: Conversation,\n    newState: boolean,\n    forceChange: boolean = false,\n  ) {\n    if (!conversationEntity) {\n      const error = new ConversationError(\n        ConversationError.TYPE.CONVERSATION_NOT_FOUND,\n        ConversationError.MESSAGE.CONVERSATION_NOT_FOUND,\n      );\n      throw error;\n    }\n\n    const stateChange = conversationEntity.is_archived() !== newState;\n\n    const currentTimestamp = this.serverTimeHandler.toServerTimestamp();\n    const archiveTimestamp = conversationEntity.getLastKnownTimestamp(currentTimestamp);\n    const sameTimestamp = conversationEntity.archivedTimestamp() === archiveTimestamp;\n    const skipChange = sameTimestamp && !forceChange;\n\n    if (!stateChange && skipChange) {\n      throw new ConversationError(ConversationError.TYPE.NO_CHANGES, ConversationError.MESSAGE.NO_CHANGES);\n    }\n\n    const payload = {\n      otr_archived: newState,\n      otr_archived_ref: new Date(archiveTimestamp).toISOString(),\n    };\n\n    const conversationId = conversationEntity.id;\n\n    const updatePromise = conversationEntity.removed_from_conversation()\n      ? Promise.resolve()\n      : this.conversationService.updateMemberProperties(conversationId, payload).catch(error => {\n          const logMessage = `Failed to change archived state of '${conversationId}' to '${newState}': ${error.code}`;\n          this.logger.error(logMessage);\n\n          const isNotFound = error.code === HTTP_STATUS.NOT_FOUND;\n          if (!isNotFound) {\n            throw error;\n          }\n        });\n\n    await updatePromise;\n    const response = {\n      data: payload,\n      from: this.userState.self().id,\n    };\n    this.onMemberUpdate(conversationEntity, response);\n  }\n\n  private checkChangedConversations() {\n    this.conversationsWithNewEvents.forEach(conversationEntity => {\n      if (conversationEntity.shouldUnarchive()) {\n        this.unarchiveConversation(conversationEntity, false, ConversationRepository.eventFromStreamMessage);\n      }\n    });\n\n    this.conversationsWithNewEvents.clear();\n  }\n\n  /**\n   * Clears conversation content from view and the database.\n   *\n   * @param conversationEntity Conversation entity to delete\n   * @param timestamp Optional timestamps for which messages to remove\n   */\n  private _clearConversation(conversationEntity: Conversation, timestamp?: number) {\n    this.deleteMessages(conversationEntity, timestamp);\n\n    if (conversationEntity.removed_from_conversation()) {\n      this.conversationService.deleteConversationFromDb(conversationEntity);\n      this.deleteConversationFromRepository(conversationEntity);\n    }\n  }\n\n  private handleConversationCreateError(error: BackendClientError, userIds: QualifiedId[]): void {\n    switch (error.label) {\n      case BackendClientError.LABEL.CLIENT_ERROR:\n        this.handleTooManyMembersError();\n        break;\n      case BackendClientError.LABEL.NOT_CONNECTED:\n        this.handleUsersNotConnected(userIds);\n        break;\n      case BackendErrorLabel.LEGAL_HOLD_MISSING_CONSENT:\n        this.showLegalHoldConsentError();\n        break;\n      default:\n        throw error;\n    }\n  }\n\n  private handleTooManyMembersError(participants = ConversationRepository.CONFIG.GROUP.MAX_SIZE) {\n    const openSpots = ConversationRepository.CONFIG.GROUP.MAX_SIZE - participants;\n    const substitutions = {\n      number1: ConversationRepository.CONFIG.GROUP.MAX_SIZE.toString(10),\n      number2: Math.max(0, openSpots).toString(10),\n    };\n\n    const messageText = t('modalConversationTooManyMembersMessage', substitutions);\n    const titleText = t('modalConversationTooManyMembersHeadline');\n    this.showModal(messageText, titleText);\n  }\n\n  private async handleUsersNotConnected(userIds: QualifiedId[] = []): Promise<void> {\n    const titleText = t('modalConversationNotConnectedHeadline');\n\n    if (userIds.length > 1) {\n      this.showModal(t('modalConversationNotConnectedMessageMany'), titleText);\n    } else {\n      // TODO(Federation): Update code once connections are implemented on the backend\n      const userEntity = await this.userRepository.getUserById(userIds[0]);\n      this.showModal(t('modalConversationNotConnectedMessageOne', userEntity.name()), titleText);\n    }\n  }\n\n  private showModal(messageText: string, titleText: string) {\n    PrimaryModal.show(PrimaryModal.type.ACKNOWLEDGE, {\n      text: {\n        message: messageText,\n        title: titleText,\n      },\n    });\n  }\n\n  private showLegalHoldConsentError() {\n    const replaceLinkLegalHold = replaceLink(\n      Config.getConfig().URL.SUPPORT.LEGAL_HOLD_BLOCK,\n      '',\n      'read-more-legal-hold',\n    );\n\n    const messageText = t('modalLegalHoldConversationMissingConsentMessage', {}, replaceLinkLegalHold);\n    const titleText = t('modalUserCannotBeAddedHeadline');\n\n    PrimaryModal.show(PrimaryModal.type.ACKNOWLEDGE, {\n      text: {\n        htmlMessage: messageText,\n        title: titleText,\n      },\n    });\n  }\n\n  //##############################################################################\n  // Send Generic Messages\n  //##############################################################################\n\n  readonly injectLegalHoldMessage = async ({\n    conversationEntity,\n    conversationId,\n    userId,\n    timestamp,\n    legalHoldStatus,\n    beforeTimestamp = false,\n  }: {\n    beforeTimestamp?: boolean;\n    conversationEntity?: Conversation;\n    conversationId: QualifiedId;\n    legalHoldStatus: LegalHoldStatus;\n    timestamp?: number;\n    userId: QualifiedId;\n  }) => {\n    if (typeof legalHoldStatus === 'undefined') {\n      return;\n    }\n    if (!timestamp) {\n      const conversation = conversationEntity || this.conversationState.findConversation(conversationId);\n      timestamp = conversation.getNextTimestamp();\n    }\n    const legalHoldUpdateMessage = EventBuilder.buildLegalHoldMessage(\n      conversationId || conversationEntity?.qualifiedId,\n      userId,\n      timestamp,\n      legalHoldStatus,\n      beforeTimestamp,\n    );\n    await this.eventRepository.injectEvent(legalHoldUpdateMessage);\n  };\n\n  async injectFileTypeRestrictedMessage(\n    conversation: Conversation,\n    user: User,\n    isIncoming: boolean,\n    fileExt: string,\n    id = createRandomUuid(),\n  ) {\n    const fileRestrictionMessage = EventBuilder.buildFileTypeRestricted(conversation, user, isIncoming, fileExt, id);\n    await this.eventRepository.injectEvent(fileRestrictionMessage);\n  }\n\n  //##############################################################################\n  // Event callbacks\n  //##############################################################################\n\n  /**\n   * Listener for incoming events.\n   *\n   * @param eventJson JSON data for event\n   * @param eventSource Source of event\n   * @returns Resolves when event was handled\n   */\n  private readonly onConversationEvent = (eventJson: IncomingEvent, eventSource = EventRepository.SOURCE.STREAM) => {\n    const logObject = {eventJson: JSON.stringify(eventJson), eventObject: eventJson};\n    const logMessage = `Conversation Event: '${eventJson.type}' (Source: ${eventSource})`;\n    this.logger.info(logMessage, logObject);\n\n    return this.pushToReceivingQueue(eventJson, eventSource);\n  };\n\n  private handleConversationEvent(\n    eventJson: IncomingEvent,\n    eventSource: EventSource = EventSource.NOTIFICATION_STREAM,\n  ) {\n    if (!eventJson) {\n      return Promise.reject(new Error('Conversation Repository Event Handling: Event missing'));\n    }\n\n    const ignoredEvents: (CONVERSATION_EVENT | CLIENT_CONVERSATION_EVENT)[] = [CONVERSATION_EVENT.MLS_MESSAGE_ADD];\n    if (ignoredEvents.includes(eventJson?.type)) {\n      return Promise.resolve();\n    }\n\n    const {conversation, qualified_conversation, data: eventData, type} = eventJson;\n    // data.conversationId is always the conversationId that should be read first. If not found we can fallback to qualified_conversation or conversation\n    const conversationId: QualifiedId = eventData?.conversationId\n      ? {domain: '', id: eventData.conversationId}\n      : qualified_conversation || {domain: '', id: conversation};\n    this.logger.info(\n      `Handling event '${type}' in conversation '${conversationId.id}/${conversationId.domain}' (Source: ${eventSource})`,\n    );\n\n    const inSelfConversation = this.conversationState.isSelfConversation(conversationId);\n    if (inSelfConversation) {\n      const typesInSelfConversation = [\n        CONVERSATION_EVENT.MEMBER_UPDATE,\n        ClientEvent.CONVERSATION.MESSAGE_HIDDEN,\n        /**\n         * As of today (07/07/2022) the backend sends `WELCOME` message to the user's own\n         * conversation (not the actual conversation that the welcome should be part of)\n         */\n        CONVERSATION_EVENT.MLS_WELCOME_MESSAGE,\n      ];\n\n      if (type === CONVERSATION_EVENT.MLS_WELCOME_MESSAGE) {\n        mlsConversationState.getState().markAsEstablished(eventData);\n      }\n\n      const isExpectedType = typesInSelfConversation.includes(type);\n      if (!isExpectedType) {\n        return Promise.reject(\n          new ConversationError(\n            ConversationError.TYPE.WRONG_CONVERSATION,\n            ConversationError.MESSAGE.WRONG_CONVERSATION,\n          ),\n        );\n      }\n    }\n\n    const isConversationCreate = type === CONVERSATION_EVENT.CREATE;\n    const onEventPromise = isConversationCreate\n      ? Promise.resolve(null)\n      : this.getConversationById(conversationId, true);\n    let previouslyArchived = false;\n\n    return onEventPromise\n      .then((conversationEntity: Conversation) => {\n        if (conversationEntity) {\n          // Check if conversation was archived\n          previouslyArchived = conversationEntity.is_archived();\n          const isPastMemberStatus = conversationEntity.status() === ConversationStatus.PAST_MEMBER;\n          const isMemberJoinType = type === CONVERSATION_EVENT.MEMBER_JOIN;\n\n          if (previouslyArchived && isPastMemberStatus && isMemberJoinType) {\n            this.unarchiveConversation(conversationEntity, false, ConversationRepository.eventFromStreamMessage);\n          }\n          const isBackendTimestamp = eventSource !== EventSource.INJECTED;\n          if (type !== CONVERSATION_EVENT.MEMBER_JOIN && type !== CONVERSATION_EVENT.MEMBER_LEAVE) {\n            conversationEntity.updateTimestampServer(eventJson.server_time || eventJson.time, isBackendTimestamp);\n          }\n        }\n        return conversationEntity;\n      })\n      .then(conversationEntity => this.checkLegalHoldStatus(conversationEntity, eventJson))\n      .then(conversationEntity => this.checkConversationParticipants(conversationEntity, eventJson, eventSource))\n      .then(conversationEntity => this.triggerFeatureEventHandlers(conversationEntity, eventJson))\n      .then(\n        conversationEntity => this.reactToConversationEvent(conversationEntity, eventJson, eventSource) as EntityObject,\n      )\n      .then((entityObject = {} as EntityObject) => {\n        if (type !== CONVERSATION_EVENT.MEMBER_JOIN && type !== CONVERSATION_EVENT.MEMBER_LEAVE) {\n          this.handleConversationNotification(entityObject as EntityObject, eventSource, previouslyArchived);\n        }\n      })\n      .catch((error: BaseError) => {\n        const ignoredErrorTypes: string[] = [\n          ConversationError.TYPE.MESSAGE_NOT_FOUND,\n          ConversationError.TYPE.CONVERSATION_NOT_FOUND,\n        ];\n\n        const isRemovedFromConversation =\n          (error as BackendClientError).label === BackendClientError.LABEL.ACCESS_DENIED;\n        if (isRemovedFromConversation) {\n          const messageText = t('conversationNotFoundMessage');\n          const titleText = t('conversationNotFoundTitle', Config.getConfig().BRAND_NAME);\n\n          this.showModal(messageText, titleText);\n          return;\n        }\n\n        if (!ignoredErrorTypes.includes(error.type)) {\n          throw error;\n        }\n      });\n  }\n\n  /**\n   * Check that sender of received event is a known conversation participant.\n   *\n   * @param conversationEntity Conversation targeted by the event\n   * @param eventJson JSON data of the event\n   * @param eventSource Source of event\n   * @returns Resolves when the participant list has been checked\n   */\n  private checkConversationParticipants(\n    conversationEntity: Conversation,\n    eventJson: IncomingEvent,\n    eventSource: EventSource,\n  ) {\n    // We ignore injected events\n    const isInjectedEvent = eventSource === EventRepository.SOURCE.INJECTED;\n    if (isInjectedEvent || !conversationEntity) {\n      return conversationEntity;\n    }\n\n    const {from: senderId, type, time} = eventJson;\n\n    if (senderId) {\n      const allParticipants = conversationEntity.participating_user_ids().concat(this.userState.self().qualifiedId);\n      const isFromUnknownUser = allParticipants.every(participant => participant.id !== senderId);\n\n      if (isFromUnknownUser) {\n        const membersUpdateMessages = [\n          CONVERSATION_EVENT.MEMBER_LEAVE,\n          CONVERSATION_EVENT.MEMBER_JOIN,\n          ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE,\n        ];\n        const isMembersUpdateEvent = membersUpdateMessages.includes(eventJson.type);\n        if (isMembersUpdateEvent) {\n          const isFromUpdatedMember = eventJson.data.user_ids?.includes(senderId);\n          if (isFromUpdatedMember) {\n            // we ignore leave/join events that are sent by the user actually leaving or joining\n            return conversationEntity;\n          }\n        }\n\n        const message = `Received '${type}' event from user '${senderId}' unknown in '${conversationEntity.id}'`;\n        this.logger.warn(message, eventJson);\n\n        const qualifiedSender: QualifiedId = {domain: '', id: senderId};\n\n        const timestamp = new Date(time).getTime() - 1;\n        return this.addMissingMember(conversationEntity, [qualifiedSender], timestamp).then(() => conversationEntity);\n      }\n    }\n\n    return conversationEntity;\n  }\n\n  private async checkLegalHoldStatus(conversationEntity: Conversation, eventJson: IncomingEvent) {\n    if (!LegalHoldEvaluator.hasMessageLegalHoldFlag(eventJson)) {\n      return conversationEntity;\n    }\n\n    const renderLegalHoldMessage = LegalHoldEvaluator.renderLegalHoldMessage(\n      eventJson,\n      conversationEntity.legalHoldStatus(),\n    );\n\n    if (!renderLegalHoldMessage) {\n      return conversationEntity;\n    }\n\n    const {\n      conversation: conversationId,\n      qualified_conversation,\n      qualified_from,\n      data: {legal_hold_status: messageLegalHoldStatus},\n      from: userId,\n      time: isoTimestamp,\n    } = eventJson;\n    const timestamp = new Date(isoTimestamp).getTime();\n    const qualifiedConversation = qualified_conversation || {domain: '', id: conversationId};\n    const qualifiedUser = qualified_from || {domain: '', id: userId};\n\n    await this.injectLegalHoldMessage({\n      beforeTimestamp: true,\n      conversationId: qualifiedConversation,\n      legalHoldStatus: messageLegalHoldStatus,\n      timestamp,\n      userId: qualifiedUser,\n    });\n\n    await this.messageRepository.updateAllClients(conversationEntity, true);\n\n    if (messageLegalHoldStatus === conversationEntity.legalHoldStatus()) {\n      return conversationEntity;\n    }\n\n    await this.injectLegalHoldMessage({\n      conversationId: qualifiedConversation,\n      legalHoldStatus: conversationEntity.legalHoldStatus(),\n      timestamp,\n      userId: qualifiedUser,\n    });\n\n    return conversationEntity;\n  }\n\n  /**\n   * Triggers the methods associated with a specific event.\n   *\n   * @param conversationEntity Conversation targeted by the event\n   * @param eventJson JSON data of the event\n   * @param eventSource Source of event\n   * @returns Resolves when the event has been treated\n   */\n  private reactToConversationEvent(\n    conversationEntity: Conversation,\n    eventJson: IncomingEvent,\n    eventSource: EventSource,\n  ) {\n    switch (eventJson.type) {\n      case CONVERSATION_EVENT.CREATE:\n        return this.onCreate(eventJson, eventSource);\n\n      case CONVERSATION_EVENT.DELETE:\n        return this.deleteConversationLocally({domain: conversationEntity.domain, id: eventJson.conversation}, false);\n\n      case CONVERSATION_EVENT.MEMBER_JOIN:\n        return this.onMemberJoin(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.MEMBER_LEAVE:\n      case ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE:\n        return this.onMemberLeave(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.MEMBER_UPDATE:\n        return this.onMemberUpdate(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.TYPING:\n        return this.onTyping(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.RENAME:\n        return this.onRename(conversationEntity, eventJson, eventSource === EventRepository.SOURCE.WEB_SOCKET);\n\n      case ClientEvent.CONVERSATION.ASSET_ADD:\n        return this.onAssetAdd(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.GROUP_CREATION:\n        return this.onGroupCreation(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.MESSAGE_DELETE:\n        return this.onMessageDeleted(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.MESSAGE_HIDDEN:\n        return this.onMessageHidden(eventJson);\n\n      case ClientEvent.CONVERSATION.ONE2ONE_CREATION:\n        return this.on1to1Creation(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.REACTION:\n        return this.onReaction(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.RECEIPT_MODE_UPDATE:\n        return this.onReceiptModeChanged(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.BUTTON_ACTION_CONFIRMATION:\n        return this.onButtonActionConfirmation(conversationEntity, eventJson);\n\n      case ClientEvent.CONVERSATION.MESSAGE_ADD:\n        const isMessageEdit = !!eventJson.edited_time;\n        if (isMessageEdit) {\n          // in case of an edition, the DB listener will take care of updating the local entity\n          return {conversationEntity};\n        }\n        return this.addEventToConversation(conversationEntity, eventJson);\n\n      case CONVERSATION_EVENT.MESSAGE_TIMER_UPDATE:\n      case ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD:\n      case ClientEvent.CONVERSATION.DELETE_EVERYWHERE:\n      case ClientEvent.CONVERSATION.FILE_TYPE_RESTRICTED:\n      case ClientEvent.CONVERSATION.INCOMING_MESSAGE_TOO_BIG:\n      case ClientEvent.CONVERSATION.KNOCK:\n      case ClientEvent.CONVERSATION.CALL_TIME_OUT:\n      case ClientEvent.CONVERSATION.LEGAL_HOLD_UPDATE:\n      case ClientEvent.CONVERSATION.LOCATION:\n      case ClientEvent.CONVERSATION.MISSED_MESSAGES:\n      case ClientEvent.CONVERSATION.UNABLE_TO_DECRYPT:\n      case ClientEvent.CONVERSATION.VERIFICATION:\n      case ClientEvent.CONVERSATION.VOICE_CHANNEL_ACTIVATE:\n      case ClientEvent.CONVERSATION.VOICE_CHANNEL_DEACTIVATE:\n        return this.addEventToConversation(conversationEntity, eventJson);\n    }\n  }\n\n  /**\n   * Calls the feature specific event handler on the current event being handled.\n   *\n   * @param conversationEntity Conversation targeted by the event\n   * @param eventJson JSON data of the event\n   * @param eventSource Source of event\n   * @returns Resolves when all the handlers have done their job\n   */\n  private async triggerFeatureEventHandlers(conversationEntity: Conversation, eventJson: IncomingEvent) {\n    const conversationEventHandlers = [this.ephemeralHandler, this.stateHandler];\n    const handlePromises = conversationEventHandlers.map(handler =>\n      handler.handleConversationEvent(conversationEntity, eventJson),\n    );\n    await Promise.all(handlePromises);\n    return conversationEntity;\n  }\n\n  /**\n   * Handles conversation update and notification message.\n   *\n   * @param entityObject Object containing the conversation and the message that are targeted by the event\n   * @param eventSource Source of event\n   * @param previouslyArchived `true` if the previous state of the conversation was archived\n   * @returns Resolves when the conversation was updated\n   */\n  private async handleConversationNotification(\n    entityObject: EntityObject,\n    eventSource: EventSource,\n    previouslyArchived: boolean,\n  ) {\n    const {conversationEntity, messageEntity} = entityObject;\n\n    if (conversationEntity) {\n      const eventFromWebSocket = eventSource === EventRepository.SOURCE.WEB_SOCKET;\n      const eventFromStream = eventSource === EventRepository.SOURCE.STREAM;\n\n      if (messageEntity) {\n        const isRemoteEvent = eventFromStream || eventFromWebSocket;\n\n        if (isRemoteEvent) {\n          this.messageRepository.sendConfirmationStatus(conversationEntity, messageEntity, Confirmation.Type.DELIVERED);\n        }\n\n        if (!eventFromStream) {\n          amplify.publish(WebAppEvents.NOTIFICATION.NOTIFY, messageEntity, undefined, conversationEntity);\n        }\n\n        if (conversationEntity.is_cleared()) {\n          conversationEntity.cleared_timestamp(0);\n        }\n      }\n\n      // Check if event needs to be un-archived\n      if (previouslyArchived) {\n        // Add to check for un-archiving at the end of stream handling\n        if (eventFromStream) {\n          return this.conversationsWithNewEvents.set(conversationEntity.id, conversationEntity);\n        }\n\n        if (eventFromWebSocket && conversationEntity.shouldUnarchive()) {\n          return this.unarchiveConversation(conversationEntity, false, 'event from WebSocket');\n        }\n      }\n    }\n  }\n\n  /**\n   * Push to receiving queue.\n   * @param eventJson JSON data for event\n   * @param source Source of event\n   */\n  private pushToReceivingQueue(eventJson: IncomingEvent, source: EventSource) {\n    this.receiving_queue.push(() => this.handleConversationEvent(eventJson, source));\n  }\n\n  /**\n   * Add \"missed events\" system message to conversation.\n   */\n  private readonly onMissedEvents = (): void => {\n    this.conversationState\n      .filteredConversations()\n      .filter(conversationEntity => !conversationEntity.removed_from_conversation())\n      .forEach(conversationEntity => {\n        const currentTimestamp = this.serverTimeHandler.toServerTimestamp();\n        const missed_event = EventBuilder.buildMissed(conversationEntity, currentTimestamp);\n        this.eventRepository.injectEvent(missed_event);\n      });\n  };\n\n  private on1to1Creation(conversationEntity: Conversation, eventJson: OneToOneCreationEvent) {\n    return this.event_mapper\n      .mapJsonEvent(eventJson, conversationEntity)\n      .then(messageEntity => this.updateMessageUserEntities(messageEntity))\n      .then((messageEntity: MemberMessage) => {\n        const userEntity = messageEntity.otherUser();\n        const isOutgoingRequest = userEntity?.isOutgoingRequest();\n        if (isOutgoingRequest) {\n          messageEntity.memberMessageType = SystemMessageType.CONNECTION_REQUEST;\n        }\n\n        conversationEntity.addMessage(messageEntity);\n        return {conversationEntity};\n      });\n  }\n\n  /**\n   * A conversation was created.\n   *\n   * @param eventJson JSON data of 'conversation.create' event\n   * @param eventSource Source of event\n   * @returns Resolves when the event was handled\n   */\n  private async onCreate(\n    eventJson: ConversationCreateEvent,\n    eventSource?: EventSource,\n  ): Promise<{conversationEntity: Conversation}> {\n    const {conversation: conversationId, data: eventData, time} = eventJson;\n    const eventTimestamp = new Date(time).getTime();\n    const initialTimestamp = isNaN(eventTimestamp) ? this.getLatestEventTimestamp(true) : eventTimestamp;\n    try {\n      const existingConversationEntity = this.conversationState.findConversation({\n        domain: eventJson.qualified_conversation?.domain,\n        id: conversationId,\n      });\n      if (existingConversationEntity) {\n        throw new ConversationError(ConversationError.TYPE.NO_CHANGES, ConversationError.MESSAGE.NO_CHANGES);\n      }\n\n      const [conversationEntity] = this.mapConversations([eventData], initialTimestamp);\n      if (conversationEntity) {\n        if (conversationEntity.participating_user_ids().length) {\n          this.addCreationMessage(conversationEntity, false, initialTimestamp, eventSource);\n        }\n        await this.updateParticipatingUserEntities(conversationEntity);\n        this.verificationStateHandler.onConversationCreate(conversationEntity);\n        await this.saveConversation(conversationEntity);\n      }\n      return {conversationEntity};\n    } catch (error) {\n      const isNoChanges = error.type === ConversationError.TYPE.NO_CHANGES;\n      if (!isNoChanges) {\n        throw error;\n      }\n    }\n    return undefined;\n  }\n\n  private async onGroupCreation(conversationEntity: Conversation, eventJson: GroupCreationEvent) {\n    const messageEntity = await this.event_mapper.mapJsonEvent(eventJson, conversationEntity);\n    const creatorId = conversationEntity.creator;\n    const creatorDomain = conversationEntity.domain;\n    const createdByParticipant = !!conversationEntity\n      .participating_user_ids()\n      .find(userId => matchQualifiedIds(userId, {domain: creatorDomain, id: creatorId}));\n    const createdBySelfUser = conversationEntity.isCreatedBySelf();\n\n    const creatorIsParticipant = createdByParticipant || createdBySelfUser;\n\n    const data = await this.conversationService.getConversationById(conversationEntity);\n    const allMembers = [...data.members.others, data.members.self];\n    const conversationRoles = allMembers.reduce<Record<string, string>>((roles, member) => {\n      roles[member.id] = member.conversation_role;\n      return roles;\n    }, {});\n    conversationEntity.roles(conversationRoles);\n\n    if (!creatorIsParticipant) {\n      (messageEntity as MemberMessage).memberMessageType = SystemMessageType.CONVERSATION_RESUME;\n    }\n\n    const updatedMessageEntity = await this.updateMessageUserEntities(messageEntity);\n    if (conversationEntity && updatedMessageEntity) {\n      conversationEntity.addMessage(updatedMessageEntity);\n    }\n\n    return {conversationEntity, messageEntity: updatedMessageEntity};\n  }\n\n  /**\n   * Users were added to a group conversation.\n   *\n   * @param conversationEntity Conversation to add users to\n   * @param eventJson JSON data of 'conversation.member-join' event\n   * @returns Resolves when the event was handled\n   */\n  private async onMemberJoin(\n    conversationEntity: Conversation,\n    eventJson: ConversationMemberJoinEvent,\n  ): Promise<void | EntityObject> {\n    // Ignore if we join a 1to1 conversation (accept a connection request)\n    const connectionEntity = this.connectionRepository.getConnectionByConversationId(conversationEntity.qualifiedId);\n    const isPendingConnection = connectionEntity?.isIncomingRequest();\n    if (isPendingConnection) {\n      return Promise.resolve();\n    }\n\n    const eventData = eventJson.data;\n\n    if (eventData.users) {\n      eventData.users.forEach(otherMember => {\n        const otherId = otherMember.qualified_id || {domain: '', id: otherMember.id};\n        const isSelfUser = matchQualifiedIds(otherId, this.userState.self());\n        const isParticipatingUser = !!conversationEntity\n          .participating_user_ids()\n          .find(participatingUser =>\n            matchQualifiedIds(participatingUser, otherMember.qualified_id || {domain: '', id: otherMember.id}),\n          );\n        if (!isSelfUser && !isParticipatingUser) {\n          conversationEntity.participating_user_ids.push({\n            domain: otherMember.qualified_id?.domain || null,\n            id: otherMember.id,\n          });\n        }\n      });\n    } else {\n      eventData.user_ids.forEach(userId => {\n        const isSelfUser = userId === this.userState.self().id;\n        const isParticipatingUser = conversationEntity.participating_user_ids().some(user => user.id === userId);\n        if (!isSelfUser && !isParticipatingUser) {\n          conversationEntity.participating_user_ids.push({domain: '', id: userId});\n        }\n      });\n    }\n\n    // Self user joins again\n    const selfUserRejoins = eventData.user_ids.includes(this.userState.self().id);\n    if (selfUserRejoins) {\n      conversationEntity.status(ConversationStatus.CURRENT_MEMBER);\n      await this.conversationRoleRepository.updateConversationRoles(conversationEntity);\n    }\n\n    const updateSequence =\n      selfUserRejoins || connectionEntity?.isConnected()\n        ? this.updateConversationFromBackend(conversationEntity)\n        : Promise.resolve();\n\n    const qualifiedUserIds =\n      eventData.users?.map(user => user.qualified_id) || eventData.user_ids.map(userId => ({domain: '', id: userId}));\n\n    if (\n      conversationEntity.groupId &&\n      !mlsConversationState.getState().isEstablished(conversationEntity.groupId) &&\n      (await this.core.service!.conversation.isMLSConversationEstablished(conversationEntity.groupId))\n    ) {\n      // If the conversation was not previously marked as established and the core if aware of this conversation, we can mark is as established\n      mlsConversationState.getState().markAsEstablished(conversationEntity.groupId);\n    }\n\n    return updateSequence\n      .then(() => this.updateParticipatingUserEntities(conversationEntity, false, true))\n      .then(() => this.addEventToConversation(conversationEntity, eventJson))\n      .then(({messageEntity}) => {\n        this.verificationStateHandler.onMemberJoined(conversationEntity, qualifiedUserIds);\n        return {conversationEntity, messageEntity};\n      });\n  }\n\n  /**\n   * Members of a group conversation were removed or left.\n   *\n   * @param conversationEntity Conversation to remove users from\n   * @param eventJson JSON data of 'conversation.member-leave' event\n   * @returns Resolves when the event was handled\n   */\n  private async onMemberLeave(\n    conversationEntity: Conversation,\n    eventJson: ConversationMemberLeaveEvent | TeamMemberLeaveEvent,\n  ): Promise<{conversationEntity: Conversation; messageEntity: Message} | undefined> {\n    const {data: eventData, from} = eventJson;\n    const isFromSelf = from === this.userState.self().id;\n    const removesSelfUser = eventData.user_ids.includes(this.userState.self().id);\n    const selfLeavingClearedConversation = isFromSelf && removesSelfUser && conversationEntity.is_cleared();\n\n    if (removesSelfUser) {\n      conversationEntity.status(ConversationStatus.PAST_MEMBER);\n      this.leaveCall(\n        conversationEntity.qualifiedId,\n        LEAVE_CALL_REASON.USER_IS_REMOVED_BY_AN_ADMIN_OR_LEFT_ON_ANOTHER_CLIENT,\n      );\n\n      if (this.userState.self().isTemporaryGuest()) {\n        eventJson.from = this.userState.self().id;\n      }\n\n      if (conversationEntity.protocol === ConversationProtocol.MLS) {\n        const {groupId} = conversationEntity;\n        if (groupId) {\n          const groupIdDecodedFromBase64 = base64ToArray(groupId);\n          await this.core.service!.conversation.wipeMLSConversation(groupIdDecodedFromBase64);\n        }\n      }\n    }\n\n    if (!selfLeavingClearedConversation) {\n      const {messageEntity} = await this.addEventToConversation(conversationEntity, eventJson);\n      (messageEntity as MemberMessage)\n        .userEntities()\n        .filter(userEntity => !userEntity.isMe)\n        .forEach(userEntity => {\n          conversationEntity.participating_user_ids.remove(userId => matchQualifiedIds(userId, userEntity));\n\n          if (userEntity.isTemporaryGuest()) {\n            userEntity.clearExpirationTimeout();\n          }\n        });\n\n      await this.updateParticipatingUserEntities(conversationEntity);\n\n      this.verificationStateHandler.onMemberLeft(conversationEntity);\n\n      if (isFromSelf && conversationEntity.removed_from_conversation()) {\n        this.archiveConversation(conversationEntity);\n      }\n\n      return {conversationEntity, messageEntity};\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Membership properties for a conversation were updated.\n   *\n   * @param conversationEntity Conversation entity that will be updated\n   * @param eventJson JSON data of 'conversation.member-update' event\n   * @returns Resolves when the event was handled\n   */\n  private onMemberUpdate(\n    conversationEntity: Conversation,\n    eventJson: Pick<ConversationMemberUpdateEvent, 'data' | 'from'> & {conversation?: string},\n  ) {\n    const {conversation, data: eventData, from} = eventJson;\n    const conversationId = {domain: '', id: conversation || '' /* TODO(federation) add domain on the sender side */};\n\n    const isConversationRoleUpdate = !!eventData.conversation_role;\n    if (isConversationRoleUpdate) {\n      const {target, qualified_target, conversation_role} = eventData;\n      const userId = qualified_target || {domain: '', id: target};\n      const conversation = this.conversationState\n        .conversations()\n        .find(conversation => matchQualifiedIds(conversation, conversationId));\n      if (conversation) {\n        const roles = conversation.roles();\n        roles[userId.id] = conversation_role;\n        conversation.roles(roles);\n      }\n      return;\n    }\n\n    const isBackendEvent = eventData.otr_archived_ref || eventData.otr_muted_ref;\n    const inSelfConversation = this.conversationState.isSelfConversation(conversationId);\n    if (!inSelfConversation && conversation && !isBackendEvent) {\n      this.logger.warn(\n        `A conversation update message was not sent in the selfConversation. Skipping conversation update`,\n        eventData,\n      );\n      return;\n    }\n\n    const isFromSelf = !this.userState.self() || from === this.userState.self().id;\n    if (!isFromSelf) {\n      this.logger.warn(\n        `A conversation update message was not sent by the self user. Skipping conversation update`,\n        eventData,\n      );\n      return;\n    }\n\n    const isActiveConversation = this.conversationState.isActiveConversation(conversationEntity);\n    const nextConversationEntity = isActiveConversation ? this.getNextConversation(conversationEntity) : undefined;\n    const previouslyArchived = conversationEntity.is_archived();\n\n    ConversationMapper.updateSelfStatus(conversationEntity, eventData);\n\n    const wasUnarchived = previouslyArchived && !conversationEntity.is_archived();\n    if (wasUnarchived) {\n      return this.fetchUsersAndEvents(conversationEntity);\n    }\n\n    if (conversationEntity.is_cleared()) {\n      this._clearConversation(conversationEntity, conversationEntity.cleared_timestamp());\n    }\n\n    if (isActiveConversation && (conversationEntity.is_archived() || conversationEntity.is_cleared())) {\n      amplify.publish(WebAppEvents.CONVERSATION.SHOW, nextConversationEntity, {});\n    }\n  }\n\n  /**\n   * An asset received in a conversation.\n   *\n   * @param conversationEntity Conversation to add the event to\n   * @param event JSON data of 'conversation.asset-add'\n   * @returns Resolves when the event was handled\n   */\n  private async onAssetAdd(conversationEntity: Conversation, event: AssetAddEvent) {\n    const fromSelf = event.from === this.userState.self().id;\n\n    const isRemoteFailure = !fromSelf && event.data.status === AssetTransferState.UPLOAD_FAILED;\n    const isLocalCancel = fromSelf && event.data.reason === ProtobufAsset.NotUploaded.CANCELLED;\n\n    if (isRemoteFailure || isLocalCancel) {\n      /**\n       * WEBAPP-6916: An unsuccessful asset upload triggers a removal of the original asset message in the `EventRepository`.\n       * Thus the event timestamps need to get updated, so that the latest event timestamp is from the message which was send before the original message.\n       *\n       * Info: Since the `EventRepository` does not have a reference to the `ConversationRepository` we do that event update at this location.\n       * A more fitting place would be the `AssetTransferState.UPLOAD_FAILED` case in `EventRepository._handleAssetUpdate`.\n       *\n       * Our assumption is that the `_handleAssetUpdate` function (invoked by `notificationsQueue.subscribe`) is executed before this function.\n       */\n      return conversationEntity.updateTimestamps(conversationEntity.getNewestMessage(), true);\n    }\n\n    if (!allowsAllFiles()) {\n      const fileName = event.data.info.name;\n      const contentType = event.data.content_type;\n      if (!isAllowedFile(fileName, contentType)) {\n        // TODO(Federation): Update code once sending assets is implemented on the backend\n        const user = await this.userRepository.getUserById({domain: '', id: event.from});\n        return this.injectFileTypeRestrictedMessage(\n          conversationEntity,\n          user,\n          true,\n          getFileExtensionOrName(fileName),\n          event.id,\n        );\n      }\n    }\n    const {messageEntity} = await this.addEventToConversation(conversationEntity, event);\n    const firstAsset = (messageEntity as ContentMessage).getFirstAsset();\n    if (firstAsset.isImage() || (firstAsset as FileAsset).status() === AssetTransferState.UPLOADED) {\n      return {conversationEntity, messageEntity};\n    }\n  }\n\n  /**\n   * A hide message received in a conversation.\n   *\n   * @param conversationEntity Conversation to add the event to\n   * @param eventJson JSON data of 'conversation.message-delete'\n   * @returns Resolves when the event was handled\n   */\n  private onMessageDeleted(conversationEntity: Conversation, eventJson: DeleteEvent) {\n    const {data: eventData, from, id: eventId, time} = eventJson;\n\n    return this.messageRepository\n      .getMessageInConversationById(conversationEntity, eventData.message_id)\n      .then(deletedMessageEntity => {\n        if (deletedMessageEntity.ephemeral_expires()) {\n          return;\n        }\n\n        const isSameSender = from === deletedMessageEntity.from;\n        if (!isSameSender) {\n          throw new ConversationError(ConversationError.TYPE.WRONG_USER, ConversationError.MESSAGE.WRONG_USER);\n        }\n\n        const isFromSelf = from === this.userState.self().id;\n        if (!isFromSelf) {\n          return this.addDeleteMessage(conversationEntity, eventId, time, deletedMessageEntity);\n        }\n      })\n      .then(() => {\n        return this.messageRepository.deleteMessageById(conversationEntity, eventData.message_id);\n      })\n      .catch(error => {\n        const isNotFound = error.type === ConversationError.TYPE.MESSAGE_NOT_FOUND;\n        if (!isNotFound) {\n          this.logger.info(`Failed to delete message for conversation '${conversationEntity.id}'`, error);\n          throw error;\n        }\n      });\n  }\n\n  /**\n   * A hide message received in a conversation.\n   *\n   * @param eventJson JSON data of 'conversation.message-hidden'\n   * @returns Resolves when the event was handled\n   */\n  private async onMessageHidden(eventJson: MessageHiddenEvent) {\n    const {conversation, qualified_conversation, data: eventData, from} = eventJson;\n\n    const conversationId = qualified_conversation || {id: conversation, domain: ''};\n    try {\n      const inSelfConversation = this.conversationState.isSelfConversation(conversationId);\n      if (!inSelfConversation) {\n        throw new ConversationError(\n          ConversationError.TYPE.WRONG_CONVERSATION,\n          ConversationError.MESSAGE.WRONG_CONVERSATION,\n        );\n      }\n\n      const isFromSelf = !this.userState.self() || from === this.userState.self().id;\n      if (!isFromSelf) {\n        throw new ConversationError(ConversationError.TYPE.WRONG_USER, ConversationError.MESSAGE.WRONG_USER);\n      }\n      const conversationEntity = await this.getConversationById({domain: '', id: eventData.conversation_id});\n      return await this.messageRepository.deleteMessageById(conversationEntity, eventData.message_id);\n    } catch (error) {\n      this.logger.info(\n        `Failed to delete message '${eventData.message_id}' for conversation '${eventData.conversation_id}'`,\n        error,\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * Someone reacted to a message.\n   *\n   * @param conversationEntity Conversation entity that a message was reacted upon in\n   * @param eventJson JSON data of 'conversation.reaction' event\n   * @returns Resolves when the event was handled\n   */\n  private async onReaction(conversationEntity: Conversation, eventJson: ReactionEvent) {\n    const conversationId = conversationEntity.id;\n    const eventData = eventJson.data;\n    const messageId = eventData.message_id;\n\n    try {\n      const messageEntity = await this.messageRepository.getMessageInConversationById(conversationEntity, messageId);\n      if (!messageEntity || !messageEntity.isContent()) {\n        const type = messageEntity ? messageEntity.type : 'unknown';\n\n        const logMessage = `Cannot react to '${type}' message '${messageId}' in conversation '${conversationId}'`;\n        this.logger.error(logMessage, messageEntity);\n        throw new ConversationError(ConversationError.TYPE.WRONG_TYPE, ConversationError.MESSAGE.WRONG_TYPE);\n      }\n\n      const changes = messageEntity.getUpdatedReactions(eventJson);\n      if (changes) {\n        const logMessage = `Updating reactions of message '${messageId}' in conversation '${conversationId}'`;\n        this.logger.debug(logMessage, {changes, event: eventJson});\n\n        this.eventService.updateEventSequentially(messageEntity.primary_key, changes);\n        return await this.prepareReactionNotification(conversationEntity, messageEntity, eventJson);\n      }\n    } catch (error) {\n      const isNotFound = error.type === ConversationError.TYPE.MESSAGE_NOT_FOUND;\n      if (!isNotFound) {\n        const logMessage = `Failed to handle reaction to message '${messageId}' in conversation '${conversationId}'`;\n        this.logger.error(logMessage, {error, event: eventJson});\n        throw error;\n      }\n    }\n    return undefined;\n  }\n\n  private async onButtonActionConfirmation(conversationEntity: Conversation, eventJson: ButtonActionConfirmationEvent) {\n    const {messageId, buttonId} = eventJson.data;\n    try {\n      const messageEntity = await this.messageRepository.getMessageInConversationById(conversationEntity, messageId);\n      if (!messageEntity || !messageEntity.isComposite()) {\n        const type = messageEntity ? messageEntity.type : 'unknown';\n\n        const log = `Cannot react to '${type}' message '${messageId}' in conversation '${conversationEntity.id}'`;\n        this.logger.error(log, messageEntity);\n        throw new ConversationError(ConversationError.TYPE.WRONG_TYPE, ConversationError.MESSAGE.WRONG_TYPE);\n      }\n      const changes = messageEntity.getSelectionChange(buttonId);\n      if (changes) {\n        this.eventService.updateEventSequentially(messageEntity.primary_key, changes);\n      }\n      return;\n    } catch (error) {\n      const isNotFound = error.type === ConversationError.TYPE.MESSAGE_NOT_FOUND;\n      if (!isNotFound) {\n        const log = `Failed to handle reaction to message '${messageId}' in conversation '${conversationEntity.id}'`;\n        this.logger.error(log, {error, event: eventJson});\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * A conversation was renamed.\n   *\n   * @param conversationEntity Conversation entity that will be renamed\n   * @param eventJson JSON data of 'conversation.rename' event\n   * @returns Resolves when the event was handled\n   */\n  private async onRename(conversationEntity: Conversation, eventJson: ConversationRenameEvent, isWebSocket = false) {\n    if (isWebSocket && eventJson.data?.name) {\n      eventJson.data.name = fixWebsocketString(eventJson.data.name);\n    }\n    const {messageEntity} = await this.addEventToConversation(conversationEntity, eventJson);\n    ConversationMapper.updateProperties(conversationEntity, eventJson.data);\n    return {conversationEntity, messageEntity};\n  }\n\n  /**\n   * A user started or stopped typing in a conversation.\n   *\n   * @param conversationEntity Conversation entity that will the user will be added to its active typing users\n   * @param eventJson JSON data of 'conversation.typing' event\n   * @returns Resolves when the event was handled\n   */\n  private async onTyping(conversationEntity: Conversation, eventJson: ConversationTypingEvent) {\n    const qualifiedUserId = eventJson.qualified_from || {domain: '', id: eventJson.from};\n    const qualifiedUser = conversationEntity\n      .participating_user_ets()\n      .find(user => matchQualifiedIds(user, qualifiedUserId));\n\n    if (!qualifiedUser) {\n      this.logger.warn(`No sender user found for event of type ${eventJson.type}`);\n      return {conversationEntity};\n    }\n\n    const conversationId = conversationEntity.id;\n    const {addTypingUser, getTypingUser, removeTypingUser} = useTypingIndicatorState.getState();\n\n    const oldUser = getTypingUser(qualifiedUser, conversationId);\n    if (oldUser) {\n      window.clearTimeout(oldUser.timerId);\n    }\n\n    if (eventJson.data.status === CONVERSATION_TYPING.STARTED) {\n      const timerId = window.setTimeout(() => {\n        removeTypingUser(qualifiedUser, conversationId);\n      }, TYPING_TIMEOUT * 6); // 10000 * 6 => 1 minute\n\n      const typingUser = {conversationId, user: qualifiedUser, timerId};\n\n      addTypingUser(typingUser);\n    }\n\n    if (eventJson.data.status === CONVERSATION_TYPING.STOPPED) {\n      removeTypingUser(qualifiedUser, conversationId);\n    }\n\n    return {conversationEntity};\n  }\n\n  /**\n   * A conversation receipt mode was changed\n   *\n   * @param conversationEntity Conversation entity that will be renamed\n   * @param eventJson JSON data of 'conversation.receipt-mode-update' event\n   * @returns Resolves when the event was handled\n   */\n  private async onReceiptModeChanged(conversationEntity: Conversation, eventJson: ConversationReceiptModeUpdateEvent) {\n    const {messageEntity} = await this.addEventToConversation(conversationEntity, eventJson);\n    ConversationMapper.updateSelfStatus(conversationEntity, {receipt_mode: eventJson.data.receipt_mode});\n    return {conversationEntity, messageEntity};\n  }\n\n  private readonly handleMessageExpiration = (messageEntity: ContentMessage) => {\n    amplify.publish(WebAppEvents.CONVERSATION.EPHEMERAL_MESSAGE_TIMEOUT, messageEntity);\n    const shouldDeleteMessage = !messageEntity.user().isMe || messageEntity.isPing();\n    if (shouldDeleteMessage) {\n      // TODO(federation) map domain\n      this.getConversationById({domain: '', id: messageEntity.conversation_id}).then(conversationEntity => {\n        const isPingFromSelf = messageEntity.user().isMe && messageEntity.isPing();\n        const deleteForSelf = isPingFromSelf || conversationEntity.removed_from_conversation();\n        if (deleteForSelf) {\n          return this.messageRepository.deleteMessage(conversationEntity, messageEntity);\n        }\n\n        const userIds = conversationEntity.isGroup()\n          ? [this.userState.self().qualifiedId, {domain: messageEntity.fromDomain ?? '', id: messageEntity.from}]\n          : undefined;\n        return this.messageRepository.deleteMessageForEveryone(conversationEntity, messageEntity, {\n          optimisticRemoval: true,\n          targetedUsers: userIds,\n        });\n      });\n    }\n  };\n\n  private async initMessageEntity(conversationEntity: Conversation, eventJson: IncomingEvent): Promise<Message> {\n    const messageEntity = await this.event_mapper.mapJsonEvent(eventJson, conversationEntity);\n    return this.updateMessageUserEntities(messageEntity);\n  }\n\n  private async replaceMessageInConversation(\n    conversationEntity: Conversation,\n    eventId: string,\n    newData: EventRecord,\n  ): Promise<ContentMessage | undefined> {\n    const originalMessage = conversationEntity.getMessage(eventId);\n    if (!originalMessage) {\n      return undefined;\n    }\n    const replacedMessageEntity = await this.event_mapper.updateMessageEvent(\n      originalMessage as ContentMessage,\n      newData,\n    );\n    await this.ephemeralHandler.validateMessage(replacedMessageEntity);\n    return replacedMessageEntity;\n  }\n\n  /**\n   * Convert a JSON event into an entity and add it to a given conversation.\n   *\n   * @param conversationEntity Conversation entity the event will be added to\n   * @param eventJson Event data\n   * @returns Promise that resolves with the message entity for the event\n   */\n  private async addEventToConversation(\n    conversationEntity: Conversation,\n    eventJson: IncomingEvent,\n  ): Promise<{conversationEntity: Conversation; messageEntity: Message}> {\n    const messageEntity = (await this.initMessageEntity(conversationEntity, eventJson)) as Message;\n    if (conversationEntity && messageEntity) {\n      const wasAdded = conversationEntity.addMessage(messageEntity);\n      if (wasAdded) {\n        await this.ephemeralHandler.validateMessage(messageEntity as ContentMessage);\n      }\n    }\n    return {conversationEntity, messageEntity};\n  }\n\n  /**\n   * Convert multiple JSON events into entities and validate them\n   *\n   * @param events Event data\n   * @param conversationEntity Conversation entity the events will be added to\n   * @returns Resolves with an array of mapped messages\n   */\n  private async validateMessages(events: EventRecord[], conversationEntity: Conversation) {\n    const mappedEvents = await this.event_mapper.mapJsonEvents(events, conversationEntity);\n    const updatedEvents = (await this.updateMessagesUserEntities(mappedEvents)) as ContentMessage[];\n    const validatedMessages = (await this.ephemeralHandler.validateMessages(updatedEvents)) as ContentMessage[];\n    return validatedMessages;\n  }\n\n  /**\n   * Convert multiple JSON events into entities, validate and add them to a given conversation.\n   *\n   * @param events Event data\n   * @param conversationEntity Conversation entity the events will be added to\n   * @param prepend Should existing messages be prepended\n   * @returns Resolves with an array of mapped messages\n   */\n  private async addEventsToConversation(events: EventRecord[], conversationEntity: Conversation, prepend = true) {\n    const validatedMessages = await this.validateMessages(events, conversationEntity);\n    if (prepend && conversationEntity.messages().length) {\n      conversationEntity.prependMessages(validatedMessages);\n    } else {\n      conversationEntity.addMessages(validatedMessages);\n    }\n    return validatedMessages;\n  }\n\n  /**\n   * Fetch all unread events and users of a conversation.\n   *\n   * @param conversationEntity Conversation fetch events and users for\n   */\n  private fetchUsersAndEvents(conversationEntity: Conversation) {\n    if (!conversationEntity.is_loaded() && !conversationEntity.is_pending()) {\n      this.updateParticipatingUserEntities(conversationEntity);\n      this.getUnreadEvents(conversationEntity);\n    }\n  }\n\n  /**\n   * Forward the reaction event to the Notification repository for browser and audio notifications.\n   *\n   * @param conversationEntity Conversation that event was received in\n   * @param messageEntity Message that has been reacted upon\n   * @param eventJson JSON data of received reaction event\n   * @returns Resolves when the notification was prepared\n   */\n  private async prepareReactionNotification(\n    conversationEntity: Conversation,\n    messageEntity: ContentMessage,\n    eventJson: ReactionEvent,\n  ) {\n    const {data: event_data, from} = eventJson;\n\n    const messageFromSelf = messageEntity.from === this.userState.self().id;\n    if (messageFromSelf && event_data.reaction) {\n      const userEntity = await this.userRepository.getUserById({domain: messageEntity.fromDomain, id: from});\n      const reactionMessageEntity = new Message(messageEntity.id, SuperType.REACTION);\n      reactionMessageEntity.user(userEntity);\n      reactionMessageEntity.reaction = event_data.reaction;\n      return {conversationEntity, messageEntity: reactionMessageEntity};\n    }\n\n    return {conversationEntity};\n  }\n\n  private updateMessagesUserEntities(messageEntities: Message[]) {\n    return Promise.all(messageEntities.map(messageEntity => this.updateMessageUserEntities(messageEntity)));\n  }\n\n  /**\n   * Updates the user entities that are part of a message.\n   *\n   * @param messageEntity Message to be updated\n   * @returns Resolves when users have been update\n   */\n  private async updateMessageUserEntities(messageEntity: Message) {\n    const userEntity = await this.userRepository.getUserById({\n      domain: messageEntity.fromDomain,\n      id: messageEntity.from,\n    });\n    messageEntity.user(userEntity);\n    if (isMemberMessage(messageEntity) || messageEntity.hasOwnProperty('userEntities')) {\n      return this.userRepository.getUsersById((messageEntity as MemberMessage).userIds()).then(userEntities => {\n        userEntities.sort(sortUsersByPriority);\n        (messageEntity as MemberMessage).userEntities(userEntities);\n        return messageEntity;\n      });\n    }\n    if (messageEntity.isContent()) {\n      const userIds = Object.keys(messageEntity.reactions());\n\n      messageEntity.reactions_user_ets.removeAll();\n      if (userIds.length) {\n        // TODO(Federation): Make code federation-aware.\n        return this.userRepository\n          .getUsersById(userIds.map(userId => ({domain: '', id: userId})))\n          .then(userEntities => {\n            messageEntity.reactions_user_ets(userEntities);\n            return messageEntity;\n          });\n      }\n    }\n    return messageEntity;\n  }\n\n  /**\n   * Delete messages from UI and database.\n   *\n   * @param conversationEntity Conversation that contains the message\n   * @param timestamp Timestamp as upper bound which messages to remove\n   */\n  private deleteMessages(conversationEntity: Conversation, timestamp?: number) {\n    conversationEntity.hasCreationMessage = false;\n\n    const iso_date = timestamp ? new Date(timestamp).toISOString() : undefined;\n    this.eventService.deleteEvents(conversationEntity.id, iso_date);\n  }\n\n  /**\n   * Add delete message to conversation.\n   *\n   * @param conversationId ID of conversation\n   * @param messageId ID of message\n   * @param time ISO 8601 formatted time string\n   * @param messageEntity Message to delete\n   */\n  public addDeleteMessage(conversation: Conversation, messageId: string, time: string, messageEntity: Message) {\n    const deleteEvent = EventBuilder.buildDelete(conversation, messageId, time, messageEntity);\n    this.eventRepository.injectEvent(deleteEvent);\n  }\n\n  //##############################################################################\n  // Message updates\n  //##############################################################################\n\n  expectReadReceipt(conversationEntity: Conversation): boolean {\n    if (conversationEntity.is1to1()) {\n      return !!this.propertyRepository.receiptMode();\n    }\n\n    if (conversationEntity.team_id && conversationEntity.isGroup()) {\n      return !!conversationEntity.receiptMode();\n    }\n\n    return false;\n  }\n\n  findConversationByGroupId(groupId: string): Conversation | undefined {\n    return this.conversationState.findConversationByGroupId(groupId);\n  }\n\n  public async cleanupEphemeralMessages(): Promise<void> {\n    this.conversationState.conversations().forEach(async conversationEntity => {\n      const messages = (await this.eventService.loadEphemeralEvents(conversationEntity.id)) as EventRecord[];\n      this.validateMessages(messages, conversationEntity);\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_TYPE, ConversationProtocol} from '@wireapp/api-client/lib/conversation/';\n\nimport {Conversation} from '../entity/Conversation';\n\nexport type MLSConversation = Conversation & {groupId: string};\n\nexport function isMLSConversation(conversation: Conversation): conversation is MLSConversation {\n  return !!conversation.groupId && conversation.protocol === ConversationProtocol.MLS;\n}\n\nexport function isSelfConversation(conversation: Conversation): boolean {\n  return conversation.type() === CONVERSATION_TYPE.SELF;\n}\n\nexport function isTeamConversation(conversation: Conversation): boolean {\n  return conversation.type() === CONVERSATION_TYPE.GLOBAL_TEAM;\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ConnectionStatus} from '@wireapp/api-client/lib/connection/';\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport ko from 'knockout';\nimport {container, singleton} from 'tsyringe';\n\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {sortGroupsByLastEvent} from 'Util/util';\n\nimport {isMLSConversation, isSelfConversation} from './ConversationSelectors';\n\nimport {Conversation} from '../entity/Conversation';\nimport {User} from '../entity/User';\nimport {TeamState} from '../team/TeamState';\nimport {UserState} from '../user/UserState';\n\n@singleton()\nexport class ConversationState {\n  /**\n   * all the conversations available\n   */\n  public readonly conversations = ko.observableArray<Conversation>([]);\n  /**\n   * current conversation that is being viewed\n   */\n  public readonly activeConversation = ko.observable<Conversation | undefined>();\n  /**\n   * ordered list of conversations that are actives. This is basically the conversations we want to show to the user\n   */\n  public readonly visibleConversations: ko.PureComputed<Conversation[]>;\n  public readonly filteredConversations: ko.PureComputed<Conversation[]>;\n  public readonly archivedConversations: ko.PureComputed<Conversation[]>;\n  private readonly selfProteusConversation: ko.PureComputed<Conversation | undefined>;\n  private readonly selfMLSConversation: ko.PureComputed<Conversation | undefined>;\n  public readonly unreadConversations: ko.PureComputed<Conversation[]>;\n  public readonly connectedUsers: ko.PureComputed<User[]>;\n\n  public readonly sortedConversations: ko.PureComputed<Conversation[]>;\n\n  constructor(\n    private readonly userState = container.resolve(UserState),\n    private readonly teamState = container.resolve(TeamState),\n  ) {\n    this.sortedConversations = ko.pureComputed(() => this.filteredConversations().sort(sortGroupsByLastEvent));\n    this.selfProteusConversation = ko.pureComputed(() =>\n      this.conversations().find(conversation => !isMLSConversation(conversation) && isSelfConversation(conversation)),\n    );\n    this.selfMLSConversation = ko.pureComputed(() =>\n      this.conversations().find(conversation => isMLSConversation(conversation) && isSelfConversation(conversation)),\n    );\n\n    this.visibleConversations = ko.pureComputed(() => {\n      return this.sortedConversations().filter(\n        conversation => !conversation.is_cleared() && !conversation.is_archived(),\n      );\n    });\n    this.unreadConversations = ko.pureComputed(() => {\n      return this.visibleConversations().filter(conversationEntity => conversationEntity.hasUnread());\n    });\n\n    this.archivedConversations = ko.pureComputed(() => {\n      return this.sortedConversations().filter(conversation => conversation.is_archived());\n    });\n\n    this.filteredConversations = ko.pureComputed(() => {\n      return this.conversations().filter(conversationEntity => {\n        const states_to_filter = [\n          ConnectionStatus.MISSING_LEGAL_HOLD_CONSENT,\n          ConnectionStatus.BLOCKED,\n          ConnectionStatus.CANCELLED,\n          ConnectionStatus.PENDING,\n        ];\n\n        if (\n          isSelfConversation(conversationEntity) ||\n          states_to_filter.includes(conversationEntity.connection().status())\n        ) {\n          return false;\n        }\n\n        return !(conversationEntity.is_cleared() && conversationEntity.removed_from_conversation());\n      });\n    });\n\n    this.connectedUsers = ko.pureComputed(() => {\n      const inviterId = this.teamState.memberInviters()[this.userState.self()?.id];\n      const inviter = inviterId ? this.userState.users().find(({id}) => id === inviterId) : null;\n      const connectedUsers = inviter ? [inviter] : [];\n      const selfTeamId = this.userState.self()?.teamId;\n      for (const conversation of this.conversations()) {\n        for (const user of conversation.participating_user_ets()) {\n          const isNotService = !user.isService;\n          const isNotIncluded = !connectedUsers.includes(user);\n          if (isNotService && isNotIncluded && (user.teamId === selfTeamId || user.isConnected())) {\n            connectedUsers.push(user);\n          }\n        }\n      }\n      return connectedUsers;\n    });\n  }\n\n  /**\n   * Returns all the selfConversations available (proteus and MLS)\n   * The MLS conversation can be manually filtered (in case MLS is not supported)\n   * @param includeMLS will filter out the MLS self conversation if false\n   */\n  getSelfConversations(includeMLS: boolean): Conversation[] {\n    const baseConversations = [this.selfProteusConversation()];\n    const selfConversations = includeMLS ? baseConversations.concat(this.selfMLSConversation()) : baseConversations;\n    return selfConversations.filter((conversation): conversation is Conversation => !!conversation);\n  }\n\n  getSelfProteusConversation(): Conversation {\n    const proteusConversation = this.selfProteusConversation();\n    if (!proteusConversation) {\n      throw new Error('No proteus self conversation');\n    }\n    return proteusConversation;\n  }\n\n  getSelfMLSConversation(): Conversation {\n    const mlsConversation = this.selfMLSConversation();\n    if (!mlsConversation) {\n      throw new Error('No MLS self conversation');\n    }\n    return mlsConversation;\n  }\n\n  /**\n   * returns true if the conversation should be visible to the user\n   * @param conversation the conversation to check visibility\n   */\n  isVisible(conversation?: Conversation): conversation is Conversation {\n    return (\n      !!conversation &&\n      this.visibleConversations().some(conv => matchQualifiedIds(conv.qualifiedId, conversation.qualifiedId))\n    );\n  }\n\n  /**\n   * Get unarchived conversation with the most recent event.\n   * @param allConversations Search all conversations\n   * @returns Most recent conversation\n   */\n  getMostRecentConversation(allConversations: boolean = false): Conversation | undefined {\n    const [conversationEntity] = allConversations ? this.sortedConversations() : this.visibleConversations();\n    return conversationEntity;\n  }\n\n  /**\n   * Find a local conversation by ID.\n   * @returns Conversation is locally available\n   */\n  findConversation(conversationId: QualifiedId): Conversation | undefined {\n    // we prevent access to local conversation if the team is deleted\n    return this.teamState.isTeamDeleted()\n      ? undefined\n      : this.conversations().find(conversation => {\n          return matchQualifiedIds(conversation, conversationId);\n        });\n  }\n\n  isSelfConversation(conversationId: QualifiedId): boolean {\n    const selfConversationIds: QualifiedId[] = [this.selfProteusConversation(), this.selfMLSConversation()]\n      .filter((conversation): conversation is Conversation => !!conversation)\n      .map(conversation => conversation.qualifiedId);\n\n    return selfConversationIds.some(selfConversation => matchQualifiedIds(selfConversation, conversationId));\n  }\n\n  findConversationByGroupId(groupId: string): Conversation | undefined {\n    return this.conversations().find(conversation => conversation.groupId === groupId);\n  }\n\n  /**\n   * Check whether conversation is currently displayed.\n   */\n  isActiveConversation(conversationEntity: Conversation): boolean {\n    const activeConversation = this.activeConversation();\n    return !!activeConversation && !!conversationEntity && matchQualifiedIds(activeConversation, conversationEntity);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** Enum of a user's participation status in a conversation */\nexport enum ConversationStatus {\n  CURRENT_MEMBER = 0,\n  PAST_MEMBER = 1,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum ConversationVerificationState {\n  DEGRADED = 2,\n  UNVERIFIED = 0,\n  VERIFIED = 1,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {MemberLeaveReason} from '@wireapp/api-client/lib/conversation/data/';\nimport {ConversationOtrMessageAddEvent, CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {ReactionType} from '@wireapp/core/lib/conversation';\nimport {DecryptionError} from '@wireapp/core/lib/errors/DecryptionError';\n\nimport type {REASON as AVS_REASON} from '@wireapp/avs';\nimport type {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport {createRandomUuid} from 'Util/util';\n\nimport {CALL_MESSAGE_TYPE} from '../calling/enum/CallMessageType';\nimport type {Conversation} from '../entity/Conversation';\nimport type {Message} from '../entity/message/Message';\nimport type {User} from '../entity/User';\nimport {CALL, ClientEvent, CONVERSATION} from '../event/Client';\nimport {StatusType} from '../message/StatusType';\nimport {VerificationMessageType} from '../message/VerificationMessageType';\nimport {AssetRecord, EventRecord} from '../storage';\n\nexport interface BaseEvent {\n  conversation: string;\n  data?: unknown;\n  from: string;\n  id: string;\n  qualified_conversation?: QualifiedId;\n  qualified_from?: QualifiedId;\n  server_time?: string;\n  time: string;\n}\n\nexport interface ConversationEvent<T> extends BaseEvent {\n  data: T;\n  id: string;\n  type: CONVERSATION;\n}\n\nexport interface CallingEvent {\n  /**\n   * content is an object that comes from avs\n   */\n  content: {\n    type: CALL_MESSAGE_TYPE;\n    version: string;\n  };\n  targetConversation?: QualifiedId;\n  conversation: string;\n  from: string;\n  qualified_conversation?: QualifiedId;\n  qualified_from?: QualifiedId;\n  sender: string;\n  time?: string;\n  type: CALL;\n  senderClientId?: string;\n}\n\nexport interface BackendEventMessage<T> extends Omit<BaseEvent, 'id'> {\n  data: T;\n  id?: string;\n  type: string;\n}\n\nexport interface VoiceChannelActivateEvent extends BaseEvent {\n  protocol_version: number;\n  type: CONVERSATION.VOICE_CHANNEL_ACTIVATE;\n}\nexport type AllVerifiedEventData = {type: VerificationMessageType};\nexport type AllVerifiedEvent = ConversationEvent<AllVerifiedEventData>;\nexport type AssetAddEvent = Omit<ConversationEvent<any>, 'id'> &\n  Partial<Pick<ConversationEvent<any>, 'id'>> & {status: StatusType; type: CONVERSATION.ASSET_ADD};\nexport type DegradedMessageEventData = {type: VerificationMessageType; userIds: QualifiedId[]};\nexport type DegradedMessageEvent = ConversationEvent<DegradedMessageEventData>;\nexport type DeleteEvent = ConversationEvent<{deleted_time: number; message_id: string; time: string}> & {\n  type: CONVERSATION.MESSAGE_DELETE;\n};\nexport type GroupCreationEventData = {\n  allTeamMembers: boolean;\n  name: string;\n  userIds: QualifiedId[];\n};\nexport type GroupCreationEvent = ConversationEvent<GroupCreationEventData> & {type: CONVERSATION.GROUP_CREATION};\nexport type LegalHoldMessageEvent = ConversationEvent<{legal_hold_status: LegalHoldStatus}> & {\n  type: CONVERSATION.LEGAL_HOLD_UPDATE;\n};\nexport type MemberJoinEvent = BackendEventMessage<{qualified_user_ids?: QualifiedId[]; user_ids: string[]}>;\nexport type MemberLeaveEvent = BackendEventMessage<{\n  name?: string;\n  qualified_user_ids?: QualifiedId[];\n  reason?: MemberLeaveReason;\n  user_ids: string[];\n}>;\nexport type MessageAddEvent = Omit<ConversationEvent<{}>, 'id'> & {\n  edited_time?: string;\n  status: StatusType;\n  type: CONVERSATION.MESSAGE_ADD;\n};\nexport type MissedEvent = BaseEvent & {id: string; type: CONVERSATION.MISSED_MESSAGES};\nexport type OneToOneCreationEvent = ConversationEvent<{userIds: QualifiedId[]}> & {\n  type: CONVERSATION.ONE2ONE_CREATION;\n};\nexport type TeamMemberLeaveEvent = ConversationEvent<{name: string; user_ids: string[]}> & {\n  type: CONVERSATION.TEAM_MEMBER_LEAVE;\n};\nexport type ReactionEvent = ConversationEvent<{message_id: string; reaction: ReactionType}> & {\n  type: CONVERSATION.REACTION;\n};\nexport type MessageHiddenEvent = ConversationEvent<{conversation_id: string; message_id: string}> & {\n  type: CONVERSATION.MESSAGE_HIDDEN;\n};\nexport type ButtonActionConfirmationEvent = ConversationEvent<{buttonId: string; messageId: string}> & {\n  type: CONVERSATION.BUTTON_ACTION_CONFIRMATION;\n};\nexport type DeleteEverywhereEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.DELETE_EVERYWHERE;\n};\nexport type CompositeMessageAddEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.COMPOSITE_MESSAGE_ADD;\n};\nexport type IncomingMessageTooBigEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.INCOMING_MESSAGE_TOO_BIG;\n};\nexport type KnockEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.KNOCK;\n};\nexport type LocationEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.LOCATION;\n};\nexport type UnableToDecryptEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.UNABLE_TO_DECRYPT;\n};\nexport type VerificationEvent = ConversationEvent<{}> & {\n  type: CONVERSATION.VERIFICATION;\n};\nexport type VoiceChannelDeactivateEvent = ConversationEvent<{duration: number; reason: AVS_REASON}> & {\n  protocol_version: number;\n  type: CONVERSATION.VOICE_CHANNEL_DEACTIVATE;\n};\nexport type FileTypeRestrictedEvent = ConversationEvent<{fileExt: string; isIncoming: boolean; name: string}> & {\n  type: CONVERSATION.FILE_TYPE_RESTRICTED;\n};\nexport type CallingTimeoutEvent = ConversationEvent<{reason: AVS_REASON.NOONE_JOINED | AVS_REASON.EVERYONE_LEFT}> & {\n  type: CONVERSATION.CALL_TIME_OUT;\n};\n\nexport interface ErrorEvent extends BaseEvent {\n  error: string;\n  error_code: number | string;\n  id: string;\n  type: CONVERSATION;\n}\n\nexport type ClientConversationEvent =\n  | AssetAddEvent\n  | CompositeMessageAddEvent\n  | DeleteEvent\n  | DeleteEverywhereEvent\n  | ButtonActionConfirmationEvent\n  | KnockEvent\n  | IncomingMessageTooBigEvent\n  | GroupCreationEvent\n  | TeamMemberLeaveEvent\n  | ReactionEvent\n  | LegalHoldMessageEvent\n  | MessageAddEvent\n  | MessageHiddenEvent\n  | OneToOneCreationEvent\n  | VoiceChannelDeactivateEvent\n  | FileTypeRestrictedEvent\n  | CallingTimeoutEvent\n  | UnableToDecryptEvent\n  | MissedEvent\n  | LocationEvent\n  | VoiceChannelActivateEvent\n  | VerificationEvent;\n\nfunction buildQualifiedId(conversation: QualifiedId | string) {\n  const qualifiedId = typeof conversation === 'string' ? {domain: '', id: conversation} : conversation;\n  return {\n    conversation: qualifiedId.id,\n    qualified_conversation: {domain: qualifiedId.domain, id: qualifiedId.id},\n  };\n}\n\nexport const EventBuilder = {\n  build1to1Creation(conversationEntity: Conversation, timestamp: number = 0): OneToOneCreationEvent {\n    const {creator: creatorId} = conversationEntity;\n    const isoDate = new Date(timestamp).toISOString();\n\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        userIds: conversationEntity.participating_user_ids(),\n      },\n      from: creatorId,\n      id: createRandomUuid(),\n      time: isoDate,\n      type: ClientEvent.CONVERSATION.ONE2ONE_CREATION,\n    };\n  },\n\n  buildAllVerified(conversationEntity: Conversation): AllVerifiedEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        type: VerificationMessageType.VERIFIED,\n      },\n      from: conversationEntity.selfUser().id,\n      id: createRandomUuid(),\n      time: new Date(conversationEntity.getNextTimestamp()).toISOString(),\n      type: ClientEvent.CONVERSATION.VERIFICATION,\n    };\n  },\n\n  buildAssetAdd(conversationEntity: Conversation, data: AssetRecord, currentTimestamp: number): AssetAddEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data,\n      from: conversationEntity.selfUser().id,\n      status: StatusType.SENDING,\n      time: conversationEntity.getNextIsoDate(currentTimestamp),\n      type: ClientEvent.CONVERSATION.ASSET_ADD,\n    };\n  },\n\n  buildCallingTimeoutEvent(\n    reason: AVS_REASON.NOONE_JOINED | AVS_REASON.EVERYONE_LEFT,\n    conversation: Conversation,\n    userId: string,\n  ): CallingTimeoutEvent {\n    return {\n      ...buildQualifiedId(conversation),\n      data: {\n        reason,\n      },\n      from: userId,\n      id: createRandomUuid(),\n      time: conversation.getNextIsoDate(),\n      type: ClientEvent.CONVERSATION.CALL_TIME_OUT,\n    };\n  },\n\n  buildDegraded(\n    conversationEntity: Conversation,\n    userIds: QualifiedId[],\n    type: VerificationMessageType,\n  ): DegradedMessageEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        type,\n        userIds,\n      },\n      from: conversationEntity.selfUser().id,\n      id: createRandomUuid(),\n      time: new Date(conversationEntity.getNextTimestamp()).toISOString(),\n      type: ClientEvent.CONVERSATION.VERIFICATION,\n    };\n  },\n\n  buildDelete(\n    conversation: Conversation,\n    messageId: string,\n    time: string,\n    deletedMessageEntity: Message,\n  ): DeleteEverywhereEvent {\n    return {\n      ...buildQualifiedId(conversation),\n      data: {\n        deleted_time: time,\n      },\n      from: deletedMessageEntity.from,\n      id: messageId,\n      time: new Date(deletedMessageEntity.timestamp()).toISOString(),\n      type: ClientEvent.CONVERSATION.DELETE_EVERYWHERE,\n    };\n  },\n\n  buildFileTypeRestricted(\n    conversation: Conversation,\n    user: User,\n    isIncoming: boolean,\n    fileExt: string,\n    id: string,\n  ): FileTypeRestrictedEvent {\n    return {\n      ...buildQualifiedId(conversation),\n      data: {\n        fileExt,\n        isIncoming,\n        name: user.name(),\n      },\n      from: user.id,\n      id,\n      time: conversation.getNextIsoDate(),\n      type: ClientEvent.CONVERSATION.FILE_TYPE_RESTRICTED,\n    };\n  },\n\n  buildGroupCreation(\n    conversationEntity: Conversation,\n    isTemporaryGuest: boolean = false,\n    timestamp: number,\n  ): GroupCreationEvent {\n    const {creator: creatorId} = conversationEntity;\n    const selfUserId = conversationEntity.selfUser().id;\n    const isoDate = new Date(timestamp || 0).toISOString();\n\n    const userIds = conversationEntity.participating_user_ids().slice();\n    const createdBySelf = creatorId === selfUserId || isTemporaryGuest;\n    if (!createdBySelf) {\n      userIds.push(conversationEntity.selfUser().qualifiedId);\n    }\n\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        allTeamMembers: conversationEntity.withAllTeamMembers(),\n        name: conversationEntity.name(),\n        userIds,\n      },\n      from: isTemporaryGuest ? selfUserId : creatorId,\n      id: createRandomUuid(),\n      time: isoDate,\n      type: ClientEvent.CONVERSATION.GROUP_CREATION,\n    };\n  },\n\n  buildIncomingMessageTooBig(\n    event: ConversationOtrMessageAddEvent,\n    messageError: Error,\n    errorCode: number,\n  ): ErrorEvent {\n    const {qualified_conversation: conversationId, conversation, data: eventData, from, time} = event;\n\n    return {\n      ...buildQualifiedId(conversationId || conversation),\n      error: `${messageError.message} (${eventData.sender})`,\n      error_code: errorCode,\n      from,\n      id: createRandomUuid(),\n      time,\n      type: ClientEvent.CONVERSATION.INCOMING_MESSAGE_TOO_BIG,\n    };\n  },\n\n  buildLegalHoldMessage(\n    conversationId: QualifiedId,\n    userId: QualifiedId,\n    timestamp: number,\n    legalHoldStatus: LegalHoldStatus,\n    beforeMessage?: boolean,\n  ): LegalHoldMessageEvent {\n    return {\n      ...buildQualifiedId(conversationId),\n      data: {\n        legal_hold_status: legalHoldStatus,\n      },\n      from: userId.id,\n      id: createRandomUuid(),\n      qualified_conversation: conversationId,\n      qualified_from: userId,\n      time: new Date(timestamp + (beforeMessage ? -1 : 0)).toISOString(),\n      type: ClientEvent.CONVERSATION.LEGAL_HOLD_UPDATE,\n    };\n  },\n\n  buildMemberJoin(\n    conversationEntity: Conversation,\n    sender: QualifiedId,\n    joiningUserIds: QualifiedId[],\n    timestamp?: number,\n  ): MemberJoinEvent {\n    if (!timestamp) {\n      timestamp = conversationEntity.getLastKnownTimestamp() + 1;\n    }\n    const isoDate = new Date(timestamp).toISOString();\n\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        user_ids: joiningUserIds.map(({id}) => id),\n      },\n      from: sender.id,\n      time: isoDate,\n      type: CONVERSATION_EVENT.MEMBER_JOIN,\n    };\n  },\n\n  buildMemberLeave(\n    conversationEntity: Conversation,\n    userId: QualifiedId,\n    removedBySelfUser: boolean,\n    currentTimestamp: number,\n  ): MemberLeaveEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        qualified_user_ids: [userId],\n        user_ids: [userId.id],\n      },\n      from: removedBySelfUser ? conversationEntity.selfUser().id : userId.id,\n      time: conversationEntity.getNextIsoDate(currentTimestamp),\n      type: CONVERSATION_EVENT.MEMBER_LEAVE,\n    };\n  },\n\n  buildMessageAdd(conversationEntity: Conversation, currentTimestamp: number, senderId: string): MessageAddEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        sender: senderId,\n      },\n      from: conversationEntity.selfUser().id,\n      status: StatusType.SENDING,\n      time: conversationEntity.getNextIsoDate(currentTimestamp),\n      type: ClientEvent.CONVERSATION.MESSAGE_ADD,\n    };\n  },\n\n  buildMissed(conversationEntity: Conversation, currentTimestamp: number): MissedEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      from: conversationEntity.selfUser().id,\n      id: createRandomUuid(),\n      time: conversationEntity.getNextIsoDate(currentTimestamp),\n      type: ClientEvent.CONVERSATION.MISSED_MESSAGES,\n    };\n  },\n\n  buildTeamMemberLeave(\n    conversationEntity: Conversation,\n    userEntity: User,\n    isoDate: string | number,\n  ): TeamMemberLeaveEvent {\n    return {\n      ...buildQualifiedId(conversationEntity),\n      data: {\n        name: userEntity.name(),\n        user_ids: [userEntity.id],\n      },\n      from: userEntity.id,\n      id: createRandomUuid(),\n      time: new Date(isoDate).toISOString(),\n      type: ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE,\n    };\n  },\n\n  buildUnableToDecrypt(event: EventRecord, decryptionError: DecryptionError): ErrorEvent {\n    const {qualified_conversation: conversationId, qualified_from, conversation, data: eventData, from, time} = event;\n\n    return {\n      ...buildQualifiedId(conversationId || conversation),\n      error: `${decryptionError.message} (${eventData.sender})`,\n      error_code: decryptionError.code ?? '',\n      from,\n      id: createRandomUuid(),\n      qualified_from: qualified_from || {domain: '', id: from},\n      time,\n      type: ClientEvent.CONVERSATION.UNABLE_TO_DECRYPT,\n    };\n  },\n\n  buildVoiceChannelActivate(\n    conversation: QualifiedId,\n    userId: QualifiedId,\n    time: string,\n    protocolVersion: number,\n  ): VoiceChannelActivateEvent {\n    return {\n      ...buildQualifiedId(conversation),\n      from: userId.id,\n      id: createRandomUuid(),\n      protocol_version: protocolVersion,\n      qualified_from: userId,\n      time,\n      type: ClientEvent.CONVERSATION.VOICE_CHANNEL_ACTIVATE,\n    };\n  },\n\n  buildVoiceChannelDeactivate(\n    conversation: QualifiedId,\n    userId: QualifiedId,\n    duration: number,\n    reason: AVS_REASON,\n    time: string,\n    protocolVersion: number,\n  ): VoiceChannelDeactivateEvent {\n    return {\n      ...buildQualifiedId(conversation),\n      data: {\n        duration,\n        reason,\n      },\n      from: userId.id,\n      id: createRandomUuid(),\n      protocol_version: protocolVersion,\n      qualified_from: userId,\n      time,\n      type: ClientEvent.CONVERSATION.VOICE_CHANNEL_DEACTIVATE,\n    };\n  },\n};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {REASON as AVS_REASON} from '@wireapp/avs';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class CallingTimeoutMessage extends Message {\n  constructor(public reason: AVS_REASON.NOONE_JOINED | AVS_REASON.EVERYONE_LEFT, time: number) {\n    super();\n    this.super_type = SuperType.CALL_TIME_OUT;\n    this.timestamp(time);\n  }\n\n  get isNoOneJoined(): boolean {\n    return this.reason === AVS_REASON.NOONE_JOINED;\n  }\n\n  get isEveryOneLeft(): boolean {\n    return this.reason === AVS_REASON.EVERYONE_LEFT;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** Enum for different call message types */\nexport enum CALL_MESSAGE_TYPE {\n  ACTIVATED = 'activated',\n  DEACTIVATED = 'deactivated',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {Message} from './Message';\n\nimport type {TERMINATION_REASON} from '../../calling/enum/TerminationReason';\nimport {CALL_MESSAGE_TYPE} from '../../message/CallMessageType';\nimport {SuperType} from '../../message/SuperType';\n\nexport class CallMessage extends Message {\n  private readonly call_message_type: CALL_MESSAGE_TYPE;\n  private readonly duration: number;\n  public readonly caption?: ko.PureComputed<string>;\n  public readonly finished_reason: TERMINATION_REASON;\n\n  constructor(type: CALL_MESSAGE_TYPE, reason?: TERMINATION_REASON, duration: number = 0) {\n    super();\n    this.super_type = SuperType.CALL;\n    this.call_message_type = type;\n    this.finished_reason = reason;\n    this.duration = duration;\n\n    this.caption = ko.pureComputed(() =>\n      this.user().isMe ? t('conversationVoiceChannelDeactivateYou') : t('conversationVoiceChannelDeactivate'),\n    );\n  }\n\n  isActivation(): boolean {\n    return this.call_message_type === CALL_MESSAGE_TYPE.ACTIVATED;\n  }\n\n  isDeactivation(): boolean {\n    return this.call_message_type === CALL_MESSAGE_TYPE.DEACTIVATED;\n  }\n\n  wasCompleted(): boolean {\n    return this.duration > 0;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ProteusErrors} from '@wireapp/core/lib/messagingProtocols/proteus';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class DecryptErrorMessage extends Message {\n  constructor(public readonly clientId: string, public readonly code: number) {\n    super();\n    this.super_type = SuperType.UNABLE_TO_DECRYPT;\n  }\n\n  get isRecoverable(): boolean {\n    return !this.isIdentityChanged && this.code >= 200 && this.code < 300;\n  }\n\n  get isIdentityChanged(): boolean {\n    return this.code === ProteusErrors.RemoteIdentityChanged;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class DeleteMessage extends Message {\n  public deleted_timestamp: null | number;\n\n  constructor() {\n    super();\n\n    this.super_type = SuperType.DELETE;\n    this.deleted_timestamp = null;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport type {Asset as ProtobufAsset} from '@wireapp/protocol-messaging';\n\nimport {Logger, getLogger} from 'Util/Logger';\n\nimport {Asset} from './Asset';\n\nimport type {AssetRemoteData} from '../../assets/AssetRemoteData';\nimport {AssetTransferState} from '../../assets/AssetTransferState';\nimport {AssetType} from '../../assets/AssetType';\n\ntype AssetMetaData = (ProtobufAsset.IAudioMetaData | ProtobufAsset.IImageMetaData | ProtobufAsset.IVideoMetaData) & {\n  duration?: number;\n  loudness?: number[];\n};\n\nexport class FileAsset extends Asset {\n  public readonly original_resource: ko.Observable<AssetRemoteData>;\n  public readonly preview_resource: ko.Observable<AssetRemoteData>;\n  protected logger: Logger;\n  public readonly downloadProgress: ko.PureComputed<number | undefined>;\n  public readonly cancelDownload: () => void;\n  public file_name: string;\n  public file_size: number;\n  public meta: Partial<AssetMetaData>;\n  public readonly status: ko.Observable<AssetTransferState>;\n  public readonly upload_failed_reason: ko.Observable<ProtobufAsset.NotUploaded>;\n  public conversationId: string;\n  public correlation_id: string;\n\n  constructor(id?: string) {\n    super(id);\n    this.type = AssetType.FILE;\n    this.logger = getLogger('FileAsset');\n\n    // AssetTransferState\n    this.status = ko.observable();\n\n    this.file_name = '';\n    this.file_size = 0;\n    this.file_type = '';\n\n    // contains asset meta data as object\n    this.meta = {};\n\n    // asset URL, instance of an OTR asset this has to be decrypted\n    this.original_resource = ko.observable();\n    this.preview_resource = ko.observable();\n\n    this.downloadProgress = ko.pureComputed(() => {\n      if (this.original_resource()) {\n        return this.original_resource().downloadProgress();\n      }\n\n      return undefined;\n    });\n\n    this.cancelDownload = () => {\n      if (this.original_resource()) {\n        this.original_resource().cancelDownload();\n      }\n    };\n\n    this.upload_failed_reason = ko.observable();\n  }\n\n  reload(): void {\n    this.logger.info('Restart upload');\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class FileTypeRestrictedMessage extends Message {\n  constructor(\n    public readonly isIncoming: boolean,\n    public readonly name: string,\n    public readonly fileExt: string,\n    timestamp: number,\n  ) {\n    super();\n    this.super_type = SuperType.FILE_TYPE_RESTRICTED;\n    this.timestamp(timestamp);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\n/**\n * Legal hold system message\n */\nexport class LegalHoldMessage extends Message {\n  constructor(public legalHoldStatus: LegalHoldStatus, timestamp: number) {\n    super();\n    this.super_type = SuperType.LEGALHOLD;\n    this.timestamp(timestamp);\n  }\n\n  get isActivationMessage(): boolean {\n    return this.legalHoldStatus === LegalHoldStatus.ENABLED;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {ITweet} from '@wireapp/protocol-messaging';\n\nimport {obfuscate} from 'Util/StringUtil';\n\nimport type {AssetRemoteData} from '../../assets/AssetRemoteData';\n\nexport type LinkPreviewData = {\n  image?: AssetRemoteData;\n  title?: string;\n  tweet?: ITweet;\n  url?: string;\n};\nexport class LinkPreview {\n  public url: string;\n  public title: string;\n  public image?: AssetRemoteData;\n  public tweet?: ITweet;\n\n  constructor({title = '', url = '', tweet, image}: LinkPreviewData = {}) {\n    this.title = title;\n    this.url = url;\n    this.tweet = tweet;\n    this.image = image;\n  }\n\n  obfuscate(): void {\n    this.title = obfuscate(this.title);\n    this.url = obfuscate(this.url);\n    this.tweet = undefined;\n    this.image = undefined;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Asset} from './Asset';\n\nimport {AssetType} from '../../assets/AssetType';\n\nexport class Location extends Asset {\n  public latitude: string;\n  public longitude: string;\n  public name: string;\n  public zoom: string;\n\n  constructor() {\n    super();\n\n    this.latitude = '';\n    this.longitude = '';\n    this.name = '';\n    this.type = AssetType.LOCATION;\n    this.zoom = '';\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {getLogger} from 'Util/Logger';\n\nimport {FileAsset} from './FileAsset';\n\nimport type {AssetRemoteData} from '../../assets/AssetRemoteData';\nimport {AssetType} from '../../assets/AssetType';\n\nexport class MediumImage extends FileAsset {\n  public readonly resource: ko.Observable<AssetRemoteData>;\n  public readonly correlation_id: string;\n  public height: string;\n  public width: string;\n\n  constructor(id: string) {\n    super(id);\n\n    this.correlation_id = '';\n    this.type = AssetType.IMAGE;\n\n    this.width = '0px';\n    this.height = '0px';\n\n    this.resource = ko.observable();\n    this.logger = getLogger('MediumImage');\n  }\n\n  public get ratio() {\n    return parseInt(this.width, 10) / parseInt(this.height, 10);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {formatDuration} from 'Util/TimeUtil';\n\nimport {SystemMessage} from './SystemMessage';\n\nimport {ConversationEphemeralHandler} from '../../conversation/ConversationEphemeralHandler';\nimport {SystemMessageType} from '../../message/SystemMessageType';\n\nexport class MessageTimerUpdateMessage extends SystemMessage {\n  public readonly message_timer: number;\n\n  constructor(messageTimer: number) {\n    super();\n\n    this.type = CONVERSATION_EVENT.MESSAGE_TIMER_UPDATE;\n    this.system_message_type = SystemMessageType.CONVERSATION_MESSAGE_TIMER_UPDATE;\n\n    this.message_timer = ConversationEphemeralHandler.validateTimer(messageTimer);\n\n    this.caption = ko.pureComputed(() => {\n      if (this.message_timer) {\n        const timeString = formatDuration(this.message_timer).text;\n        return this.user().isMe\n          ? t('conversationUpdatedTimerYou', timeString)\n          : t('conversationUpdatedTimer', timeString);\n      }\n\n      return this.user().isMe ? t('conversationResetTimerYou') : t('conversationResetTimer');\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class MissedMessage extends Message {\n  constructor() {\n    super();\n    this.super_type = SuperType.MISSED;\n    this.affect_order(false);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\n\nexport class PingMessage extends Message {\n  public readonly caption: ko.PureComputed<string>;\n  public readonly get_icon_classes: ko.PureComputed<string>;\n\n  constructor() {\n    super();\n    this.super_type = SuperType.PING;\n\n    this.caption = ko.pureComputed(() => (this.user().isMe ? t('conversationPingYou') : t('conversationPing')));\n\n    this.get_icon_classes = ko.pureComputed(() => {\n      const show_ping_animation = Date.now() - this.timestamp() < 2000;\n      let css_classes = this.accent_color();\n      if (show_ping_animation) {\n        css_classes += ' ping-animation ping-animation-soft';\n      }\n      return css_classes;\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {SystemMessage} from './SystemMessage';\n\nimport {SystemMessageType} from '../../message/SystemMessageType';\n\nexport class ReceiptModeUpdateMessage extends SystemMessage {\n  constructor(isReceiptEnabled: boolean) {\n    super();\n\n    this.type = CONVERSATION_EVENT.RECEIPT_MODE_UPDATE;\n    this.system_message_type = SystemMessageType.CONVERSATION_RECEIPT_MODE_UPDATE;\n\n    this.caption = ko.pureComputed(() => {\n      if (isReceiptEnabled) {\n        return this.user().isMe ? t('conversationReceiptsOnYou') : t('conversationReceiptsOn');\n      }\n      return this.user().isMe ? t('conversationReceiptsOffYou') : t('conversationReceiptsOff');\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport ko from 'knockout';\n\nimport {t} from 'Util/LocalizerUtil';\n\nimport {SystemMessage} from './SystemMessage';\n\nimport {SystemMessageType} from '../../message/SystemMessageType';\n\nexport class RenameMessage extends SystemMessage {\n  public readonly system_message_type: SystemMessageType;\n  public name: string;\n\n  constructor() {\n    super();\n\n    this.type = CONVERSATION_EVENT.RENAME;\n    this.system_message_type = SystemMessageType.CONVERSATION_RENAME;\n    this.name = '';\n\n    this.caption = ko.pureComputed(() => (this.user().isMe ? t('conversationRenameYou') : t('conversationRename')));\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {QualifiedUserId} from '@wireapp/protocol-messaging';\n\nimport {isQualifiedId} from 'Util/TypePredicateUtil';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\nimport {VerificationMessageType} from '../../message/VerificationMessageType';\nimport type {User} from '../User';\n\nexport class VerificationMessage extends Message {\n  public readonly userEntities: ko.ObservableArray<User>;\n  public userIds: ko.ObservableArray<QualifiedUserId | string>;\n  public verificationMessageType: ko.Observable<VerificationMessageType>;\n  public readonly isSelfClient: ko.PureComputed<boolean>;\n\n  constructor() {\n    super();\n\n    this.super_type = SuperType.VERIFICATION;\n    this.affect_order(false);\n\n    this.verificationMessageType = ko.observable();\n    this.userIds = ko.observableArray<QualifiedUserId | string>();\n\n    this.userEntities = ko.observableArray();\n\n    this.isSelfClient = ko.pureComputed(() => {\n      const messageUserId = this.userIds()?.length === 1 && this.userIds()[0];\n      return isQualifiedId(messageUserId)\n        ? messageUserId.id === this.user().id && messageUserId.domain === this.user().domain\n        : messageUserId === this.user().id;\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT, ConversationEvent} from '@wireapp/api-client/lib/event/';\nimport {container} from 'tsyringe';\n\nimport {LinkPreview, Mention} from '@wireapp/protocol-messaging';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {base64ToArray} from 'Util/util';\n\nimport {MemberJoinEvent, MemberLeaveEvent, TeamMemberLeaveEvent, ErrorEvent} from './EventBuilder';\n\nimport {AssetRemoteData} from '../assets/AssetRemoteData';\nimport {AssetTransferState} from '../assets/AssetTransferState';\nimport {TERMINATION_REASON} from '../calling/enum/TerminationReason';\nimport {AssetData} from '../cryptography/CryptographyMapper';\nimport type {Conversation} from '../entity/Conversation';\nimport type {Asset} from '../entity/message/Asset';\nimport {Button} from '../entity/message/Button';\nimport {CallingTimeoutMessage} from '../entity/message/CallingTimeoutMessage';\nimport {CallMessage} from '../entity/message/CallMessage';\nimport {CompositeMessage} from '../entity/message/CompositeMessage';\nimport {ContentMessage} from '../entity/message/ContentMessage';\nimport {DecryptErrorMessage} from '../entity/message/DecryptErrorMessage';\nimport {DeleteMessage} from '../entity/message/DeleteMessage';\nimport {FileAsset} from '../entity/message/FileAsset';\nimport {FileTypeRestrictedMessage} from '../entity/message/FileTypeRestrictedMessage';\nimport {LegalHoldMessage} from '../entity/message/LegalHoldMessage';\nimport {LinkPreview as LinkPreviewEntity, LinkPreviewData} from '../entity/message/LinkPreview';\nimport {Location} from '../entity/message/Location';\nimport {MediumImage} from '../entity/message/MediumImage';\nimport {MemberMessage} from '../entity/message/MemberMessage';\nimport type {Message} from '../entity/message/Message';\nimport {MessageTimerUpdateMessage} from '../entity/message/MessageTimerUpdateMessage';\nimport {MissedMessage} from '../entity/message/MissedMessage';\nimport {PingMessage} from '../entity/message/PingMessage';\nimport {ReceiptModeUpdateMessage} from '../entity/message/ReceiptModeUpdateMessage';\nimport {RenameMessage} from '../entity/message/RenameMessage';\nimport {Text} from '../entity/message/Text';\nimport type {Text as TextAsset} from '../entity/message/Text';\nimport {VerificationMessage} from '../entity/message/VerificationMessage';\nimport {ConversationError} from '../error/ConversationError';\nimport {ClientEvent} from '../event/Client';\nimport {CALL_MESSAGE_TYPE} from '../message/CallMessageType';\nimport {MentionEntity} from '../message/MentionEntity';\nimport {QuoteEntity} from '../message/QuoteEntity';\nimport {StatusType} from '../message/StatusType';\nimport {SystemMessageType} from '../message/SystemMessageType';\nimport {APIClient} from '../service/APIClientSingleton';\nimport type {EventRecord} from '../storage';\n\n// Event Mapper to convert all server side JSON events into core entities.\nexport class EventMapper {\n  logger: Logger;\n  /**\n   * Construct a new Event Mapper.\n   */\n  constructor(private readonly apiClient = container.resolve(APIClient)) {\n    this.logger = getLogger('EventMapper');\n  }\n\n  private get fallbackDomain() {\n    return this.apiClient.context?.domain;\n  }\n\n  /**\n   * Convert multiple JSON events into message entities.\n   *\n   * @param events Event data\n   * @param conversationEntity Conversation entity the events belong to\n   * @returns Resolves with the mapped message entities\n   */\n  async mapJsonEvents(events: EventRecord[], conversationEntity: Conversation): Promise<Message[]> {\n    const reversedEvents = events.filter(event => !!event).reverse();\n    const mappedEvents = await Promise.all(\n      reversedEvents.map(async (event): Promise<Message | void> => {\n        try {\n          return await this._mapJsonEvent(event, conversationEntity);\n        } catch (error) {\n          const errorMessage = `Failure while mapping events. Affected '${event.type}' event: ${error.message}`;\n          this.logger.error(errorMessage, {error, event});\n        }\n      }),\n    );\n    return mappedEvents.filter(messageEntity => !!messageEntity) as Message[];\n  }\n\n  /**\n   * Convert JSON event into a message entity.\n   *\n   * @param event Event data\n   * @param conversationEntity Conversation entity the event belong to\n   * @returns Resolves with the mapped message entity\n   */\n  mapJsonEvent(event: EventRecord, conversationEntity: Conversation) {\n    return this._mapJsonEvent(event, conversationEntity).catch(error => {\n      const isMessageNotFound = error.type === ConversationError.TYPE.MESSAGE_NOT_FOUND;\n      if (isMessageNotFound) {\n        throw error;\n      }\n      const errorMessage = `Failure while mapping events. Affected '${event.type}' event: ${error.message}`;\n      this.logger.error(errorMessage, {error, event});\n\n      throw new ConversationError(\n        ConversationError.TYPE.MESSAGE_NOT_FOUND,\n        ConversationError.MESSAGE.MESSAGE_NOT_FOUND,\n      );\n    });\n  }\n\n  /**\n   * Will update the content of the originalEntity with the new data given.\n   * Will try to do as little updates as possible to avoid to many observable emission.\n   *\n   * @param originalEntity the original message to update\n   * @param event new json data to feed into the entity\n   * @returns the updated message entity\n   */\n  async updateMessageEvent(originalEntity: ContentMessage, event: EventRecord): Promise<ContentMessage> {\n    const {id, data: eventData, edited_time: editedTime, conversation, qualified_conversation} = event;\n\n    if (eventData.quote) {\n      const {message_id: messageId, user_id: userId, error} = eventData.quote;\n      originalEntity.quote(new QuoteEntity({error, messageId, userId}));\n    }\n\n    if (id !== originalEntity.id && originalEntity.hasAssetText()) {\n      originalEntity.assets.removeAll();\n      const textAsset = await this._mapAssetText(eventData);\n      originalEntity.assets.push(textAsset);\n    } else if (originalEntity.getFirstAsset) {\n      const asset = originalEntity.getFirstAsset();\n      if (eventData.status && (asset as FileAsset).status) {\n        const assetEntity = this._mapAsset(event);\n        originalEntity.assets([assetEntity]);\n      }\n      if (eventData.previews) {\n        if ((asset as TextAsset).previews().length !== eventData.previews.length) {\n          const previews = await this._mapAssetLinkPreviews(eventData.previews);\n          (asset as TextAsset).previews(previews as LinkPreviewEntity[]);\n        }\n      }\n\n      const {\n        preview_id,\n        preview_key,\n        preview_domain = qualified_conversation?.domain || this.fallbackDomain,\n        preview_otr_key,\n        preview_sha256,\n        preview_token,\n      } = eventData as AssetData;\n      if (preview_otr_key) {\n        const remoteDataPreview = preview_key\n          ? AssetRemoteData.v3(preview_key, preview_domain, preview_otr_key, preview_sha256, preview_token, true)\n          : AssetRemoteData.v2(conversation, preview_id, preview_otr_key, preview_sha256, true);\n        (asset as FileAsset).preview_resource(remoteDataPreview);\n      }\n    }\n\n    if (event.reactions) {\n      originalEntity.reactions(event.reactions);\n      originalEntity.version = event.version;\n    }\n\n    if (event.selected_button_id) {\n      originalEntity.version = event.version;\n    }\n\n    originalEntity.id = id;\n\n    if (originalEntity.isContent() || (originalEntity as Message).isPing()) {\n      originalEntity.status(event.status || StatusType.SENT);\n    }\n\n    originalEntity.replacing_message_id = eventData.replacing_message_id;\n    if (editedTime || eventData.edited_time) {\n      originalEntity.edited_timestamp(new Date(editedTime || eventData.edited_time).getTime());\n    }\n\n    return addMetadata(originalEntity, event);\n  }\n\n  /**\n   * Convert JSON event into a message entity.\n   *\n   * @param event Event data\n   * @param conversationEntity Conversation entity the event belong to\n   * @returns Mapped message entity\n   */\n  async _mapJsonEvent(event: ConversationEvent | EventRecord, conversationEntity: Conversation) {\n    let messageEntity;\n\n    switch (event.type) {\n      case CONVERSATION_EVENT.MEMBER_JOIN: {\n        messageEntity = this._mapEventMemberJoin(event as MemberJoinEvent, conversationEntity);\n        break;\n      }\n\n      case CONVERSATION_EVENT.MEMBER_LEAVE: {\n        messageEntity = this._mapEventMemberLeave(event as MemberLeaveEvent);\n        break;\n      }\n\n      case CONVERSATION_EVENT.RECEIPT_MODE_UPDATE: {\n        messageEntity = this._mapEventReceiptModeUpdate(event);\n        break;\n      }\n\n      case CONVERSATION_EVENT.MESSAGE_TIMER_UPDATE: {\n        messageEntity = this._mapEventMessageTimerUpdate(event);\n        break;\n      }\n\n      case CONVERSATION_EVENT.RENAME: {\n        messageEntity = this._mapEventRename(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.ASSET_ADD: {\n        messageEntity = addMetadata(this._mapEventAssetAdd(event), event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD: {\n        const addMessage = await this._mapEventCompositeMessageAdd(event);\n        messageEntity = addMetadata(addMessage, event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.DELETE_EVERYWHERE: {\n        messageEntity = this._mapEventDeleteEverywhere(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.GROUP_CREATION: {\n        messageEntity = this._mapEventGroupCreation(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.INCOMING_MESSAGE_TOO_BIG:\n      case ClientEvent.CONVERSATION.UNABLE_TO_DECRYPT: {\n        messageEntity = this._mapEventUnableToDecrypt(event as ErrorEvent);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.KNOCK: {\n        messageEntity = addMetadata(this._mapEventPing(), event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.CALL_TIME_OUT: {\n        messageEntity = this._mapEventCallingTimeout(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.LEGAL_HOLD_UPDATE: {\n        messageEntity = this._mapEventLegalHoldUpdate(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.LOCATION: {\n        messageEntity = addMetadata(this._mapEventLocation(event), event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.MESSAGE_ADD: {\n        const addMessage = await this._mapEventMessageAdd(event);\n        messageEntity = addMetadata(addMessage, event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.MISSED_MESSAGES: {\n        messageEntity = this._mapEventMissedMessages();\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.ONE2ONE_CREATION: {\n        messageEntity = this._mapEvent1to1Creation(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE: {\n        messageEntity = this._mapEventTeamMemberLeave(event as TeamMemberLeaveEvent);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.VERIFICATION: {\n        messageEntity = this._mapEventVerification(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.VOICE_CHANNEL_ACTIVATE: {\n        messageEntity = this._mapEventVoiceChannelActivate();\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.VOICE_CHANNEL_DEACTIVATE: {\n        messageEntity = this._mapEventVoiceChannelDeactivate(event);\n        break;\n      }\n\n      case ClientEvent.CONVERSATION.FILE_TYPE_RESTRICTED: {\n        messageEntity = this._mapFileTypeRestricted(event);\n        break;\n      }\n\n      default: {\n        const {type, id} = event as EventRecord;\n        this.logger.warn(`Ignored unhandled '${type}' event ${id ? `'${id}' ` : ''}`, event);\n        throw new ConversationError(\n          ConversationError.TYPE.MESSAGE_NOT_FOUND,\n          ConversationError.MESSAGE.MESSAGE_NOT_FOUND,\n        );\n      }\n    }\n\n    const {\n      category,\n      data,\n      from,\n      qualified_from,\n      id,\n      primary_key,\n      time,\n      type,\n      version,\n      from_client_id,\n      ephemeral_expires,\n      ephemeral_started,\n    } = event as EventRecord;\n\n    messageEntity.category = category;\n    messageEntity.conversation_id = conversationEntity.id;\n    messageEntity.from = from;\n    messageEntity.fromDomain = qualified_from?.domain;\n    messageEntity.fromClientId = from_client_id;\n    messageEntity.id = id;\n    messageEntity.primary_key = primary_key;\n    messageEntity.timestamp(new Date(time).getTime());\n    messageEntity.type = type;\n    messageEntity.version = version || 1;\n\n    if (data) {\n      messageEntity.legalHoldStatus = data.legal_hold_status;\n    }\n\n    if (messageEntity.isContent() || messageEntity.isPing()) {\n      messageEntity.status((event as EventRecord).status || StatusType.SENT);\n    }\n\n    if (messageEntity.isComposite()) {\n      const {selected_button_id, waiting_button_id} = event as EventRecord;\n      messageEntity.selectedButtonId(selected_button_id);\n      messageEntity.waitingButtonId(waiting_button_id);\n    }\n    if (messageEntity.isReactable()) {\n      (messageEntity as ContentMessage).reactions((event as EventRecord).reactions || {});\n    }\n\n    if (ephemeral_expires) {\n      messageEntity.ephemeral_expires(ephemeral_expires);\n      messageEntity.ephemeral_started(Number(ephemeral_started) || 0);\n    }\n\n    if (isNaN(messageEntity.timestamp())) {\n      this.logger.warn(`Could not get timestamp for message '${messageEntity.id}'. Skipping it.`, event);\n      messageEntity = undefined;\n    }\n\n    return messageEntity;\n  }\n\n  //##############################################################################\n  // Event mappers\n  //##############################################################################\n\n  /**\n   * Maps JSON data of conversation.one2one-creation message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Member message entity\n   */\n  private _mapEvent1to1Creation({data: eventData}: EventRecord) {\n    const {has_service: hasService, userIds} = eventData;\n    const messageEntity = new MemberMessage();\n    messageEntity.memberMessageType = SystemMessageType.CONNECTION_ACCEPTED;\n    messageEntity.userIds(userIds);\n\n    if (hasService) {\n      messageEntity.showServicesWarning = true;\n    }\n\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.asset_add message into message entity.\n   *\n   * @param event Message data\n   * @returns Content message entity\n   */\n  private _mapEventAssetAdd(event: EventRecord) {\n    const messageEntity = new ContentMessage();\n\n    const assetEntity = this._mapAsset(event);\n    messageEntity.assets.push(assetEntity);\n\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of delete everywhere event to message entity.\n   *\n   * @param eventData Message data\n   * @returns Delete message entity\n   */\n  private _mapEventDeleteEverywhere({data: eventData}: EventRecord) {\n    const messageEntity = new DeleteMessage();\n    messageEntity.deleted_timestamp = new Date(eventData.deleted_time).getTime();\n    return messageEntity;\n  }\n\n  /**\n   * Map JSON ata of group creation event to message entity.\n   *\n   * @param eventData Message data\n   * @returns Member message entity\n   */\n  private _mapEventGroupCreation({data: eventData}: EventRecord) {\n    const messageEntity = new MemberMessage();\n    messageEntity.memberMessageType = SystemMessageType.CONVERSATION_CREATE;\n    messageEntity.name(eventData.name || '');\n    messageEntity.userIds(eventData.userIds);\n    messageEntity.allTeamMembers = eventData.allTeamMembers;\n    return messageEntity;\n  }\n\n  _mapEventCallingTimeout({data, time}: EventRecord) {\n    return new CallingTimeoutMessage(data.reason, parseInt(time, 10));\n  }\n\n  _mapEventLegalHoldUpdate({data, timestamp}: EventRecord) {\n    return new LegalHoldMessage(data.legal_hold_status, timestamp);\n  }\n\n  /**\n   * Maps JSON data of conversation.location message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Location message entity\n   */\n  private _mapEventLocation({data: eventData}: EventRecord) {\n    const location = eventData.location;\n    const messageEntity = new ContentMessage();\n    const assetEntity = new Location();\n\n    assetEntity.longitude = location.longitude;\n    assetEntity.latitude = location.latitude;\n    assetEntity.name = location.name;\n    assetEntity.zoom = location.zoom;\n\n    messageEntity.assets.push(assetEntity);\n\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.member_join message into message entity.\n   *\n   * @param event Message data\n   * @param conversationEntity Conversation entity the event belong to\n   * @returns Member message entity\n   */\n  private _mapEventMemberJoin(\n    event: MemberJoinEvent & {data: {has_service?: boolean}},\n    conversationEntity: Conversation,\n  ) {\n    const {data: eventData, from: sender} = event;\n    const {has_service: hasService} = eventData;\n    const userIds = eventData.qualified_user_ids || eventData.user_ids.map(id => ({domain: '', id}));\n\n    const messageEntity = new MemberMessage();\n\n    const isSingleModeConversation = conversationEntity.is1to1() || conversationEntity.isRequest();\n    messageEntity.visible(!isSingleModeConversation);\n\n    if (conversationEntity.isGroup()) {\n      const messageFromCreator = sender === conversationEntity.creator;\n      const creatorIndex = userIds.findIndex(user => user.id === sender);\n      const creatorIsJoiningMember = messageFromCreator && creatorIndex !== -1;\n\n      if (creatorIsJoiningMember) {\n        userIds.splice(creatorIndex, 1);\n        messageEntity.memberMessageType = SystemMessageType.CONVERSATION_CREATE;\n      }\n\n      if (hasService) {\n        messageEntity.showServicesWarning = true;\n      }\n\n      messageEntity.userIds(userIds);\n    }\n\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.member_leave message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Member message entity\n   */\n  private _mapEventMemberLeave({data: eventData}: MemberLeaveEvent) {\n    const messageEntity = new MemberMessage();\n    const userIds = eventData.qualified_user_ids || eventData.user_ids.map(id => ({domain: '', id}));\n    messageEntity.userIds(userIds);\n    messageEntity.reason = eventData.reason;\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.message_add message into message entity.\n   *\n   * @param event Message data\n   * @returns Content message entity\n   */\n  private async _mapEventMessageAdd(event: EventRecord) {\n    const {data: eventData, edited_time: editedTime} = event;\n    const messageEntity = new ContentMessage();\n\n    const assets = await this._mapAssetText(eventData);\n    messageEntity.assets.push(assets);\n    messageEntity.replacing_message_id = eventData.replacing_message_id;\n    messageEntity.edited_timestamp(new Date(editedTime || eventData.edited_time).getTime());\n\n    if (eventData.quote) {\n      const {message_id: messageId, user_id: userId, error} = eventData.quote;\n      messageEntity.quote(new QuoteEntity({error, messageId, userId}));\n    }\n\n    return messageEntity;\n  }\n\n  private async _mapEventCompositeMessageAdd(event: EventRecord) {\n    const {data: eventData} = event;\n    const messageEntity = new CompositeMessage();\n    const assets: (Asset | FileAsset | Text | MediumImage)[] = await Promise.all(\n      eventData.items.map(\n        async (item: {button: {id: string; text: string}; text: EventRecord}): Promise<void | Button | Text> => {\n          if (item.button) {\n            return new Button(item.button.id, item.button.text);\n          }\n          if (item.text) {\n            return this._mapAssetText(item.text);\n          }\n        },\n      ),\n    );\n    messageEntity.assets.push(...assets);\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of local missed message event to message entity.\n   */\n  private _mapEventMissedMessages(): MissedMessage {\n    return new MissedMessage();\n  }\n\n  /**\n   * Maps JSON data of `conversation.knock` message into message entity.\n   */\n  private _mapEventPing(): PingMessage {\n    return new PingMessage();\n  }\n\n  /**\n   * Maps JSON data of conversation.rename message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Rename message entity\n   */\n  private _mapEventRename({data: eventData}: EventRecord) {\n    const messageEntity = new RenameMessage();\n    messageEntity.name = eventData.name;\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.receipt-mode-update message into message entity.\n   *\n   * @param eventData Message data\n   * @returns receipt mode update message entity\n   */\n  private _mapEventReceiptModeUpdate({data: eventData}: EventRecord) {\n    return new ReceiptModeUpdateMessage(!!eventData.receipt_mode);\n  }\n\n  /**\n   * Maps JSON data of conversation.message-timer-update message into message entity.\n   *\n   * @param eventData Message data\n   * @returns message timer update message entity\n   */\n  private _mapEventMessageTimerUpdate({data: eventData}: EventRecord) {\n    return new MessageTimerUpdateMessage(eventData.message_timer);\n  }\n\n  /**\n   * Maps JSON data of conversation.team_leave message into message entity.\n   *\n   * @param event Message data\n   * @returns Member message entity\n   */\n  private _mapEventTeamMemberLeave(event: MemberLeaveEvent) {\n    const messageEntity = this._mapEventMemberLeave(event);\n    const eventData = event.data;\n    messageEntity.name(eventData.name || t('conversationSomeone'));\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of local decrypt errors to message entity.\n   *\n   * @param error_code Error data received as JSON\n   * @returns Decrypt error message entity\n   */\n  private _mapEventUnableToDecrypt({error_code: errorCode, error}: ErrorEvent) {\n    const code = typeof errorCode === 'string' ? parseInt(errorCode.split(' ')[0], 10) : errorCode;\n    const clientId = error.replace(/\\n/g, '').replace(/^.*\\(([\\w\\d]+)\\)$/g, '$1');\n    return new DecryptErrorMessage(clientId, code);\n  }\n\n  /**\n   * Maps JSON data of conversation.verification message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Verification message entity\n   */\n  private _mapEventVerification({data: eventData}: EventRecord) {\n    const messageEntity = new VerificationMessage();\n    // Database can contain non-camelCased naming. For backwards compatibility reasons we handle both.\n    messageEntity.userIds(eventData.userIds || eventData.user_ids);\n    messageEntity.verificationMessageType(eventData.type);\n\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.voice-channel-activate message into message entity.\n   * @returns Call message entity\n   */\n  private _mapEventVoiceChannelActivate() {\n    const messageEntity = new CallMessage(CALL_MESSAGE_TYPE.ACTIVATED);\n    messageEntity.visible(false);\n    return messageEntity;\n  }\n\n  /**\n   * Maps JSON data of conversation.voice-channel-deactivate message into message entity.\n   *\n   * @param eventData Message data\n   * @returns Call message entity\n   */\n  private _mapEventVoiceChannelDeactivate({data: eventData}: EventRecord) {\n    const messageEntity = new CallMessage(CALL_MESSAGE_TYPE.DEACTIVATED, eventData.reason, eventData.duration);\n\n    if (typeof eventData.duration !== 'undefined') {\n      // new message format, including duration\n      messageEntity.visible(!messageEntity.wasCompleted());\n    } else {\n      // legacy format that we still need to map (no migration)\n      messageEntity.visible(messageEntity.finished_reason === TERMINATION_REASON.MISSED);\n    }\n\n    return messageEntity;\n  }\n\n  //##############################################################################\n  // Asset mappers\n  //##############################################################################\n\n  _mapAsset(event: EventRecord) {\n    const eventData = event.data;\n    const assetInfo = eventData.info;\n    const isMediumImage = assetInfo && assetInfo.tag === 'medium';\n    return isMediumImage ? this._mapAssetImage(event) : this._mapAssetFile(event);\n  }\n\n  /**\n   * Maps JSON data of file asset into asset entity.\n   *\n   * @param event Asset data received as JSON\n   * @returns FileAsset entity\n   */\n  private _mapAssetFile(event: EventRecord) {\n    const {conversation: conversationId, qualified_conversation, data: eventData} = event;\n    const {content_length, content_type, id, info, meta, status} = eventData;\n\n    const assetEntity = new FileAsset(id);\n\n    assetEntity.conversationId = conversationId;\n\n    // Original\n    assetEntity.file_size = content_length;\n    assetEntity.file_type = content_type;\n    assetEntity.meta = meta;\n\n    // info\n    if (info) {\n      const {correlation_id, name} = info;\n      assetEntity.correlation_id = correlation_id;\n      assetEntity.file_name = name;\n    }\n\n    // Remote data - full\n    const {key, otr_key, sha256, token, domain = qualified_conversation?.domain} = eventData as AssetData;\n    const remoteData = key\n      ? AssetRemoteData.v3(key, domain, otr_key, sha256, token)\n      : AssetRemoteData.v2(conversationId, id, otr_key, sha256);\n    assetEntity.original_resource(remoteData);\n\n    // Remote data - preview\n    const {\n      preview_id,\n      preview_key,\n      preview_domain = qualified_conversation?.domain || this.fallbackDomain,\n      preview_otr_key,\n      preview_sha256,\n      preview_token,\n    } = eventData as AssetData;\n    if (preview_otr_key) {\n      const remoteDataPreview =\n        key && preview_key\n          ? AssetRemoteData.v3(preview_key, preview_domain, preview_otr_key, preview_sha256, preview_token, true)\n          : AssetRemoteData.v2(conversationId, preview_id, preview_otr_key, preview_sha256, true);\n      assetEntity.preview_resource(remoteDataPreview);\n    }\n\n    assetEntity.status(status || AssetTransferState.UPLOAD_PENDING);\n\n    return assetEntity;\n  }\n\n  /**\n   * Maps JSON data of medium image asset into asset entity.\n   *\n   * @param event Asset data received as JSON\n   * @returns Medium image asset entity\n   */\n  private _mapAssetImage(event: EventRecord<AssetData>) {\n    const {data: eventData, conversation: conversationId, qualified_conversation} = event;\n    const {content_length, content_type, id: assetId, info} = eventData;\n    const assetEntity = new MediumImage(assetId);\n    assetEntity.file_size = content_length;\n    assetEntity.file_type = content_type;\n\n    if (info) {\n      assetEntity.width = `${info.width}px`;\n      assetEntity.height = `${info.height}px`;\n    }\n\n    const {key, otr_key, sha256, token, domain = qualified_conversation?.domain || this.fallbackDomain} = eventData;\n\n    if (!otr_key || !sha256) {\n      return assetEntity;\n    }\n    const remoteData = key\n      ? AssetRemoteData.v3(key, domain, otr_key, sha256, token, true)\n      : AssetRemoteData.v2(conversationId, assetId, otr_key, sha256, true);\n\n    assetEntity.resource(remoteData);\n    return assetEntity;\n  }\n\n  /**\n   * Map link preview from proto message.\n   *\n   * @param linkPreview Link preview proto message\n   * @returns Mapped link preview\n   */\n  private _mapAssetLinkPreview(linkPreview: LinkPreview): LinkPreviewEntity | void {\n    if (linkPreview) {\n      const {image, title, url, tweet} = linkPreview;\n      const {image: article_image, title: article_title} = linkPreview.article || {};\n\n      const linkPreviewData: LinkPreviewData = {\n        title: title || article_title || '',\n        tweet: tweet ?? undefined,\n        url: url,\n      };\n      const previewImage = image || article_image;\n      if (previewImage && previewImage.uploaded) {\n        const {assetId: assetKey, assetToken, assetDomain} = previewImage.uploaded;\n\n        if (assetKey) {\n          let {otrKey, sha256} = previewImage.uploaded;\n\n          otrKey = new Uint8Array(otrKey);\n          sha256 = new Uint8Array(sha256);\n\n          const remoteData = AssetRemoteData.v3(\n            assetKey,\n            assetDomain || this.fallbackDomain,\n            otrKey,\n            sha256,\n            assetToken,\n            true,\n          );\n          linkPreviewData.image = remoteData;\n        }\n      }\n\n      return new LinkPreviewEntity(linkPreviewData);\n    }\n  }\n\n  /**\n   * Map link previews from proto messages.\n   *\n   * @param linkPreviews Link previews as base64 encoded proto messages\n   * @returns Array of mapped link previews\n   */\n  private async _mapAssetLinkPreviews(linkPreviews: string[]) {\n    const encodedLinkPreviews = await Promise.all(linkPreviews.map(base64 => base64ToArray(base64)));\n    return encodedLinkPreviews\n      .map(encodedLinkPreview => LinkPreview.decode(encodedLinkPreview))\n      .map(linkPreview => this._mapAssetLinkPreview(linkPreview))\n      .filter(linkPreviewEntity => linkPreviewEntity);\n  }\n\n  /**\n   * Map mentions from proto messages.\n   *\n   * @param mentions Mentions as base64 encoded proto messages\n   * @param messageText Text of message\n   * @returns Array of mapped mentions\n   */\n  private async _mapAssetMentions(mentions: string[], messageText: string) {\n    const encodedMentions = await Promise.all(mentions.map(base64 => base64ToArray(base64)));\n    return encodedMentions\n      .map(encodedMention => {\n        const protoMention = Mention.decode(encodedMention);\n        return new MentionEntity(\n          protoMention.start,\n          protoMention.length,\n          protoMention.qualifiedUserId?.id || protoMention.userId,\n          protoMention.qualifiedUserId?.domain,\n        );\n      })\n      .filter((mentionEntity, _, allMentions): boolean | void => {\n        if (mentionEntity) {\n          try {\n            return mentionEntity.validate(messageText, allMentions);\n          } catch (error) {\n            this.logger.warn(`Removed invalid mention when mapping message: ${error.message}`, mentionEntity);\n            return false;\n          }\n        }\n      });\n  }\n\n  /**\n   * Maps JSON data of text asset into asset entity.\n   *\n   * @param eventData Asset data received as JSON\n   * @returns Text asset entity\n   */\n  private async _mapAssetText(eventData: EventRecord) {\n    const {id, content, mentions, message, previews} = eventData;\n    const messageText = content || message;\n    const assetEntity = new Text(id, messageText);\n\n    if (mentions && mentions.length) {\n      const mappedMentions = await this._mapAssetMentions(mentions, messageText);\n      assetEntity.mentions(mappedMentions);\n    }\n    if (previews && previews.length) {\n      const mappedLinkPreviews = (await this._mapAssetLinkPreviews(previews)) as unknown as LinkPreviewEntity[];\n      assetEntity.previews(mappedLinkPreviews);\n    }\n\n    return assetEntity;\n  }\n\n  _mapFileTypeRestricted(event: EventRecord) {\n    const {\n      data: {isIncoming, name, fileExt},\n      time,\n    } = event;\n    return new FileTypeRestrictedMessage(isIncoming, name, fileExt, +time);\n  }\n}\n\n// TODO: Method is probably being used for data from backend & database. If yes, it should be split up (Single-responsibility principle).\nfunction addMetadata<T extends Message>(entity: T, event: EventRecord): T {\n  const {data: eventData, read_receipts} = event;\n  if (eventData) {\n    entity.expectsReadConfirmation = eventData.expects_read_confirmation;\n    entity.legalHoldStatus = eventData.legal_hold_status;\n  }\n  entity.readReceipts(read_receipts || []);\n  return entity;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {t} from 'Util/LocalizerUtil';\n\nexport const NOTIFICATION_STATE = {\n  EVERYTHING: 0b00,\n  MENTIONS_AND_REPLIES: 0b01,\n  NOTHING: 0b11,\n};\n\nexport const getNotificationText = (status: number) => {\n  const statusTexts: Record<number, string> = {\n    [NOTIFICATION_STATE.EVERYTHING]: t('notificationSettingsEverything'),\n    [NOTIFICATION_STATE.MENTIONS_AND_REPLIES]: t('notificationSettingsMentionsAndReplies'),\n    [NOTIFICATION_STATE.NOTHING]: t('notificationSettingsNothing'),\n  };\n  return statusTexts[status];\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport Linkify from 'linkify-it';\n\nconst codeBlockRegex = /(`+)[^`]*?\\1$/gm;\nconst linkify = new Linkify();\n\n/**\n * Check if the text contains only one link\n * @param text Text to parse\n * @returns Text contains only a link\n */\nexport const containsOnlyLink = (text: string): boolean => {\n  const textWithoutCode = text.trim().replace(codeBlockRegex, '');\n  const urls = linkify.match(textWithoutCode) || [];\n  return urls.length === 1 && urls[0].raw === textWithoutCode;\n};\n\n/**\n * Get first link and link offset for given text.\n * @param text Text to parse\n * @returns Containing link and its offset\n */\nexport const getFirstLinkWithOffset = (text: string): {offset: number; url: string} | undefined => {\n  const textWithoutCode = text.trim().replace(codeBlockRegex, '');\n\n  const links = linkify.match(textWithoutCode) || [];\n  const [firstLink] = links.filter(link => ['http:', 'https:', ''].includes(link.schema));\n\n  return firstLink\n    ? {\n        offset: firstLink.index,\n        url: firstLink.raw,\n      }\n    : undefined;\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\n\nimport {\n  Asset,\n  Availability,\n  ButtonActionConfirmation,\n  Calling,\n  Cleared,\n  Composite,\n  Confirmation,\n  DataTransfer,\n  External,\n  GenericMessage,\n  IAsset,\n  IImageAsset,\n  ImageAsset,\n  LastRead,\n  LegalHoldStatus,\n  LinkPreview,\n  Location,\n  Mention,\n  MessageDelete,\n  MessageEdit,\n  MessageHide,\n  Quote,\n  Reaction,\n  Text,\n} from '@wireapp/protocol-messaging';\n\nimport {getLogger, Logger} from 'Util/Logger';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\nimport {base64ToArray, arrayToBase64, createRandomUuid} from 'Util/util';\n\nimport {decryptAesAsset} from '../assets/AssetCrypto';\nimport {AssetTransferState} from '../assets/AssetTransferState';\nimport {ConversationEphemeralHandler} from '../conversation/ConversationEphemeralHandler';\nimport {GENERIC_MESSAGE_TYPE} from '../cryptography/GenericMessageType';\nimport {PROTO_MESSAGE_TYPE} from '../cryptography/ProtoMessageType';\nimport {CryptographyError} from '../error/CryptographyError';\nimport {ClientEvent, CONVERSATION} from '../event/Client';\nimport {StatusType} from '../message/StatusType';\nimport {EventRecord} from '../storage';\n\nexport interface MappedText {\n  data: {content: string; mentions: string[]; previews: string[]; quote?: string; replacing_message_id?: string};\n  type: CONVERSATION;\n}\n\nexport interface MappedAssetMetaData {\n  duration: number;\n  loudness: Uint8Array;\n}\n\nexport interface MappedAsset {\n  data: any;\n  type: CONVERSATION;\n}\n\nexport interface AssetData {\n  content_length: number;\n  content_type: string;\n  domain?: string;\n  id?: string;\n  info: {\n    height?: number;\n    name?: string;\n    tag?: string;\n    width?: number;\n  };\n  key?: string;\n  meta?: MappedAssetMetaData;\n  otr_key?: Uint8Array;\n  preview_domain?: string;\n  preview_id?: string;\n  preview_key?: string;\n  preview_otr_key?: Uint8Array;\n  preview_sha256?: Uint8Array;\n  preview_token?: string;\n  reason?: Asset.NotUploaded | AssetTransferState;\n  sha256?: Uint8Array;\n  status?: AssetTransferState;\n  token?: string;\n}\ntype ConversationEvent = Omit<EventRecord, 'id'>;\n\nexport class CryptographyMapper {\n  private readonly logger: Logger;\n\n  static get CONFIG() {\n    return {\n      MAX_MENTIONS_PER_MESSAGE: 500,\n    };\n  }\n\n  constructor() {\n    this.logger = getLogger('CryptographyMapper');\n  }\n\n  /**\n   * Maps a generic message into an event in JSON.\n   *\n   * @param genericMessage Received ProtoBuffer message\n   * @param event Event of `CONVERSATION_EVENT.OTR-ASSET-ADD` or `CONVERSATION_EVENT.OTR-MESSAGE-ADD`\n   * @returns Resolves with the mapped event\n   */\n  async mapGenericMessage(genericMessage: GenericMessage, event: ConversationEvent) {\n    if (!genericMessage) {\n      throw new CryptographyError(\n        CryptographyError.TYPE.NO_GENERIC_MESSAGE,\n        CryptographyError.MESSAGE.NO_GENERIC_MESSAGE,\n      );\n    }\n\n    if (genericMessage.external) {\n      genericMessage = await this._unwrapExternal(genericMessage.external as External, event);\n    }\n\n    return this._mapGenericMessage(genericMessage, event);\n  }\n\n  async _mapGenericMessage(genericMessage: GenericMessage, event: ConversationEvent) {\n    let specificContent;\n\n    switch (genericMessage.content) {\n      case GENERIC_MESSAGE_TYPE.ASSET: {\n        const mappedAsset = this._mapAsset(genericMessage.asset as Asset);\n        specificContent = addMetadata(mappedAsset, genericMessage.asset);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.AVAILABILITY: {\n        specificContent = this._mapAvailability(genericMessage.availability as Availability);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.CALLING: {\n        specificContent = this._mapCalling(genericMessage.calling as Calling, event.data);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.CLEARED: {\n        specificContent = this._mapCleared(genericMessage.cleared as Cleared);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.CONFIRMATION: {\n        specificContent = this._mapConfirmation(genericMessage.confirmation as Confirmation);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.DELETED: {\n        specificContent = this._mapDeleted(genericMessage.deleted as MessageDelete);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.EDITED: {\n        specificContent = await this._mapEdited(genericMessage.edited as MessageEdit);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.EPHEMERAL: {\n        specificContent = await this._mapEphemeral(genericMessage, event);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.HIDDEN: {\n        specificContent = this._mapHidden(genericMessage.hidden as MessageHide);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.IMAGE: {\n        const mappedImage = this._mapImage(genericMessage.image as ImageAsset, event.data.id);\n        specificContent = addMetadata(mappedImage, genericMessage.image);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.KNOCK: {\n        const mappedKnock = this._mapKnock();\n        specificContent = addMetadata(mappedKnock, genericMessage.knock);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.LAST_READ: {\n        specificContent = this._mapLastRead(genericMessage.lastRead as LastRead);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.LOCATION: {\n        const mappedLocation = this._mapLocation(genericMessage.location as Location);\n        specificContent = addMetadata(mappedLocation, genericMessage.location);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.REACTION: {\n        specificContent = this._mapReaction(genericMessage.reaction as Reaction);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.TEXT: {\n        const mappedText = this._mapText(genericMessage.text as Text);\n        specificContent = addMetadata(mappedText, genericMessage.text);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.COMPOSITE_MESSAGE: {\n        const mappedComposite = await this._mapComposite(genericMessage.composite as Composite);\n        specificContent = addMetadata(mappedComposite, genericMessage.composite);\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.BUTTON_ACTION_CONFIRMATION: {\n        specificContent = this._mapButtonActionConfirmation(\n          genericMessage.buttonActionConfirmation as ButtonActionConfirmation,\n        );\n        break;\n      }\n\n      case GENERIC_MESSAGE_TYPE.DATA_TRANSFER: {\n        specificContent = this._mapDataTransfer(genericMessage.dataTransfer as DataTransfer);\n        break;\n      }\n\n      default: {\n        const logMessage = `Skipped event '${genericMessage.messageId}' of unhandled type '${genericMessage.content}'`;\n        this.logger.debug(logMessage, {event, generic_message: genericMessage});\n        return undefined;\n      }\n    }\n\n    const {conversation, qualified_conversation, from, qualified_from, senderClientId} = event;\n    const genericContent = {\n      conversation,\n      from,\n      from_client_id: event.data.sender,\n      id: genericMessage.messageId,\n      qualified_conversation,\n      qualified_from,\n      senderClientId,\n      status: event.status,\n      time: event.time,\n    };\n\n    return {...genericContent, ...specificContent};\n  }\n\n  async _mapComposite(composite: Composite) {\n    const items = await Promise.all(\n      composite.items.map(async item => {\n        if ((item as Composite.Item).content !== GENERIC_MESSAGE_TYPE.TEXT) {\n          return item;\n        }\n\n        const {mentions: protoMentions, content} = item.text;\n\n        if (protoMentions && protoMentions.length > CryptographyMapper.CONFIG.MAX_MENTIONS_PER_MESSAGE) {\n          this.logger.warn(`Message contains '${protoMentions.length}' mentions exceeding limit`, item.text);\n          protoMentions.length = CryptographyMapper.CONFIG.MAX_MENTIONS_PER_MESSAGE;\n        }\n\n        const mentions = protoMentions.map(protoMention => arrayToBase64(Mention.encode(protoMention).finish()));\n\n        return {\n          text: {\n            content,\n            mentions,\n          },\n        };\n      }),\n    );\n    return {\n      data: {items},\n      type: ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD,\n    };\n  }\n\n  _mapButtonActionConfirmation(buttonActionConfirmation: ButtonActionConfirmation) {\n    return {\n      data: {\n        buttonId: buttonActionConfirmation.buttonId,\n        messageId: buttonActionConfirmation.referenceMessageId,\n      },\n      type: ClientEvent.CONVERSATION.BUTTON_ACTION_CONFIRMATION,\n    };\n  }\n\n  _mapAsset(asset: Asset) {\n    const {original, preview, uploaded, notUploaded} = asset;\n    let data: AssetData;\n\n    if (original) {\n      data = {\n        content_length: original.size as number,\n        content_type: original.mimeType,\n        info: {\n          name: original.name || null,\n        },\n      };\n\n      if (original.image) {\n        data.info.height = original.image.height;\n        data.info.width = original.image.width;\n      } else {\n        data.meta = this._mapAssetMetaData(original);\n      }\n    }\n\n    if (preview) {\n      const remote = preview.remote;\n\n      data = {\n        ...data,\n        preview_domain: remote.assetDomain,\n        preview_key: remote.assetId,\n        preview_otr_key: new Uint8Array(remote.otrKey),\n        preview_sha256: new Uint8Array(remote.sha256),\n        preview_token: remote.assetToken,\n      };\n    }\n\n    const isImage = original && original.image;\n    if (isImage) {\n      data.info.tag = 'medium';\n    }\n\n    if (asset.hasOwnProperty('uploaded') && uploaded !== null) {\n      data = {\n        ...data,\n        domain: uploaded.assetDomain,\n        key: uploaded.assetId,\n        otr_key: new Uint8Array(uploaded.otrKey),\n        sha256: new Uint8Array(uploaded.sha256),\n        status: AssetTransferState.UPLOADED,\n        token: uploaded.assetToken,\n      };\n    } else if (asset.hasOwnProperty('notUploaded') && notUploaded !== null) {\n      data = {...data, reason: notUploaded, status: AssetTransferState.UPLOAD_FAILED};\n    }\n\n    return {data, type: ClientEvent.CONVERSATION.ASSET_ADD};\n  }\n\n  _mapAssetMetaData(original: Asset.IOriginal): MappedAssetMetaData | undefined {\n    const audioData = original.audio;\n    if (audioData) {\n      const loudnessArray = audioData.normalizedLoudness || new ArrayBuffer(0);\n      const durationInSeconds = audioData.durationInMillis\n        ? Number(audioData.durationInMillis) / TIME_IN_MILLIS.SECOND\n        : 0;\n\n      return {\n        duration: durationInSeconds,\n        loudness: new Uint8Array(loudnessArray),\n      };\n    }\n    return undefined;\n  }\n\n  _mapAvailability(availability: Availability) {\n    const knownAvailabilityTypes = [\n      Availability.Type.NONE,\n      Availability.Type.AVAILABLE,\n      Availability.Type.AWAY,\n      Availability.Type.BUSY,\n    ];\n\n    if (!knownAvailabilityTypes.includes(availability.type)) {\n      const message = `Availability type \"${availability.type}\" is unknown.`;\n      throw new CryptographyError(CryptographyError.TYPE.UNHANDLED_TYPE, message);\n    }\n\n    return {\n      data: {\n        availability: availability.type,\n      },\n      type: ClientEvent.USER.AVAILABILITY,\n    };\n  }\n\n  _mapCalling(calling: Calling, eventData: ConversationEvent & {sender: string}) {\n    return {\n      content: JSON.parse(calling.content),\n      targetConversation: calling.qualifiedConversationId,\n      sender: eventData.sender,\n      type: ClientEvent.CALL.E_CALL,\n    };\n  }\n\n  _mapCleared(cleared: Cleared) {\n    return {\n      data: {\n        cleared_timestamp: cleared.clearedTimestamp.toString(),\n        conversationId: cleared.conversationId,\n      },\n      type: CONVERSATION_EVENT.MEMBER_UPDATE,\n    };\n  }\n\n  _mapConfirmation(confirmation: Confirmation) {\n    return {\n      data: {\n        message_id: confirmation.firstMessageId,\n        more_message_ids: confirmation.moreMessageIds || [],\n        status: (() => {\n          switch (confirmation.type) {\n            case Confirmation.Type.DELIVERED:\n              return StatusType.DELIVERED;\n            case Confirmation.Type.READ:\n              return StatusType.SEEN;\n            default:\n              const message = `Confirmation type \"${confirmation.type}\" is unknown.`;\n              throw new CryptographyError(CryptographyError.TYPE.UNHANDLED_TYPE, message);\n          }\n        })(),\n      },\n      type: ClientEvent.CONVERSATION.CONFIRMATION,\n    };\n  }\n\n  _mapDeleted(deleted: MessageDelete) {\n    return {\n      data: {\n        message_id: deleted.messageId,\n      },\n      type: ClientEvent.CONVERSATION.MESSAGE_DELETE,\n    };\n  }\n\n  async _mapEdited(edited: MessageEdit) {\n    const mappedMessage = this._mapText(edited.text as Text);\n    mappedMessage.data.replacing_message_id = edited.replacingMessageId;\n    return mappedMessage;\n  }\n\n  async _mapEphemeral(genericMessage: GenericMessage, event: ConversationEvent) {\n    const messageTimer = genericMessage.ephemeral[PROTO_MESSAGE_TYPE.EPHEMERAL_EXPIRATION];\n    (genericMessage.ephemeral as unknown as GenericMessage).messageId = genericMessage.messageId;\n\n    const embeddedMessage: any = await this._mapGenericMessage(\n      genericMessage.ephemeral as unknown as GenericMessage,\n      event,\n    );\n    embeddedMessage.ephemeral_expires = ConversationEphemeralHandler.validateTimer(messageTimer as number);\n\n    return embeddedMessage;\n  }\n\n  /**\n   * Unpacks a specific generic message which is wrapped inside an external generic message.\n   *\n   * @note Wrapped messages get the 'message_id' of their wrappers (external message)\n   * @param external Generic message of type 'external'\n   * @param event Backend event of type 'conversation.otr-message-add'\n   * @returns Resolves with generic message\n   */\n  async _unwrapExternal(external: External, event: ConversationEvent) {\n    const {otrKey, sha256} = external;\n    try {\n      const eventData = event.data;\n      if (!eventData.data || !otrKey || !sha256) {\n        throw new Error('Not all expected properties defined');\n      }\n      const cipherTextArray = base64ToArray(eventData.data);\n      const cipherText = cipherTextArray.buffer;\n      const keyBytes = new Uint8Array(otrKey).buffer;\n      const referenceSha256 = new Uint8Array(sha256).buffer;\n      const externalMessageBuffer = await decryptAesAsset(cipherText, keyBytes, referenceSha256);\n      return GenericMessage.decode(new Uint8Array(externalMessageBuffer));\n    } catch (error) {\n      this.logger.error(`Failed to unwrap external message: ${error.message}`, error);\n      throw new CryptographyError(CryptographyError.TYPE.BROKEN_EXTERNAL, CryptographyError.MESSAGE.BROKEN_EXTERNAL);\n    }\n  }\n\n  _mapHidden(hidden: MessageHide) {\n    return {\n      data: {\n        conversation_id: hidden.conversationId,\n        message_id: hidden.messageId,\n      },\n      type: ClientEvent.CONVERSATION.MESSAGE_HIDDEN,\n    };\n  }\n\n  _mapImage(image: ImageAsset, eventId: string) {\n    const isMediumImage = image.tag === 'medium';\n    if (isMediumImage) {\n      return this._mapImageMedium(image, eventId);\n    }\n\n    this.logger.info(`Skipped event '${eventId}': ${CryptographyError.MESSAGE.IGNORED_PREVIEW}`);\n    throw new CryptographyError(CryptographyError.TYPE.IGNORED_PREVIEW, CryptographyError.MESSAGE.IGNORED_PREVIEW);\n  }\n\n  _mapImageMedium(image: ImageAsset, eventId: string) {\n    // set ID even if asset id is missing\n    eventId = eventId || createRandomUuid();\n\n    return {\n      data: {\n        content_length: image.size,\n        content_type: image.mimeType,\n        id: eventId,\n        info: {\n          height: image.height,\n          tag: image.tag,\n          width: image.width,\n        },\n        otr_key: new Uint8Array(image.otrKey ? image.otrKey : []),\n        sha256: new Uint8Array(image.sha256 ? image.sha256 : []),\n      },\n      type: ClientEvent.CONVERSATION.ASSET_ADD,\n    };\n  }\n\n  _mapKnock() {\n    return {\n      data: {},\n      type: ClientEvent.CONVERSATION.KNOCK,\n    };\n  }\n\n  _mapLastRead(lastRead: LastRead) {\n    return {\n      data: {\n        conversationId: lastRead.conversationId,\n        last_read_timestamp: lastRead.lastReadTimestamp.toString(),\n      },\n      type: CONVERSATION_EVENT.MEMBER_UPDATE,\n    };\n  }\n\n  _mapDataTransfer(dataTransfer: DataTransfer) {\n    return {\n      data: {\n        trackingIdentifier: dataTransfer.trackingIdentifier.identifier,\n      },\n      type: ClientEvent.USER.DATA_TRANSFER,\n    };\n  }\n\n  _mapLocation(location: Location) {\n    return {\n      data: {\n        location: {\n          latitude: location.latitude,\n          longitude: location.longitude,\n          name: location.name,\n          zoom: location.zoom,\n        },\n      },\n      type: ClientEvent.CONVERSATION.LOCATION,\n    };\n  }\n\n  _mapReaction(reaction: Reaction) {\n    return {\n      data: {\n        message_id: reaction.messageId,\n        reaction: reaction.emoji,\n      },\n      type: ClientEvent.CONVERSATION.REACTION,\n    };\n  }\n\n  _mapText(text: Text): MappedText {\n    const {mentions: protoMentions, quote: protoQuote} = text;\n\n    const protoLinkPreviews = text[PROTO_MESSAGE_TYPE.LINK_PREVIEWS];\n\n    if (protoMentions && protoMentions.length > CryptographyMapper.CONFIG.MAX_MENTIONS_PER_MESSAGE) {\n      this.logger.warn(`Message contains '${protoMentions.length}' mentions exceeding limit`, text);\n      protoMentions.length = CryptographyMapper.CONFIG.MAX_MENTIONS_PER_MESSAGE;\n    }\n\n    const mentions = protoMentions.map(protoMention => arrayToBase64(Mention.encode(protoMention).finish()));\n    const previews = protoLinkPreviews.map(protoLinkPreview =>\n      arrayToBase64(LinkPreview.encode(protoLinkPreview).finish()),\n    );\n\n    const mappedText: MappedText = {\n      data: {\n        content: `${text.content}`,\n        mentions,\n        previews,\n      },\n      type: ClientEvent.CONVERSATION.MESSAGE_ADD,\n    };\n\n    if (protoQuote) {\n      const quote = arrayToBase64(Quote.encode(protoQuote).finish());\n      mappedText.data.quote = quote;\n    }\n\n    return mappedText;\n  }\n}\n\nfunction addMetadata(\n  mappedEvent: MappedAsset,\n  asset: (IAsset | IImageAsset) & Partial<{expectsReadConfirmation: boolean; legalHoldStatus: LegalHoldStatus}>,\n) {\n  mappedEvent.data = {\n    ...mappedEvent.data,\n    expects_read_confirmation: asset.expectsReadConfirmation,\n    legal_hold_status: asset.legalHoldStatus,\n  };\n\n  return mappedEvent;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum GENERIC_MESSAGE_TYPE {\n  ASSET = 'asset',\n  AVAILABILITY = 'availability',\n  BUTTON_ACTION = 'buttonAction',\n  BUTTON_ACTION_CONFIRMATION = 'buttonActionConfirmation',\n  CALLING = 'calling',\n  CLEARED = 'cleared',\n  CLIENT_ACTION = 'clientAction',\n  COMPOSITE_MESSAGE = 'composite',\n  CONFIRMATION = 'confirmation',\n  DATA_TRANSFER = 'dataTransfer',\n  DELETED = 'deleted',\n  EDITED = 'edited',\n  EPHEMERAL = 'ephemeral',\n  EXTERNAL = 'external',\n  HIDDEN = 'hidden',\n  IMAGE = 'image',\n  KNOCK = 'knock',\n  LAST_READ = 'lastRead',\n  LOCATION = 'location',\n  REACTION = 'reaction',\n  TEXT = 'text',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum PROTO_MESSAGE_TYPE {\n  ASSET_NOT_UPLOADED = 'notUploaded',\n  ASSET_ORIGINAL = 'original',\n  ASSET_PREVIEW = 'preview',\n  ASSET_UPLOADED = 'uploaded',\n  EPHEMERAL_EXPIRATION = 'expireAfterMillis',\n  EXPECTS_READ_CONFIRMATION = 'expectsReadConfirmation',\n  LEGAL_HOLD_STATUS = 'legalHoldStatus',\n  LINK_PREVIEW_IMAGE = 'image',\n  LINK_PREVIEW_TITLE = 'title',\n  LINK_PREVIEWS = 'linkPreview',\n  MENTION_TYPE_USER_ID = 'userId',\n  MENTIONS = 'mentions',\n  QUOTE = 'quote',\n  TWEET = 'tweet',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  CONVERSATION_ACCESS_ROLE,\n  CONVERSATION_ACCESS,\n  CONVERSATION_LEGACY_ACCESS_ROLE,\n  CONVERSATION_TYPE,\n} from '@wireapp/api-client/lib/conversation/';\nimport {RECEIPT_MODE} from '@wireapp/api-client/lib/conversation/data';\nimport {ConversationProtocol} from '@wireapp/api-client/lib/conversation/NewConversation';\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport {amplify} from 'amplify';\nimport ko from 'knockout';\nimport {container} from 'tsyringe';\nimport {Cancelable, debounce} from 'underscore';\n\nimport {Availability, LegalHoldStatus} from '@wireapp/protocol-messaging';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {useLegalHoldModalState} from 'Components/Modals/LegalHoldModal/LegalHoldModal.state';\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {truncate} from 'Util/StringUtil';\n\nimport {CallMessage} from './message/CallMessage';\nimport type {ContentMessage} from './message/ContentMessage';\nimport type {MemberMessage} from './message/MemberMessage';\nimport type {Message} from './message/Message';\nimport {PingMessage} from './message/PingMessage';\nimport type {SystemMessage} from './message/SystemMessage';\nimport type {User} from './User';\n\nimport type {Call} from '../calling/Call';\nimport {ClientRepository} from '../client';\nimport {Config} from '../Config';\nimport {ConnectionEntity} from '../connection/ConnectionEntity';\nimport {ACCESS_STATE} from '../conversation/AccessState';\nimport {ConversationRepository} from '../conversation/ConversationRepository';\nimport {isSelfConversation} from '../conversation/ConversationSelectors';\nimport {ConversationStatus} from '../conversation/ConversationStatus';\nimport {ConversationVerificationState} from '../conversation/ConversationVerificationState';\nimport {NOTIFICATION_STATE} from '../conversation/NotificationSetting';\nimport {ConversationError} from '../error/ConversationError';\nimport {StatusType} from '../message/StatusType';\nimport {ConversationRecord} from '../storage/record/ConversationRecord';\nimport {TeamState} from '../team/TeamState';\n\ninterface UnreadState {\n  allEvents: Message[];\n  allMessages: ContentMessage[];\n  calls: CallMessage[];\n  otherMessages: ContentMessage[];\n  pings: PingMessage[];\n  selfMentions: ContentMessage[];\n  selfReplies: ContentMessage[];\n}\n\nenum TIMESTAMP_TYPE {\n  ARCHIVED = 'archivedTimestamp',\n  CLEARED = 'cleared_timestamp',\n  LAST_EVENT = 'last_event_timestamp',\n  LAST_READ = 'last_read_timestamp',\n  LAST_SERVER = 'last_server_timestamp',\n  MUTED = 'mutedTimestamp',\n}\n\nexport class Conversation {\n  private readonly teamState: TeamState;\n  public readonly archivedState: ko.Observable<boolean>;\n  private readonly incomingMessages: ko.ObservableArray<Message | ContentMessage | MemberMessage>;\n  private readonly isManaged: boolean;\n  private readonly isTeam1to1: ko.PureComputed<boolean>;\n  public readonly last_server_timestamp: ko.Observable<number>;\n  private readonly logger: Logger;\n  public readonly mutedState: ko.Observable<number>;\n  private readonly mutedTimestamp: ko.Observable<number>;\n  private readonly publishPersistState: (() => void) & Cancelable;\n  private shouldPersistStateChanges: boolean;\n  public blockLegalHoldMessage: boolean;\n  public hasCreationMessage: boolean;\n  public needsLegalHoldApproval: boolean = false;\n  public readonly accessCode: ko.Observable<string>;\n  public readonly accessState: ko.Observable<ACCESS_STATE>;\n  public readonly archivedTimestamp: ko.Observable<number>;\n  public readonly availabilityOfUser: ko.PureComputed<Availability.Type>;\n  public readonly call: ko.Observable<Call | null>;\n  public readonly cleared_timestamp: ko.Observable<number>;\n  public readonly connection: ko.Observable<ConnectionEntity>;\n  // TODO(Federation): Currently the 'creator' just refers to a user id but it has to become a qualified id\n  public creator: string;\n  public groupId?: string;\n  public epoch: number = -1;\n  public cipherSuite: number = 1;\n  public readonly isUsingMLSProtocol: boolean;\n  public readonly display_name: ko.PureComputed<string>;\n  public readonly firstUserEntity: ko.PureComputed<User>;\n  public readonly enforcedTeamMessageTimer: ko.PureComputed<number>;\n  public readonly globalMessageTimer: ko.Observable<number | null>;\n  public readonly hasAdditionalMessages: ko.Observable<boolean>;\n  public readonly hasGlobalMessageTimer: ko.PureComputed<boolean>;\n  public readonly hasGuest: ko.PureComputed<boolean>;\n  public readonly hasDirectGuest: ko.PureComputed<boolean>;\n  public readonly hasLegalHold: ko.Computed<boolean>;\n  public readonly hasService: ko.PureComputed<boolean>;\n  public readonly hasUnread: ko.PureComputed<boolean>;\n  public id: string;\n  public readonly inTeam: ko.PureComputed<boolean>;\n  public readonly lastDeliveredMessage: ko.PureComputed<Message | undefined>;\n  public readonly is_archived: ko.Observable<boolean>;\n  public readonly is_cleared: ko.PureComputed<boolean>;\n  public readonly is_loaded: ko.Observable<boolean>;\n  public readonly is_pending: ko.Observable<boolean>;\n  public readonly is_verified: ko.PureComputed<boolean | undefined>;\n  public readonly is1to1: ko.PureComputed<boolean>;\n  public readonly isActiveParticipant: ko.PureComputed<boolean>;\n  public readonly isClearable: ko.PureComputed<boolean>;\n  public readonly isCreatedBySelf: ko.PureComputed<boolean>;\n  public readonly isGroup: ko.PureComputed<boolean>;\n  public readonly isGuest: ko.Observable<boolean>;\n  public readonly isGuestRoom: ko.PureComputed<boolean>;\n  public readonly isGuestAndServicesRoom: ko.PureComputed<boolean>;\n  public readonly isServicesRoom: ko.PureComputed<boolean>;\n  public readonly isLeavable: ko.PureComputed<boolean>;\n  public readonly isMutable: ko.PureComputed<boolean>;\n  public readonly isRequest: ko.PureComputed<boolean>;\n  /** @deprecated use isSelfConversation from conversationSelectors */\n  public readonly isSelf: ko.PureComputed<boolean>;\n  public readonly isTeamOnly: ko.PureComputed<boolean>;\n  public readonly last_event_timestamp: ko.Observable<number>;\n  public readonly last_read_timestamp: ko.Observable<number>;\n  public readonly legalHoldStatus: ko.Observable<LegalHoldStatus>;\n  public readonly localMessageTimer: ko.Observable<number>;\n  public readonly messages_unordered: ko.ObservableArray<Message | ContentMessage | MemberMessage>;\n  public readonly messages_visible: ko.PureComputed<(Message | ContentMessage | MemberMessage)[]>;\n  public readonly messages: ko.PureComputed<(Message | ContentMessage | MemberMessage)[]>;\n  public readonly messageTimer: ko.PureComputed<number>;\n  public readonly name: ko.Observable<string>;\n  public readonly notificationState: ko.PureComputed<number>;\n  public readonly participating_user_ets: ko.ObservableArray<User>;\n  public readonly participating_user_ids: ko.ObservableArray<QualifiedId>;\n  public readonly receiptMode: ko.Observable<RECEIPT_MODE>;\n  public readonly removed_from_conversation: ko.PureComputed<boolean>;\n  public readonly roles: ko.Observable<Record<string, string>>;\n  public readonly selfUser: ko.Observable<User | undefined>;\n  public readonly servicesCount: ko.PureComputed<number>;\n  public readonly showNotificationsEverything: ko.PureComputed<boolean>;\n  public readonly showNotificationsMentionsAndReplies: ko.PureComputed<boolean>;\n  public readonly showNotificationsNothing: ko.PureComputed<boolean>;\n  public status: ko.Observable<ConversationStatus>;\n  public team_id: string;\n  public readonly type: ko.Observable<CONVERSATION_TYPE>;\n  public readonly unreadState: ko.PureComputed<UnreadState>;\n  public readonly verification_state: ko.Observable<ConversationVerificationState>;\n  public readonly withAllTeamMembers: ko.Observable<boolean>;\n  public readonly hasExternal: ko.PureComputed<boolean>;\n  public readonly hasFederatedUsers: ko.PureComputed<boolean>;\n  public accessModes?: CONVERSATION_ACCESS[];\n  public accessRole?: CONVERSATION_LEGACY_ACCESS_ROLE | CONVERSATION_ACCESS_ROLE[];\n  public domain: string;\n\n  static get TIMESTAMP_TYPE(): typeof TIMESTAMP_TYPE {\n    return TIMESTAMP_TYPE;\n  }\n\n  constructor(\n    conversation_id: string = '',\n    domain: string = '',\n    public readonly protocol = ConversationProtocol.PROTEUS,\n    teamState = container.resolve(TeamState),\n  ) {\n    this.teamState = teamState;\n    this.id = conversation_id;\n\n    this.domain = domain;\n\n    this.logger = getLogger(`Conversation (${this.id})`);\n\n    this.accessState = ko.observable();\n    this.accessCode = ko.observable();\n    this.creator = undefined;\n    this.name = ko.observable();\n    this.team_id = undefined;\n    this.type = ko.observable();\n\n    /**\n     * If a conversation has the groupId property it means that it\n     * is MLS protocol based as this property is for MLS conversations only.\n     * @returns boolean\n     */\n    this.isUsingMLSProtocol = protocol === ConversationProtocol.MLS;\n\n    this.is_loaded = ko.observable(false);\n    this.is_pending = ko.observable(false);\n\n    this.participating_user_ets = ko.observableArray([]); // Does not include self user\n    this.participating_user_ids = ko.observableArray([]); // Does not include self user\n    this.selfUser = ko.observable();\n    this.roles = ko.observable({});\n\n    this.hasCreationMessage = false;\n\n    this.firstUserEntity = ko.pureComputed(() => this.participating_user_ets()[0]);\n    this.availabilityOfUser = ko.pureComputed(() => this.firstUserEntity()?.availability());\n\n    this.isGuest = ko.observable(false);\n    this.isManaged = false;\n\n    this.inTeam = ko.pureComputed(() => {\n      const isSameTeam = this.selfUser()?.teamId === this.team_id;\n      const isSameDomain = this.domain === this.selfUser()?.domain;\n      return !!this.team_id && isSameTeam && !this.isGuest() && isSameDomain;\n    });\n    this.isGuestRoom = ko.pureComputed(() => this.accessState() === ACCESS_STATE.TEAM.GUEST_ROOM);\n    this.isGuestAndServicesRoom = ko.pureComputed(() => this.accessState() === ACCESS_STATE.TEAM.GUESTS_SERVICES);\n    this.isServicesRoom = ko.pureComputed(() => this.accessState() === ACCESS_STATE.TEAM.SERVICES);\n    this.isTeamOnly = ko.pureComputed(() => this.accessState() === ACCESS_STATE.TEAM.TEAM_ONLY);\n    this.withAllTeamMembers = ko.observable(false);\n\n    this.isTeam1to1 = ko.pureComputed(() => {\n      const isGroupConversation = this.type() === CONVERSATION_TYPE.REGULAR;\n      const hasOneParticipant = this.participating_user_ids().length === 1;\n      return isGroupConversation && hasOneParticipant && this.team_id && !this.name();\n    });\n    this.isGroup = ko.pureComputed(() => {\n      const isGroupConversation = this.type() === CONVERSATION_TYPE.REGULAR;\n      return isGroupConversation && !this.isTeam1to1();\n    });\n    this.is1to1 = ko.pureComputed(() => {\n      const is1to1Conversation = this.type() === CONVERSATION_TYPE.ONE_TO_ONE;\n      return is1to1Conversation || this.isTeam1to1();\n    });\n    this.isRequest = ko.pureComputed(() => this.type() === CONVERSATION_TYPE.CONNECT);\n    this.isSelf = ko.pureComputed(() => this.type() === CONVERSATION_TYPE.SELF);\n\n    this.hasDirectGuest = ko.pureComputed(() => {\n      const hasGuestUser = this.participating_user_ets().some(userEntity => userEntity.isDirectGuest());\n      return hasGuestUser && this.isGroup() && this.selfUser()?.inTeam();\n    });\n    this.hasGuest = ko.pureComputed(() => {\n      const hasGuestUser = this.participating_user_ets().some(userEntity => userEntity.isGuest());\n      return hasGuestUser && this.isGroup() && this.selfUser()?.inTeam();\n    });\n    this.hasService = ko.pureComputed(() => this.participating_user_ets().some(userEntity => userEntity.isService));\n    this.hasExternal = ko.pureComputed(() => this.participating_user_ets().some(userEntity => userEntity.isExternal()));\n    this.hasFederatedUsers = ko.pureComputed(() =>\n      this.participating_user_ets().some(userEntity => userEntity.isFederated),\n    );\n    this.servicesCount = ko.pureComputed(\n      () => this.participating_user_ets().filter(userEntity => userEntity.isService).length,\n    );\n\n    // in case this is a one2one conversation this is the connection to that user\n    this.connection = ko.observable(new ConnectionEntity());\n    this.connection.subscribe(connectionEntity => {\n      const connectedUserId = connectionEntity?.userId;\n      if (connectedUserId && this.participating_user_ids().every(user => !matchQualifiedIds(user, connectedUserId))) {\n        this.participating_user_ids.push(connectedUserId);\n      }\n    });\n\n    // E2EE conversation states\n    this.archivedState = ko.observable(false).extend({notify: 'always'});\n    this.mutedState = ko.observable(NOTIFICATION_STATE.EVERYTHING);\n    this.verification_state = ko.observable(ConversationVerificationState.UNVERIFIED);\n\n    this.archivedTimestamp = ko.observable(0);\n    this.cleared_timestamp = ko.observable(0);\n    this.last_event_timestamp = ko.observable(0);\n    this.last_read_timestamp = ko.observable(0);\n    this.last_server_timestamp = ko.observable(0);\n    this.mutedTimestamp = ko.observable(0);\n\n    this.call = ko.observable(null);\n\n    // Conversation states for view\n    this.notificationState = ko.pureComputed(() => {\n      if (!this.selfUser()) {\n        return NOTIFICATION_STATE.NOTHING;\n      }\n      const mutedState = this.mutedState();\n\n      const knownNotificationStates = Object.values(NOTIFICATION_STATE);\n      if (knownNotificationStates.includes(mutedState)) {\n        const isStateMentionsAndReplies = mutedState === NOTIFICATION_STATE.MENTIONS_AND_REPLIES;\n        const isInvalidState = isStateMentionsAndReplies && !this.selfUser().inTeam();\n\n        return isInvalidState ? NOTIFICATION_STATE.NOTHING : mutedState;\n      }\n\n      if (typeof mutedState === 'boolean') {\n        const migratedMutedState = this.selfUser().inTeam()\n          ? NOTIFICATION_STATE.MENTIONS_AND_REPLIES\n          : NOTIFICATION_STATE.NOTHING;\n        return this.mutedState() ? migratedMutedState : NOTIFICATION_STATE.EVERYTHING;\n      }\n\n      return NOTIFICATION_STATE.EVERYTHING;\n    });\n\n    this.is_archived = this.archivedState;\n    this.is_cleared = ko.pureComputed(() => this.last_event_timestamp() <= this.cleared_timestamp());\n    this.is_verified = ko.pureComputed(() => {\n      if (!this.hasInitializedUsers()) {\n        return undefined;\n      }\n\n      return this.allUserEntities.every(userEntity => userEntity.is_verified());\n    });\n\n    this.legalHoldStatus = ko.observable(LegalHoldStatus.DISABLED);\n\n    this.hasLegalHold = ko.computed(() => {\n      const isInitialized = this.hasInitializedUsers();\n      const hasLegalHold = isInitialized && this.allUserEntities.some(userEntity => userEntity.isOnLegalHold());\n\n      if (isInitialized) {\n        this.legalHoldStatus(hasLegalHold ? LegalHoldStatus.ENABLED : LegalHoldStatus.DISABLED);\n      }\n\n      if (!hasLegalHold) {\n        const {closeRequestModal} = useLegalHoldModalState.getState();\n        closeRequestModal(this.id);\n      }\n\n      return hasLegalHold;\n    });\n\n    this.blockLegalHoldMessage = false;\n\n    this.legalHoldStatus.subscribe(legalHoldStatus => {\n      if (!this.blockLegalHoldMessage && !isSelfConversation(this) && this.hasInitializedUsers()) {\n        amplify.publish(WebAppEvents.CONVERSATION.INJECT_LEGAL_HOLD_MESSAGE, {\n          conversationEntity: this,\n          legalHoldStatus,\n          userId: this.selfUser().qualifiedId,\n        });\n      }\n    });\n\n    this.isCreatedBySelf = ko.pureComputed(\n      () => this.selfUser().id === this.creator && !this.removed_from_conversation(),\n    );\n\n    this.showNotificationsEverything = ko.pureComputed(() => {\n      return this.notificationState() === NOTIFICATION_STATE.EVERYTHING;\n    });\n    this.showNotificationsNothing = ko.pureComputed(() => {\n      return this.notificationState() === NOTIFICATION_STATE.NOTHING;\n    });\n    this.showNotificationsMentionsAndReplies = ko.pureComputed(() => {\n      return this.notificationState() === NOTIFICATION_STATE.MENTIONS_AND_REPLIES;\n    });\n\n    this.status = ko.observable(ConversationStatus.CURRENT_MEMBER);\n    this.removed_from_conversation = ko.pureComputed(() => {\n      return this.status() === ConversationStatus.PAST_MEMBER;\n    });\n    this.isActiveParticipant = ko.pureComputed(() => !this.removed_from_conversation() && !this.isGuest());\n    this.isClearable = ko.pureComputed(() => !this.isRequest() && !this.is_cleared());\n    this.isLeavable = ko.pureComputed(() => this.isGroup() && !this.removed_from_conversation());\n    this.isMutable = ko.pureComputed(() => !this.isRequest() && !this.removed_from_conversation());\n\n    // Messages\n    this.localMessageTimer = ko.observable(null);\n    this.globalMessageTimer = ko.observable(null);\n\n    this.receiptMode = ko.observable(RECEIPT_MODE.OFF);\n\n    // The team configuration for self-deleting messages has\n    // always precedence over conversation or local settings.\n    // https://wearezeta.atlassian.net/wiki/spaces/SER/pages/474873953/Tech+spec+Self-deleting+messages+feature+config\n    //\n    // E.g. If a user is participant of a foreign conversation\n    // that enforces self-deleting messages while self-deleting\n    // messages are disabled for the users team, the user will\n    // send normal messages (not self-deleting) and ignore the\n    // setting of the conversation.\n    this.messageTimer = ko.pureComputed(\n      () =>\n        this.teamState.isSelfDeletingMessagesEnabled() &&\n        (this.teamState.getEnforcedSelfDeletingMessagesTimeout() ||\n          this.globalMessageTimer() ||\n          this.localMessageTimer()),\n    );\n    this.hasGlobalMessageTimer = ko.pureComputed(() => this.globalMessageTimer() > 0);\n\n    this.messages_unordered = ko.observableArray();\n    this.messages = ko.pureComputed(() =>\n      [...this.messages_unordered()].sort((message_a, message_b) => {\n        return message_a.timestamp() - message_b.timestamp();\n      }),\n    );\n    this.lastDeliveredMessage = ko.pureComputed(() => this.getLastDeliveredMessage());\n\n    this.incomingMessages = ko.observableArray();\n\n    this.hasAdditionalMessages = ko.observable(true);\n\n    this.messages_visible = ko\n      .pureComputed(() => (!this.id ? [] : this.messages().filter(messageEntity => messageEntity.visible())))\n      .extend({trackArrayChanges: true});\n\n    // Calling\n    this.unreadState = ko.pureComputed(() => {\n      const unreadState: UnreadState = {\n        allEvents: [],\n        allMessages: [],\n        calls: [],\n        otherMessages: [],\n        pings: [],\n        selfMentions: [],\n        selfReplies: [],\n      };\n      const messages = [...this.messages(), ...this.incomingMessages()];\n      for (let index = messages.length - 1; index >= 0; index--) {\n        const messageEntity = messages[index];\n        if (messageEntity.visible()) {\n          const isReadMessage = messageEntity.timestamp() <= this.last_read_timestamp() || messageEntity.user().isMe;\n          if (isReadMessage) {\n            break;\n          }\n\n          const isMissedCall = messageEntity.isCall() && !messageEntity.wasCompleted();\n          const isPing = messageEntity.isPing();\n          const isMessage = messageEntity.isContent();\n          const isSelfMentioned =\n            isMessage &&\n            this.selfUser() &&\n            (messageEntity as ContentMessage).isUserMentioned(this.selfUser().qualifiedId);\n          const isSelfQuoted =\n            isMessage && this.selfUser() && (messageEntity as ContentMessage).isUserQuoted(this.selfUser().id);\n\n          if (isMissedCall || isPing || isMessage) {\n            unreadState.allMessages.push(messageEntity as ContentMessage);\n          }\n\n          if (isSelfMentioned) {\n            unreadState.selfMentions.push(messageEntity as ContentMessage);\n          } else if (isSelfQuoted) {\n            unreadState.selfReplies.push(messageEntity as ContentMessage);\n          } else if (isMissedCall) {\n            unreadState.calls.push(messageEntity);\n          } else if (isPing) {\n            unreadState.pings.push(messageEntity);\n          } else if (isMessage) {\n            unreadState.otherMessages.push(messageEntity as ContentMessage);\n          }\n\n          unreadState.allEvents.push(messageEntity as ContentMessage);\n        }\n      }\n\n      return unreadState;\n    });\n\n    this.hasUnread = ko.pureComputed(() => {\n      const isIgnored = this.isRequest() || this.showNotificationsNothing();\n      if (isIgnored) {\n        return false;\n      }\n      const {\n        allMessages: unreadMessages,\n        selfMentions: unreadSelfMentions,\n        selfReplies: unreadSelfReplies,\n      } = this.unreadState();\n\n      return this.showNotificationsMentionsAndReplies()\n        ? unreadSelfMentions.length > 0 || unreadSelfReplies.length > 0\n        : unreadMessages.length > 0;\n    });\n\n    /**\n     * Display name strategy:\n     *\n     * 'One-to-One Conversations' and 'Connection Requests':\n     * We should not use the conversation name received from the backend as fallback as it will always contain the\n     * name of the user who received the connection request initially\n     *\n     * - Name of the other participant\n     * - Name of the other user of the associated connection\n     * - \"...\" if neither of those has been attached yet\n     *\n     * 'Group Conversation':\n     * - Conversation name received from backend\n     * - If unnamed, we will create a name from the participant names\n     * - Join the user's first names to a comma separated list or uses the user's first name if only one user participating\n     * - \"...\" if the user entities have not yet been attached yet\n     */\n    this.display_name = ko.pureComputed(() => {\n      if (this.isRequest() || this.is1to1()) {\n        const [userEntity] = this.participating_user_ets();\n        const userName = userEntity?.name();\n        return userName || '…';\n      }\n\n      if (this.isGroup()) {\n        if (this.name()) {\n          return this.name();\n        }\n\n        const hasUserEntities = !!this.participating_user_ets().length;\n        if (hasUserEntities) {\n          const isJustServices = this.participating_user_ets().every(userEntity => userEntity.isService);\n          const joinedNames = this.participating_user_ets()\n            .filter(userEntity => isJustServices || !userEntity.isService)\n            .map(userEntity => userEntity.name())\n            .join(', ');\n\n          const maxLength = ConversationRepository.CONFIG.GROUP.MAX_NAME_LENGTH;\n          return truncate(joinedNames, maxLength, false);\n        }\n\n        const hasUserIds = !!this.participating_user_ids().length;\n        if (!hasUserIds) {\n          return t('conversationsEmptyConversation');\n        }\n      }\n\n      return '…';\n    });\n\n    this.shouldPersistStateChanges = false;\n    this.publishPersistState = debounce(() => {\n      amplify.publish(WebAppEvents.CONVERSATION.PERSIST_STATE, this);\n    }, 100);\n\n    this._initSubscriptions();\n  }\n\n  get qualifiedId(): QualifiedId {\n    return {domain: this.domain, id: this.id};\n  }\n\n  private hasInitializedUsers() {\n    const hasMappedUsers = this.participating_user_ets().length || !this.participating_user_ids().length;\n    return Boolean(this.selfUser() && hasMappedUsers);\n  }\n\n  private _initSubscriptions() {\n    [\n      this.archivedState,\n      this.archivedTimestamp,\n      this.cleared_timestamp,\n      this.messageTimer,\n      this.isGuest,\n      this.last_event_timestamp,\n      this.last_read_timestamp,\n      this.last_server_timestamp,\n      this.mutedState,\n      this.mutedTimestamp,\n      this.name,\n      this.participating_user_ids,\n      this.receiptMode,\n      this.status,\n      this.type,\n      this.verification_state,\n    ].forEach(property => (property as ko.Observable).subscribe(this.persistState));\n  }\n\n  get allUserEntities() {\n    return [this.selfUser()].concat(this.participating_user_ets());\n  }\n\n  readonly persistState = (): void => {\n    if (this.shouldPersistStateChanges) {\n      this.publishPersistState();\n    }\n  };\n\n  setStateChangePersistence(persistChanges: boolean): void {\n    this.shouldPersistStateChanges = persistChanges;\n  }\n\n  /**\n   * Remove all message from conversation unless there are unread messages.\n   */\n  release(): void {\n    if (!this.unreadState().allEvents.length) {\n      this.removeMessages();\n      this.is_loaded(false);\n      this.hasAdditionalMessages(true);\n    }\n  }\n\n  /**\n   * Set the timestamp of a given type.\n   * @note This will only increment timestamps\n   * @param timestamp Timestamp to be set\n   * @param type Type of timestamp to be updated\n   * @param forceUpdate set the timestamp regardless of previous timestamp value (no checks)\n   * @returns Timestamp value which can be `false` (boolean) if there is no timestamp\n   */\n  setTimestamp(timestamp: string | number, type: TIMESTAMP_TYPE, forceUpdate: boolean = false): number | false {\n    if (typeof timestamp === 'string') {\n      timestamp = window.parseInt(timestamp, 10);\n    }\n\n    let entityTimestamp: ko.Observable<number>;\n\n    switch (type) {\n      case TIMESTAMP_TYPE.ARCHIVED:\n        entityTimestamp = this.archivedTimestamp;\n        break;\n      case TIMESTAMP_TYPE.CLEARED:\n        entityTimestamp = this.cleared_timestamp;\n        break;\n      case TIMESTAMP_TYPE.LAST_EVENT:\n        entityTimestamp = this.last_event_timestamp;\n        break;\n      case TIMESTAMP_TYPE.LAST_READ:\n        entityTimestamp = this.last_read_timestamp;\n        break;\n      case TIMESTAMP_TYPE.LAST_SERVER:\n        entityTimestamp = this.last_server_timestamp;\n        break;\n      case TIMESTAMP_TYPE.MUTED:\n        entityTimestamp = this.mutedTimestamp;\n        break;\n    }\n\n    if (!entityTimestamp) {\n      throw new ConversationError(\n        ConversationError.TYPE.INVALID_PARAMETER,\n        ConversationError.MESSAGE.INVALID_PARAMETER,\n      );\n    }\n\n    const updatedTimestamp = forceUpdate ? timestamp : this._incrementTimeOnly(entityTimestamp(), timestamp);\n\n    if (updatedTimestamp !== false) {\n      entityTimestamp(updatedTimestamp);\n    }\n\n    return updatedTimestamp;\n  }\n\n  /**\n   * Increment only on timestamp update\n   * @param currentTimestamp Current timestamp\n   * @param updatedTimestamp Timestamp from update\n   * @returns Updated timestamp or `false` if not increased\n   */\n  private _incrementTimeOnly(currentTimestamp: number, updatedTimestamp: number): number | false {\n    const timestampIncreased = updatedTimestamp > currentTimestamp;\n    return timestampIncreased ? updatedTimestamp : false;\n  }\n\n  /**\n   * Adds a single message to the conversation.\n   * @param messageEntity Message entity to be added to the conversation.\n   * @returns If a message was replaced in the conversation\n   */\n  addMessage(messageEntity: Message | ContentMessage | MemberMessage): boolean | void {\n    if (messageEntity) {\n      const messageWithLinkPreview = () => this._findDuplicate(messageEntity.id, messageEntity.from);\n      const editedMessage = () =>\n        this._findDuplicate((messageEntity as ContentMessage).replacing_message_id, messageEntity.from);\n      const alreadyAdded = messageWithLinkPreview() || editedMessage();\n      if (alreadyAdded) {\n        return false;\n      }\n      if (this.isShowingLastReceivedMessage()) {\n        this.updateTimestamps(messageEntity);\n        this.incomingMessages.remove(({id}) => messageEntity.id === id);\n        this.messages_unordered.push(messageEntity);\n      } else {\n        this.incomingMessages.push(messageEntity);\n      }\n      amplify.publish(WebAppEvents.CONVERSATION.MESSAGE.ADDED, messageEntity);\n      return true;\n    }\n  }\n\n  /**\n   * Adds multiple messages to the conversation.\n   * @param message_ets Array of message entities to be added to the conversation\n   */\n  addMessages(message_ets: ContentMessage[]): void {\n    message_ets = message_ets\n      .map(message_et => this._checkForDuplicate(message_et))\n      .filter(message_et => !!message_et) as ContentMessage[];\n\n    // in order to avoid multiple db writes check the messages from the end and stop once\n    // we found a message from self user\n    for (let counter = message_ets.length - 1; counter >= 0; counter--) {\n      const message_et = message_ets[counter];\n      if (message_et.user()?.isMe) {\n        this.updateTimestamps(message_et);\n        break;\n      }\n    }\n    const messageIds = message_ets.map(({id}) => id);\n    this.incomingMessages.remove(({id}) => messageIds.includes(id));\n    this.messages_unordered.push(...message_ets);\n  }\n\n  getFirstUnreadSelfMention(): ContentMessage {\n    return this.unreadState().selfMentions.slice().pop();\n  }\n\n  getLastKnownTimestamp(currentTimestamp?: number): number {\n    const last_known_timestamp = Math.max(this.last_server_timestamp(), this.last_event_timestamp());\n    return last_known_timestamp ?? currentTimestamp;\n  }\n\n  /**\n   * Return the next timestamp that can be used to inject a message right after the last message that is not a message currently being sent\n   */\n  getNextTimestamp(): number {\n    const sentMessages = this.messages().filter(message => message?.status() !== StatusType.SENDING);\n    if (sentMessages.length === 0) {\n      return this.getLastKnownTimestamp() + 1;\n    }\n    const lastMessageTimestamp = sentMessages[sentMessages.length - 1].timestamp();\n    // The next timestamp can never be before the last known timestamp, so we need to take the max between the last message and the last known server timestamp\n    return Math.max(lastMessageTimestamp, this.getLastKnownTimestamp()) + 1;\n  }\n\n  getLatestTimestamp(currentTimestamp: number): number {\n    return Math.max(this.last_server_timestamp(), this.last_event_timestamp(), currentTimestamp);\n  }\n\n  getNextIsoDate(currentTimestamp?: number): string {\n    if (typeof currentTimestamp !== 'number') {\n      currentTimestamp = Date.now();\n    }\n    const timestamp = Math.max(this.last_server_timestamp() + 1, currentTimestamp);\n    return new Date(timestamp).toISOString();\n  }\n\n  getNumberOfServices(): number {\n    return this.participating_user_ets().filter(userEntity => userEntity.isService).length;\n  }\n\n  getNumberOfParticipants(countSelf: boolean = true, countServices: boolean = true): number {\n    const adjustCountForSelf = countSelf && !this.removed_from_conversation() ? 1 : 0;\n    const adjustCountForServices = countServices ? 0 : this.getNumberOfServices();\n\n    return this.participating_user_ids().length + adjustCountForSelf - adjustCountForServices;\n  }\n\n  getNumberOfClients(): number {\n    const participantsMapped = this.participating_user_ids().length === this.participating_user_ets().length;\n    if (participantsMapped) {\n      return this.participating_user_ets().reduce((accumulator, userEntity) => {\n        return userEntity.devices().length\n          ? accumulator + userEntity.devices().length\n          : accumulator + ClientRepository.CONFIG.AVERAGE_NUMBER_OF_CLIENTS;\n      }, this.selfUser().devices().length);\n    }\n\n    return this.getNumberOfParticipants() * ClientRepository.CONFIG.AVERAGE_NUMBER_OF_CLIENTS;\n  }\n\n  /**\n   * Prepends messages with new batch of messages.\n   * @param message_ets Array of messages to be added to conversation\n   */\n  prependMessages(message_ets: ContentMessage[]): void {\n    message_ets = message_ets\n      .map(message_et => this._checkForDuplicate(message_et))\n      .filter(message_et => !!message_et) as ContentMessage[];\n\n    this.messages_unordered.unshift(...message_ets);\n  }\n\n  /**\n   * Removes message from the conversation by message id.\n   * @param message_id ID of the message entity to be removed from the conversation\n   */\n  removeMessageById(message_id: string): void {\n    this.messages_unordered.remove(message_et => message_id && message_id === message_et.id);\n  }\n\n  /**\n   * Removes messages from the conversation.\n   * @param timestamp Optional timestamp which messages should be removed\n   */\n  removeMessages(timestamp?: number): void {\n    if (timestamp && typeof timestamp === 'number') {\n      this.messages_unordered.remove(message_et => timestamp >= message_et.timestamp());\n      return;\n    }\n    this.messages_unordered.removeAll();\n  }\n\n  shouldUnarchive(): boolean {\n    if (!this.archivedState() || this.showNotificationsNothing()) {\n      return false;\n    }\n\n    const isNewerMessage = (messageEntity: Message) => messageEntity.timestamp() > this.archivedTimestamp();\n\n    const {allEvents, allMessages, selfMentions, selfReplies} = this.unreadState();\n    if (this.showNotificationsMentionsAndReplies()) {\n      const mentionsAndReplies = selfMentions.concat(selfReplies);\n      return mentionsAndReplies.some(isNewerMessage);\n    }\n\n    const hasNewMessage = allMessages.some(isNewerMessage);\n    if (hasNewMessage) {\n      return true;\n    }\n\n    return allEvents.some(messageEntity => {\n      if (!isNewerMessage(messageEntity)) {\n        return false;\n      }\n\n      const isCallActivation = messageEntity.isCall() && messageEntity.isActivation();\n      const isMemberJoin = messageEntity.isMember() && (messageEntity as MemberMessage).isMemberJoin();\n      const wasSelfUserAdded =\n        isMemberJoin && (messageEntity as MemberMessage).isUserAffected(this.selfUser().qualifiedId);\n\n      return isCallActivation || wasSelfUserAdded;\n    });\n  }\n\n  /**\n   * Checks for message duplicates.\n   *\n   * @param messageEntity Message entity to be added to the conversation\n   * @returns Message if it is not a duplicate\n   */\n  private _checkForDuplicate(messageEntity: ContentMessage): ContentMessage | undefined {\n    if (messageEntity) {\n      const existingMessageEntity = this._findDuplicate(messageEntity.id, messageEntity.from);\n      if (existingMessageEntity) {\n        const logData = {additionalMessage: messageEntity, existingMessage: existingMessageEntity};\n        this.logger.warn(`Filtered message '${messageEntity.id}' as duplicate in view`, logData);\n        return undefined;\n      }\n      return messageEntity;\n    }\n    return undefined;\n  }\n\n  private _findDuplicate(): undefined;\n  private _findDuplicate(messageId: string, from: string): Message | ContentMessage | MemberMessage;\n  private _findDuplicate(messageId?: string, from?: string): Message | ContentMessage | MemberMessage | undefined {\n    if (messageId) {\n      return this.messages_unordered().find(messageEntity => {\n        const sameId = messageEntity.id === messageId;\n        const sameSender = messageEntity.from === from;\n        return sameId && sameSender;\n      });\n    }\n    return undefined;\n  }\n\n  updateTimestampServer(time: number | string, is_backend_timestamp: boolean = false): void {\n    if (is_backend_timestamp) {\n      const timestamp = new Date(time).getTime();\n\n      if (!isNaN(timestamp)) {\n        this.setTimestamp(timestamp, TIMESTAMP_TYPE.LAST_SERVER);\n      }\n    }\n  }\n\n  /**\n   * Update information about conversation activity from single message.\n   *\n   * @param message_et Message to be added to conversation\n   * @param forceUpdate set the timestamp regardless of previous timestamp value (no checks)\n   */\n  updateTimestamps(\n    message_et?: Message | ContentMessage | MemberMessage | SystemMessage,\n    forceUpdate: boolean = false,\n  ): void {\n    if (message_et) {\n      const timestamp = message_et.timestamp();\n      if (timestamp <= this.last_server_timestamp()) {\n        if (message_et.timestamp_affects_order()) {\n          this.setTimestamp(timestamp, TIMESTAMP_TYPE.LAST_EVENT, forceUpdate);\n\n          const from_self = message_et.user()?.isMe;\n          if (from_self) {\n            this.setTimestamp(timestamp, TIMESTAMP_TYPE.LAST_READ);\n          }\n        }\n      }\n    }\n  }\n\n  getAllMessages(): (Message | ContentMessage | MemberMessage | SystemMessage)[] {\n    return this.messages();\n  }\n\n  /**\n   * Get the first message of the conversation.\n   */\n  getOldestMessage(): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    return this.messages()[0];\n  }\n\n  /**\n   * Get the last message of the conversation.\n   */\n  getNewestMessage(): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    return this.messages()[this.messages().length - 1];\n  }\n\n  /**\n   * Get the message before a given message.\n   * @param message_et Message to look up from\n   */\n  getPreviousMessage(message_et: Message): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    const messages_visible = this.messages_visible();\n    const message_index = messages_visible.indexOf(message_et);\n    if (message_index > 0) {\n      return messages_visible[message_index - 1];\n    }\n    return undefined;\n  }\n\n  /**\n   * Get the last text message that was added by self user.\n   */\n  getLastEditableMessage(): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    const messages = this.messages();\n    for (let index = messages.length - 1; index >= 0; index--) {\n      const message_et = messages[index];\n      if (message_et.isEditable()) {\n        return message_et;\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Get the last delivered message.\n   */\n  getLastDeliveredMessage(): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    return this.messages()\n      .slice()\n      .reverse()\n      .find(messageEntity => {\n        const isDelivered = messageEntity.status() >= StatusType.DELIVERED;\n        return isDelivered && messageEntity.user().isMe;\n      });\n  }\n\n  /**\n   * Get a message by its unique ID.\n   * Only lookup in the loaded message list which is a limited view of all the messages in DB.\n   *\n   * @param messageId ID of message to be retrieved\n   */\n  getMessage(messageId: string): Message | ContentMessage | MemberMessage | SystemMessage | undefined {\n    return this.messages().find(messageEntity => messageEntity.id === messageId);\n  }\n\n  updateGuests(): void {\n    this.getTemporaryGuests().forEach(userEntity => userEntity.checkGuestExpiration());\n  }\n\n  getTemporaryGuests(): User[] {\n    const userEntities = this.selfUser()\n      ? this.participating_user_ets().concat(this.selfUser())\n      : this.participating_user_ets();\n    return userEntities.filter(userEntity => userEntity.isTemporaryGuest());\n  }\n\n  getUsersWithUnverifiedClients(): User[] {\n    const userEntities = this.selfUser()\n      ? this.participating_user_ets().concat(this.selfUser())\n      : this.participating_user_ets();\n    return userEntities.filter(userEntity => !userEntity.is_verified());\n  }\n\n  supportsVideoCall(sftEnabled: boolean): boolean {\n    if (sftEnabled) {\n      return true;\n    }\n    const participantCount = this.getNumberOfParticipants(true, false);\n    const config = Config.getConfig();\n    return participantCount <= config.MAX_VIDEO_PARTICIPANTS;\n  }\n\n  readonly isShowingLastReceivedMessage = (): boolean => {\n    return this.getNewestMessage()?.timestamp()\n      ? this.getNewestMessage().timestamp() >= this.last_event_timestamp()\n      : true;\n  };\n\n  serialize(): ConversationRecord {\n    return {\n      access: this.accessModes,\n      access_role: this.accessRole,\n      archived_state: this.archivedState(),\n      archived_timestamp: this.archivedTimestamp(),\n      cipher_suite: this.cipherSuite,\n      cleared_timestamp: this.cleared_timestamp(),\n      creator: this.creator,\n      domain: this.domain,\n      ephemeral_timer: this.localMessageTimer(),\n      epoch: this.epoch,\n      global_message_timer: this.globalMessageTimer(),\n      group_id: this.groupId,\n      id: this.id,\n      is_guest: this.isGuest(),\n      is_managed: this.isManaged,\n      last_event_timestamp: this.last_event_timestamp(),\n      last_read_timestamp: this.last_read_timestamp(),\n      last_server_timestamp: this.last_server_timestamp(),\n      legal_hold_status: this.legalHoldStatus(),\n      muted_state: this.mutedState(),\n      muted_timestamp: this.mutedTimestamp(),\n      name: this.name(),\n      others: this.participating_user_ids().map(user => user.id),\n      protocol: this.protocol,\n      qualified_others: this.participating_user_ids(),\n      receipt_mode: this.receiptMode(),\n      roles: this.roles(),\n      status: this.status(),\n      team_id: this.team_id,\n      type: this.type(),\n      verification_state: this.verification_state(),\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport {amplify} from 'amplify';\nimport ko from 'knockout';\n\nimport {Availability} from '@wireapp/protocol-messaging';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {clamp} from 'Util/NumberUtil';\nimport {getFirstChar} from 'Util/StringUtil';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nimport type {AssetRemoteData} from '../assets/AssetRemoteData';\nimport type {ClientEntity} from '../client/ClientEntity';\nimport {ACCENT_ID} from '../Config';\nimport {ConnectionEntity} from '../connection/ConnectionEntity';\nimport {ROLE as TEAM_ROLE} from '../user/UserPermission';\n\nexport class User {\n  private expirationIntervalId?: number;\n  private expirationTimeoutId?: number;\n  public readonly expirationIsUrgent: ko.Observable<boolean>;\n  public id: string;\n  public isDeleted: boolean;\n  public isMe: boolean;\n  public isService: boolean;\n  public isSingleSignOn: boolean;\n  public isNoPasswordSSO: boolean;\n  public joaatHash: number;\n  public providerId?: string;\n  public readonly accent_color: ko.PureComputed<string>;\n  public readonly accent_id: ko.Observable<number>;\n  public readonly availability: ko.Observable<Availability.Type>;\n  public readonly connection: ko.Observable<ConnectionEntity>;\n  /** does not include current client/device */\n  public readonly devices: ko.ObservableArray<ClientEntity>;\n  public readonly email: ko.Observable<string>;\n  public locale?: string;\n  public readonly expirationRemaining: ko.Observable<number>;\n  public readonly expirationRemainingText: ko.Observable<string>;\n  public readonly expirationText: ko.Observable<string>;\n  public readonly hasPendingLegalHold: ko.PureComputed<boolean>;\n  public readonly initials: ko.PureComputed<string>;\n  public readonly inTeam: ko.Observable<boolean>;\n  public readonly is_verified: ko.PureComputed<boolean>;\n  public readonly isBlocked: ko.PureComputed<boolean>;\n  public readonly isCanceled: ko.PureComputed<boolean>;\n  public readonly isConnected: ko.PureComputed<boolean>;\n  public readonly isExpired: ko.Observable<boolean>;\n  public readonly isExternal: ko.PureComputed<boolean>;\n  public readonly isGuest: ko.Observable<boolean>;\n\n  /**\n   * isDirectGuest is true when the user is a guest but not a federated user (a federated user is, by definition, a guest)\n   */\n  public readonly isDirectGuest: ko.PureComputed<boolean>;\n  public readonly isIgnored: ko.PureComputed<boolean>;\n  public readonly isIncomingRequest: ko.PureComputed<boolean>;\n  public readonly isOnLegalHold: ko.PureComputed<boolean>;\n  public readonly isOutgoingRequest: ko.PureComputed<boolean>;\n  public readonly isRequest: ko.PureComputed<boolean>;\n  public readonly isTeamMember: ko.Observable<boolean>;\n  public readonly isTemporaryGuest: ko.Observable<boolean>;\n  public readonly isUnknown: ko.PureComputed<boolean>;\n  public readonly managedBy: ko.Observable<string>;\n  public readonly mediumPictureResource: ko.Observable<AssetRemoteData>;\n  public readonly name: ko.Observable<string>;\n  public readonly phone: ko.Observable<string>;\n  public readonly previewPictureResource: ko.Observable<AssetRemoteData>;\n  public readonly providerName: ko.Observable<string>;\n  public readonly teamRole: ko.Observable<TEAM_ROLE>;\n  public readonly username: ko.Observable<string>;\n  public isFederated: boolean = false;\n  public serviceId?: string;\n  public teamId?: string;\n  /** The federated domain (when the user is on a federated server) */\n  public domain: string;\n  public readonly isBlockedLegalHold: ko.PureComputed<boolean>;\n\n  static get ACCENT_COLOR() {\n    return {\n      [ACCENT_ID.BLUE]: 'var(--blue-500)',\n      [ACCENT_ID.GREEN]: 'var(--green-500)',\n      [ACCENT_ID.PURPLE]: 'var(--purple-500)',\n      [ACCENT_ID.AMBER]: 'var(--amber-500)',\n      [ACCENT_ID.RED]: 'var(--red-500)',\n      [ACCENT_ID.TURQUOISE]: 'var(--turquoise-500)',\n    };\n  }\n\n  static get CONFIG() {\n    return {\n      MANAGED_BY: {\n        SCIM: 'scim',\n        WIRE: 'wire',\n      },\n      TEMPORARY_GUEST: {\n        EXPIRATION_INTERVAL: TIME_IN_MILLIS.MINUTE,\n        EXPIRATION_THRESHOLD: TIME_IN_MILLIS.SECOND * 10,\n        LIFETIME: TIME_IN_MILLIS.DAY,\n      },\n    };\n  }\n\n  constructor(id: string = '', domain: string = '') {\n    this.id = id;\n    this.domain = domain;\n    this.isMe = false;\n    this.isService = false;\n    this.isSingleSignOn = false;\n    this.isNoPasswordSSO = false;\n    this.isDeleted = false;\n    this.providerId = undefined;\n    this.serviceId = undefined;\n    this.providerName = ko.observable(undefined);\n\n    this.joaatHash = -1;\n\n    this.accent_id = ko.observable(ACCENT_ID.BLUE);\n\n    this.accent_color = ko.pureComputed(() => User.ACCENT_COLOR[this.accent_id()] || User.ACCENT_COLOR[ACCENT_ID.BLUE]);\n\n    this.email = ko.observable();\n    this.phone = ko.observable();\n\n    this.name = ko.observable('');\n\n    this.managedBy = ko.observable(User.CONFIG.MANAGED_BY.WIRE);\n\n    this.initials = ko.pureComputed(() => {\n      const nameParts = this.name().toUpperCase().split(' ');\n      if (nameParts.length > 1) {\n        const first = getFirstChar(nameParts[0]);\n        const last = getFirstChar(nameParts[nameParts.length - 1]);\n        return `${first}${last}`;\n      }\n      return nameParts[0].slice(0, 2);\n    });\n\n    this.username = ko.observable('');\n\n    this.previewPictureResource = ko.observable().extend({rateLimit: {method: 'notifyWhenChangesStop', timeout: 100}});\n    this.mediumPictureResource = ko.observable().extend({rateLimit: {method: 'notifyWhenChangesStop', timeout: 100}});\n\n    this.connection = ko.observable(new ConnectionEntity());\n\n    this.isBlocked = ko.pureComputed(() => this.connection().isBlocked() || this.isBlockedLegalHold());\n    this.isBlockedLegalHold = ko.pureComputed(() => this.connection().isMissingLegalHoldConsent());\n    this.isCanceled = ko.pureComputed(() => this.connection().isCanceled());\n    this.isConnected = ko.pureComputed(() => this.connection().isConnected());\n    this.isIgnored = ko.pureComputed(() => this.connection().isIgnored());\n    this.isIncomingRequest = ko.pureComputed(() => this.connection().isIncomingRequest());\n    this.isOutgoingRequest = ko.pureComputed(() => this.connection().isOutgoingRequest());\n    this.isUnknown = ko.pureComputed(() => this.connection().isUnknown());\n    this.isExternal = ko.pureComputed(() => this.teamRole() === TEAM_ROLE.PARTNER);\n\n    this.inTeam = ko.observable(false);\n    this.isGuest = ko.observable(false);\n    this.isDirectGuest = ko.pureComputed(() => {\n      return this.isGuest() && !this.isFederated;\n    });\n    this.isTemporaryGuest = ko.observable(false);\n    this.isTeamMember = ko.observable(false);\n    this.teamRole = ko.observable(TEAM_ROLE.NONE);\n    this.teamId = undefined;\n\n    this.isRequest = ko.pureComputed(() => this.connection().isRequest());\n\n    this.devices = ko.observableArray();\n    this.is_verified = ko.pureComputed(() => {\n      if (this.devices().length === 0 && !this.isMe) {\n        return false;\n      }\n      return this.devices().every(client_et => client_et.meta.isVerified());\n    });\n    this.isOnLegalHold = ko.pureComputed(() => {\n      return this.devices().some(client_et => client_et.isLegalHold());\n    });\n\n    const _hasPendingLegalHold = ko.observable(false);\n    this.hasPendingLegalHold = ko.pureComputed({\n      owner: this,\n      read: () => this.isMe && !this.isOnLegalHold() && _hasPendingLegalHold(),\n      write: value => _hasPendingLegalHold(value),\n    });\n\n    this.availability = ko.observable(Availability.Type.NONE);\n\n    this.expirationRemaining = ko.observable(0);\n    this.expirationText = ko.observable('');\n    this.expirationIsUrgent = ko.observable(false);\n    this.expirationRemainingText = ko.observable('');\n    this.expirationIntervalId = undefined;\n    this.expirationTimeoutId = undefined;\n    this.isExpired = ko.observable(false);\n  }\n\n  get qualifiedId(): QualifiedId {\n    return {domain: this.domain, id: this.id};\n  }\n  get hasDomain(): boolean {\n    return !!this.domain;\n  }\n\n  /**\n   * Returns the fully qualified user ID.\n   * @example \"@handle@wire.com\"\n   */\n  get handle(): string {\n    if (!this.username()) {\n      /** Very old user accounts don't have a handle on Wire. */\n      return '';\n    }\n    return this.isFederated ? `@${this.username()}@${this.domain}` : `@${this.username()}`;\n  }\n\n  subscribeToChanges(): void {\n    this.availability.subscribe(() => amplify.publish(WebAppEvents.USER.PERSIST, this));\n  }\n\n  addClient(new_client_et: ClientEntity): boolean {\n    for (const client_et of this.devices()) {\n      if (client_et.id === new_client_et.id) {\n        return false;\n      }\n    }\n\n    this.devices.push(new_client_et);\n\n    if (this.isMe) {\n      this.devices.sort((client_a, client_b) => new Date(client_b.time).getTime() - new Date(client_a.time).getTime());\n    }\n\n    return true;\n  }\n\n  hasActivatedIdentity(): boolean {\n    return !!this.email() || !!this.phone() || this.isSingleSignOn;\n  }\n\n  removeClient(client_id: string): ClientEntity[] {\n    return this.devices.remove(client_et => client_et.id === client_id);\n  }\n\n  serialize() {\n    return {\n      availability: this.availability(),\n      domain: this.domain,\n      id: this.id,\n    };\n  }\n\n  setGuestExpiration(timestamp: number): void {\n    if (this.expirationIntervalId) {\n      window.clearInterval(this.expirationIntervalId);\n      this.expirationIntervalId = undefined;\n    }\n\n    this._setRemainingExpirationTime(timestamp);\n\n    const expirationInterval = User.CONFIG.TEMPORARY_GUEST.EXPIRATION_INTERVAL;\n    this.expirationIntervalId = window.setInterval(\n      () => this._setRemainingExpirationTime(timestamp),\n      expirationInterval,\n    );\n\n    window.setTimeout(() => {\n      this.isExpired(true);\n      window.clearInterval(this.expirationIntervalId);\n    }, this.expirationRemaining());\n  }\n\n  clearExpirationTimeout(): void {\n    if (this.expirationTimeoutId) {\n      window.clearTimeout(this.expirationTimeoutId);\n      this.expirationTimeoutId = undefined;\n    }\n  }\n\n  checkGuestExpiration(): void {\n    const checkExpiration = this.isTemporaryGuest() && !this.expirationTimeoutId;\n    if (checkExpiration) {\n      if (this.isExpired()) {\n        amplify.publish(WebAppEvents.USER.UPDATE, this.qualifiedId);\n        return;\n      }\n\n      const timeout = this.expirationRemaining() + User.CONFIG.TEMPORARY_GUEST.EXPIRATION_THRESHOLD;\n      this.expirationTimeoutId = window.setTimeout(\n        () => amplify.publish(WebAppEvents.USER.UPDATE, this.qualifiedId),\n        timeout,\n      );\n    }\n  }\n\n  private _setRemainingExpirationTime(expirationTime: number): void {\n    const remainingTime = clamp(expirationTime - Date.now(), 0, User.CONFIG.TEMPORARY_GUEST.LIFETIME);\n    const remainingMinutes = Math.ceil(remainingTime / TIME_IN_MILLIS.MINUTE);\n\n    if (remainingMinutes <= 45) {\n      const remainingQuarters = Math.max(1, Math.ceil(remainingMinutes / 15));\n      const timeValue = remainingQuarters * 15;\n      this.expirationText(t('userRemainingTimeMinutes', timeValue));\n      this.expirationRemaining(timeValue * TIME_IN_MILLIS.MINUTE);\n      this.expirationRemainingText(`${timeValue}m`);\n    } else {\n      const showOneAndAHalf = remainingMinutes > 60 && remainingMinutes <= 90;\n      const timeValue = showOneAndAHalf ? 1.5 : Math.ceil(remainingMinutes / 60);\n      this.expirationText(t('userRemainingTimeHours', timeValue));\n      this.expirationRemaining(timeValue * TIME_IN_MILLIS.HOUR);\n      this.expirationRemainingText(`${timeValue}h`);\n    }\n\n    this.expirationIsUrgent(remainingMinutes < 120);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {FileAsset} from './FileAsset';\nimport type {Location as LocationAsset} from './Location';\nimport type {MediumImage as MediumImageAsset} from './MediumImage';\nimport type {Text as TextAsset} from './Text';\n\nimport {AssetType} from '../../assets/AssetType';\n\nexport interface AssetPayload {\n  id: string;\n  key: string;\n  size: string;\n  type: string;\n}\n\nexport class Asset {\n  public file_type?: string;\n  public file_name?: string;\n  public id?: string;\n  public key: string;\n  public size: string;\n  public type: string;\n  public text: string;\n\n  constructor(id?: string) {\n    this.id = id;\n    this.key = '';\n    this.type = '';\n    this.text = '';\n  }\n\n  isDownloadable(): boolean {\n    return this.isAudio() || this.isFile() || this.isVideo() || this.isImage();\n  }\n\n  isImage(): this is MediumImageAsset {\n    return this.type === AssetType.IMAGE;\n  }\n\n  isText(): this is TextAsset {\n    return this.type === AssetType.TEXT;\n  }\n\n  isFile(): this is FileAsset {\n    return this.type === AssetType.FILE && !this.isVideo() && !this.isAudio();\n  }\n\n  isLocation(): this is LocationAsset {\n    return this.type === AssetType.LOCATION;\n  }\n\n  isVideo(): boolean {\n    const is_video_asset = this.type === AssetType.FILE && this.file_type?.startsWith('video');\n    if (is_video_asset) {\n      const can_play = document.createElement('video').canPlayType(this.file_type);\n      if (can_play !== '') {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  isAudio(): boolean {\n    const is_audio_asset = this.type === AssetType.FILE && this.file_type?.startsWith('audio');\n    if (is_audio_asset) {\n      const can_play = document.createElement('audio').canPlayType(this.file_type);\n      if (can_play !== '') {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  isButton(): boolean {\n    return this.type === AssetType.BUTTON;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Asset} from './Asset';\n\nimport {AssetType} from '../../assets/AssetType';\n\nexport class Button extends Asset {\n  public readonly text: string;\n\n  constructor(id?: string, text: string = '') {\n    super(id);\n    this.type = AssetType.BUTTON;\n\n    this.text = text;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {ContentMessage} from './ContentMessage';\n\nexport class CompositeMessage extends ContentMessage {\n  errorButtonId: ko.Observable<string | undefined>;\n  errorMessage: ko.Observable<string>;\n  selectedButtonId: ko.Observable<string | undefined>;\n  waitingButtonId: ko.Observable<string | undefined>;\n\n  constructor(id?: string) {\n    super(id);\n    this.selectedButtonId = ko.observable();\n    this.waitingButtonId = ko.observable();\n    this.errorButtonId = ko.observable();\n    this.errorMessage = ko.observable('');\n  }\n\n  getSelectionChange(buttonId: string): false | {selected_button_id: string; version: number} {\n    this.waitingButtonId(undefined);\n    if (this.selectedButtonId() === buttonId) {\n      return false;\n    }\n    this.selectedButtonId(buttonId);\n    return {selected_button_id: buttonId, version: this.version + 1};\n  }\n\n  setButtonError(buttonId: string, errorMessage: string): void {\n    this.errorButtonId(buttonId);\n    this.errorMessage(errorMessage);\n  }\n\n  clearButtonError(): void {\n    this.errorButtonId(undefined);\n    this.errorMessage('');\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport type {ReactionType} from '@wireapp/core/lib/conversation/ReactionType';\nimport ko from 'knockout';\n\nimport {copyText} from 'Util/ClipboardUtil';\nimport {t} from 'Util/LocalizerUtil';\nimport {formatLocale, formatTimeShort} from 'Util/TimeUtil';\n\nimport type {Asset} from './Asset';\nimport type {FileAsset} from './FileAsset';\nimport type {MediumImage} from './MediumImage';\nimport {Message} from './Message';\nimport {Text as TextAsset} from './Text';\n\nimport {AssetRepository} from '../../assets/AssetRepository';\nimport type {QuoteEntity} from '../../message/QuoteEntity';\nimport {SuperType} from '../../message/SuperType';\nimport {UserReactionMap} from '../../storage';\nimport {User} from '../User';\n\nexport class ContentMessage extends Message {\n  private readonly isLikedProvisional: ko.Observable<boolean>;\n  public readonly reactions_user_ets: ko.ObservableArray<User>;\n  public readonly assets: ko.ObservableArray<Asset | FileAsset | TextAsset | MediumImage>;\n  public readonly is_liked: ko.PureComputed<boolean>;\n  public readonly like_caption: ko.PureComputed<string>;\n  public readonly other_likes: ko.PureComputed<User[]>;\n  public readonly quote: ko.Observable<QuoteEntity>;\n  // TODO: Rename to `reactionsUsers`\n  public readonly reactions_user_ids: ko.PureComputed<string>;\n  public readonly was_edited: ko.PureComputed<boolean>;\n  public replacing_message_id: null | string;\n  readonly edited_timestamp: ko.Observable<number>;\n  // TODO(Federation): Make reactions federation-aware.\n  readonly reactions: ko.Observable<UserReactionMap>;\n\n  constructor(id?: string) {\n    super(id);\n\n    this.assets = ko.observableArray([]);\n    this.super_type = SuperType.CONTENT;\n    this.replacing_message_id = null;\n    this.edited_timestamp = ko.observable(null);\n\n    this.was_edited = ko.pureComputed(() => !!this.edited_timestamp());\n\n    this.reactions = ko.observable({});\n    this.reactions_user_ets = ko.observableArray();\n    this.reactions_user_ids = ko.pureComputed(() => {\n      return this.reactions_user_ets()\n        .map(user_et => user_et.name())\n        .join(', ');\n    });\n\n    this.quote = ko.observable();\n    this.readReceipts = ko.observableArray([]);\n\n    this.isLikedProvisional = ko.observable(null);\n    this.is_liked = ko.pureComputed({\n      read: () => {\n        const isLikedProvisional = this.isLikedProvisional();\n        const reactionsUserEts = this.reactions_user_ets();\n        if (isLikedProvisional !== null) {\n          this.isLikedProvisional(null);\n          return isLikedProvisional;\n        }\n        return reactionsUserEts.some(user => user.isMe);\n      },\n      write: value => {\n        return this.isLikedProvisional(value);\n      },\n    });\n    this.other_likes = ko.pureComputed(() => this.reactions_user_ets().filter(user_et => !user_et.isMe));\n\n    this.like_caption = ko.pureComputed(() => {\n      const maxShownNames = 2;\n      if (this.reactions_user_ets().length <= maxShownNames) {\n        return this.reactions_user_ets()\n          .map(user => user.name())\n          .join(', ');\n      }\n      return t('conversationLikesCaption', this.reactions_user_ets().length);\n    });\n  }\n\n  readonly displayEditedTimestamp = () => {\n    return t('conversationEditTimestamp', formatTimeShort(this.edited_timestamp()));\n  };\n\n  /**\n   * Add another content asset to the message.\n   * @param asset_et New content asset\n   */\n  addAsset(asset_et: Asset): void {\n    this.assets.push(asset_et);\n  }\n\n  copy(): void {\n    copyText((this.getFirstAsset() as TextAsset).text);\n  }\n\n  /**\n   * Get the first asset attached to the message.\n   * @returns The first asset attached to the message\n   */\n  getFirstAsset(): Asset | FileAsset | TextAsset | MediumImage {\n    return this.assets()[0];\n  }\n\n  getUpdatedReactions({\n    data: event_data,\n    from,\n  }: {\n    data: {reaction: ReactionType};\n    from: string;\n  }): false | {reactions: UserReactionMap; version: number} {\n    const reaction = event_data && event_data.reaction;\n    const hasUser = this.reactions()[from];\n    const shouldAdd = reaction && !hasUser;\n    const shouldDelete = !reaction && hasUser;\n\n    if (!shouldAdd && !shouldDelete) {\n      return false;\n    }\n\n    const newReactions = {...this.reactions()};\n\n    if (shouldAdd) {\n      newReactions[from] = reaction;\n    } else {\n      delete newReactions[from];\n    }\n\n    return {reactions: newReactions, version: this.version + 1};\n  }\n\n  /**\n   * @param userId The user id to check\n   * @returns `true` if the message mentions the user, `false` otherwise.\n   */\n  isUserMentioned(userId: QualifiedId): boolean {\n    return this.hasAssetText()\n      ? this.assets().some(assetEntity => assetEntity.isText() && assetEntity.isUserMentioned(userId))\n      : false;\n  }\n\n  /**\n   * @param userId The user id to check\n   * @returns `true` if the message quotes the user, `false` otherwise.\n   */\n  isUserQuoted(userId: string): boolean {\n    return this.quote() ? this.quote().isQuoteFromUser(userId) : false;\n  }\n\n  /**\n   * @param userId The user id to check\n   * @returns `true` if the user was mentioned or quoted, `false` otherwise.\n   */\n  isUserTargeted(userId: QualifiedId): boolean {\n    return userId && (this.isUserMentioned(userId) || this.isUserQuoted(userId.id));\n  }\n\n  /**\n   * Download message content.\n   */\n  download(assetRepository: AssetRepository): void {\n    const asset_et = this.getFirstAsset() as FileAsset | MediumImage;\n\n    if (typeof (asset_et as MediumImage).resource === 'function') {\n      assetRepository.download((asset_et as MediumImage).resource(), this.getContentName());\n    } else if (typeof (asset_et as FileAsset).original_resource === 'function') {\n      const fileAsset: FileAsset = asset_et;\n      assetRepository.downloadFile(fileAsset);\n    }\n  }\n\n  /**\n   * Get content name.\n   * @returns The content/file name.\n   */\n  getContentName(): string {\n    const asset_et = this.getFirstAsset() as FileAsset;\n    let {file_name} = asset_et;\n\n    if (!file_name) {\n      const date = this.timestamp();\n      file_name = `Wire ${formatLocale(date, 'yyyy-MM-dd')} at ${formatTimeShort(date)}`;\n    }\n\n    if (asset_et.file_type) {\n      const file_extension = asset_et.file_type.split('/').pop();\n      file_name = `${file_name}.${file_extension}`;\n    }\n\n    return file_name;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {MemberLeaveReason} from '@wireapp/api-client/lib/conversation/data/';\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport ko from 'knockout';\n\nimport {Declension, joinNames, replaceLink, t} from 'Util/LocalizerUtil';\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {getUserName} from 'Util/SanitizationUtil';\nimport {capitalizeFirstChar} from 'Util/StringUtil';\n\nimport {SystemMessage} from './SystemMessage';\n\nimport {Config} from '../../Config';\nimport {ClientEvent} from '../../event/Client';\nimport {SuperType} from '../../message/SuperType';\nimport {SystemMessageType} from '../../message/SystemMessageType';\nimport {User} from '../User';\n\nexport class MemberMessage extends SystemMessage {\n  public allTeamMembers: User[];\n  private readonly exceedsMaxVisibleUsers: ko.PureComputed<boolean>;\n  public readonly hasUsers: ko.PureComputed<boolean>;\n  private readonly hiddenUserCount: ko.PureComputed<number>;\n  private readonly joinedUserEntities: ko.PureComputed<User[]>;\n  public readonly name: ko.Observable<string>;\n  public readonly otherUser: ko.PureComputed<User>;\n  private readonly senderName: ko.PureComputed<string>;\n  public readonly showNamedCreation: ko.PureComputed<boolean>;\n  private readonly visibleUsers: ko.Observable<User[]>;\n  public readonly highlightedUsers: ko.PureComputed<User[]>;\n  public readonly htmlCaption: ko.PureComputed<string>;\n  public readonly htmlGroupCreationHeader: ko.PureComputed<string>;\n  public readonly remoteUserEntities: ko.PureComputed<User[]>;\n  public showServicesWarning: boolean;\n  public readonly userEntities: ko.ObservableArray<User>;\n  public readonly userIds: ko.ObservableArray<QualifiedId>;\n  public memberMessageType: SystemMessageType;\n  public reason: MemberLeaveReason;\n\n  static get CONFIG() {\n    return {\n      MAX_USERS_VISIBLE: 17,\n      MAX_WHOLE_TEAM_USERS_VISIBLE: 10,\n      REDUCED_USERS_COUNT: 15,\n    };\n  }\n\n  constructor() {\n    super();\n\n    this.super_type = SuperType.MEMBER;\n    this.memberMessageType = SystemMessageType.NORMAL;\n\n    this.userEntities = ko.observableArray();\n    this.userIds = ko.observableArray();\n    this.name = ko.observable('');\n\n    this.exceedsMaxVisibleUsers = ko.pureComputed(() => {\n      return this.joinedUserEntities().length > MemberMessage.CONFIG.MAX_USERS_VISIBLE;\n    });\n    this.visibleUsers = ko.observable([]);\n    this.hiddenUserCount = ko.pureComputed(() => this.joinedUserEntities().length - this.visibleUsers().length);\n    this.highlightedUsers = ko.pureComputed(() => {\n      return this.type === CONVERSATION_EVENT.MEMBER_JOIN ? this.joinedUserEntities() : [];\n    });\n\n    this.hasUsers = ko.pureComputed(() => !!this.userEntities().length);\n    this.allTeamMembers = undefined;\n    this.showServicesWarning = false;\n\n    // Users joined the conversation without sender\n    this.joinedUserEntities = ko.pureComputed(() => {\n      return this.userEntities().filter(userEntity => !matchQualifiedIds(this.user(), userEntity));\n    });\n\n    this.joinedUserEntities.subscribe(joinedUserEntities => {\n      const selfUser = joinedUserEntities.find(userEntity => userEntity.isMe);\n      const visibleUsers = joinedUserEntities.filter(userEntity => !userEntity.isMe);\n      if (this.exceedsMaxVisibleUsers()) {\n        const spliceCount = MemberMessage.CONFIG.REDUCED_USERS_COUNT;\n        visibleUsers.splice(selfUser ? spliceCount - 1 : spliceCount);\n      }\n      if (selfUser) {\n        visibleUsers.push(selfUser);\n      }\n      this.visibleUsers(visibleUsers);\n    });\n\n    // Users joined the conversation without self\n    this.remoteUserEntities = ko.pureComputed(() => {\n      return this.userEntities().filter(userEntity => !userEntity.isMe);\n    });\n\n    this.senderName = ko.pureComputed(() => {\n      const isTeamMemberLeave = this.type === ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE;\n      return isTeamMemberLeave ? this.name() : getUserName(this.user(), Declension.NOMINATIVE, true);\n    });\n\n    this.showNamedCreation = ko.pureComputed(() => this.isConversationCreate() && this.name().length > 0);\n\n    this.otherUser = ko.pureComputed(() => (this.hasUsers() ? this.userEntities()[0] : new User('', null)));\n\n    this.htmlCaption = ko.pureComputed(() => {\n      if (!this.hasUsers()) {\n        return '';\n      }\n\n      const replaceShowMore = {\n        '/showmore': '</a>',\n        showmore: '<a class=\"message-header-show-more\" data-uie-name=\"do-show-more\">',\n      };\n\n      const count = this.hiddenUserCount();\n      const dativeUsers = this.generateNameString(this.exceedsMaxVisibleUsers(), Declension.DATIVE);\n      const accusativeUsers = this.generateNameString(this.exceedsMaxVisibleUsers(), Declension.ACCUSATIVE);\n      const name = this.senderName();\n\n      switch (this.memberMessageType) {\n        case SystemMessageType.CONNECTION_ACCEPTED:\n        case SystemMessageType.CONNECTION_REQUEST: {\n          if (this.otherUser()) {\n            if (this.otherUser().isBlocked()) {\n              return t('conversationConnectionBlocked');\n            }\n\n            if (this.otherUser().isOutgoingRequest()) {\n              return '';\n            }\n          }\n\n          return t('conversationConnectionAccepted');\n        }\n\n        case SystemMessageType.CONVERSATION_CREATE: {\n          if (this.name().length) {\n            const exceedsMaxTeam = this.joinedUserEntities().length > MemberMessage.CONFIG.MAX_WHOLE_TEAM_USERS_VISIBLE;\n            if (this.allTeamMembers && exceedsMaxTeam) {\n              const guestCount = this.joinedUserEntities().filter(userEntity => userEntity.isGuest()).length;\n              if (!guestCount) {\n                return t('conversationCreateTeam', {}, replaceShowMore);\n              }\n\n              const hasSingleGuest = guestCount === 1;\n              return hasSingleGuest\n                ? t('conversationCreateTeamGuest', {}, replaceShowMore)\n                : t('conversationCreateTeamGuests', guestCount, replaceShowMore);\n            }\n\n            return this.exceedsMaxVisibleUsers()\n              ? t('conversationCreateWithMore', {count: count.toString(), users: dativeUsers}, replaceShowMore)\n              : t('conversationCreateWith', dativeUsers);\n          }\n\n          if (this.user().isMe) {\n            return this.exceedsMaxVisibleUsers()\n              ? t('conversationCreatedYouMore', {count: count.toString(), users: dativeUsers}, replaceShowMore)\n              : t('conversationCreatedYou', dativeUsers);\n          }\n\n          return this.exceedsMaxVisibleUsers()\n            ? t('conversationCreatedMore', {count: count.toString(), name, users: dativeUsers}, replaceShowMore)\n            : t('conversationCreated', {name, users: dativeUsers});\n        }\n\n        case SystemMessageType.CONVERSATION_RESUME: {\n          return t('conversationResume', this.generateNameString(false, Declension.DATIVE));\n        }\n\n        default:\n          break;\n      }\n\n      switch (this.type) {\n        case CONVERSATION_EVENT.MEMBER_JOIN: {\n          const senderJoined = matchQualifiedIds(this.otherUser(), this.user());\n          if (senderJoined) {\n            return this.user().isMe\n              ? t('conversationMemberJoinedSelfYou')\n              : t('conversationMemberJoinedSelf', this.senderName());\n          }\n\n          if (this.user().isMe) {\n            return this.exceedsMaxVisibleUsers()\n              ? t('conversationMemberJoinedYouMore', {count: count.toString(), users: accusativeUsers}, replaceShowMore)\n              : t('conversationMemberJoinedYou', accusativeUsers, replaceShowMore);\n          }\n          return this.exceedsMaxVisibleUsers()\n            ? t(\n                'conversationMemberJoinedMore',\n                {count: count.toString(), name, users: accusativeUsers},\n                replaceShowMore,\n              )\n            : t('conversationMemberJoined', {name, users: accusativeUsers}, replaceShowMore);\n        }\n\n        case CONVERSATION_EVENT.MEMBER_LEAVE: {\n          if (this.reason === MemberLeaveReason.LEGAL_HOLD_POLICY_CONFLICT) {\n            return this.generateLegalHoldLeaveMessage();\n          }\n          const temporaryGuestRemoval = this.otherUser().isMe && this.otherUser().isTemporaryGuest();\n          if (temporaryGuestRemoval) {\n            return t('temporaryGuestLeaveMessage');\n          }\n\n          const senderLeft = matchQualifiedIds(this.otherUser(), this.user());\n          if (senderLeft) {\n            return this.user().isMe ? t('conversationMemberLeftYou') : t('conversationMemberLeft', name);\n          }\n\n          const allUsers = this.generateNameString();\n          return this.user().isMe\n            ? t('conversationMemberRemovedYou', allUsers)\n            : t('conversationMemberRemoved', {name, users: allUsers});\n        }\n\n        case ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE: {\n          return t('conversationTeamLeft', name);\n        }\n\n        default:\n          break;\n      }\n      return '';\n    });\n\n    this.htmlGroupCreationHeader = ko.pureComputed(() => {\n      if (this.showNamedCreation()) {\n        if (this.user().isTemporaryGuest()) {\n          return t('conversationCreateTemporary');\n        }\n\n        const groupCreationString = this.user().isMe\n          ? t('conversationCreatedNameYou')\n          : t('conversationCreatedName', this.senderName());\n        return capitalizeFirstChar(groupCreationString);\n      }\n      return '';\n    });\n  }\n\n  private readonly generateLegalHoldLeaveMessage = () => {\n    const replaceLinkLegalHold = replaceLink(\n      Config.getConfig().URL.SUPPORT.LEGAL_HOLD_BLOCK,\n      '',\n      'read-more-legal-hold',\n    );\n    if (this.userEntities().some(user => user.isMe)) {\n      return t('conversationYouRemovedMissingLegalHoldConsent', {}, replaceLinkLegalHold);\n    }\n    const users = this.generateNameString(this.exceedsMaxVisibleUsers());\n\n    if (this.userEntities().length === 1) {\n      return t('conversationMemberRemovedMissingLegalHoldConsent', users, replaceLinkLegalHold);\n    }\n    if (this.exceedsMaxVisibleUsers()) {\n      return t(\n        'conversationMultipleMembersRemovedMissingLegalHoldConsentMore',\n        {\n          count: this.hiddenUserCount().toString(10),\n          users,\n        },\n        replaceLinkLegalHold,\n      );\n    }\n    return t('conversationMultipleMembersRemovedMissingLegalHoldConsent', users, replaceLinkLegalHold);\n  };\n\n  readonly showLargeAvatar = (): boolean => {\n    const largeAvatarTypes = [SystemMessageType.CONNECTION_ACCEPTED, SystemMessageType.CONNECTION_REQUEST];\n    return largeAvatarTypes.includes(this.memberMessageType);\n  };\n\n  private generateNameString(skipAnd = false, declension = Declension.ACCUSATIVE): string {\n    return joinNames(this.visibleUsers(), declension, skipAnd, true);\n  }\n\n  isConnection(): boolean {\n    const connectionMessageTypes = [SystemMessageType.CONNECTION_ACCEPTED, SystemMessageType.CONNECTION_REQUEST];\n    return connectionMessageTypes.includes(this.memberMessageType);\n  }\n\n  isConnectionRequest(): boolean {\n    return this.memberMessageType === SystemMessageType.CONNECTION_REQUEST;\n  }\n\n  isCreation(): boolean {\n    return [\n      SystemMessageType.CONNECTION_ACCEPTED,\n      SystemMessageType.CONNECTION_REQUEST,\n      SystemMessageType.CONVERSATION_CREATE,\n      SystemMessageType.CONVERSATION_RESUME,\n    ].includes(this.memberMessageType);\n  }\n\n  isConversationCreate(): boolean {\n    return this.memberMessageType === SystemMessageType.CONVERSATION_CREATE;\n  }\n\n  isConversationResume(): boolean {\n    return this.memberMessageType === SystemMessageType.CONVERSATION_RESUME;\n  }\n\n  isGroupCreation(): boolean {\n    return this.isConversationCreate() || this.isConversationResume();\n  }\n\n  isMemberChange(): boolean {\n    return this.isMemberJoin() || this.isMemberLeave() || this.isTeamMemberLeave();\n  }\n\n  isMemberJoin(): boolean {\n    return this.type === CONVERSATION_EVENT.MEMBER_JOIN;\n  }\n\n  isMemberLeave(): boolean {\n    return this.type === CONVERSATION_EVENT.MEMBER_LEAVE;\n  }\n\n  isTeamMemberLeave(): boolean {\n    return this.type === ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE;\n  }\n\n  isMemberRemoval(): boolean {\n    return this.isMemberLeave() || this.isTeamMemberLeave();\n  }\n\n  isUserAffected(userId: QualifiedId): boolean {\n    return !!this.userIds().find(user => matchQualifiedIds(user, userId));\n  }\n\n  guestCount(): number {\n    return this.joinedUserEntities().filter(user => user.isGuest()).length;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport type {ReactionType} from '@wireapp/core/lib/conversation/';\nimport ko from 'knockout';\n\nimport type {LegalHoldStatus} from '@wireapp/protocol-messaging';\n\nimport {t} from 'Util/LocalizerUtil';\nimport {getUserName} from 'Util/SanitizationUtil';\nimport {formatDateNumeral, formatDurationCaption, formatTimeShort, fromUnixTime, TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nimport {CallingTimeoutMessage} from './CallingTimeoutMessage';\nimport type {CallMessage} from './CallMessage';\nimport type {CompositeMessage} from './CompositeMessage';\nimport type {ContentMessage} from './ContentMessage';\nimport type {DecryptErrorMessage} from './DecryptErrorMessage';\nimport {DeleteMessage} from './DeleteMessage';\nimport type {FileAsset} from './FileAsset';\nimport {FileTypeRestrictedMessage} from './FileTypeRestrictedMessage';\nimport type {LegalHoldMessage} from './LegalHoldMessage';\nimport type {LinkPreview} from './LinkPreview';\nimport type {MemberMessage} from './MemberMessage';\nimport {MissedMessage} from './MissedMessage';\nimport type {PingMessage} from './PingMessage';\nimport type {SystemMessage} from './SystemMessage';\nimport type {VerificationMessage} from './VerificationMessage';\n\nimport {AssetTransferState} from '../../assets/AssetTransferState';\nimport {AssetType} from '../../assets/AssetType';\nimport {EphemeralStatusType} from '../../message/EphemeralStatusType';\nimport type {MessageCategory} from '../../message/MessageCategory';\nimport {StatusType} from '../../message/StatusType';\nimport {SuperType} from '../../message/SuperType';\nimport type {ReadReceipt} from '../../storage/record/EventRecord';\nimport {User} from '../User';\n\nexport class Message {\n  private messageTimerStarted: boolean;\n  protected readonly affect_order: ko.Observable<boolean>;\n  public category?: MessageCategory;\n  public conversation_id: string;\n  public from: string;\n  // TODO(Federation): Map domain to Message entity\n  public fromDomain?: string;\n  public fromClientId: string;\n  public id: string;\n  public primary_key?: string;\n  public reaction: ReactionType;\n  public readonly accent_color: ko.PureComputed<string>;\n  public readonly ephemeral_caption: ko.PureComputed<string>;\n  public readonly ephemeral_expires: ko.Observable<boolean | number | string>;\n  public readonly ephemeral_remaining: ko.Observable<number>;\n  public readonly ephemeral_started: ko.Observable<number>;\n  public readonly ephemeral_status: ko.Computed<EphemeralStatusType>;\n  public expectsReadConfirmation: boolean;\n  public readonly headerSenderName: ko.PureComputed<string>;\n  public readonly isObfuscated: ko.PureComputed<boolean>;\n  public legalHoldStatus?: LegalHoldStatus;\n  public readonly status: ko.Observable<StatusType>;\n  public readonly timestamp_affects_order: ko.PureComputed<boolean>;\n  public readonly timestamp: ko.Observable<number>;\n  public readonly unsafeSenderName: ko.PureComputed<string>;\n  public readonly user: ko.Observable<User>;\n  public readonly visible: ko.Observable<boolean>;\n  public readReceipts: ko.ObservableArray<ReadReceipt>;\n  public super_type: SuperType;\n  public type: string;\n  public version: number;\n\n  /**\n   * Sort messages by timestamp\n   * @param message_ets Message entities\n   * @returns Sorted message entities\n   */\n  static sortByTimestamp(message_ets: Message[]): Message[] {\n    return message_ets.sort((m1, m2) => m1.timestamp() - m2.timestamp());\n  }\n\n  constructor(id: string = '0', super_type?: SuperType) {\n    this.id = id;\n    this.super_type = super_type;\n    this.ephemeral_caption = ko.pureComputed(() => {\n      const remainingTime = this.ephemeral_remaining();\n      return remainingTime ? `${formatDurationCaption(remainingTime)} ${t('ephemeralRemaining')}` : '';\n    });\n    this.ephemeral_remaining = ko.observable(0);\n    this.ephemeral_expires = ko.observable(false);\n    this.ephemeral_started = ko.observable(0);\n    this.ephemeral_status = ko.computed(() => {\n      const isExpired = this.ephemeral_expires() === true;\n      if (isExpired) {\n        return EphemeralStatusType.TIMED_OUT;\n      }\n\n      if (typeof this.ephemeral_expires() === 'number') {\n        return EphemeralStatusType.INACTIVE;\n      }\n\n      if (typeof this.ephemeral_expires() === 'string') {\n        const isExpiring = Date.now() >= this.ephemeral_expires();\n        return isExpiring ? EphemeralStatusType.TIMED_OUT : EphemeralStatusType.ACTIVE;\n      }\n\n      return EphemeralStatusType.NONE;\n    });\n\n    this.isObfuscated = ko.pureComputed(() => {\n      const messageIsAtLeastSent = this.status() > StatusType.SENDING;\n      const isEphemeralInactive = this.ephemeral_status() === EphemeralStatusType.INACTIVE;\n      return messageIsAtLeastSent && (isEphemeralInactive || this.isExpired());\n    });\n\n    this.readReceipts = ko.observableArray([]);\n\n    this.conversation_id = '';\n    this.expectsReadConfirmation = false;\n    this.from = '';\n    this.fromClientId = '';\n    this.legalHoldStatus = undefined;\n    this.primary_key = undefined;\n    this.status = ko.observable(StatusType.UNSPECIFIED);\n    this.type = '';\n    this.user = ko.observable(new User('', null));\n    this.version = 1;\n    this.visible = ko.observable(true);\n\n    this.affect_order = ko.observable(true);\n    this.timestamp = ko.observable(Date.now());\n    this.timestamp_affects_order = ko.pureComputed(() => this.visible() && this.affect_order());\n\n    // MessageCategory\n    this.category = undefined;\n\n    this.unsafeSenderName = ko.pureComputed(() => getUserName(this.user(), undefined, true));\n    this.headerSenderName = ko.pureComputed(() => {\n      return this.user().name();\n    });\n\n    this.accent_color = ko.pureComputed(() => `accent-color-${this.user().accent_id()}`);\n  }\n\n  public get qualifiedFrom(): QualifiedId {\n    return {domain: this.fromDomain || '', id: this.from};\n  }\n\n  readonly displayTimestampShort = (): string => {\n    const date = fromUnixTime(this.timestamp() / TIME_IN_MILLIS.SECOND);\n    return formatTimeShort(date);\n  };\n\n  readonly displayTimestampLong = (): string => {\n    const date = fromUnixTime(this.timestamp() / TIME_IN_MILLIS.SECOND);\n    return formatDateNumeral(date);\n  };\n\n  readonly equals = (messageEntity?: Message) => (messageEntity && this.id ? this.id === messageEntity.id : false);\n\n  /**\n   * Check if message contains an asset of type file.\n   * @returns Message contains any file type asset\n   */\n  hasAsset(): boolean {\n    return this.isContent() ? this.assets().some(assetEntity => assetEntity.type === AssetType.FILE) : false;\n  }\n\n  /**\n   * Check if message contains a file asset.\n   * @returns Message contains a file\n   */\n  hasAssetFile(): boolean {\n    return this.isContent() ? this.assets().some(assetEntity => assetEntity.isFile()) : false;\n  }\n\n  /**\n   * Check if message contains any image asset.\n   * @returns Message contains any image\n   */\n  hasAssetImage(): boolean {\n    return this.isContent() ? this.assets().some(assetEntity => assetEntity.isImage()) : false;\n  }\n\n  /**\n   * Check if message contains a location asset.\n   * @returns Message contains a location\n   */\n  hasAssetLocation(): boolean {\n    return this.isContent() ? this.assets().some(assetEntity => assetEntity.isLocation()) : false;\n  }\n\n  /**\n   * Check if message contains a text asset.\n   * @returns Message contains text\n   */\n  hasAssetText(): boolean {\n    return this.isContent() ? this.assets().some(assetEntity => assetEntity.isText()) : false;\n  }\n\n  /**\n   * Check if message is a call message.\n   * @returns Is message of type call\n   */\n  isCall(): this is CallMessage {\n    return this.super_type === SuperType.CALL;\n  }\n\n  /**\n   * Check if message is a content message.\n   * @returns Is message of type content\n   */\n  isContent(): this is ContentMessage {\n    return this.super_type === SuperType.CONTENT;\n  }\n\n  isComposite(): this is CompositeMessage {\n    return this.isContent() && this.hasOwnProperty('selectedButtonId');\n  }\n\n  /**\n   * Check if message can be deleted.\n   * @returns `true`, if message is deletable, `false` otherwise.\n   */\n  isDeletable(): boolean {\n    return !this.hasUnavailableAsset(false) && !this.isComposite() && this.status() !== StatusType.SENDING;\n  }\n\n  /**\n   * Check if the message content can be downloaded.\n   * @returns `true`, if the message has downloadable content, `false` otherwise.\n   */\n  isDownloadable(): this is ContentMessage {\n    const isExpiredEphemeral = this.ephemeral_status() === EphemeralStatusType.TIMED_OUT;\n    if (isExpiredEphemeral) {\n      return false;\n    }\n\n    if (this.hasUnavailableAsset()) {\n      return false;\n    }\n\n    if (this.isContent()) {\n      const assetEntity = this.getFirstAsset();\n\n      if (assetEntity && typeof (assetEntity as FileAsset).original_resource === 'function') {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  isEdited(): boolean {\n    return this.isContent() && this.was_edited();\n  }\n\n  isLinkPreview(): this is LinkPreview {\n    return (\n      this.hasAssetText() &&\n      (this as unknown as ContentMessage)\n        .assets()\n        .some(assetEntity => assetEntity.isText() && assetEntity.previews().length)\n    );\n  }\n\n  /**\n   * Check if message is a member message.\n   * @returns Is message of type member\n   */\n  isMember(): this is MemberMessage {\n    return this.super_type === SuperType.MEMBER;\n  }\n\n  /**\n   * Check if message is a ping message.\n   * @returns Is message of type ping\n   */\n  isPing(): this is PingMessage {\n    return this.super_type === SuperType.PING;\n  }\n\n  /**\n   * Check if message is a system message.\n   * @returns Is message of type system\n   */\n  isSystem(): this is SystemMessage {\n    return this.super_type === SuperType.SYSTEM;\n  }\n\n  isFileTypeRestricted(): this is FileTypeRestrictedMessage {\n    return this.super_type === SuperType.FILE_TYPE_RESTRICTED;\n  }\n\n  isDelete(): this is DeleteMessage {\n    return this.super_type === SuperType.DELETE;\n  }\n\n  isMissed(): this is MissedMessage {\n    return this.super_type === SuperType.MISSED;\n  }\n\n  isCallTimeout(): this is CallingTimeoutMessage {\n    return this.super_type === SuperType.CALL_TIME_OUT;\n  }\n\n  /**\n   * Check if message is an undecryptable message.\n   * @returns Is message unable to decrypt\n   */\n  isUnableToDecrypt(): this is DecryptErrorMessage {\n    return this.super_type === SuperType.UNABLE_TO_DECRYPT;\n  }\n\n  /**\n   * Check if message is a verification message.\n   * @returns Is message of type verification\n   */\n  isVerification(): this is VerificationMessage {\n    return this.super_type === SuperType.VERIFICATION;\n  }\n\n  isLegalHold(): this is LegalHoldMessage {\n    return this.super_type === SuperType.LEGALHOLD;\n  }\n\n  /**\n   * Check if message can be copied.\n   * @returns `true`, if message can be copied, `false` otherwise.\n   */\n\n  isCopyable(): this is ContentMessage {\n    return this.hasAssetText() && !this.isComposite() && (!this.isEphemeral() || this.user().isMe);\n  }\n\n  /**\n   * Check if message can be edited.\n   * @returns `true`, if message can be edited, `false` otherwise.\n   */\n  isEditable(): boolean {\n    return this.hasAssetText() && this.user().isMe && !this.isEphemeral();\n  }\n\n  /**\n   * Check if message is ephemeral.\n   * @returns `true`, if message is ephemeral, `false` otherwise.\n   */\n  isEphemeral(): boolean {\n    return this.ephemeral_expires() !== false;\n  }\n\n  /**\n   * Check if ephemeral message is expired.\n   * @returns `true`, if message expired, `false` otherwise.\n   */\n  readonly isExpired = (): boolean => this.ephemeral_expires() === true;\n\n  /**\n   * Check if message has an unavailable (uploading or failed) asset.\n   * @returns `true`, if an asset is unavailable, `false` otherwise.\n   */\n  hasUnavailableAsset(includeFailedState = true): boolean {\n    if (this.hasAsset()) {\n      return (this as unknown as ContentMessage).assets().some(asset => {\n        const unavailableStatus = [AssetTransferState.UPLOAD_PENDING, AssetTransferState.UPLOADING];\n        if (includeFailedState) {\n          unavailableStatus.push(AssetTransferState.UPLOAD_FAILED);\n        }\n        const assetStatus = (asset as FileAsset).status();\n        return unavailableStatus.includes(assetStatus);\n      });\n    }\n    return false;\n  }\n\n  /**\n   * Check if message can be reacted to.\n   * @returns `true`, if message type supports reactions, `false` otherwise.\n   */\n  isReactable(): this is ContentMessage {\n    return (\n      this.isContent() &&\n      !this.isComposite() &&\n      !this.isEphemeral() &&\n      this.status() !== StatusType.SENDING &&\n      !this.hasUnavailableAsset()\n    );\n  }\n\n  /**\n   * Check if message can be replied to.\n   * @returns `true`, if message type supports replies, `false` otherwise.\n   */\n  isReplyable(): boolean {\n    return (\n      this.isContent() &&\n      !this.isComposite() &&\n      !this.isEphemeral() &&\n      this.status() !== StatusType.SENDING &&\n      !this.hasUnavailableAsset()\n    );\n  }\n\n  /** Start the ephemeral timer for the message. */\n  readonly startMessageTimer = (timeOffset: number): void => {\n    if (this.messageTimerStarted) {\n      return;\n    }\n\n    if (this.ephemeral_status() === EphemeralStatusType.INACTIVE) {\n      const startingTimestamp = this.user().isMe ? Math.min(this.timestamp() + timeOffset, Date.now()) : Date.now();\n      const expirationTimestamp = `${startingTimestamp + Number(this.ephemeral_expires())}`;\n      this.ephemeral_expires(expirationTimestamp);\n      this.ephemeral_started(startingTimestamp);\n    }\n\n    const remainingTime = Number(this.ephemeral_expires()) - this.ephemeral_started();\n    this.ephemeral_remaining(remainingTime);\n    this.messageTimerStarted = true;\n  };\n\n  /**\n   * Update the status of a message.\n   * @param updated_status New status of message\n   * @returns Returns the new status on a successful update, `false` otherwise\n   */\n  updateStatus(updated_status: StatusType): StatusType | false {\n    if (this.status() >= StatusType.SENT) {\n      if (updated_status > this.status()) {\n        return this.status(updated_status);\n      }\n    } else if (this.status() !== updated_status) {\n      return this.status(updated_status);\n    }\n    return false;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\n\nimport {Message} from './Message';\n\nimport {SuperType} from '../../message/SuperType';\nimport {SystemMessageType} from '../../message/SystemMessageType';\n\nexport class SystemMessage extends Message {\n  public caption: ko.PureComputed<string>;\n  public system_message_type: SystemMessageType;\n\n  constructor() {\n    super();\n    this.super_type = SuperType.SYSTEM;\n    this.system_message_type = SystemMessageType.NORMAL;\n  }\n\n  isConversationRename(): boolean {\n    return this.system_message_type === SystemMessageType.CONVERSATION_RENAME;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {formatString} from 'Util/StringUtil';\n\ninterface IFrameOptions {\n  allowfullscreen: string;\n  class: string;\n  frameborder: string;\n  height: string;\n  src?: string;\n  type: string;\n  video: boolean;\n  width: string;\n}\n\n/**\n * Create an iFrame.\n * @param options Settings to be used to create the iFrame\n * @returns HTML string\n */\nconst _createIFrameContainer = (options?: Partial<IFrameOptions>): string => {\n  const defaults = {\n    allowfullscreen: ' allowfullscreen',\n    class: 'iframe-container iframe-container-video',\n    frameborder: '0',\n    height: '100%',\n    type: 'default',\n    video: true,\n    width: '100%',\n  };\n\n  options = {...defaults, ...options};\n  const iFrameContainer = `<div class=\"{0}\"><iframe class=\"${options.type}\" width=\"{1}\" height=\"{2}\" src=\"{3}\" frameborder=\"{4}\"{5}></iframe></div>`;\n\n  if (!options.video) {\n    options.allowfullscreen = '';\n    options.class = 'iframe-container';\n  }\n\n  if (Runtime.isDesktopApp()) {\n    options.allowfullscreen = '';\n  }\n\n  return formatString(\n    iFrameContainer,\n    options.class,\n    options.width,\n    options.height,\n    options.src,\n    options.frameborder,\n    options.allowfullscreen,\n  );\n};\n\n/**\n * Appends an iFrame.\n *\n * @param link Link element\n * @param message Message containing the link\n * @param iFrame HTML text of the iFrame\n * @returns Message content\n */\nconst _appendIFrame = (link: HTMLAnchorElement, message: string, iFrame: string): string => {\n  const linkString = link.outerHTML.replace(/&amp;/g, '&');\n  return message.replace(/&amp;/g, '&').replace(linkString, `${linkString}${iFrame}`);\n};\n\n/**\n * Find search parameters in a string\n *\n * @param params String where we should find the parameters\n */\nconst _getParameters = (params: string): string => params.slice(params.indexOf('?')).replace(/^\\?/, '');\n\n/**\n * Generate embedded YouTube URL to use as source in iFrames\n *\n * @param url Given YouTube URL\n * @returns YouTube embed URL\n */\nconst generateYouTubeEmbedUrl = (url: string): string | void => {\n  if (url.match(MediaEmbeds.regex.youtube)) {\n    const videoId = url.match(/(?:embed\\/|v=|v\\/|be\\/)([a-zA-Z0-9_-]{11})/);\n    if (!videoId) {\n      return;\n    }\n\n    // Extract params from the URL\n    const parser = document.createElement('a');\n    parser.href = url;\n    const searchParams = new URLSearchParams([_getParameters(parser.search), _getParameters(parser.hash)].join('&'));\n\n    // Append HTML5 parameter to YouTube src to force HTML5 mode\n    // This fixes the issue that FF displays black box in some cases\n    searchParams.set('html5', '1');\n\n    searchParams.set('enablejsapi', '0');\n    searchParams.set('modestbranding', '1');\n\n    // Do not get related videos at the end\n    searchParams.set('rel', '0');\n\n    // Convert the timestamp into an embed friendly format (start=seconds)\n    if (searchParams.has('t')) {\n      searchParams.set('start', convertYouTubeTimestampToSeconds(searchParams.get('t')).toString());\n      searchParams.delete('t');\n    }\n\n    // Remove some parameters\n    searchParams.delete('autoplay');\n    searchParams.delete('v');\n    searchParams.delete('widget_referrer');\n    searchParams.delete('showinfo');\n\n    return `https://www.youtube-nocookie.com/embed/${videoId[1]}?${searchParams.toString()}`;\n  }\n};\n\n/**\n * Converts YouTube timestamp into seconds\n *\n * @param timestamp YouTube timestamp (e.g. \"1h8m55s\")\n * @returns Timestamp in seconds\n */\nconst convertYouTubeTimestampToSeconds = (timestamp: string): number => {\n  if (timestamp) {\n    if (/^[0-9]*$/.test(timestamp)) {\n      return parseInt(timestamp, 10);\n    }\n\n    const _extractUnit = (unit: 'h' | 'm' | 's'): number => {\n      const extracted = (timestamp.match(new RegExp(`([0-9]+)(?=${unit})`)) || ['0'])[0];\n      return parseInt(extracted, 10);\n    };\n\n    return _extractUnit('h') * 3600 + _extractUnit('m') * 60 + _extractUnit('s');\n  }\n  return 0;\n};\n\n// Make public for testability.\nexport const MediaEmbeds = {\n  convertYouTubeTimestampToSeconds,\n  generateYouTubeEmbedUrl,\n  regex: {\n    // example: http://regexr.com/3ase5\n    soundcloud: /(https?:\\/\\/(?:www\\.|m\\.)?)?soundcloud\\.com(\\/[\\w-]+){2,3}/g,\n    spotify: /https?:\\/\\/(?:play\\.|open\\.)*spotify\\.com\\/([^?]+)/g,\n    vimeo: /https?:\\/\\/(?:(?:player\\.)?vimeo\\.com\\/)(?:channels(?:\\/[^/]+)?\\/|video\\/)?([0-9]+)/g,\n    youtube:\n      /(?:youtube(?:-nocookie)?\\.com\\/\\S*(?:(?:\\/e(?:mbed))?\\/|watch\\/?\\?(?:\\S*?&?v=))|youtu\\.be\\/)([a-zA-Z0-9_-]{6,11})/g,\n  },\n\n  /**\n   * Appends SoundCloud iFrame if link is a valid SoundCloud source.\n   *\n   * @param link Link element\n   * @param message Message containing the link\n   * @returns Message with appended iFrame\n   */\n  soundcloud(link: HTMLAnchorElement, message: string): string {\n    let linkSrc = link.href;\n\n    if (linkSrc.match(MediaEmbeds.regex.soundcloud)) {\n      linkSrc = linkSrc.replace(/(m\\.)/, '');\n      let linkPathName = link.pathname;\n\n      if (linkPathName.endsWith('/')) {\n        linkPathName = linkPathName.slice(0, -1);\n      }\n\n      let isSingleTrack = false;\n      const slashesInLink = linkPathName.split('/').length;\n\n      if (slashesInLink === 3) {\n        isSingleTrack = true;\n      } else if (slashesInLink > 3 && linkPathName.indexOf('sets') === -1) {\n        // Fix for WEBAPP-1137\n        return message;\n      }\n\n      const height = isSingleTrack ? 164 : 465;\n\n      const iFrame = _createIFrameContainer({\n        height: height.toString(),\n        src: 'https://w.soundcloud.com/player/?url={1}&visual=false&show_comments=false&buying=false&show_playcount=false&liking=false&sharing=false&hide_related=true',\n        type: 'soundcloud',\n        video: false,\n      });\n\n      const embed = formatString(iFrame, height, linkSrc);\n      message = _appendIFrame(link, message, embed);\n    }\n\n    return message;\n  },\n\n  /**\n   * Appends Spotify iFrame if link is a valid Spotify source.\n   *\n   * @param link Link element\n   * @param message Message containing the link\n   * @returns Message with appended iFrame\n   */\n  spotify(link: HTMLAnchorElement, message: string): string {\n    const linkSrc = link.href;\n\n    if (linkSrc.match(MediaEmbeds.regex.spotify)) {\n      const iFrame = _createIFrameContainer({\n        height: '80px',\n        src: 'https://embed.spotify.com/?uri=spotify$1',\n        type: 'spotify',\n        video: false,\n      });\n\n      // convert spotify uri: album/23... -> album:23... -> album%3A23...\n      let embed = '';\n      linkSrc.replace(MediaEmbeds.regex.spotify, (match, group1) => {\n        const replaceSlashes = group1.replace(/\\//g, ':');\n        const encodedParams = encodeURIComponent(`:${replaceSlashes}`);\n        return (embed = iFrame.replace('$1', encodedParams));\n      });\n\n      message = _appendIFrame(link, message, embed);\n    }\n\n    return message;\n  },\n\n  /**\n   * Appends Vimeo iFrame if link is a valid Vimeo source.\n   *\n   * @param link Link element\n   * @param message Message containing the link\n   * @param themeColor User color\n   * @returns Message with appended iFrame\n   */\n  vimeo(link: HTMLAnchorElement, message: string, themeColor: string): string {\n    const linkSrc = link.href;\n    const vimeoColor = themeColor ? themeColor.replace('#', '') : undefined;\n\n    if (linkSrc.match(MediaEmbeds.regex.vimeo)) {\n      const iFrame = _createIFrameContainer({\n        src: `https://player.vimeo.com/video/$1?portrait=0&color=${vimeoColor}&badge=0`,\n        type: 'vimeo',\n      });\n\n      let embed = '';\n      linkSrc.replace(MediaEmbeds.regex.vimeo, (match, group1) => (embed = iFrame.replace('$1', group1)));\n\n      message = _appendIFrame(link, message, embed);\n    }\n\n    return message;\n  },\n\n  /**\n   * Appends YouTube iFrame if link is a valid YouTube source.\n   *\n   * @param link Link element\n   * @param message Message containing the link\n   * @returns Message with appended iFrame\n   */\n  youtube(link: HTMLAnchorElement, message: string): string {\n    const embedUrl = generateYouTubeEmbedUrl(link.href);\n\n    if (embedUrl) {\n      const iFrame = _createIFrameContainer({\n        src: embedUrl,\n        type: 'youtube',\n      });\n\n      message = _appendIFrame(link, message, iFrame);\n      return message;\n    }\n\n    return message;\n  },\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {WebappProperties} from '@wireapp/api-client/lib/user/data/';\nimport {amplify} from 'amplify';\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {getLinksFromHtml} from 'Util/UrlUtil';\n\nimport {MediaEmbeds} from './MediaEmbeds';\n\nimport {Config} from '../Config';\n\nexport class MediaParser {\n  showEmbed: boolean;\n  embeds: ((link: HTMLAnchorElement, message: string, themeColor: string) => string)[];\n\n  constructor() {\n    this.showEmbed = Config.getConfig().FEATURE.ENABLE_MEDIA_EMBEDS;\n    amplify.subscribe(WebAppEvents.PROPERTIES.UPDATED, ({settings}: WebappProperties) => {\n      this.showEmbed = settings.previews.send && Config.getConfig().FEATURE.ENABLE_MEDIA_EMBEDS;\n    });\n\n    amplify.subscribe(WebAppEvents.PROPERTIES.UPDATE.PREVIEWS.SEND, (value: boolean) => {\n      this.showEmbed = value && Config.getConfig().FEATURE.ENABLE_MEDIA_EMBEDS;\n    });\n\n    this.embeds = [MediaEmbeds.soundcloud, MediaEmbeds.spotify, MediaEmbeds.vimeo, MediaEmbeds.youtube];\n  }\n\n  /**\n   * Render media embeds.\n   * @note Checks message for valid media links and appends an iFrame right after the link\n   *\n   * @param message Message text\n   * @param themeColor Accent color to be applied to the embed\n   * @returns Message with rendered media embeds\n   */\n  readonly renderMediaEmbeds = (message: string, themeColor?: string): string => {\n    if (this.showEmbed) {\n      getLinksFromHtml<HTMLAnchorElement>(message).forEach(link => {\n        this.embeds.forEach(embed => (message = embed(link, message, themeColor)));\n      });\n    }\n    return message;\n  };\n}\n\nexport const mediaParser = new MediaParser();\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport ko from 'knockout';\n\nimport {renderMessage} from 'Util/messageRenderer';\n\nimport {Asset} from './Asset';\nimport type {LinkPreview} from './LinkPreview';\n\nimport {AssetType} from '../../assets/AssetType';\nimport {containsOnlyLink} from '../../conversation/linkPreviews/helpers';\nimport {mediaParser} from '../../media/MediaParser';\nimport type {MentionEntity} from '../../message/MentionEntity';\n\nexport class Text extends Asset {\n  public readonly mentions: ko.ObservableArray<MentionEntity>;\n  public readonly previews: ko.ObservableArray<LinkPreview>;\n  public readonly should_render_text: ko.PureComputed<boolean>;\n  /** Raw message text */\n  public text: string;\n\n  constructor(id?: string, text: string = '') {\n    super(id);\n    this.type = AssetType.TEXT;\n\n    this.text = text;\n    this.mentions = ko.observableArray();\n    this.previews = ko.observableArray();\n\n    this.should_render_text = ko.pureComputed(() => {\n      if (this.text === null || this.text.length === 0) {\n        return false;\n      }\n      const has_link_previews = this.previews().length > 0;\n      return !has_link_previews || (has_link_previews && !containsOnlyLink(this.text));\n    });\n  }\n\n  // Process text before rendering it\n  render(selfId: QualifiedId, themeColor?: string): string {\n    const message = renderMessage(this.text, selfId, this.mentions());\n    return !this.previews().length ? mediaParser.renderMediaEmbeds(message, themeColor) : message;\n  }\n\n  isUserMentioned(userId: QualifiedId): boolean {\n    return this.mentions().some(mentionEntity => mentionEntity.targetsUser(userId));\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError, BASE_ERROR_TYPE} from './BaseError';\n\nenum AUTH_ERROR_TYPE {\n  COOKIES_DISABLED = 'COOKIES_DISABLED',\n  INDEXED_DB_UNSUPPORTED = 'INDEXED_DB_UNSUPPORTED',\n  MULTIPLE_TABS = 'MULTIPLE_TABS',\n  PRIVATE_MODE = 'PRIVATE_MODE',\n}\n\nexport class AuthError extends BaseError {\n  constructor(type: AUTH_ERROR_TYPE | BASE_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<AUTH_ERROR_TYPE, string> {\n    return {\n      COOKIES_DISABLED: 'Cookies are disabled',\n      INDEXED_DB_UNSUPPORTED: 'IndexedDB is not supported',\n      MULTIPLE_TABS: 'Cannot open in multiple tabs simultaneously',\n      PRIVATE_MODE: 'Unsupported Private Mode',\n    };\n  }\n\n  static get TYPE(): Record<AUTH_ERROR_TYPE, AUTH_ERROR_TYPE> {\n    return {\n      COOKIES_DISABLED: AUTH_ERROR_TYPE.COOKIES_DISABLED,\n      INDEXED_DB_UNSUPPORTED: AUTH_ERROR_TYPE.INDEXED_DB_UNSUPPORTED,\n      MULTIPLE_TABS: AUTH_ERROR_TYPE.MULTIPLE_TABS,\n      PRIVATE_MODE: AUTH_ERROR_TYPE.PRIVATE_MODE,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BackendErrorLabel} from '@wireapp/api-client/lib/http/';\n\nimport {BaseError} from './BaseError';\n\nexport class BackendClientError extends BaseError {\n  code: number;\n  label: string;\n\n  constructor(params: {code: number; label?: string; message: string}) {\n    super(BackendClientError.TYPE.GENERIC, params.message);\n    this.code = params.code;\n    this.label = params.label;\n  }\n\n  static get LABEL() {\n    return {\n      ACCESS_DENIED: BackendErrorLabel.ACCESS_DENIED,\n      BAD_GATEWAY: BackendErrorLabel.BAD_GATEWAY,\n      BAD_REQUEST: BackendErrorLabel.BAD_REQUEST,\n      BLACKLISTED_EMAIL: BackendErrorLabel.BLACKLISTED_EMAIL,\n      BLACKLISTED_PHONE: BackendErrorLabel.BLACKLISTED_PHONE,\n      CLIENT_ERROR: BackendErrorLabel.CLIENT_ERROR,\n      DOMAIN_BLOCKED_FOR_REGISTRATION: BackendErrorLabel.DOMAIN_BLOCKED_FOR_REGISTRATION,\n      INVALID_CREDENTIALS: BackendErrorLabel.INVALID_CREDENTIALS,\n      INVALID_EMAIL: BackendErrorLabel.INVALID_EMAIL,\n      INVALID_INVITATION_CODE: BackendErrorLabel.INVALID_INVITATION_CODE,\n      INVALID_PHONE: BackendErrorLabel.INVALID_PHONE,\n      KEY_EXISTS: BackendErrorLabel.KEY_EXISTS,\n      MISSING_AUTH: BackendErrorLabel.MISSING_AUTH,\n      NOT_CONNECTED: BackendErrorLabel.NOT_CONNECTED,\n      NOT_FOUND: BackendErrorLabel.NOT_FOUND,\n      PASSWORD_EXISTS: BackendErrorLabel.PASSWORD_EXISTS,\n      PENDING_ACTIVATION: BackendErrorLabel.PENDING_ACTIVATION,\n      PENDING_LOGIN: BackendErrorLabel.PENDING_LOGIN,\n      SERVER_ERROR: BackendErrorLabel.SERVER_ERROR,\n      SERVICE_DISABLED: BackendErrorLabel.SERVICE_DISABLED,\n      SUSPENDED: BackendErrorLabel.ACCOUNT_SUSPENDED,\n      TOO_MANY_BOTS: BackendErrorLabel.TOO_MANY_SERVICES,\n      TOO_MANY_CLIENTS: BackendErrorLabel.TOO_MANY_CLIENTS,\n      TOO_MANY_MEMBERS: BackendErrorLabel.TOO_MANY_MEMBERS,\n      UNAUTHORIZED: BackendErrorLabel.UNAUTHORIZED,\n      UNKNOWN_CLIENT: BackendErrorLabel.UNKNOWN_CLIENT,\n    };\n  }\n\n  static get TYPE() {\n    return {\n      GENERIC: 'GENERIC',\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum BASE_ERROR_TYPE {\n  INVALID_PARAMETER = 'INVALID_PARAMETER',\n  MISSING_PARAMETER = 'MISSING_PARAMETER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport class BaseError extends Error {\n  type: BASE_ERROR_TYPE | string;\n\n  constructor(type: BASE_ERROR_TYPE | string, message: string) {\n    super();\n\n    this.type = type;\n    this.message = message;\n    this.stack = new Error().stack;\n    this.name = this.constructor.name;\n  }\n\n  static get MESSAGE(): Record<string, string> {\n    return {\n      INVALID_PARAMETER: 'Invalid parameter passed',\n      MISSING_PARAMETER: 'Required parameter is not defined',\n      UNKNOWN: 'Unknown',\n    };\n  }\n\n  static get TYPE(): Record<string, string> {\n    return {\n      INVALID_PARAMETER: BASE_ERROR_TYPE.INVALID_PARAMETER,\n      MISSING_PARAMETER: BASE_ERROR_TYPE.MISSING_PARAMETER,\n      UNKNOWN: BASE_ERROR_TYPE.UNKNOWN,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError, BASE_ERROR_TYPE} from './BaseError';\n\nexport enum CLIENT_ERROR_TYPE {\n  CLIENT_NOT_SET = 'CLIENT_NOT_SET',\n  DATABASE_FAILURE = 'DATABASE_FAILURE',\n  NO_CLIENT_ID = 'NO_CLIENT_ID',\n  NO_USER_ID = 'NO_USER_ID',\n  NO_VALID_CLIENT = 'NO_VALID_CLIENT',\n  REQUEST_FAILURE = 'REQUEST_FAILURE',\n  REQUEST_FORBIDDEN = 'REQUEST_FORBIDDEN',\n  TOO_MANY_CLIENTS = 'TOO_MANY_CLIENTS',\n}\n\nexport class ClientError extends BaseError {\n  constructor(type: CLIENT_ERROR_TYPE | BASE_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<CLIENT_ERROR_TYPE, string> {\n    return {\n      CLIENT_NOT_SET: 'Local client is not yet set',\n      DATABASE_FAILURE: 'Client related database transaction failed',\n      NO_CLIENT_ID: 'Client ID is not defined',\n      NO_USER_ID: 'User ID is not defined',\n      NO_VALID_CLIENT: 'No valid local client found',\n      REQUEST_FAILURE: 'Client related backend request failed',\n      REQUEST_FORBIDDEN: 'Client related backend request forbidden',\n      TOO_MANY_CLIENTS: 'User has reached the maximum of allowed clients',\n    };\n  }\n\n  static get TYPE(): Record<CLIENT_ERROR_TYPE, CLIENT_ERROR_TYPE> {\n    return {\n      CLIENT_NOT_SET: CLIENT_ERROR_TYPE.CLIENT_NOT_SET,\n      DATABASE_FAILURE: CLIENT_ERROR_TYPE.DATABASE_FAILURE,\n      NO_CLIENT_ID: CLIENT_ERROR_TYPE.NO_CLIENT_ID,\n      NO_USER_ID: CLIENT_ERROR_TYPE.NO_USER_ID,\n      NO_VALID_CLIENT: CLIENT_ERROR_TYPE.NO_VALID_CLIENT,\n      REQUEST_FAILURE: CLIENT_ERROR_TYPE.REQUEST_FAILURE,\n      REQUEST_FORBIDDEN: CLIENT_ERROR_TYPE.REQUEST_FORBIDDEN,\n      TOO_MANY_CLIENTS: CLIENT_ERROR_TYPE.TOO_MANY_CLIENTS,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError, BASE_ERROR_TYPE} from './BaseError';\n\nenum CONVERSATION_ERROR_TYPE {\n  CONVERSATION_NOT_FOUND = 'CONVERSATION_NOT_FOUND',\n  DEGRADED_CONVERSATION_CANCELLATION = 'DEGRADED_CONVERSATION_CANCELLATION',\n  INVALID_PARAMETER = 'INVALID_PARAMETER',\n  LEGAL_HOLD_CONVERSATION_CANCELLATION = 'LEGAL_HOLD_CONVERSATION_CANCELLATION',\n  MESSAGE_NOT_FOUND = 'MESSAGE_NOT_FOUND',\n  NO_CHANGES = 'NO_CHANGES',\n  NO_CONVERSATION_ID = 'NO_CONVERSATION_ID',\n  NO_MESSAGE_CHANGES = 'NO_MESSAGE_CHANGES',\n  REQUEST_FAILURE = 'REQUEST_FAILURE',\n  UNKNOWN_ACTIVITY = 'UNKNOWN_ACTIVITY',\n  WRONG_CHANGE = 'WRONG_CHANGE',\n  WRONG_CONVERSATION = 'WRONG_CONVERSATION',\n  WRONG_TYPE = 'WRONG_TYPE',\n  WRONG_USER = 'WRONG_USER',\n}\n\nexport class ConversationError extends BaseError {\n  constructor(type: CONVERSATION_ERROR_TYPE | BASE_ERROR_TYPE, message: string, error?: Error) {\n    super(type, message);\n    if (error) {\n      this.stack = `${this.stack}\\n${error.stack}`;\n    }\n  }\n\n  static get MESSAGE(): Record<CONVERSATION_ERROR_TYPE | string, string> {\n    return {\n      CONVERSATION_NOT_FOUND: 'Conversation not found',\n      DEGRADED_CONVERSATION_CANCELLATION: 'Sending to degraded conversation was canceled by user',\n      INVALID_PARAMETER: 'Invalid parameter passed',\n      LEGAL_HOLD_CONVERSATION_CANCELLATION: 'Sending to legal hold conversation was canceled by user',\n      MESSAGE_NOT_FOUND: 'Message not found in conversation',\n      NO_CHANGES: 'Missing changes to message',\n      NO_CONVERSATION_ID: 'Conversation ID is not defined',\n      NO_MESSAGE_CHANGES: 'Edited message equals original message',\n      REQUEST_FAILURE: 'Conversation related backend request failed',\n      UNKNOWN_ACTIVITY: 'Unknown activity',\n      WRONG_CHANGE: 'Attempted unsupported change on conversation',\n      WRONG_CONVERSATION: 'Message was sent in the wrong conversation',\n      WRONG_TYPE: 'Wrong message to for action',\n      WRONG_USER: 'Wrong user tried to change or delete a message',\n    };\n  }\n\n  static get TYPE(): Record<CONVERSATION_ERROR_TYPE, CONVERSATION_ERROR_TYPE> {\n    return {\n      CONVERSATION_NOT_FOUND: CONVERSATION_ERROR_TYPE.CONVERSATION_NOT_FOUND,\n      DEGRADED_CONVERSATION_CANCELLATION: CONVERSATION_ERROR_TYPE.DEGRADED_CONVERSATION_CANCELLATION,\n      INVALID_PARAMETER: CONVERSATION_ERROR_TYPE.INVALID_PARAMETER,\n      LEGAL_HOLD_CONVERSATION_CANCELLATION: CONVERSATION_ERROR_TYPE.LEGAL_HOLD_CONVERSATION_CANCELLATION,\n      MESSAGE_NOT_FOUND: CONVERSATION_ERROR_TYPE.MESSAGE_NOT_FOUND,\n      NO_CHANGES: CONVERSATION_ERROR_TYPE.NO_CHANGES,\n      NO_CONVERSATION_ID: CONVERSATION_ERROR_TYPE.NO_CONVERSATION_ID,\n      NO_MESSAGE_CHANGES: CONVERSATION_ERROR_TYPE.NO_MESSAGE_CHANGES,\n      REQUEST_FAILURE: CONVERSATION_ERROR_TYPE.REQUEST_FAILURE,\n      UNKNOWN_ACTIVITY: CONVERSATION_ERROR_TYPE.UNKNOWN_ACTIVITY,\n      WRONG_CHANGE: CONVERSATION_ERROR_TYPE.WRONG_CHANGE,\n      WRONG_CONVERSATION: CONVERSATION_ERROR_TYPE.WRONG_CONVERSATION,\n      WRONG_TYPE: CONVERSATION_ERROR_TYPE.WRONG_TYPE,\n      WRONG_USER: CONVERSATION_ERROR_TYPE.WRONG_USER,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError} from './BaseError';\n\nenum CRYPTOGRAPHY_ERROR_TYPE {\n  BROKEN_EXTERNAL = 'BROKEN_EXTERNAL',\n  IGNORED_ASSET = 'IGNORED_ASSET',\n  IGNORED_PREVIEW = 'IGNORED_PREVIEW',\n  NO_DATA_CONTENT = 'NO_DATA_CONTENT',\n  NO_GENERIC_MESSAGE = 'NO_GENERIC_MESSAGE',\n  PREVIOUSLY_STORED = 'PREVIOUSLY_STORED',\n  UNHANDLED_TYPE = 'UNHANDLED_TYPE',\n}\n\nexport class CryptographyError extends BaseError {\n  constructor(type: CRYPTOGRAPHY_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<CRYPTOGRAPHY_ERROR_TYPE, string> {\n    return {\n      BROKEN_EXTERNAL: 'Failed to map external message',\n      IGNORED_ASSET: 'Ignored asset preview',\n      IGNORED_PREVIEW: 'Ignored image preview',\n      NO_DATA_CONTENT: 'No message data content found',\n      NO_GENERIC_MESSAGE: 'No GenericMessage found',\n      PREVIOUSLY_STORED: 'Message was previously stored',\n      UNHANDLED_TYPE: 'Unhandled event type',\n    };\n  }\n\n  static get TYPE(): Record<CRYPTOGRAPHY_ERROR_TYPE, CRYPTOGRAPHY_ERROR_TYPE> {\n    return {\n      BROKEN_EXTERNAL: CRYPTOGRAPHY_ERROR_TYPE.BROKEN_EXTERNAL,\n      IGNORED_ASSET: CRYPTOGRAPHY_ERROR_TYPE.IGNORED_ASSET,\n      IGNORED_PREVIEW: CRYPTOGRAPHY_ERROR_TYPE.IGNORED_PREVIEW,\n      NO_DATA_CONTENT: CRYPTOGRAPHY_ERROR_TYPE.NO_DATA_CONTENT,\n      NO_GENERIC_MESSAGE: CRYPTOGRAPHY_ERROR_TYPE.NO_GENERIC_MESSAGE,\n      PREVIOUSLY_STORED: CRYPTOGRAPHY_ERROR_TYPE.PREVIOUSLY_STORED,\n      UNHANDLED_TYPE: CRYPTOGRAPHY_ERROR_TYPE.UNHANDLED_TYPE,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError} from './BaseError';\n\nenum STORAGE_ERROR_TYPE {\n  FAILED_TO_OPEN = 'FAILED_TO_OPEN',\n  INVALID_TIME = 'INVALID_TIME',\n  INVALID_TIMESTAMP = 'INVALID_TIMESTAMP',\n  NO_CONVERSATION_ID = 'NO_CONVERSATION_ID',\n  NO_DATA = 'NO_DATA',\n  NO_SENDER_ID = 'NO_SENDER_ID',\n  NO_TIME = 'NO_TIME',\n  NON_SEQUENTIAL_UPDATE = 'NON_SEQUENTIAL_UPDATE',\n  NOT_FOUND = 'NOT_FOUND',\n}\n\nexport class StorageError extends BaseError {\n  constructor(type: STORAGE_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<STORAGE_ERROR_TYPE, string> {\n    return {\n      FAILED_TO_OPEN: 'Failed to open database',\n      INVALID_TIME: 'Event time needs to be ISO 8601',\n      INVALID_TIMESTAMP: 'Invalid timestamp',\n      NON_SEQUENTIAL_UPDATE: 'Update is non sequential',\n      NOT_FOUND: 'Record matching primary key was not found',\n      NO_CONVERSATION_ID: 'Missing conversation ID',\n      NO_DATA: 'Storage value is undefined or null',\n      NO_SENDER_ID: 'Missing sender ID',\n      NO_TIME: 'Missing time',\n    };\n  }\n\n  static get TYPE(): Record<STORAGE_ERROR_TYPE, STORAGE_ERROR_TYPE> {\n    return {\n      FAILED_TO_OPEN: STORAGE_ERROR_TYPE.FAILED_TO_OPEN,\n      INVALID_TIME: STORAGE_ERROR_TYPE.INVALID_TIME,\n      INVALID_TIMESTAMP: STORAGE_ERROR_TYPE.INVALID_TIMESTAMP,\n      NON_SEQUENTIAL_UPDATE: STORAGE_ERROR_TYPE.NON_SEQUENTIAL_UPDATE,\n      NOT_FOUND: STORAGE_ERROR_TYPE.NOT_FOUND,\n      NO_CONVERSATION_ID: STORAGE_ERROR_TYPE.NO_CONVERSATION_ID,\n      NO_DATA: STORAGE_ERROR_TYPE.NO_DATA,\n      NO_SENDER_ID: STORAGE_ERROR_TYPE.NO_SENDER_ID,\n      NO_TIME: STORAGE_ERROR_TYPE.NO_TIME,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError} from './BaseError';\n\nenum TEAM_ERROR_TYPE {\n  NO_APP_CONFIG = 'NO_APP_CONFIG',\n  NO_PERMISSIONS = 'NO_PERMISSIONS',\n}\n\nexport class TeamError extends BaseError {\n  constructor(type: TEAM_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<TEAM_ERROR_TYPE, string> {\n    return {\n      NO_APP_CONFIG: 'Unable to receive application configuration',\n      NO_PERMISSIONS: 'No permissions provided',\n    };\n  }\n\n  static get TYPE(): Record<TEAM_ERROR_TYPE, TEAM_ERROR_TYPE> {\n    return {\n      NO_APP_CONFIG: TEAM_ERROR_TYPE.NO_APP_CONFIG,\n      NO_PERMISSIONS: TEAM_ERROR_TYPE.NO_PERMISSIONS,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum CALL {\n  E_CALL = 'call.e-call',\n}\n\nexport enum CONVERSATION {\n  ASSET_ADD = 'conversation.asset-add',\n  BUTTON_ACTION_CONFIRMATION = 'conversation.button-action-confirmation',\n  CALL_TIME_OUT = 'conversation.call-time-out',\n  COMPOSITE_MESSAGE_ADD = 'conversation.composite-message-add',\n  CONFIRMATION = 'conversation.confirmation',\n  DELETE_EVERYWHERE = 'conversation.delete-everywhere',\n  FILE_TYPE_RESTRICTED = 'conversation.file-type-restricted',\n  GROUP_CREATION = 'conversation.group-creation',\n  INCOMING_MESSAGE_TOO_BIG = 'conversation.incoming-message-too-big',\n  KNOCK = 'conversation.knock',\n  LEGAL_HOLD_UPDATE = 'conversation.legal-hold-update',\n  LOCATION = 'conversation.location',\n  MESSAGE_ADD = 'conversation.message-add',\n  MESSAGE_DELETE = 'conversation.message-delete',\n  MESSAGE_HIDDEN = 'conversation.message-hidden',\n  MISSED_MESSAGES = 'conversation.missed-messages',\n  ONE2ONE_CREATION = 'conversation.one2one-creation',\n  REACTION = 'conversation.reaction',\n  TEAM_MEMBER_LEAVE = 'conversation.team-member-leave',\n  UNABLE_TO_DECRYPT = 'conversation.unable-to-decrypt',\n  VERIFICATION = 'conversation.verification',\n  VOICE_CHANNEL_ACTIVATE = 'conversation.voice-channel-activate',\n  VOICE_CHANNEL_DEACTIVATE = 'conversation.voice-channel-deactivate',\n}\n\nexport enum USER {\n  AVAILABILITY = 'user.availability',\n  DATA_TRANSFER = 'user.data-transfer',\n}\n\nexport const ClientEvent = {\n  CALL,\n  CONVERSATION,\n  USER,\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum EVENT_TYPE {\n  CALL = 'call',\n  CONVERSATION = 'conversation',\n  FEATURE_CONFIG = 'feature-config',\n  TEAM = 'team',\n  USER = 'user',\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum EventValidation {\n  OUTDATED_TIMESTAMP = 'OUTDATED_TIMESTAMP',\n  VALID = 'VALID',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BaseError} from './BaseError';\n\nenum EVENT_ERROR_TYPE {\n  DATABASE_FAILURE = 'DATABASE_FAILURE',\n  DEPRECATED_SCHEMA = 'DEPRECATED_SCHEMA',\n  NO_CLIENT_ID = 'NO_CLIENT_ID',\n  NO_EVENT = 'NO_EVENT',\n  NO_LAST_DATE = 'NO_LAST_DATE',\n  NO_LAST_ID = 'NO_LAST_ID',\n  NO_NOTIFICATIONS = 'NO_NOTIFICATIONS',\n  OUTDATED_E_CALL_EVENT = 'OUTDATED_E_CALL_EVENT',\n  REQUEST_FAILURE = 'REQUEST_FAILURE',\n  VALIDATION_FAILED = 'VALIDATION_FAILED',\n  WEBSOCKET_DISCONNECT = 'WEBSOCKET_DISCONNECT',\n}\n\nexport class EventError extends BaseError {\n  constructor(type: EVENT_ERROR_TYPE, message: string) {\n    super(type, message);\n  }\n\n  static get MESSAGE(): Record<EVENT_ERROR_TYPE, string> {\n    return {\n      DATABASE_FAILURE: 'Event related database transaction failure',\n      DEPRECATED_SCHEMA: 'Event type is deprecated',\n      NO_CLIENT_ID: 'Missing client id',\n      NO_EVENT: 'Event is missing',\n      NO_LAST_DATE: 'Last event date not found in storage',\n      NO_LAST_ID: 'Last notification ID not found in storage',\n      NO_NOTIFICATIONS: 'No notifications found',\n      OUTDATED_E_CALL_EVENT: 'Ignoring outdated e-call event',\n      REQUEST_FAILURE: 'Event related backend request failure',\n      VALIDATION_FAILED: 'Event failed validation',\n      WEBSOCKET_DISCONNECT: 'Websocket disconnect during notification stream processing',\n    };\n  }\n\n  static get TYPE(): Record<EVENT_ERROR_TYPE, EVENT_ERROR_TYPE> {\n    return {\n      DATABASE_FAILURE: EVENT_ERROR_TYPE.DATABASE_FAILURE,\n      DEPRECATED_SCHEMA: EVENT_ERROR_TYPE.DEPRECATED_SCHEMA,\n      NO_CLIENT_ID: EVENT_ERROR_TYPE.NO_CLIENT_ID,\n      NO_EVENT: EVENT_ERROR_TYPE.NO_EVENT,\n      NO_LAST_DATE: EVENT_ERROR_TYPE.NO_LAST_DATE,\n      NO_LAST_ID: EVENT_ERROR_TYPE.NO_LAST_ID,\n      NO_NOTIFICATIONS: EVENT_ERROR_TYPE.NO_NOTIFICATIONS,\n      OUTDATED_E_CALL_EVENT: EVENT_ERROR_TYPE.OUTDATED_E_CALL_EVENT,\n      REQUEST_FAILURE: EVENT_ERROR_TYPE.REQUEST_FAILURE,\n      VALIDATION_FAILED: EVENT_ERROR_TYPE.VALIDATION_FAILED,\n      WEBSOCKET_DISCONNECT: EVENT_ERROR_TYPE.WEBSOCKET_DISCONNECT,\n    };\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT, USER_EVENT} from '@wireapp/api-client/lib/event/';\nimport {NotificationSource, HandledEventPayload} from '@wireapp/core/lib/notification';\nimport {amplify} from 'amplify';\nimport ko from 'knockout';\nimport {container} from 'tsyringe';\n\nimport {Account, ConnectionState, ProcessedEventPayload} from '@wireapp/core';\nimport {Asset as ProtobufAsset, GenericMessage} from '@wireapp/protocol-messaging';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {getLogger, Logger} from 'Util/Logger';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nimport {ClientEvent} from './Client';\nimport type {EventService} from './EventService';\nimport {EventSource} from './EventSource';\nimport {EVENT_TYPE} from './EventType';\nimport {EventTypeHandling} from './EventTypeHandling';\nimport {EventValidation} from './EventValidation';\nimport {validateEvent} from './EventValidator';\nimport {NOTIFICATION_HANDLING_STATE} from './NotificationHandlingState';\nimport type {NotificationService} from './NotificationService';\n\nimport {AssetTransferState} from '../assets/AssetTransferState';\nimport type {ClientEntity} from '../client/ClientEntity';\nimport {EventBuilder} from '../conversation/EventBuilder';\nimport {AssetData, CryptographyMapper} from '../cryptography/CryptographyMapper';\nimport {CryptographyError} from '../error/CryptographyError';\nimport {EventError} from '../error/EventError';\nimport {categoryFromEvent} from '../message/MessageCategorization';\nimport type {EventRecord} from '../storage';\nimport type {ServerTimeHandler} from '../time/serverTimeHandler';\nimport {EventName} from '../tracking/EventName';\nimport {UserState} from '../user/UserState';\nimport {Warnings} from '../view_model/WarningsContainer';\n\nexport class EventRepository {\n  logger: Logger;\n  currentClient: ko.Observable<ClientEntity> | undefined;\n  notificationHandlingState: ko.Observable<NOTIFICATION_HANDLING_STATE>;\n  previousHandlingState: NOTIFICATION_HANDLING_STATE | undefined;\n  notificationsHandled: number;\n  notificationsTotal: number;\n  lastEventDate: ko.Observable<string | undefined>;\n  eventProcessMiddlewares: Function[];\n\n  static get CONFIG() {\n    return {\n      E_CALL_EVENT_LIFETIME: TIME_IN_MILLIS.SECOND * 30,\n      IGNORED_ERRORS: [\n        CryptographyError.TYPE.IGNORED_ASSET,\n        CryptographyError.TYPE.IGNORED_PREVIEW,\n        CryptographyError.TYPE.PREVIOUSLY_STORED,\n        CryptographyError.TYPE.UNHANDLED_TYPE,\n        EventError.TYPE.OUTDATED_E_CALL_EVENT,\n        EventError.TYPE.VALIDATION_FAILED,\n      ],\n      NOTIFICATION_BATCHES: {\n        INITIAL: 500,\n        MAX: 10000,\n        SUBSEQUENT: 5000,\n      },\n    };\n  }\n\n  // TODO: Will be replaced with \"EventSource\"\n  static get SOURCE() {\n    return {\n      BACKEND_RESPONSE: EventSource.BACKEND_RESPONSE,\n      INJECTED: EventSource.INJECTED,\n      STREAM: EventSource.NOTIFICATION_STREAM,\n      WEB_SOCKET: EventSource.WEBSOCKET,\n    };\n  }\n\n  constructor(\n    readonly eventService: EventService,\n    readonly notificationService: NotificationService,\n    private readonly serverTimeHandler: ServerTimeHandler,\n    private readonly userState = container.resolve(UserState),\n  ) {\n    this.logger = getLogger('EventRepository');\n\n    this.currentClient = undefined;\n\n    this.notificationHandlingState = ko.observable(NOTIFICATION_HANDLING_STATE.STREAM);\n    this.notificationHandlingState.subscribe(handling_state => {\n      amplify.publish(WebAppEvents.EVENT.NOTIFICATION_HANDLING_STATE, handling_state);\n    });\n    this.notificationsHandled = 0;\n    this.notificationsTotal = 0;\n\n    this.lastEventDate = ko.observable();\n\n    this.eventProcessMiddlewares = [];\n  }\n\n  /**\n   * Will set a middleware to run before the EventRepository actually processes the event.\n   * Middleware is just a function with the following signature (Event) => Promise<Event>.\n   *\n   * @param middlewares middlewares to run when a new event is about to be processed\n   */\n  setEventProcessMiddlewares(middlewares: Function[]) {\n    this.eventProcessMiddlewares = middlewares;\n  }\n\n  //##############################################################################\n  // WebSocket handling\n  //##############################################################################\n\n  private readonly updateConnectivitityStatus = (state: ConnectionState) => {\n    this.logger.log('Websocket connection state changed to', state);\n    switch (state) {\n      case ConnectionState.CONNECTING: {\n        Warnings.hideWarning(Warnings.TYPE.NO_INTERNET);\n        Warnings.showWarning(Warnings.TYPE.CONNECTIVITY_RECONNECT);\n        return;\n      }\n      case ConnectionState.PROCESSING_NOTIFICATIONS: {\n        this.notificationHandlingState(NOTIFICATION_HANDLING_STATE.STREAM);\n        Warnings.hideWarning(Warnings.TYPE.NO_INTERNET);\n        Warnings.hideWarning(Warnings.TYPE.CONNECTIVITY_RECONNECT);\n        Warnings.showWarning(Warnings.TYPE.CONNECTIVITY_RECOVERY);\n        return;\n      }\n      case ConnectionState.CLOSED: {\n        Warnings.showWarning(Warnings.TYPE.NO_INTERNET);\n        return;\n      }\n      case ConnectionState.LIVE: {\n        this.notificationHandlingState(NOTIFICATION_HANDLING_STATE.WEB_SOCKET);\n        amplify.publish(WebAppEvents.CONNECTION.ONLINE);\n        Warnings.hideWarning(Warnings.TYPE.NO_INTERNET);\n        Warnings.hideWarning(Warnings.TYPE.CONNECTIVITY_RECONNECT);\n        Warnings.hideWarning(Warnings.TYPE.CONNECTIVITY_RECOVERY);\n      }\n    }\n  };\n\n  private readonly handleIncomingEvent = async (payload: HandledEventPayload, source: NotificationSource) => {\n    try {\n      await this.handleEvent({...payload, event: payload.event as EventRecord}, source);\n    } catch (error) {\n      if (source === EventSource.NOTIFICATION_STREAM) {\n        this.logger.warn(`Failed to handle event of type \"${event.type}\": ${error.message}`, error);\n      } else {\n        throw error;\n      }\n    }\n  };\n\n  /**\n   * connects to the websocket with the given account\n   *\n   * @param account the account to connect to\n   * @param onNotificationStreamProgress callback when a notification for the notification stream has been processed\n   * @returns Resolves when the notification stream has fully been processed\n   */\n  async connectWebSocket(\n    account: Account,\n    onNotificationStreamProgress: (progress: {done: number; total: number}) => void,\n  ): Promise<void> {\n    await this.handleTimeDrift();\n    const connect = () => {\n      // We make sure there is only be a single active connection to the WebSocket.\n      this.disconnectWebSocket?.();\n      return new Promise<void>(async resolve => {\n        this.disconnectWebSocket = account.listen({\n          onConnectionStateChanged: connectionState => {\n            this.updateConnectivitityStatus(connectionState);\n            if (connectionState === ConnectionState.LIVE) {\n              resolve();\n            }\n          },\n          onEvent: this.handleIncomingEvent,\n          onMissedNotifications: this.triggerMissedSystemEventMessageRendering,\n          onNotificationStreamProgress: onNotificationStreamProgress,\n        });\n      });\n    };\n\n    window.addEventListener('online', () => {\n      this.logger.info('Internet connection regained. Re-establishing WebSocket connection...');\n      connect();\n    });\n\n    window.addEventListener('offline', () => {\n      this.logger.warn('Internet connection lost');\n      this.disconnectWebSocket();\n      Warnings.showWarning(Warnings.TYPE.NO_INTERNET);\n    });\n    return connect();\n  }\n\n  /**\n   * Close the WebSocket connection. (will be set only once the connectWebSocket is called)\n   */\n  disconnectWebSocket: () => void = () => {};\n\n  //##############################################################################\n  // Notification Stream handling\n  //##############################################################################\n  private async handleTimeDrift() {\n    try {\n      const time = await this.notificationService.getServerTime();\n      this.serverTimeHandler.computeTimeOffset(time);\n    } catch (errorResponse) {\n      if (errorResponse.response?.time) {\n        this.serverTimeHandler.computeTimeOffset(errorResponse.response?.time);\n      }\n    }\n  }\n\n  private getIsoDateFromEvent(event: EventRecord, defaultValue = false): string | void {\n    const {client, connection, time: eventDate, type: eventType} = event;\n\n    if (eventDate) {\n      return eventDate;\n    }\n\n    const isTypeUserClientAdd = eventType === USER_EVENT.CLIENT_ADD;\n    if (isTypeUserClientAdd) {\n      return client.time;\n    }\n\n    const isTypeUserConnection = eventType === USER_EVENT.CONNECTION;\n    if (isTypeUserConnection) {\n      return connection.lastUpdate;\n    }\n\n    if (defaultValue) {\n      return new Date(0).toISOString();\n    }\n  }\n\n  private readonly triggerMissedSystemEventMessageRendering = async (missedNotificationId: string) => {\n    const notificationId = await this.notificationService.getMissedIdFromDb();\n    const shouldUpdatePersistedId = missedNotificationId !== notificationId;\n    if (shouldUpdatePersistedId) {\n      amplify.publish(WebAppEvents.CONVERSATION.MISSED_EVENTS);\n      this.notificationService.saveMissedIdToDb(missedNotificationId);\n    }\n  };\n\n  /**\n   * Persist updated last event timestamp.\n   *\n   * @param eventDate Updated last event date\n   * @returns Resolves when the last event date was stored\n   */\n  private updateLastEventDate(eventDate: string): Promise<string> | void {\n    const didDateIncrease = eventDate > this.lastEventDate();\n    if (didDateIncrease) {\n      this.lastEventDate(eventDate);\n      return this.notificationService.saveLastEventDateToDb(eventDate);\n    }\n  }\n\n  //##############################################################################\n  // Notification/Event handling\n  //##############################################################################\n\n  /**\n   * Inject event into a conversation.\n   * @note Don't add unable to decrypt to self conversation\n   *\n   * @param event Event payload to be injected\n   * @param source Source of injection\n   * @returns Resolves when the event has been processed\n   */\n  async injectEvent(event: EventRecord, source: EventSource = EventSource.INJECTED): Promise<EventRecord | undefined> {\n    if (!event) {\n      throw new EventError(EventError.TYPE.NO_EVENT, EventError.MESSAGE.NO_EVENT);\n    }\n\n    const isHandlingWebSocket = this.notificationHandlingState() === NOTIFICATION_HANDLING_STATE.WEB_SOCKET;\n    if (!isHandlingWebSocket) {\n      source = EventRepository.SOURCE.INJECTED;\n    }\n\n    const {conversation: conversationId, id = 'ID not specified', type} = event;\n    const inSelfConversation = conversationId === this.userState.self().id;\n    if (!inSelfConversation) {\n      this.logger.info(`Injected event ID '${id}' of type '${type}' with source '${source}'`, event);\n      return this.handleEvent({event}, source);\n    }\n    return event;\n  }\n\n  /**\n   * Distribute the given event.\n   *\n   * @param event Mapped event to be distributed\n   * @param source Source of notification\n   */\n  private async distributeEvent(event: EventRecord, source: EventSource): Promise<EventRecord> {\n    const {conversation: conversationId, from: userId, type} = event;\n\n    const hasIds = conversationId && userId;\n    const logMessage = hasIds\n      ? `Distributed '${type}' event for conversation '${conversationId}' from user '${userId}'`\n      : `Distributed '${type}' event`;\n    this.logger.info(logMessage, event);\n\n    const [category] = type.split('.');\n    switch (category) {\n      case EVENT_TYPE.CALL:\n        amplify.publish(WebAppEvents.CALL.EVENT_FROM_BACKEND, event, source);\n        break;\n      case EVENT_TYPE.CONVERSATION:\n        amplify.publish(WebAppEvents.CONVERSATION.EVENT_FROM_BACKEND, event, source);\n        break;\n      case EVENT_TYPE.FEATURE_CONFIG:\n      case EVENT_TYPE.TEAM:\n        amplify.publish(WebAppEvents.TEAM.EVENT_FROM_BACKEND, event, source);\n        break;\n      case EVENT_TYPE.USER:\n        amplify.publish(WebAppEvents.USER.EVENT_FROM_BACKEND, event, source);\n        break;\n      default:\n        amplify.publish(type, event, source);\n    }\n    // Wait for the event handlers to have finished their async tasks\n    await new Promise(res => setTimeout(res, 0));\n    return event;\n  }\n\n  /**\n   * Handle a single event from the notification stream or WebSocket.\n   *\n   * @param event Event coming from backend\n   * @param source Source of event\n   * @returns Resolves with the saved record or the plain event if the event was skipped\n   */\n  private handleEvent(\n    {event, decryptedData, decryptionError}: Omit<ProcessedEventPayload, 'event'> & {event: EventRecord},\n    source: EventSource,\n  ): Promise<EventRecord | undefined> {\n    const logObject = {eventJson: JSON.stringify(event), eventObject: event};\n    const validationResult = validateEvent(\n      event as {time: string; type: CONVERSATION_EVENT | USER_EVENT},\n      source,\n      this.lastEventDate(),\n    );\n    switch (validationResult) {\n      default: {\n        return Promise.resolve(event as EventRecord);\n      }\n      case EventValidation.OUTDATED_TIMESTAMP: {\n        this.logger.info(`Ignored outdated event type: '${event.type}'`, logObject);\n        return Promise.resolve(event as EventRecord);\n      }\n      case EventValidation.VALID:\n        return this.processEvent(event as EventRecord, source, decryptedData, decryptionError);\n    }\n  }\n\n  /**\n   * Decrypts, saves and distributes an event received from the backend.\n   *\n   * @param event Backend event extracted from notification stream\n   * @param source Source of event\n   * @returns Resolves with the saved record or `true` if the event was skipped\n   */\n  private async processEvent(\n    event: EventRecord,\n    source: EventSource,\n    decryptedData?: GenericMessage,\n    decryptionError?: HandledEventPayload['decryptionError'],\n  ): Promise<EventRecord | undefined> {\n    if (decryptionError) {\n      this.logger.warn(`Decryption Error: (${decryptionError.code}) ${decryptionError.message}`, decryptionError);\n      const ignoredCodes = [\n        208, // Outated event decyption error (see https://github.com/wireapp/wire-web-core/blob/5c8c56097eadfa55e79856cd6745087f0fd12e24/packages/proteus/README.md#decryption-errors)\n        209, // Duplicate event decryption error (see https://github.com/wireapp/wire-web-core/blob/5c8c56097eadfa55e79856cd6745087f0fd12e24/packages/proteus/README.md#decryption-errors)\n      ];\n      if (decryptionError.code && ignoredCodes.includes(decryptionError.code)) {\n        return undefined;\n      }\n      amplify.publish(WebAppEvents.ANALYTICS.EVENT, EventName.E2EE.FAILED_MESSAGE_DECRYPTION, {\n        cause: decryptionError.code,\n      });\n      event = EventBuilder.buildUnableToDecrypt(event, decryptionError);\n    }\n    if (decryptedData) {\n      event = await new CryptographyMapper().mapGenericMessage(decryptedData, event);\n      if (!event) {\n        return undefined;\n      }\n    }\n    for (const eventProcessMiddleware of this.eventProcessMiddlewares) {\n      event = await eventProcessMiddleware(event);\n    }\n\n    const shouldSaveEvent = EventTypeHandling.STORE.includes(event.type as CONVERSATION_EVENT);\n    if (shouldSaveEvent) {\n      const savedEvent = await this.handleEventSaving(event);\n      event = savedEvent ?? event;\n    }\n\n    return this.handleEventDistribution(event, source);\n  }\n\n  /**\n   * Handle a saved event and distribute it.\n   *\n   * @param event Backend event extracted from notification stream\n   * @param source Source of event\n   * @returns The distributed event\n   */\n  private handleEventDistribution(event: EventRecord, source: EventSource): Promise<EventRecord> {\n    const eventDate = this.getIsoDateFromEvent(event);\n    const isInjectedEvent = source === EventRepository.SOURCE.INJECTED;\n    const canSetEventDate = !isInjectedEvent && eventDate;\n    if (canSetEventDate) {\n      /*\n       * HOTFIX: The \"conversation.voice-channel-deactivate\" event is the ONLY event which we inject with a source set to WebSocket.\n       * This is wrong but changing it will break our current conversation archive functionality (WEBAPP-6435).\n       * That's why we need to explicitly list the \"conversation.voice-channel-deactivate\" here because injected events should NEVER\n       * modify the last event timestamp which we use to query the backend's notification stream.\n       */\n      if (event.type !== ClientEvent.CONVERSATION.VOICE_CHANNEL_DEACTIVATE) {\n        this.updateLastEventDate(eventDate as string);\n      }\n    }\n    return this.distributeEvent(event, source);\n  }\n\n  /**\n   * Handle a mapped event, check for malicious ID use and save it.\n   *\n   * @param event Backend event extracted from notification stream\n   * @returns Resolves with the saved event\n   */\n  private handleEventSaving(event: EventRecord): Promise<EventRecord | undefined> {\n    const conversationId = event.conversation;\n    const mappedData = event.data || {};\n\n    // first check if a message that should be replaced exists in DB\n    const findEventToReplacePromise = mappedData.replacing_message_id\n      ? this.eventService.loadEvent(conversationId, mappedData.replacing_message_id)\n      : Promise.resolve();\n\n    return (findEventToReplacePromise as Promise<EventRecord>).then((eventToReplace: EventRecord) => {\n      const hasLinkPreview = mappedData.previews && mappedData.previews.length;\n      const isReplacementWithoutOriginal = !eventToReplace && mappedData.replacing_message_id;\n      if (isReplacementWithoutOriginal && !hasLinkPreview) {\n        // the only valid case of a replacement with no original message is when an edited message gets a link preview\n        this.throwValidationError(event, 'Edit event without original event');\n      }\n\n      const handleEvent = (newEvent: EventRecord) => {\n        // check for duplicates (same id)\n        const loadEventPromise = newEvent.id\n          ? this.eventService.loadEvent(conversationId, newEvent.id)\n          : Promise.resolve(undefined);\n\n        return loadEventPromise.then((storedEvent?: EventRecord) => {\n          return storedEvent\n            ? this.handleDuplicatedEvent(storedEvent, newEvent)\n            : this.eventService.saveEvent(newEvent);\n        });\n      };\n\n      return eventToReplace ? this.handleEventReplacement(eventToReplace, event) : handleEvent(event);\n    });\n  }\n\n  private handleEventReplacement(originalEvent: EventRecord, newEvent: EventRecord): Promise<EventRecord> {\n    const newData = newEvent.data || {};\n    if (originalEvent.data.from !== newData.from) {\n      const logMessage = `ID previously used by user '${newEvent.from}'`;\n      const errorMessage = 'ID reused by other user';\n      this.throwValidationError(newEvent, errorMessage, logMessage);\n    }\n    const primaryKeyUpdate = {primary_key: originalEvent.primary_key};\n    const isLinkPreviewEdit = newData.previews && !!newData.previews.length;\n\n    const commonUpdates = EventRepository.getCommonMessageUpdates(originalEvent, newEvent);\n\n    const specificUpdates = isLinkPreviewEdit\n      ? this.getUpdatesForLinkPreview(originalEvent, newEvent)\n      : EventRepository.getUpdatesForEditMessage(originalEvent, newEvent);\n\n    const updates = {...specificUpdates, ...commonUpdates};\n\n    const identifiedUpdates = {...primaryKeyUpdate, ...updates};\n    return this.eventService.replaceEvent(identifiedUpdates);\n  }\n\n  private handleDuplicatedEvent(originalEvent: EventRecord, newEvent: EventRecord) {\n    switch (newEvent.type) {\n      case ClientEvent.CONVERSATION.ASSET_ADD:\n        return this.handleAssetUpdate(originalEvent, newEvent);\n\n      case ClientEvent.CONVERSATION.MESSAGE_ADD:\n        return this.handleLinkPreviewUpdate(originalEvent, newEvent);\n\n      default:\n        this.throwValidationError(newEvent, `Forbidden type '${newEvent.type}' for duplicate events`);\n    }\n  }\n\n  private async handleAssetUpdate(\n    originalEvent: EventRecord<AssetData>,\n    newEvent: EventRecord<AssetData>,\n  ): Promise<EventRecord> {\n    const newEventData = newEvent.data;\n    // the preview status is not sent by the client so we fake a 'preview' status in order to cleanly handle it in the switch statement\n    const ASSET_PREVIEW = 'preview';\n    const isPreviewEvent = !newEventData.status && !!newEventData.preview_key;\n    const previewStatus = isPreviewEvent ? ASSET_PREVIEW : newEventData.status;\n\n    switch (previewStatus) {\n      case ASSET_PREVIEW:\n      case AssetTransferState.UPLOADED: {\n        const updatedData = {...originalEvent.data, ...newEventData};\n        const updatedEvent = {...originalEvent, data: updatedData};\n        return this.eventService.replaceEvent(updatedEvent);\n      }\n\n      case AssetTransferState.UPLOAD_FAILED: {\n        // case of both failed or canceled upload\n        const fromOther = newEvent.from !== this.userState.self().id;\n        const sameSender = newEvent.from === originalEvent.from;\n        const selfCancel = !fromOther && newEvent.data.reason === ProtobufAsset.NotUploaded.CANCELLED;\n        // we want to delete the event in the case of an error from the remote client or a cancel on the user's own client\n        const shouldDeleteEvent = (fromOther || selfCancel) && sameSender;\n        if (shouldDeleteEvent) {\n          await this.eventService.deleteEvent(newEvent.conversation, newEvent.id);\n          return newEvent;\n        }\n        return this.eventService.updateEventAsUploadFailed(originalEvent.primary_key, newEvent.data.reason);\n      }\n\n      default: {\n        this.throwValidationError(newEvent, `Unhandled asset status update '${newEvent.data.status}'`);\n      }\n    }\n  }\n\n  private handleLinkPreviewUpdate(originalEvent: EventRecord, newEvent: EventRecord): Promise<EventRecord> {\n    const newEventData = newEvent.data;\n    const originalData = originalEvent.data;\n    if (originalEvent.from !== newEvent.from) {\n      const logMessage = `ID previously used by user '${newEvent.from}'`;\n      const errorMessage = 'ID reused by other user';\n      return this.throwValidationError(newEvent, errorMessage, logMessage);\n    }\n\n    const containsLinkPreview = newEventData.previews && !!newEventData.previews.length;\n    if (!containsLinkPreview) {\n      const errorMessage = 'Link preview event does not contain previews';\n      return this.throwValidationError(newEvent, errorMessage);\n    }\n\n    const textContentMatches = newEventData.content === originalData.content;\n    if (!textContentMatches) {\n      const errorMessage = 'ID of link preview reused';\n      const logMessage = 'Text content for link preview not matching';\n      return this.throwValidationError(newEvent, errorMessage, logMessage);\n    }\n\n    const bothAreMessageAddType = newEvent.type === originalEvent.type;\n    if (!bothAreMessageAddType) {\n      return this.throwValidationError(newEvent, 'ID reused by same user');\n    }\n\n    const updates = this.getUpdatesForLinkPreview(originalEvent, newEvent);\n    const identifiedUpdates = {primary_key: originalEvent.primary_key, ...updates};\n    return this.eventService.replaceEvent(identifiedUpdates);\n  }\n\n  private static getCommonMessageUpdates(originalEvent: EventRecord, newEvent: EventRecord) {\n    return {\n      ...newEvent,\n      data: {...newEvent.data, expects_read_confirmation: originalEvent.data.expects_read_confirmation},\n      edited_time: newEvent.time,\n      read_receipts: !newEvent.read_receipts ? originalEvent.read_receipts : newEvent.read_receipts,\n      status: !newEvent.status || newEvent.status < originalEvent.status ? originalEvent.status : newEvent.status,\n      time: originalEvent.time,\n      version: 1,\n    };\n  }\n\n  private static getUpdatesForEditMessage(\n    originalEvent: EventRecord,\n    newEvent: EventRecord,\n  ): EventRecord & {reactions: {}} {\n    // Remove reactions, so that likes (hearts) don't stay when a message's text gets edited\n    return {...newEvent, reactions: {}};\n  }\n\n  private getUpdatesForLinkPreview(originalEvent: EventRecord, newEvent: EventRecord): EventRecord {\n    const newData = newEvent.data;\n    const originalData = originalEvent.data;\n    const updatingLinkPreview = !!originalData.previews.length;\n    if (updatingLinkPreview) {\n      this.throwValidationError(newEvent, 'ID of link preview reused');\n    }\n\n    const textContentMatches = !newData.previews.length || newData.content === originalData.content;\n    if (!textContentMatches) {\n      const logMessage = 'Text content for link preview not matching';\n      const errorMessage = 'ID of link preview reused';\n      this.throwValidationError(newEvent, errorMessage, logMessage);\n    }\n\n    return {\n      ...newEvent,\n      category: categoryFromEvent(newEvent),\n      ephemeral_expires: originalEvent.ephemeral_expires,\n      ephemeral_started: originalEvent.ephemeral_started,\n      ephemeral_time: originalEvent.ephemeral_time,\n      server_time: newEvent.time,\n      time: originalEvent.time,\n      version: originalEvent.version,\n    };\n  }\n\n  private throwValidationError(event: EventRecord, errorMessage: string, logMessage?: string): never {\n    const baseLogMessage = `Ignored '${event.type}' (${event.id || 'no ID'}) in '${event.conversation}' from '${\n      event.from\n    }':'`;\n    const baseErrorMessage = 'Event validation failed:';\n    this.logger.warn(`${baseLogMessage} ${logMessage || errorMessage}`, event);\n    throw new EventError(EventError.TYPE.VALIDATION_FAILED, `${baseErrorMessage} ${errorMessage}`);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT, USER_EVENT} from '@wireapp/api-client/lib/event/';\n\nimport {EventSource} from './EventSource';\nimport {EventValidation} from './EventValidation';\n\nexport function validateEvent(\n  event: {time: string; type: CONVERSATION_EVENT | USER_EVENT},\n  source: EventSource,\n  lastEventDate?: string,\n): EventValidation {\n  const eventTime = event.time;\n  const isFromNotificationStream = source === EventSource.NOTIFICATION_STREAM;\n  const shouldCheckEventDate = !!eventTime && isFromNotificationStream && lastEventDate;\n\n  if (shouldCheckEventDate) {\n    /** This check prevents duplicated \"You joined\" system messages. */\n    const isOutdated = new Date(lastEventDate).getTime() >= new Date(eventTime).getTime();\n    if (isOutdated) {\n      return EventValidation.OUTDATED_TIMESTAMP;\n    }\n  }\n\n  return EventValidation.VALID;\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {NotificationSource} from '@wireapp/core/lib/notification';\n\nenum WebAppEventSource {\n  BACKEND_RESPONSE = 'backend_response',\n  INJECTED = 'injected',\n}\n\nexport type EventSource = NotificationSource | WebAppEventSource;\nexport const EventSource = {...WebAppEventSource, ...NotificationSource};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CONVERSATION_EVENT} from '@wireapp/api-client/lib/event/';\n\nimport {ClientEvent} from './Client';\n\nexport const EventTypeHandling = {\n  CONFIRM: [\n    ClientEvent.CONVERSATION.ASSET_ADD,\n    ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD,\n    ClientEvent.CONVERSATION.KNOCK,\n    ClientEvent.CONVERSATION.LOCATION,\n    ClientEvent.CONVERSATION.MESSAGE_ADD,\n  ],\n  STORE: [\n    CONVERSATION_EVENT.MEMBER_JOIN,\n    CONVERSATION_EVENT.MEMBER_LEAVE,\n    CONVERSATION_EVENT.MESSAGE_TIMER_UPDATE,\n    CONVERSATION_EVENT.RECEIPT_MODE_UPDATE,\n    CONVERSATION_EVENT.RENAME,\n    ClientEvent.CONVERSATION.ASSET_ADD,\n    ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD,\n    ClientEvent.CONVERSATION.DELETE_EVERYWHERE,\n    ClientEvent.CONVERSATION.GROUP_CREATION,\n    ClientEvent.CONVERSATION.INCOMING_MESSAGE_TOO_BIG,\n    ClientEvent.CONVERSATION.KNOCK,\n    ClientEvent.CONVERSATION.CALL_TIME_OUT,\n    ClientEvent.CONVERSATION.LEGAL_HOLD_UPDATE,\n    ClientEvent.CONVERSATION.LOCATION,\n    ClientEvent.CONVERSATION.MESSAGE_ADD,\n    ClientEvent.CONVERSATION.MISSED_MESSAGES,\n    ClientEvent.CONVERSATION.ONE2ONE_CREATION,\n    ClientEvent.CONVERSATION.TEAM_MEMBER_LEAVE,\n    ClientEvent.CONVERSATION.UNABLE_TO_DECRYPT,\n    ClientEvent.CONVERSATION.VERIFICATION,\n    ClientEvent.CONVERSATION.VOICE_CHANNEL_ACTIVATE,\n    ClientEvent.CONVERSATION.VOICE_CHANNEL_DEACTIVATE,\n  ],\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum NOTIFICATION_HANDLING_STATE {\n  RECOVERY = 'z.event.NOTIFICATION_HANDLING_STATE.RECOVERY',\n  STREAM = 'z.event.NOTIFICATION_HANDLING_STATE.STREAM',\n  WEB_SOCKET = 'z.event.NOTIFICATION_HANDLING_STATE.WEB_SOCKET',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {currentLanguage} from './auth/localeConfig';\nimport {Config} from './Config';\n\nconst env = window.wire.env;\n\nexport const URL = {\n  ACCOUNT: env.URL?.ACCOUNT_BASE,\n  PRIVACY_POLICY: env.URL?.PRIVACY_POLICY,\n  TEAM_SETTINGS: env.URL?.TEAMS_BASE,\n  TERMS_OF_USE_PERSONAL: env.URL?.TERMS_OF_USE_PERSONAL,\n  TERMS_OF_USE_TEAMS: env.URL?.TERMS_OF_USE_TEAMS,\n  WEBAPP: {\n    INTERNAL: 'https://wire-webapp-staging.wire.com',\n    PRODUCTION: env.APP_BASE || 'https://app.wire.com',\n    STAGING: 'https://wire-webapp-staging.zinfra.io',\n  },\n  WEBSITE: env.URL?.WEBSITE_BASE,\n};\n\nexport const URL_PATH = {\n  CREATE_TEAM: '/create-team/',\n  DECRYPT_ERROR_1: '/privacy/error-1/',\n  DECRYPT_ERROR_2: '/privacy/error-2/',\n  MANAGE_SERVICES: '/services/',\n  MANAGE_TEAM: '/login/',\n  PASSWORD_RESET: '/forgot/',\n  PRIVACY_HOW: '/privacy/how/',\n  PRIVACY_WHY: '/privacy/why/',\n  SUPPORT_USERNAME: '/support/username/',\n};\n\nconst getTeamSettingsUrl = (path: string = '', utmSource?: string): string | undefined => {\n  const query = utmSource ? `?utm_source=${utmSource}&utm_term=desktop` : '';\n  const teamSettingsUrl = `${URL.TEAM_SETTINGS}${path}${query}`;\n  return URL.TEAM_SETTINGS ? teamSettingsUrl : undefined;\n};\n\nexport const getWebsiteUrl = (path: string = '', pkCampaign?: string): string | undefined => {\n  if (URL.WEBSITE) {\n    const query = pkCampaign ? `?pk_campaign=${pkCampaign}&pk_kwd=desktop` : '';\n    const websiteUrl = `${URL.WEBSITE}${path}${query}`;\n    return addLocaleToUrl(URL.WEBSITE ? websiteUrl : undefined);\n  }\n  return undefined;\n};\n\nexport const getAccountPagesUrl = (path: string = ''): string | undefined => {\n  const accountPagesUrl = `${URL.ACCOUNT}${path}`;\n  return URL.ACCOUNT ? accountPagesUrl : undefined;\n};\n\nexport const getPrivacyPolicyUrl = (): string => addLocaleToUrl(URL.PRIVACY_POLICY || undefined);\nexport const getTermsOfUsePersonalUrl = (): string => addLocaleToUrl(URL.TERMS_OF_USE_PERSONAL || undefined);\nexport const getTermsOfUseTeamUrl = (): string => addLocaleToUrl(URL.TERMS_OF_USE_TEAMS || undefined);\n\nexport const getManageServicesUrl = (utmSource?: string): string =>\n  getTeamSettingsUrl(URL_PATH.MANAGE_SERVICES, utmSource);\nexport const getManageTeamUrl = (utmSource?: string): string => getTeamSettingsUrl(URL_PATH.MANAGE_TEAM, utmSource);\n\nexport const getCreateTeamUrl = (): string =>\n  Config.getConfig().FEATURE.ENABLE_ACCOUNT_REGISTRATION && `${Config.getConfig().URL.TEAMS_BASE}/register/email`;\nexport const getPrivacyHowUrl = (): string => getWebsiteUrl(URL_PATH.PRIVACY_HOW);\nexport const getPrivacyWhyUrl = (): string => getWebsiteUrl(URL_PATH.PRIVACY_WHY);\nexport const getSupportUsernameUrl = (): string => getWebsiteUrl(URL_PATH.SUPPORT_USERNAME);\n\nexport const addLocaleToUrl = (url?: string): string => {\n  if (!url) {\n    return undefined;\n  }\n  const language = currentLanguage().slice(0, 2);\n  const websiteLanguage = language == 'de' ? language : 'en';\n  return url.replace(Config.getConfig().URL.WEBSITE_BASE, `${Config.getConfig().URL.WEBSITE_BASE}/${websiteLanguage}`);\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Draft} from 'Util/DraftStateUtil';\n\nimport {ContentMessage} from '../entity/message/ContentMessage';\nimport {MemberMessage} from '../entity/message/MemberMessage';\nimport {SuperType} from '../message/SuperType';\n\nexport const isReadableMessage = (message: any): message is ContentMessage =>\n  message &&\n  'super_type' in message &&\n  (message.super_type === SuperType.CONTENT || message.super_type === SuperType.PING);\n\nexport const isContentMessage = (message: any): message is ContentMessage =>\n  message && 'super_type' in message && message.super_type === SuperType.CONTENT;\n\nexport const isMemberMessage = (message: any | undefined | null): message is MemberMessage =>\n  message && 'super_type' in message && message.super_type === SuperType.MEMBER;\n\nexport const isDraftMessageWithReplyId = (message: any | undefined | null): message is Draft =>\n  message && 'reply' in message && 'messageId' in message.reply;\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ServiceEntity} from '../integration/ServiceEntity';\n\nexport const isServiceEntity = (entity: any): entity is ServiceEntity => 'isService' in entity && entity.isService;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useEffect, useRef, useState} from 'react';\n\nimport Cookies from 'js-cookie';\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\nimport {createRandomUuid} from 'Util/util';\n\nconst CONFIG = {\n  COOKIE_NAME: 'app_opened',\n  INTERVAL: TIME_IN_MILLIS.SECOND,\n};\n\nfunction isRunningInstance(instanceId?: string) {\n  if (Runtime.isDesktopApp()) {\n    return true;\n  }\n  const cookieValue = Cookies.get(CONFIG.COOKIE_NAME);\n  const otherInstanceId = cookieValue ? JSON.parse(cookieValue).appInstanceId : cookieValue;\n  return otherInstanceId === instanceId;\n}\n\nfunction poll(instanceIdRef: {current: string | undefined}, onNewInstance: () => void) {\n  const checkSingleInstance = (): void => {\n    if (!isRunningInstance(instanceIdRef.current)) {\n      onNewInstance();\n    }\n  };\n  const interval = window.setInterval(checkSingleInstance, CONFIG.INTERVAL);\n  return () => window.clearInterval(interval);\n}\n\nfunction killCurrentInstance() {\n  return Cookies.remove(CONFIG.COOKIE_NAME);\n}\n\nfunction register(instanceId: string) {\n  Cookies.set(CONFIG.COOKIE_NAME, JSON.stringify({appInstanceId: instanceId}), {sameSite: 'Lax'});\n  return () => killCurrentInstance();\n}\n\nexport function useSingleInstance() {\n  const instanceId = useRef<string | undefined>(undefined);\n  const [hasOtherInstance, setHasOtherInstance] = useState(!isRunningInstance(instanceId.current));\n\n  const registerInstance = () => {\n    instanceId.current = createRandomUuid();\n    return register(instanceId.current);\n  };\n\n  const killRunningInstance = () => {\n    killCurrentInstance();\n    setHasOtherInstance(false);\n  };\n\n  useEffect(() => poll(instanceId, () => setHasOtherInstance(true)));\n\n  return {hasOtherInstance, killRunningInstance, registerInstance};\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {UserAsset as APIClientUserAsset} from '@wireapp/api-client/lib/user/';\nimport ko from 'knockout';\n\nimport {AssetRemoteData} from '../assets/AssetRemoteData';\n\nexport interface ServiceData {\n  assets?: APIClientUserAsset[];\n  description?: string;\n  enabled?: boolean;\n  id?: string;\n  name?: string;\n  provider?: string;\n  summary?: string;\n  tags?: string[];\n}\n\nexport class ServiceEntity {\n  description: string;\n  id: string;\n  mediumPictureResource: ko.Observable<AssetRemoteData>;\n  name: ko.Observable<string>;\n  previewPictureResource: ko.Observable<AssetRemoteData>;\n  providerId: string;\n  providerName: ko.Observable<string>;\n  summary: string;\n  tags: string[];\n  isService: boolean;\n\n  constructor(serviceData: ServiceData = {}) {\n    const {description = '', id = '', name = '', provider: providerId = '', summary = '', tags = []} = serviceData;\n\n    this.id = id;\n    this.description = description;\n    this.name = ko.observable(name);\n    this.providerId = providerId;\n    this.providerName = ko.observable(' ');\n    this.summary = summary;\n    this.tags = tags;\n\n    this.mediumPictureResource = ko.observable();\n    this.previewPictureResource = ko.observable();\n    this.isService = true;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport cs from 'I18n/cs-CZ.json';\nimport da from 'I18n/da-DK.json';\nimport de from 'I18n/de-DE.json';\nimport el from 'I18n/el-GR.json';\nimport en from 'I18n/en-US.json';\nimport es from 'I18n/es-ES.json';\nimport et from 'I18n/et-EE.json';\nimport fi from 'I18n/fi-FI.json';\nimport fr from 'I18n/fr-FR.json';\nimport hr from 'I18n/hr-HR.json';\nimport hu from 'I18n/hu-HU.json';\nimport it from 'I18n/it-IT.json';\nimport lt from 'I18n/lt-LT.json';\nimport nl from 'I18n/nl-NL.json';\nimport pl from 'I18n/pl-PL.json';\nimport pt from 'I18n/pt-BR.json';\nimport ro from 'I18n/ro-RO.json';\nimport ru from 'I18n/ru-RU.json';\nimport sk from 'I18n/sk-SK.json';\nimport sl from 'I18n/sl-SI.json';\nimport tr from 'I18n/tr-TR.json';\nimport uk from 'I18n/uk-UA.json';\nimport {DEFAULT_LOCALE, setLocale, setStrings} from 'Util/LocalizerUtil';\nimport {loadValue, storeValue} from 'Util/StorageUtil';\nimport {setDateLocale, LocaleType} from 'Util/TimeUtil';\nimport {getParameter} from 'Util/UrlUtil';\n\nimport {URLParameter} from '../auth/URLParameter';\nimport {StorageKey} from '../storage/StorageKey';\n\nconst strings = {\n  cs,\n  da,\n  de,\n  el,\n  en,\n  es,\n  et,\n  fi,\n  fr,\n  hr,\n  hu,\n  it,\n  lt,\n  nl,\n  pl,\n  pt,\n  ro,\n  ru,\n  sk,\n  sl,\n  tr,\n  uk,\n};\n\nsetStrings(strings);\n\nexport function setAppLocale() {\n  const queryParam = getParameter(URLParameter.LOCALE);\n  const currentBrowserLocale = navigator.language.slice(0, 2) as LocaleType;\n\n  if (queryParam) {\n    storeValue(StorageKey.LOCALIZATION.LOCALE, queryParam);\n  }\n\n  const storedLocale = loadValue<LocaleType>(StorageKey.LOCALIZATION.LOCALE);\n  const locale: LocaleType = storedLocale || currentBrowserLocale || (DEFAULT_LOCALE as LocaleType);\n  setLocale(locale);\n  setDateLocale(locale);\n\n  document.getElementsByTagName('html')[0].setAttribute('lang', locale);\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum EphemeralStatusType {\n  ACTIVE = 1,\n  INACTIVE = 2,\n  NONE = 0,\n  TIMED_OUT = 3,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\n\nimport {IMention, Mention} from '@wireapp/protocol-messaging';\n\nimport {matchQualifiedIds} from 'Util/QualifiedId';\nimport {isUUID} from 'Util/ValidationUtil';\n\nimport {PROTO_MESSAGE_TYPE} from '../cryptography/ProtoMessageType';\n\nexport enum ERROR {\n  INVALID_LENGTH = 'Invalid mention: Invalid length',\n  INVALID_START_CHAR = 'Invalid mention: Mention does not start with @',\n  INVALID_START_INDEX = 'Invalid mention: Invalid startIndex',\n  INVALID_USER_ID = 'Invalid mention: User ID is not a valid UUID',\n  MISSING_LENGTH = 'Invalid mention: Missing length',\n  MISSING_START_INDEX = 'Invalid mention: Missing startIndex',\n  MISSING_USER_ID = 'Invalid mention: Missing user ID',\n  OUT_OF_BOUNDS = 'Invalid mention: Length out of string boundary',\n  OVERLAPPING = 'Invalid mention: Overlap with another mention',\n}\n\nexport class MentionEntity {\n  static ERROR = ERROR;\n  startIndex: number;\n  length: number;\n  type: PROTO_MESSAGE_TYPE;\n  userId: string;\n  domain: string | null;\n\n  constructor(startIndex: number, length: number, userId: string, domain: string | null) {\n    this.startIndex = startIndex;\n    this.length = length;\n    this.type = PROTO_MESSAGE_TYPE.MENTION_TYPE_USER_ID;\n    this.domain = domain;\n    this.userId = userId;\n  }\n\n  targetsUser(userId: QualifiedId): boolean {\n    const isTypeUserId = this.type === PROTO_MESSAGE_TYPE.MENTION_TYPE_USER_ID;\n    return isTypeUserId && matchQualifiedIds(this.userQualifiedId, userId);\n  }\n\n  get userQualifiedId(): QualifiedId {\n    return {domain: this.domain || '', id: this.userId};\n  }\n\n  // Index of first char outside of mention\n  get endIndex(): number {\n    return this.startIndex + this.length;\n  }\n\n  validate(messageText = '', allMentions: MentionEntity[] = []): boolean {\n    if (allMentions.includes(this)) {\n      const mentionIndex = allMentions.indexOf(this);\n      const otherMentions = allMentions.slice(0, mentionIndex);\n      const isOverlapping = otherMentions.some(\n        mention => this.endIndex > mention.startIndex && this.startIndex < mention.endIndex,\n      );\n      if (isOverlapping) {\n        throw new Error(MentionEntity.ERROR.OVERLAPPING);\n      }\n    }\n\n    const startIndexIsNumber = typeof this.startIndex === 'number';\n    if (!startIndexIsNumber) {\n      throw new Error(MentionEntity.ERROR.MISSING_START_INDEX);\n    }\n\n    const lengthIsNumber = typeof this.length === 'number';\n    if (!lengthIsNumber) {\n      throw new Error(MentionEntity.ERROR.MISSING_LENGTH);\n    }\n\n    const userIdIsString = typeof this.userId === 'string';\n    if (!userIdIsString) {\n      throw new Error(MentionEntity.ERROR.MISSING_USER_ID);\n    }\n\n    const isValidStartIndex = this.startIndex >= 0;\n    if (!isValidStartIndex) {\n      throw new Error(MentionEntity.ERROR.INVALID_START_INDEX);\n    }\n\n    const isValidLength = this.length >= 1;\n    if (!isValidLength) {\n      throw new Error(MentionEntity.ERROR.INVALID_LENGTH);\n    }\n\n    const isValidEnd = messageText.length && this.endIndex <= messageText.length;\n    if (!isValidEnd) {\n      throw new Error(MentionEntity.ERROR.OUT_OF_BOUNDS);\n    }\n\n    const isValidUserId = isUUID(this.userId);\n    if (!isValidUserId) {\n      throw new Error(MentionEntity.ERROR.INVALID_USER_ID);\n    }\n\n    const isValidMention = messageText.charAt(this.startIndex) === '@';\n    if (!isValidMention) {\n      throw new Error(MentionEntity.ERROR.INVALID_START_CHAR);\n    }\n\n    return true;\n  }\n\n  toJSON() {\n    return {\n      length: this.length,\n      startIndex: this.startIndex,\n      userId: this.userId,\n      userQualifiedId: this.domain ? this.userQualifiedId : undefined,\n    };\n  }\n\n  toProto(): Mention {\n    const options: IMention = {length: this.length, start: this.startIndex};\n    const isUserIdMention = this.type === PROTO_MESSAGE_TYPE.MENTION_TYPE_USER_ID;\n    if (isUserIdMention) {\n      options.userId = this.userId;\n      if (this.domain) {\n        options.qualifiedUserId = this.userQualifiedId;\n      }\n    }\n    return new Mention(options);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {isObject} from 'underscore';\n\nimport {MessageCategory} from './MessageCategory';\n\nimport {ClientEvent} from '../event/Client';\nimport {EventRecord} from '../storage/record/EventRecord';\n\nconst _checkAsset = (event: any): MessageCategory | void => {\n  const {data: eventData, type: eventType} = event;\n\n  const isAssetAdd = eventType === ClientEvent.CONVERSATION.ASSET_ADD;\n  if (isAssetAdd) {\n    const isTagUndefined = eventData.info.tag === undefined;\n    if (isTagUndefined) {\n      return MessageCategory.FILE;\n    }\n\n    let category = MessageCategory.IMAGE;\n    if (eventData.content_type === 'image/gif') {\n      category = category | MessageCategory.GIF;\n    }\n\n    return category;\n  }\n};\n\nconst _checkLocation = (event: any): MessageCategory | void => {\n  const isLocation = event.type === ClientEvent.CONVERSATION.LOCATION;\n  if (isLocation) {\n    return MessageCategory.LOCATION;\n  }\n};\n\nconst _checkPing = (event: any): MessageCategory | void => {\n  const isPing = event.type === ClientEvent.CONVERSATION.KNOCK;\n  if (isPing) {\n    return MessageCategory.KNOCK;\n  }\n};\n\nconst _checkComposite = (event: any): MessageCategory | void => {\n  const isComposite = event.type === ClientEvent.CONVERSATION.COMPOSITE_MESSAGE_ADD;\n  if (isComposite) {\n    return MessageCategory.COMPOSITE;\n  }\n};\n\nconst _checkText = (event: any): MessageCategory | void => {\n  const {data: eventData, type: eventType} = event;\n\n  const isMessageAdd = eventType === ClientEvent.CONVERSATION.MESSAGE_ADD;\n  if (isMessageAdd) {\n    let category = MessageCategory.TEXT;\n\n    const isLinkPreview = eventData.previews && !!eventData.previews.length;\n    if (isLinkPreview) {\n      category = category | MessageCategory.LINK | MessageCategory.LINK_PREVIEW;\n    }\n\n    return category;\n  }\n};\n\nexport const categoryFromEvent = (event: EventRecord): MessageCategory => {\n  try {\n    const eventReactions = event.reactions;\n    let category = MessageCategory.NONE;\n\n    const categoryChecks = [_checkText, _checkAsset, _checkPing, _checkLocation, _checkComposite];\n    for (const check of categoryChecks) {\n      const matchedCategory = check(event);\n      if (matchedCategory) {\n        category = matchedCategory;\n        break;\n      }\n    }\n\n    const isReaction = isObject(eventReactions) && !!Object.keys(eventReactions).length;\n    if (isReaction) {\n      category = category | MessageCategory.LIKED;\n    }\n\n    return category;\n  } catch (error) {\n    return MessageCategory.UNDEFINED;\n  }\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** Enum for different message categories */\nexport enum MessageCategory {\n  AUDIO = 1 << 10,\n  COMPOSITE = 1 << 14,\n  EXCLUDED = 1 << 1,\n  FILE = 1 << 9,\n  GIF = 1 << 8,\n  IMAGE = 1 << 7,\n  KNOCK = 1 << 2,\n  LIKED = 1 << 13,\n  LINK = 1 << 5,\n  LINK_PREVIEW = 1 << 6,\n  LOCATION = 1 << 12,\n  NONE = 0,\n  SYSTEM = 1 << 3,\n  TEXT = 1 << 4,\n  UNDEFINED = 1 << 0,\n  VIDEO = 1 << 11,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Quote} from '@wireapp/protocol-messaging';\n\nexport interface QuoteEntityOptions {\n  error?: Error;\n  hash?: ArrayBuffer;\n  messageId: string;\n  userId: string;\n}\n\nexport class QuoteEntity {\n  error?: Error;\n  hash?: ArrayBuffer;\n  messageId: string;\n  userId: string;\n\n  static ERROR = {\n    INVALID_HASH: 'INVALID_HASH',\n    MESSAGE_NOT_FOUND: 'MESSAGE_NOT_FOUND',\n  };\n\n  constructor(options: QuoteEntityOptions) {\n    this.messageId = options.messageId;\n    this.hash = options.hash;\n    this.userId = options.userId;\n    this.error = options.error;\n  }\n\n  isQuoteFromUser(userId: string): boolean {\n    return this.userId === userId;\n  }\n\n  toJSON(): {messageId: string; userId: string} {\n    return {\n      messageId: this.messageId,\n      userId: this.userId,\n    };\n  }\n\n  toProto(): Quote {\n    return new Quote({\n      quotedMessageId: this.messageId,\n      quotedMessageSha256: new Uint8Array(this.hash),\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** Enum for different confirmation types */\nexport enum StatusType {\n  DELIVERED = 3,\n  FAILED = 0,\n  SEEN = 4,\n  SENDING = 1,\n  SENT = 2,\n  UNSPECIFIED = -1,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** Enum for different message super types */\nexport enum SuperType {\n  CALL = 'call',\n  CALL_TIME_OUT = 'call-time-out',\n  CONTENT = 'normal',\n  DELETE = 'delete',\n  DEVICE = 'device',\n  FILE_TYPE_RESTRICTED = 'file-type-restricted',\n  LEGALHOLD = 'legal-hold',\n  LOCATION = 'location',\n  MEMBER = 'member',\n  MISSED = 'missed',\n  PING = 'ping',\n  REACTION = 'reaction',\n  SPECIAL = 'special',\n  SYSTEM = 'system',\n  UNABLE_TO_DECRYPT = 'unable-to-decrypt',\n  VERIFICATION = 'verification',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/**\n * @todo Refactor to use member-join and member-leave instead of normal. It duplicates \"SuperType\".\n */\nexport enum SystemMessageType {\n  CONNECTION_ACCEPTED = 'created-one-to-one',\n  CONNECTION_CONNECTED = 'connected',\n  CONNECTION_REQUEST = 'connecting',\n  CONVERSATION_CREATE = 'created-group',\n  CONVERSATION_DELETE = 'deleted-group',\n  CONVERSATION_MESSAGE_TIMER_UPDATE = 'message-timer-update',\n  CONVERSATION_RECEIPT_MODE_UPDATE = 'receipt-mode-update',\n  CONVERSATION_RENAME = 'rename',\n  CONVERSATION_RESUME = 'resume',\n  MEMBER_JOIN = 'join',\n  MEMBER_LEAVE = 'leave',\n  NORMAL = 'normal',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum VerificationMessageType {\n  NEW_DEVICE = 'new-device',\n  NEW_MEMBER = 'new-member',\n  UNVERIFIED = 'unverified',\n  VERIFIED = 'verified',\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {getStorage} from 'Util/localStorage';\n\nimport {MLSConversationState} from './mlsConversationState';\n\nconst storageKey = 'mlsConversationsState';\nconst storage = getStorage();\n\nexport const loadState = (): MLSConversationState => {\n  const storedState = storage?.getItem(storageKey);\n  if (!storedState) {\n    return {\n      established: new Set(),\n      pendingWelcome: new Set(),\n    };\n  }\n  const parsedState = JSON.parse(storedState);\n  return {\n    established: new Set(parsedState.established),\n    pendingWelcome: new Set(parsedState.pendingWelcome),\n  };\n};\n\nexport const saveState = ({established, pendingWelcome}: MLSConversationState) => {\n  storage?.setItem(storageKey, JSON.stringify({established: [...established], pendingWelcome: [...pendingWelcome]}));\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport create from 'zustand';\nimport createVanilla from 'zustand/vanilla';\n\nimport {loadState, saveState} from './conversationStateStorage';\n\nimport {Conversation} from '../../entity/Conversation';\n\nexport interface MLSConversationState {\n  /** list of conversations that are fully joined */\n  established: Set<string>;\n  /** list of conversations that are waiting for a welcome */\n  pendingWelcome: Set<string>;\n}\n\nconst initialState = loadState();\n\ntype StoreState = MLSConversationState & {\n  isEstablished: (groupId: string) => boolean;\n  isPendingWelcome: (groupId: string) => boolean;\n  filterEstablishedConversations: (conversations: Conversation[]) => Conversation[];\n  markAsEstablished: (groupId: string) => void;\n  markAsPendingWelcome: (groupId: string) => void;\n  /**\n   * Will send external proposal for all the conversations that are not pendingWelcome or established\n   * @param conversations The conversations that we want to process (only the mls conversations will be considered)\n   * @param sendExternalProposal Callback that will be called with every conversation that needs an external proposal\n   */\n  sendExternalToPendingJoin(\n    conversations: Conversation[],\n    isEstablishedConversation: (groupId: string) => Promise<boolean>,\n    sendExternalProposal: (conversationId: QualifiedId) => Promise<unknown>,\n  ): Promise<void>;\n};\n\nexport const mlsConversationState = createVanilla<StoreState>((set, get) => {\n  return {\n    established: initialState.established,\n    filterEstablishedConversations: conversations =>\n      conversations.filter(conversation => !conversation.groupId || get().isEstablished(conversation.groupId)),\n\n    isEstablished: groupId => get().established.has(groupId),\n\n    isPendingWelcome: groupId => get().pendingWelcome.has(groupId),\n\n    markAsEstablished: groupId =>\n      set(state => ({\n        ...state,\n        established: state.established.add(groupId),\n      })),\n\n    markAsPendingWelcome: groupId =>\n      set(state => ({\n        ...state,\n        pendingWelcome: state.pendingWelcome.add(groupId),\n      })),\n\n    pendingWelcome: initialState.pendingWelcome,\n\n    async sendExternalToPendingJoin(conversations, isAlreadyEstablished, sendExternalCommit): Promise<void> {\n      const currentState = get();\n      const conversationsToJoin: {groupId: string; conversationId: QualifiedId}[] = [];\n      const pendingConversations: string[] = [];\n      const alreadyEstablishedConversations: string[] = [];\n\n      for (const conversation of conversations) {\n        const groupId = conversation.groupId;\n        if (!conversation.isUsingMLSProtocol || !groupId) {\n          continue;\n        }\n        if (!currentState.isEstablished(groupId) && !currentState.isPendingWelcome(groupId)) {\n          if (await isAlreadyEstablished(groupId)) {\n            // check is the conversation is not actually already established\n            alreadyEstablishedConversations.push(groupId);\n          } else {\n            conversationsToJoin.push({conversationId: conversation.qualifiedId, groupId});\n          }\n        }\n      }\n\n      await Promise.all(\n        conversationsToJoin.map(async ({conversationId, groupId}) => {\n          try {\n            await sendExternalCommit(conversationId);\n            alreadyEstablishedConversations.push(groupId);\n          } catch {\n            pendingConversations.push(groupId);\n          }\n        }),\n      );\n\n      set({\n        ...currentState,\n        established: new Set([...currentState.established, ...alreadyEstablishedConversations]),\n        pendingWelcome: new Set([...currentState.pendingWelcome, ...pendingConversations]),\n      });\n    },\n  };\n});\n\n/**\n * react hook to manipulate the MLS conversation state\n */\nexport const useMLSConversationState = create(mlsConversationState);\n\nmlsConversationState.subscribe(saveState);\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Account} from '@wireapp/core';\n\nimport {arrayToBase64} from 'Util/util';\n\nimport {mlsConversationState} from './mlsConversationState';\n\nimport {ConversationRepository} from '../conversation/ConversationRepository';\nimport {\n  isMLSConversation,\n  isSelfConversation,\n  isTeamConversation,\n  MLSConversation,\n} from '../conversation/ConversationSelectors';\nimport {Conversation} from '../entity/Conversation';\nimport {User} from '../entity/User';\n\ntype MLSConversationRepository = Pick<\n  ConversationRepository,\n  'findConversationByGroupId' | 'getConversationById' | 'conversationRoleRepository'\n>;\n\nexport async function initMLSConversations(\n  conversations: Conversation[],\n  selfUser: User,\n  core: Account,\n  conversationRepository: MLSConversationRepository,\n): Promise<void> {\n  core.configureMLSCallbacks({\n    authorize: groupIdBytes => {\n      const groupId = arrayToBase64(groupIdBytes);\n      const conversation = conversationRepository.findConversationByGroupId(groupId);\n      if (!conversation) {\n        // If the conversation is not found, it means it's being created by the self user, thus they have admin rights\n        return true;\n      }\n      return conversationRepository.conversationRoleRepository.isUserGroupAdmin(conversation, selfUser);\n    },\n    groupIdFromConversationId: async conversationId => {\n      const conversation = await conversationRepository.getConversationById(conversationId);\n      return conversation?.groupId;\n    },\n    // This is enforced by backend, no need to implement this on the client side.\n    userAuthorize: () => true,\n  });\n\n  const mlsConversations = conversations.filter(isMLSConversation);\n  await joinNewConversations(mlsConversations, core);\n}\n\n/**\n * Will join all the conversation that the current user is part of but that are not joined by the current user's device\n *\n * @param conversations - all the conversations that the user is part of\n * @param core - the instance of the core\n */\nasync function joinNewConversations(conversations: MLSConversation[], core: Account): Promise<void> {\n  // We send external proposal to all the MLS conversations that are in an unknown state (not established nor pendingWelcome)\n  await mlsConversationState.getState().sendExternalToPendingJoin(\n    conversations,\n    groupId => core.service!.conversation.isMLSConversationEstablished(groupId),\n    conversationId => core.service!.conversation.joinByExternalCommit(conversationId),\n  );\n}\n\n/**\n * Will register special conversations agains the core.\n * The self conversation and the team conversation as special conversation that are created by noone and, thus, need to be manually created by the first device that detects them\n *\n * @param conversations all the conversations the user is part of\n * @param core instance of the core\n */\nexport async function registerUninitializedConversations(\n  conversations: Conversation[],\n  selfUser: User,\n  selfClientId: string,\n  core: Account,\n): Promise<void> {\n  const uninitializedConversations = conversations.filter(\n    (conversation): conversation is MLSConversation =>\n      isMLSConversation(conversation) &&\n      conversation.epoch === 0 &&\n      (isSelfConversation(conversation) || isTeamConversation(conversation)),\n  );\n\n  await Promise.all(\n    uninitializedConversations.map(conversation =>\n      core.service?.mls.registerConversation(conversation.groupId, [selfUser.qualifiedId], {\n        user: selfUser,\n        client: selfClientId,\n      }),\n    ),\n  );\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum MotionDuration {\n  LONG = 550,\n  MEDIUM = 350,\n  SHORT = 150,\n  X_LONG = 700,\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/** @see https://developer.mozilla.org/en-US/docs/Web/API/Notification/permission */\nexport enum PermissionState {\n  DEFAULT = 'default',\n  DENIED = 'denied',\n  GRANTED = 'granted',\n  IGNORED = 'ignored',\n  UNSUPPORTED = 'unsupported',\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {container} from 'tsyringe';\n\nimport {EMOJI_RANGES} from 'Util/EmojiUtil';\nimport {getLogger, Logger} from 'Util/Logger';\nimport {computeTransliteration, sortByPriority, startsWith, transliterationIndex} from 'Util/StringUtil';\n\nimport type {SearchService} from './SearchService';\n\nimport type {User} from '../entity/User';\nimport {Core} from '../service/CoreSingleton';\nimport {validateHandle} from '../user/UserHandleGenerator';\nimport type {UserRepository} from '../user/UserRepository';\n\nexport class SearchRepository {\n  logger: Logger;\n  private readonly searchService: SearchService;\n  private readonly userRepository: UserRepository;\n\n  static get CONFIG() {\n    return {\n      MAX_DIRECTORY_RESULTS: 30,\n      MAX_SEARCH_RESULTS: 10,\n      SEARCHABLE_FIELDS: {\n        NAME: 'name',\n        USERNAME: 'username',\n      },\n    };\n  }\n\n  /**\n   * Trim and remove @.\n   * @param query Search string\n   * @returns Normalized search query\n   */\n  static normalizeQuery(query: string): string {\n    if (typeof query !== 'string') {\n      return '';\n    }\n    return query.trim().replace(/^[@]/, '').toLowerCase();\n  }\n\n  /**\n   * @param searchService SearchService\n   * @param userRepository Repository for all user interactions\n   */\n  constructor(\n    searchService: SearchService,\n    userRepository: UserRepository,\n    private readonly core = container.resolve(Core),\n  ) {\n    this.searchService = searchService;\n    this.userRepository = userRepository;\n    this.logger = getLogger('SearchRepository');\n  }\n\n  /**\n   * Search for a user in the given user list and given a search term.\n   * Doesn't sort the results and keep the initial order of the given user list.\n   *\n   * @param term the search term\n   * @param userEntities entities to match the search term against\n   * @param properties list of properties that will be matched against the search term\n   *    the order of the properties in the array indicates the priorities by which results will be sorted\n   * @returns the filtered list of users\n   */\n  searchUserInSet(\n    term: string,\n    userEntities: User[],\n    properties = [SearchRepository.CONFIG.SEARCHABLE_FIELDS.NAME, SearchRepository.CONFIG.SEARCHABLE_FIELDS.USERNAME],\n  ): User[] {\n    if (term === '') {\n      return userEntities;\n    }\n    const excludedEmojis = Array.from(term).reduce<Record<string, string>>((emojis, char) => {\n      const isEmoji = EMOJI_RANGES.includes(char);\n      if (isEmoji) {\n        emojis[char] = char;\n      }\n      return emojis;\n    }, {});\n    const termSlug = computeTransliteration(term, excludedEmojis);\n    const weightedResults = userEntities.reduce((results, userEntity) => {\n      const values = properties\n        .slice()\n        .reverse()\n        .map((property: keyof User) =>\n          typeof userEntity[property] === 'function' ? (userEntity[property] as Function)() : userEntity[property],\n        );\n\n      const uniqueValues = Array.from(new Set(values));\n      const matchWeight = uniqueValues.reduce((weight, value, index) => {\n        const propertyWeight = 10 * index + 1;\n        const propertyMatchWeight = this.matches(term, termSlug, excludedEmojis, value);\n        return weight + propertyMatchWeight * propertyWeight;\n      }, 0);\n\n      return matchWeight === 0 ? results : results.concat({user: userEntity, weight: matchWeight});\n    }, []);\n\n    return weightedResults\n      .sort((result1, result2) => {\n        if (result2.weight === result1.weight) {\n          return result2.user.name() > result1.user.name() ? -1 : 1;\n        }\n        return result2.weight - result1.weight;\n      })\n      .map(result => result.user);\n  }\n\n  private matches(term: string, termSlug: string, excludedChars?: Record<string, string>, value?: string): number {\n    const isStrictMatch = (value || '').toLowerCase().startsWith(term.toLowerCase());\n    if (isStrictMatch) {\n      // if the pattern matches the raw text, give the maximum value to the match\n      return 100;\n    }\n    const nameSlug = computeTransliteration(value, excludedChars);\n    const nameIndex = transliterationIndex(nameSlug, termSlug);\n    const isStrictTransliteratedMatch = nameIndex === 0;\n    if (isStrictTransliteratedMatch) {\n      // give a little less points if the pattern strictly matches the transliterated string\n      return 50;\n    }\n    const noMatch = nameIndex < 0;\n    if (noMatch) {\n      return 0;\n    }\n\n    const tokens = nameSlug.split(/-/g);\n    // computing the match value by testing all components of the property\n    return tokens.reverse().reduce((weight, token, index) => {\n      const indexWeight = index + 1;\n      let tokenWeight = 0;\n      const tokenIndex = transliterationIndex(token, termSlug);\n\n      if (tokenIndex === 0) {\n        tokenWeight = indexWeight * 10;\n      } else if (tokenIndex > 0) {\n        tokenWeight = indexWeight;\n      }\n\n      return weight + tokenWeight;\n    }, 0);\n  }\n\n  /**\n   * Search for users on the backend by name.\n   * @note We skip a few results as connection changes need a while to reflect on the backend.\n   *\n   * @param query Search query\n   * @param isHandle Is query a user handle\n   * @param maxResults Maximum number of results\n   * @returns Resolves with the search results\n   */\n  async searchByName(\n    query: string,\n    isHandle?: boolean,\n    maxResults = SearchRepository.CONFIG.MAX_SEARCH_RESULTS,\n  ): Promise<User[]> {\n    const [rawName, rawDomain] = this.core.backendFeatures.isFederated ? query.replace(/^@/, '').split('@') : [query];\n    const [name, domain] = validateHandle(rawName, rawDomain) ? [rawName, rawDomain] : [query];\n\n    const matchedUserIdsFromDirectorySearch: QualifiedId[] = await this.searchService\n      .getContacts(name, SearchRepository.CONFIG.MAX_DIRECTORY_RESULTS, domain)\n      .then(({documents}) => documents.map(match => ({domain: match.qualified_id?.domain || '', id: match.id})));\n\n    const userIds: QualifiedId[] = [...matchedUserIdsFromDirectorySearch];\n    const userEntities = await this.userRepository.getUsersById(userIds);\n\n    return Promise.resolve(userEntities)\n      .then(userEntities => userEntities.filter(userEntity => !userEntity.isMe))\n      .then(userEntities => {\n        if (isHandle) {\n          userEntities = userEntities.filter(userEntity => startsWith(userEntity.username(), query));\n        }\n\n        return userEntities\n          .sort((userA, userB) => {\n            return isHandle\n              ? sortByPriority(userA.username(), userB.username(), query)\n              : sortByPriority(userA.name(), userB.name(), query);\n          })\n          .slice(0, maxResults);\n      });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {singleton} from 'tsyringe';\n\nimport {APIClient as APIClientUnconfigured} from '@wireapp/api-client';\n\nimport {Config} from '../Config';\n\n@singleton()\nexport class APIClient extends APIClientUnconfigured {\n  constructor() {\n    super({\n      urls: {\n        name: Config.getConfig().ENVIRONMENT,\n        rest: Config.getConfig().BACKEND_REST,\n        ws: Config.getConfig().BACKEND_WS,\n      },\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum BackendEnvironment {\n  DEVELOPMENT = 'development',\n  PRODUCTION = 'production',\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Config} from '../Config';\n\n/**\n * The value store util allows storing a single value across page navigation.\n * This value will never be stored on the disk, which makes it a good candidate for storing cryptographic key material.\n * There are no guarantees regarding the time the value will stay in memory. Should not be used as a reliable store.\n * Main use case is to pass on a value from a page to another page.\n */\nlet worker: ServiceWorker;\n\nenum ValueStoreActionType {\n  GET = 'get',\n  SAVE = 'save',\n}\n\ninterface ValueStoreAction {\n  action: ValueStoreActionType;\n  value?: string;\n}\n\n/**\n * Returns the ephemeral value and deletes it directly after so it can be only retrieved once.\n */\nexport async function getEphemeralValue(): Promise<any> {\n  const worker = await getWorker();\n  return sendMessage(worker, {action: ValueStoreActionType.GET});\n}\n\nexport async function saveRandomEncryptionKey(): Promise<string> {\n  const secretKey = new Uint32Array(64);\n  window.crypto.getRandomValues(secretKey);\n  const hexKey: string[] = [];\n  for (const x of secretKey) {\n    hexKey.push(`00${x.toString(16)}`.slice(-2));\n  }\n  const encryptionKey = hexKey.join('');\n  await saveEphemeralValue(encryptionKey);\n  return encryptionKey;\n}\n\nexport async function saveEphemeralValue(value: string): Promise<string> {\n  const worker = await getWorker();\n  return sendMessage(worker, {action: ValueStoreActionType.SAVE, value});\n}\n\nasync function getWorker(): Promise<ServiceWorker> {\n  const registration = await navigator.serviceWorker.register(\n    `/worker/sw-value-store.js?${Config.getConfig().VERSION}`,\n  );\n  worker = registration.installing || registration.waiting || registration.active;\n  return worker;\n}\n\nfunction sendMessage(worker: ServiceWorker, action: ValueStoreAction): Promise<string> {\n  const messageChannel = new MessageChannel();\n  return new Promise((resolve, reject) => {\n    messageChannel.port1.onmessage = event => {\n      resolve(event.data);\n    };\n    try {\n      worker.postMessage(action, [messageChannel.port2]);\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Dexie, Table, Transaction} from 'dexie';\n\nimport {getLogger, Logger} from 'Util/Logger';\n\nimport {AmplifyRecord, ConversationRecord, CryptoboxRecord, EventRecord, UserRecord} from './record';\nimport {ClientRecord} from './record/ClientRecord';\nimport {GroupIdRecord} from './record/GroupIdRecord';\nimport {StorageSchemata} from './StorageSchemata';\n\n/**\n * TypeScript representation of local IndexedDB schema managed with Dexie.\n * @see https://dexie.org/docs/Typescript#create-a-subclass\n */\nexport class DexieDatabase extends Dexie {\n  amplify: Table<AmplifyRecord, string>;\n  clients: Table<ClientRecord, string>;\n  /** @deprecated */\n  conversation_events: Table<{}, string>;\n  conversations: Table<ConversationRecord, string>;\n  events: Table<EventRecord, number>;\n  keys: Table<CryptoboxRecord, string>;\n  prekeys: Table<CryptoboxRecord, string>;\n  sessions: Table<CryptoboxRecord, string>;\n  users: Table<UserRecord, string>;\n  groupIds: Table<GroupIdRecord, string>;\n\n  private readonly logger: Logger;\n\n  constructor(dbName: string) {\n    super(dbName);\n    this.logger = getLogger(`Dexie (${dbName})`);\n\n    StorageSchemata.SCHEMATA.forEach(({schema, upgrade, version}) => {\n      const versionInstance = this.version(version).stores(schema);\n      if (upgrade) {\n        versionInstance.upgrade((transaction: Transaction) => {\n          this.logger.warn(`Database upgrade to version '${version}'`);\n          upgrade(transaction, this);\n        });\n      }\n    });\n\n    this.amplify = this.table(StorageSchemata.OBJECT_STORE.AMPLIFY);\n    this.clients = this.table(StorageSchemata.OBJECT_STORE.CLIENTS);\n    this.conversation_events = this.table(StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS);\n    this.conversations = this.table(StorageSchemata.OBJECT_STORE.CONVERSATIONS);\n    this.events = this.table(StorageSchemata.OBJECT_STORE.EVENTS);\n    this.keys = this.table(StorageSchemata.OBJECT_STORE.KEYS);\n    this.prekeys = this.table(StorageSchemata.OBJECT_STORE.PRE_KEYS);\n    this.sessions = this.table(StorageSchemata.OBJECT_STORE.SESSIONS);\n    this.users = this.table(StorageSchemata.OBJECT_STORE.USERS);\n    this.groupIds = this.table(StorageSchemata.OBJECT_STORE.GROUP_IDS);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {SQLiteProvidedSchema, SQLiteType} from '@wireapp/store-engine-sqleet';\n\nimport {StorageSchemata} from './StorageSchemata';\n\ninterface SQLeetSchema {\n  schema: SQLiteProvidedSchema<string>;\n  version: number;\n}\n\nexport class SQLeetSchemata {\n  static getLatest(): SQLiteProvidedSchema<string> {\n    return SQLeetSchemata.SCHEMATA[SQLeetSchemata.SCHEMATA.length - 1].schema;\n  }\n\n  static get SCHEMATA(): SQLeetSchema[] {\n    return [\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: SQLiteType.JSON_OR_TEXT,\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: {\n            address: SQLiteType.TEXT,\n            class: SQLiteType.TEXT,\n            id: SQLiteType.TEXT,\n            label: SQLiteType.TEXT,\n            location: SQLiteType.JSON,\n            meta: SQLiteType.JSON,\n            model: SQLiteType.TEXT,\n            time: SQLiteType.TEXT,\n            type: SQLiteType.TEXT,\n          },\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: {\n            accessModes: SQLiteType.JSON,\n            accessRole: SQLiteType.TEXT,\n            archived_state: SQLiteType.BOOLEAN,\n            archived_timestamp: SQLiteType.INTEGER,\n            creator: SQLiteType.TEXT,\n            id: SQLiteType.TEXT,\n            last_event_timestamp: SQLiteType.INTEGER,\n            last_server_timestamp: SQLiteType.INTEGER,\n            message_timer: SQLiteType.INTEGER,\n            muted_state: SQLiteType.INTEGER,\n            muted_timestamp: SQLiteType.INTEGER,\n            name: SQLiteType.TEXT,\n            others: SQLiteType.JSON,\n            receipt_mode: SQLiteType.INTEGER,\n            status: SQLiteType.INTEGER,\n            team_id: SQLiteType.TEXT,\n            type: SQLiteType.INTEGER,\n          },\n          [StorageSchemata.OBJECT_STORE.EVENTS]: {\n            category: SQLiteType.INTEGER,\n            conversation: SQLiteType.TEXT,\n            data: SQLiteType.JSON,\n            ephemeral_expires: SQLiteType.TEXT,\n            ephemeral_started: SQLiteType.TEXT,\n            from: SQLiteType.TEXT,\n            from_client_id: SQLiteType.TEXT,\n            id: SQLiteType.TEXT,\n            primary_key: SQLiteType.INTEGER,\n            reactions: SQLiteType.JSON,\n            read_receipts: SQLiteType.JSON,\n            status: SQLiteType.INTEGER,\n            time: SQLiteType.TEXT,\n            type: SQLiteType.TEXT,\n            version: SQLiteType.INTEGER,\n          },\n          [StorageSchemata.OBJECT_STORE.KEYS]: {\n            created: SQLiteType.INTEGER,\n            id: SQLiteType.TEXT,\n            serialised: SQLiteType.TEXT,\n            version: SQLiteType.TEXT,\n          },\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: {\n            created: SQLiteType.INTEGER,\n            id: SQLiteType.TEXT,\n            serialised: SQLiteType.TEXT,\n            version: SQLiteType.TEXT,\n          },\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: {\n            created: SQLiteType.INTEGER,\n            id: SQLiteType.TEXT,\n            serialised: SQLiteType.TEXT,\n            version: SQLiteType.TEXT,\n          },\n          [StorageSchemata.OBJECT_STORE.USERS]: {\n            id: SQLiteType.TEXT,\n          },\n        },\n        version: 1,\n      },\n    ];\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport Dexie from 'dexie';\n\nimport type {CRUDEngine} from '@wireapp/store-engine';\nimport {MemoryEngine} from '@wireapp/store-engine';\nimport {IndexedDBEngine} from '@wireapp/store-engine-dexie';\nimport {SQLeetEngine} from '@wireapp/store-engine-sqleet';\n\nimport {saveRandomEncryptionKey} from 'Util/ephemeralValueStore';\n\nimport {DexieDatabase} from '../storage/DexieDatabase';\nimport {SQLeetSchemata} from '../storage/SQLeetSchemata';\n\nexport enum DatabaseTypes {\n  /** a permament storage that will still live after logout */\n  PERMANENT,\n  /** a storage that is encrypted on disk */\n  ENCRYPTED,\n  /** a storage that will be lost when the app is reloaded */\n  EFFEMERAL,\n}\n\nconst providePermanentEngine = async (storeName: string, requestPersistentStorage: boolean): Promise<CRUDEngine> => {\n  const db = new DexieDatabase(storeName);\n  const engine = new IndexedDBEngine();\n  try {\n    await engine.initWithDb(db, requestPersistentStorage);\n  } catch (error) {\n    await engine.initWithDb(db, false);\n  }\n  return engine as CRUDEngine; // FIXME: the type of IndexedDBEngine needs fixing on the web packages side\n};\n\nconst provideTemporaryAndNonPersistentEngine = async (storeName: string): Promise<CRUDEngine> => {\n  await Dexie.delete('/sqleet');\n  const encryptionKey = await saveRandomEncryptionKey();\n  const engine = new SQLeetEngine('/worker/sqleet-worker.js', SQLeetSchemata.getLatest(), encryptionKey);\n  await engine.init(storeName);\n  return engine;\n};\n\nexport async function createStorageEngine(\n  storeName: string,\n  type: DatabaseTypes,\n  requestPersistentStorage: boolean = false,\n): Promise<CRUDEngine> {\n  switch (type) {\n    case DatabaseTypes.PERMANENT:\n      return providePermanentEngine(storeName, requestPersistentStorage);\n\n    case DatabaseTypes.ENCRYPTED:\n      return provideTemporaryAndNonPersistentEngine(storeName);\n\n    case DatabaseTypes.EFFEMERAL:\n      return new MemoryEngine();\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ClientType} from '@wireapp/api-client/lib/client/';\nimport {container, singleton} from 'tsyringe';\n\nimport {Account} from '@wireapp/core';\n\nimport {isTemporaryClientAndNonPersistent, supportsCoreCryptoProteus, supportsMLS} from 'Util/util';\n\nimport {APIClient} from './APIClientSingleton';\nimport {createStorageEngine, DatabaseTypes} from './StoreEngineProvider';\n\nimport {Config} from '../Config';\n\ndeclare global {\n  interface Window {\n    systemCrypto?: {\n      decrypt: (value: Uint8Array) => Promise<Uint8Array>;\n      encrypt: (encrypted: Uint8Array) => Promise<Uint8Array>;\n    };\n  }\n}\n\n@singleton()\nexport class Core extends Account<Uint8Array> {\n  constructor(apiClient = container.resolve(APIClient)) {\n    super(apiClient, {\n      createStore: (storeName, context) => {\n        const dbType = isTemporaryClientAndNonPersistent(context.clientType === ClientType.PERMANENT)\n          ? DatabaseTypes.ENCRYPTED\n          : DatabaseTypes.PERMANENT;\n\n        return createStorageEngine(storeName, dbType);\n      },\n      cryptoProtocolConfig: {\n        coreCrypoWasmFilePath: '/min/core-crypto.wasm',\n        mls: supportsMLS()\n          ? {\n              keyingMaterialUpdateThreshold: Config.getConfig().FEATURE.MLS_CONFIG_KEYING_MATERIAL_UPDATE_THRESHOLD,\n            }\n          : undefined,\n\n        proteus: supportsCoreCryptoProteus(),\n        /*\n         * When in an electron context, the window.systemCrypto will be populated by the renderer process.\n         * We then give those crypto primitives to the core that will use them when encrypting MLS secrets.\n         * When in a browser context, then this systemCrypto will be undefined and the core will then use it's internal encryption system\n         */\n        systemCrypto: window.systemCrypto,\n      },\n      nbPrekeys: 100,\n    });\n  }\n  get storage() {\n    return this['storeEngine'];\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport const StorageKey = {\n  AUTH: {\n    ACCESS_TOKEN: {\n      EXPIRATION: 'z.storage.StorageKey.AUTH.ACCESS_TOKEN.EXPIRATION',\n      TTL: 'z.storage.StorageKey.AUTH.ACCESS_TOKEN.TTL',\n      TYPE: 'z.storage.StorageKey.AUTH.ACCESS_TOKEN.TYPE',\n      VALUE: 'z.storage.StorageKey.AUTH.ACCESS_TOKEN.VALUE',\n    },\n    COOKIE_LABEL: 'z.storage.StorageKey.AUTH.COOKIE_LABEL',\n    PERSIST: 'z.storage.StorageKey.AUTH.PERSIST',\n    SHOW_LOGIN: 'z.storage.StorageKey.AUTH.SHOW_LOGIN',\n  },\n  CONVERSATION: {\n    EMOJI_USAGE_COUNT: 'z.storage.StorageKey.CONVERSATION.EMOJI_USAGE_COUNT',\n    INPUT: 'z.storage.StorageKey.CONVERSATION.INPUT',\n  },\n  LOCALIZATION: {\n    LOCALE: 'z.storage.StorageKey.LOCALIZATION.LOCALE',\n  },\n  SEARCH: {\n    SUGGESTED_SEARCH_ETS: 'z.storage.StorageKey.SEARCH.SUGGESTED_SEARCH_ETS',\n  },\n};\n\nexport const ROOT_FONT_SIZE_KEY = 'root-font-size';\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {Dexie, Transaction} from 'dexie';\n\nimport {base64ToArray} from 'Util/util';\n\nimport {categoryFromEvent} from '../message/MessageCategorization';\n\ninterface DexieSchema {\n  schema: Record<string, string>;\n  upgrade?: (transaction: Transaction, database?: Dexie) => void;\n  version: number;\n}\n\nexport class StorageSchemata {\n  static get OBJECT_STORE() {\n    return {\n      AMPLIFY: 'amplify',\n      CLIENTS: 'clients',\n      CONVERSATIONS: 'conversations',\n      CONVERSATION_EVENTS: 'conversation_events',\n      EVENTS: 'events',\n      GROUP_IDS: 'group_ids',\n      KEYS: 'keys',\n      LAST_KEY_MATERIAL_UPDATE_DATES: 'last_key_material_update_dates',\n      PENDING_PROPOSALS: 'pending_proposals',\n      PRE_KEYS: 'prekeys',\n      SESSIONS: 'sessions',\n      USERS: 'users',\n    } as const;\n  }\n\n  static get SCHEMATA(): DexieSchema[] {\n    return [\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: '',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', raw.conversation, raw.time, meta.timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        version: 1,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: '',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', raw.conversation, raw.time, raw.type, meta.timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        version: 2,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: '',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', raw.conversation, raw.time, raw.type, meta.timestamp',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        version: 3,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', raw.conversation, raw.time, raw.type, meta.timestamp',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CLIENTS)\n            .toCollection()\n            .modify(client => {\n              client.meta = {is_verified: true, primary_key: 'local_identity'};\n            });\n        },\n        version: 4,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', conversation, time, type',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        version: 5,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', conversation, time, type',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction, database: Dexie) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CONVERSATIONS)\n            .toCollection()\n            .eachKey(key => {\n              database.table(StorageSchemata.OBJECT_STORE.CONVERSATIONS).update(key, {id: key});\n            });\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.SESSIONS)\n            .toCollection()\n            .eachKey(key => {\n              database.table(StorageSchemata.OBJECT_STORE.SESSIONS).update(key, {id: key});\n            });\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.PRE_KEYS)\n            .toCollection()\n            .eachKey(key => {\n              database.table(StorageSchemata.OBJECT_STORE.PRE_KEYS).update(key, {id: key});\n            });\n        },\n        version: 6,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', conversation, time, type',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS)\n            .toCollection()\n            .modify(event => {\n              const mappedEvent = event.mapped || event.raw;\n              delete event.mapped;\n              delete event.raw;\n              delete event.meta;\n              event = {...event, ...mappedEvent};\n            });\n        },\n        version: 7,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', conversation, time, type',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS)\n            .toCollection()\n            .modify(event => {\n              const isTypeDeleteEveryWhere = event.type === 'conversation.delete-everywhere';\n              if (isTypeDeleteEveryWhere) {\n                event.time = new Date(event.time).toISOString();\n              }\n            });\n        },\n        version: 8,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]: ', conversation, time, type, [conversation+time]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        version: 9,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS)\n            .toCollection()\n            .modify(event => {\n              event.category = categoryFromEvent(event);\n            });\n        },\n        version: 10,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          const localClientPrimaryKey = 'local_identity';\n\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CLIENTS)\n            .toCollection()\n            .each((client, cursor) => {\n              const isExpectedMetaPrimaryKey = client.meta.primary_key === localClientPrimaryKey;\n              const isExpectedPrimaryKey = client.primary_key === localClientPrimaryKey;\n\n              const isExpectedClient = isExpectedMetaPrimaryKey && isExpectedPrimaryKey;\n              if (isExpectedClient) {\n                transaction.table(StorageSchemata.OBJECT_STORE.CLIENTS).delete(cursor.primaryKey);\n                transaction.table(StorageSchemata.OBJECT_STORE.CLIENTS).put(client, localClientPrimaryKey);\n              }\n            });\n        },\n        version: 11,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.KEYS)\n            .toCollection()\n            .modify(record => {\n              record.serialised = base64ToArray(record.serialised).buffer;\n            });\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.PRE_KEYS)\n            .toCollection()\n            .modify(record => {\n              record.serialised = base64ToArray(record.serialised).buffer;\n            });\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.SESSIONS)\n            .toCollection()\n            .modify(record => {\n              record.serialised = base64ToArray(record.serialised).buffer;\n            });\n        },\n        version: 12,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction, database: Dexie) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS)\n            .toCollection()\n            .toArray()\n            .then(items => database.table(StorageSchemata.OBJECT_STORE.EVENTS).bulkPut(items));\n        },\n        version: 13,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n        },\n        upgrade: (transaction: Transaction) => {\n          transaction\n            .table(StorageSchemata.OBJECT_STORE.EVENTS)\n            .toCollection()\n            .modify(event => {\n              const isTypeAssetMeta = event.type === 'conversation.asset-meta';\n              if (isTypeAssetMeta) {\n                event.type = 'conversation.asset-add';\n              }\n            });\n        },\n        version: 14,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n          [StorageSchemata.OBJECT_STORE.USERS]: ', id',\n        },\n        version: 15,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n          [StorageSchemata.OBJECT_STORE.USERS]: ', id',\n          [StorageSchemata.OBJECT_STORE.GROUP_IDS]: '',\n        },\n        version: 16,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n          [StorageSchemata.OBJECT_STORE.USERS]: ', id',\n          [StorageSchemata.OBJECT_STORE.GROUP_IDS]: '',\n          [StorageSchemata.OBJECT_STORE.PENDING_PROPOSALS]: '',\n        },\n        version: 17,\n      },\n      {\n        schema: {\n          [StorageSchemata.OBJECT_STORE.AMPLIFY]: '',\n          [StorageSchemata.OBJECT_STORE.CLIENTS]: ', meta.primary_key',\n          [StorageSchemata.OBJECT_STORE.CONVERSATION_EVENTS]:\n            ', category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.CONVERSATIONS]: ', id, last_event_timestamp',\n          [StorageSchemata.OBJECT_STORE.EVENTS]:\n            '++primary_key, id, category, conversation, time, type, [conversation+time], [conversation+category]',\n          [StorageSchemata.OBJECT_STORE.KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.PRE_KEYS]: '',\n          [StorageSchemata.OBJECT_STORE.SESSIONS]: '',\n          [StorageSchemata.OBJECT_STORE.USERS]: ', id',\n          [StorageSchemata.OBJECT_STORE.GROUP_IDS]: '',\n          [StorageSchemata.OBJECT_STORE.PENDING_PROPOSALS]: '',\n          [StorageSchemata.OBJECT_STORE.LAST_KEY_MATERIAL_UPDATE_DATES]: '',\n        },\n        version: 18,\n      },\n      {\n        schema: {},\n        version: 19,\n      },\n    ];\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport Dexie, {Transaction} from 'dexie';\nimport {singleton} from 'tsyringe';\n\nimport {CRUDEngine, error as StoreEngineError} from '@wireapp/store-engine';\nimport {IndexedDBEngine} from '@wireapp/store-engine-dexie';\nimport {SQLeetEngine} from '@wireapp/store-engine-sqleet';\n\nimport {Logger, getLogger} from 'Util/Logger';\nimport {loadValue, storeValue} from 'Util/StorageUtil';\n\nimport {DexieDatabase} from './DexieDatabase';\nimport {StorageSchemata} from './StorageSchemata';\n\nimport {StorageError} from '../error/StorageError';\n\ninterface DatabaseListener {\n  callback: DatabaseListenerCallback;\n  store: string;\n  type: DEXIE_CRUD_EVENT;\n}\n\nexport type DatabaseListenerCallback = (changes: {obj: any; oldObj: any}) => void;\n\nenum DEXIE_CRUD_EVENT {\n  DELETING = 'deleting',\n  UPDATING = 'updating',\n}\n\n@singleton()\nexport class StorageService {\n  public db?: DexieDatabase;\n  private readonly dbListeners: DatabaseListener[] = [];\n  private hasHookSupport: boolean;\n  private engine: CRUDEngine;\n  public isTemporaryAndNonPersistent: boolean;\n  private readonly logger: Logger;\n  public dbName?: string;\n\n  constructor() {\n    this.logger = getLogger('StorageService');\n  }\n\n  //##############################################################################\n  // Initialization\n  //##############################################################################\n\n  /**\n   * Initialize the IndexedDB for a user.\n   *\n   * @param userId User ID\n   * @param requestPersistentStorage if a persistent storage should be requested\n   * @returns Resolves with the database name\n   */\n  init(engine: CRUDEngine): string {\n    this.engine = engine;\n    this.dbName = this.engine.storeName;\n    this.hasHookSupport = this.engine instanceof IndexedDBEngine;\n    this.isTemporaryAndNonPersistent = this.engine instanceof SQLeetEngine;\n\n    try {\n      if (this.hasHookSupport) {\n        this.db = this.engine['db'];\n        this._initCrudHooks(this.db);\n      }\n      return this.dbName;\n    } catch (error) {\n      const logMessage = `Failed to initialize database '${this.dbName}': ${error.message || error}`;\n      this.logger.error(logMessage, {error});\n      throw new StorageError(StorageError.TYPE.FAILED_TO_OPEN, StorageError.MESSAGE.FAILED_TO_OPEN);\n    }\n  }\n\n  private _initCrudHooks(db: DexieDatabase): void {\n    const callListener = (\n      table: string,\n      eventType: string,\n      obj: Object,\n      updatedObj: Object,\n      transaction: Transaction,\n    ) => {\n      transaction.on('complete', () => {\n        this.dbListeners\n          .filter(listener => listener.store === table && listener.type === eventType)\n          .forEach(({callback}) => callback({obj: updatedObj, oldObj: obj}));\n      });\n    };\n\n    const listenableTables = [StorageSchemata.OBJECT_STORE.EVENTS];\n\n    listenableTables.forEach(table => {\n      db.table(table).hook(\n        DEXIE_CRUD_EVENT.UPDATING,\n        function (modifications: Object, primaryKey: string, obj: Object, transaction: Transaction): void {\n          this.onsuccess = updatedObj => callListener(table, DEXIE_CRUD_EVENT.UPDATING, obj, updatedObj, transaction);\n        },\n      );\n\n      db.table(table).hook(\n        DEXIE_CRUD_EVENT.DELETING,\n        function (primaryKey: string, obj: Object, transaction: Transaction): void {\n          this.onsuccess = (): void => callListener(table, DEXIE_CRUD_EVENT.DELETING, obj, undefined, transaction);\n        },\n      );\n    });\n  }\n\n  addUpdatedListener(storeName: string, callback: DatabaseListenerCallback): void {\n    this.dbListeners.push({callback, store: storeName, type: DEXIE_CRUD_EVENT.UPDATING});\n  }\n\n  addDeletedListener(storeName: string, callback: DatabaseListenerCallback): void {\n    this.dbListeners.push({callback, store: storeName, type: DEXIE_CRUD_EVENT.DELETING});\n  }\n\n  //##############################################################################\n  // Interactions\n  //##############################################################################\n\n  /**\n   * Clear all stores.\n   *\n   * @returns Resolves when all stores have been cleared\n   */\n  async clearStores(): Promise<void[]> {\n    const deleteStorePromises = this.isTemporaryAndNonPersistent\n      ? [this.engine.purge()]\n      : Object.keys(this.db?._dbSchema ?? [])\n          // avoid clearing tables needed by third parties (dexie-observable for eg)\n          .filter(table => !table.startsWith('_'))\n          .map(storeName => this.deleteStore(storeName));\n    return Promise.all(deleteStorePromises);\n  }\n\n  /**\n   * Removes persisted data.\n   *\n   * @param storeName Name of the object store\n   * @param primaryKey Primary key\n   * @returns Resolves when the object is deleted\n   */\n  async delete(storeName: string, primaryKey: string): Promise<string> {\n    if (this.hasHookSupport) {\n      return this.engine.delete(storeName, primaryKey);\n    }\n\n    const oldRecord = await this.engine.read<unknown>(storeName, primaryKey);\n    const deletedKey = await this.engine.delete(storeName, primaryKey);\n\n    this.notifyListeners(storeName, DEXIE_CRUD_EVENT.DELETING, oldRecord, undefined);\n\n    return deletedKey;\n  }\n\n  async deleteDatabase(): Promise<boolean> {\n    try {\n      await this.engine.purge();\n      this.logger.info(`Deleting database '${this.dbName}' successful`);\n      this.dbName = undefined;\n      return true;\n    } catch (error) {\n      this.logger.error(`Deleting database '${this.dbName}' failed`);\n      throw error;\n    }\n  }\n\n  async deleteStore(storeName: string): Promise<void> {\n    this.logger.info(`Deleting object store '${storeName}' in database '${this.dbName}'`);\n    await this.engine.deleteAll(storeName);\n  }\n\n  /**\n   * Delete multiple database stores.\n   *\n   * @param storeNames Names of database stores to delete\n   * @returns Resolves when the stores have been deleted\n   */\n  async deleteStores(storeNames: string[]): Promise<void> {\n    const deleteStorePromises = storeNames.map(storeName => this.deleteStore(storeName));\n    await Promise.all(deleteStorePromises);\n  }\n\n  async deleteEventInConversation(storeName: string, conversationId: string, eventId: string): Promise<number> {\n    if (this.isTemporaryAndNonPersistent) {\n      let deletedRecords = 0;\n      const primaryKeys = await this.readAllPrimaryKeys(storeName);\n\n      for (const primaryKey of primaryKeys) {\n        const record = await this.load<{conversation: string; id: string; time: number}>(storeName, primaryKey);\n        if (record?.id === eventId && record.conversation === conversationId) {\n          await this.delete(storeName, primaryKey);\n          deletedRecords++;\n        }\n      }\n\n      return deletedRecords;\n    }\n\n    if (!this.db) {\n      return 0;\n    }\n\n    return this.db\n      .table(storeName)\n      .where('id')\n      .equals(eventId)\n      .and(record => record.conversation === conversationId)\n      .delete();\n  }\n\n  async deleteEventsByDate(storeName: string, conversationId: string, isoDate?: string): Promise<number> {\n    if (this.isTemporaryAndNonPersistent) {\n      let deletedRecords = 0;\n      const primaryKeys = await this.readAllPrimaryKeys(storeName);\n\n      for (const primaryKey of primaryKeys) {\n        const record = await this.load<{conversation: string; time: string}>(storeName, primaryKey);\n        if (record?.conversation === conversationId && (!isoDate || isoDate >= record.time)) {\n          await this.delete(storeName, primaryKey);\n          deletedRecords++;\n        }\n      }\n\n      return deletedRecords;\n    }\n\n    if (!this.db) {\n      return 0;\n    }\n\n    return this.db\n      .table(storeName)\n      .where('conversation')\n      .equals(conversationId)\n      .filter(record => !isoDate || isoDate >= record.time)\n      .delete();\n  }\n\n  /**\n   * Returns an array of all records for a given object store.\n   *\n   * @param storeName Name of object store\n   * @returns Resolves with the records from the object store\n   */\n  async getAll<T = Object>(storeName: string): Promise<T[]> {\n    try {\n      const records = await this.engine.readAll<T>(storeName);\n      return records.filter(Boolean);\n    } catch (error) {\n      this.logger.error(`Failed to load objects from store '${storeName}'`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * @param tableNames Names of tables to get\n   * @returns Resolves with matching tables\n   */\n  getTables(tableNames: string[]): Dexie.Table<any, any>[] {\n    if (!this.db) {\n      return [];\n    }\n    return tableNames.map(tableName => this.db.table(tableName));\n  }\n\n  /**\n   * Loads persisted data via a promise.\n   * @note If a key cannot be found, it resolves and returns \"undefined\".\n   *\n   * @param storeName Name of object store\n   * @param primaryKey Primary key of object to be retrieved\n   * @returns Resolves with the record matching the primary key\n   */\n  async load<T = Object>(storeName: string, primaryKey: string): Promise<T | undefined> {\n    try {\n      return await this.engine.read<T>(storeName, primaryKey);\n    } catch (error) {\n      if (error instanceof StoreEngineError.RecordNotFoundError) {\n        return undefined;\n      }\n      this.logger.error(`Failed to load '${primaryKey}' from store '${storeName}'`, error);\n      throw error;\n    }\n  }\n\n  async loadFromSimpleStorage<T = Object>(primaryKey: string): Promise<T | undefined> {\n    if (this.isTemporaryAndNonPersistent) {\n      return this.load<T>(StorageSchemata.OBJECT_STORE.AMPLIFY, primaryKey);\n    }\n\n    return loadValue(primaryKey);\n  }\n\n  async readAllPrimaryKeys(storeName: string): Promise<string[]> {\n    return this.engine.readAllPrimaryKeys(storeName);\n  }\n\n  /**\n   * Saves objects in the local database.\n   *\n   * @param storeName Name of object store where to save the object\n   * @param primaryKey Primary key which should be used to store the object\n   * @param entity Data to store in object store\n   * @returns Resolves with the primary key of the persisted object\n   */\n  async save<T = Object>(storeName: string, primaryKey: string, entity: T): Promise<string> {\n    if (!entity) {\n      throw new StorageError(StorageError.TYPE.NO_DATA, StorageError.MESSAGE.NO_DATA);\n    }\n\n    if (this.isTemporaryAndNonPersistent) {\n      try {\n        const newKey = await this.engine.create(storeName, primaryKey, entity);\n        return newKey;\n      } catch (error) {\n        if (error instanceof StoreEngineError.RecordAlreadyExistsError) {\n          await this.update(storeName, primaryKey, entity);\n          return primaryKey;\n        }\n        this.logger.error(`Failed to create '${primaryKey}' in store '${storeName}'`, error);\n        throw error;\n      }\n    } else {\n      try {\n        const newKey = await this.engine.updateOrCreate(storeName, primaryKey, entity);\n        return newKey;\n      } catch (error) {\n        this.logger.error(`Failed to update or create '${primaryKey}' in store '${storeName}'`, error);\n        throw error;\n      }\n    }\n  }\n\n  async saveToSimpleStorage<T = Object>(primaryKey: string, entity: T): Promise<void> {\n    if (this.isTemporaryAndNonPersistent) {\n      await this.engine.updateOrCreate(StorageSchemata.OBJECT_STORE.AMPLIFY, primaryKey, entity);\n    } else {\n      storeValue(primaryKey, entity);\n    }\n  }\n\n  /**\n   * Closes the database. This operation completes immediately and there is no returned Promise.\n   * @see https://github.com/dfahlander/Dexie.js/wiki/Dexie.close()\n   * @param reason Cause for the termination\n   */\n  terminate(reason: string = 'unknown reason'): void {\n    this.logger.info(`Closing database connection with '${this.dbName}' because of '${reason}'.`);\n    if (this.db) {\n      this.db.close();\n    }\n  }\n\n  private notifyListeners<T, U>(storeName: string, eventType: DEXIE_CRUD_EVENT, oldRecord: T, newRecord: U): void {\n    this.dbListeners\n      .filter(dbListener => dbListener.store === storeName && dbListener.type === eventType)\n      .forEach(dbListener => dbListener.callback({obj: newRecord, oldObj: oldRecord}));\n  }\n\n  /**\n   * Update previously persisted data via a promise.\n   *\n   * @param storeName Name of object store\n   * @param primaryKey Primary key of object to be updated\n   * @param changes Object containing the key paths to each property you want to change\n   * @returns Promise with the number of updated records (0 if no records were changed).\n   */\n  async update<T extends Record<string, any>>(storeName: string, primaryKey: string, changes: T): Promise<number> {\n    try {\n      if (this.hasHookSupport) {\n        const numberOfUpdates = await this.db.table(storeName).update(primaryKey, changes);\n        const logMessage = `Updated ${numberOfUpdates} record(s) with key '${primaryKey}' in store '${storeName}'`;\n        this.logger.info(logMessage, changes);\n        return numberOfUpdates;\n      }\n      const oldRecord = await this.load<unknown>(storeName, primaryKey);\n      await this.engine.update(storeName, primaryKey, changes);\n      const newRecord = await this.load<unknown>(storeName, primaryKey);\n\n      this.notifyListeners(storeName, DEXIE_CRUD_EVENT.UPDATING, oldRecord, newRecord);\n\n      return 1;\n    } catch (error) {\n      this.logger.error(`Failed to update '${primaryKey}' in store '${storeName}'`, error);\n      throw error;\n    }\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {container} from 'tsyringe';\n\nimport {Logger, getLogger} from 'Util/Logger';\n\nimport {StorageService} from './StorageService';\n\nimport {StorageError} from '../error/StorageError';\nimport {StorageSchemata} from '../storage/StorageSchemata';\n\ntype AmplifyRecord = {key: string; value: string};\n\nexport class StorageRepository {\n  private readonly AMPLIFY_STORE_NAME: string;\n  private readonly logger: Logger;\n\n  static get CONFIG() {\n    return {\n      CRYPTOGRAPHY_TABLES: [\n        StorageSchemata.OBJECT_STORE.AMPLIFY,\n        StorageSchemata.OBJECT_STORE.CLIENTS,\n        StorageSchemata.OBJECT_STORE.KEYS,\n        StorageSchemata.OBJECT_STORE.SESSIONS,\n        StorageSchemata.OBJECT_STORE.PRE_KEYS,\n      ],\n    };\n  }\n\n  constructor(public readonly storageService = container.resolve(StorageService)) {\n    this.logger = getLogger('StorageRepository');\n    this.AMPLIFY_STORE_NAME = StorageSchemata.OBJECT_STORE.AMPLIFY;\n  }\n\n  clearStores(): Promise<void> {\n    return this.storageService\n      .clearStores()\n      .then(() => this.logger.info(`Cleared database '${this.storageService.dbName}'`));\n  }\n\n  deleteCryptographyStores(): Promise<void> {\n    return this.storageService.deleteStores(StorageRepository.CONFIG.CRYPTOGRAPHY_TABLES);\n  }\n\n  deleteDatabase(): Promise<boolean> {\n    this.logger.warn(`Deleting database '${this.storageService.dbName}'`);\n    return this.storageService.deleteDatabase();\n  }\n\n  getValue(primaryKey: string): Promise<string | AmplifyRecord> {\n    return this.storageService.load<AmplifyRecord>(this.AMPLIFY_STORE_NAME, primaryKey).then(record => {\n      if (record?.value) {\n        return record.value;\n      }\n      throw new StorageError(StorageError.TYPE.NOT_FOUND, StorageError.MESSAGE.NOT_FOUND);\n    });\n  }\n\n  async saveValue<T>(primaryKey: string, value: T): Promise<string> {\n    await this.storageService.save(this.AMPLIFY_STORE_NAME, primaryKey, {value});\n    return primaryKey;\n  }\n\n  terminate(reason: string): void {\n    this.storageService.terminate(reason);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {FeatureList, FeatureStatus, SelfDeletingTimeout} from '@wireapp/api-client/lib/team/feature/';\nimport ko from 'knockout';\nimport {container, singleton} from 'tsyringe';\n\nimport {sortUsersByPriority} from 'Util/StringUtil';\n\nimport {TeamEntity} from './TeamEntity';\n\nimport {User} from '../entity/User';\nimport {ROLE} from '../user/UserPermission';\nimport {UserState} from '../user/UserState';\n\n@singleton()\nexport class TeamState {\n  public readonly isTeamDeleted: ko.Observable<boolean>;\n  public readonly memberInviters: ko.Observable<any>;\n  public readonly memberRoles: ko.Observable<any>;\n  public readonly supportsLegalHold: ko.Observable<boolean>;\n  public readonly teamName: ko.PureComputed<string>;\n  public readonly teamFeatures: ko.Observable<FeatureList>;\n  public readonly classifiedDomains: ko.PureComputed<string[] | undefined>;\n  public readonly isConferenceCallingEnabled: ko.PureComputed<boolean>;\n  public readonly isFileSharingSendingEnabled: ko.PureComputed<boolean>;\n  public readonly isFileSharingReceivingEnabled: ko.PureComputed<boolean>;\n  public readonly isVideoCallingEnabled: ko.PureComputed<boolean>;\n  public readonly isMLSEnabled: ko.PureComputed<boolean>;\n  public readonly isProtocolToggleEnabledForUser: ko.PureComputed<boolean>;\n  public readonly isGuestLinkEnabled: ko.PureComputed<boolean>;\n  public readonly isSelfDeletingMessagesEnabled: ko.PureComputed<boolean>;\n  public readonly isSelfDeletingMessagesEnforced: ko.PureComputed<boolean>;\n  public readonly getEnforcedSelfDeletingMessagesTimeout: ko.PureComputed<SelfDeletingTimeout>;\n  public readonly isAppLockEnabled: ko.PureComputed<boolean>;\n  public readonly isAppLockEnforced: ko.PureComputed<boolean>;\n  public readonly appLockInactivityTimeoutSecs: ko.PureComputed<number>;\n  readonly teamMembers: ko.PureComputed<User[]>;\n  readonly teamUsers: ko.PureComputed<User[]>;\n  readonly isTeam: ko.PureComputed<boolean>;\n  readonly team: ko.Observable<TeamEntity>;\n  readonly teamDomain: ko.PureComputed<string>;\n  readonly teamSize: ko.PureComputed<number>;\n\n  constructor(private readonly userState = container.resolve(UserState)) {\n    this.team = ko.observable();\n\n    this.isTeam = ko.pureComputed(() => !!this.team()?.id);\n    this.isTeamDeleted = ko.observable(false);\n\n    /** Note: this does not include the self user */\n    this.teamMembers = ko.pureComputed(() => (this.isTeam() ? this.team().members() : []));\n    this.memberRoles = ko.observable({});\n    this.memberInviters = ko.observable({});\n    this.teamFeatures = ko.observable();\n\n    this.teamDomain = ko.pureComputed(() => userState.self().domain);\n    this.teamName = ko.pureComputed(() => (this.isTeam() ? this.team().name() : this.userState.self().name()));\n    this.teamSize = ko.pureComputed(() => (this.isTeam() ? this.teamMembers().length + 1 : 0));\n    this.teamUsers = ko.pureComputed(() => {\n      return this.teamMembers()\n        .concat(this.userState.connectedUsers())\n        .filter((item, index, array) => array.indexOf(item) === index)\n        .sort(sortUsersByPriority);\n    });\n\n    this.supportsLegalHold = ko.observable(false);\n\n    this.userState.isTeam = this.isTeam;\n    this.userState.teamMembers = this.teamMembers;\n    this.userState.teamUsers = this.teamUsers;\n\n    this.isFileSharingSendingEnabled = ko.pureComputed(() => {\n      const status = this.teamFeatures()?.fileSharing?.status;\n      return status ? status === FeatureStatus.ENABLED : true;\n    });\n    this.isFileSharingReceivingEnabled = ko.pureComputed(() => {\n      const status = this.teamFeatures()?.fileSharing?.status;\n      return status ? status === FeatureStatus.ENABLED : true;\n    });\n\n    this.classifiedDomains = ko.pureComputed(() => {\n      return this.teamFeatures()?.classifiedDomains.status === FeatureStatus.ENABLED\n        ? this.teamFeatures().classifiedDomains.config.domains\n        : undefined;\n    });\n\n    this.isSelfDeletingMessagesEnabled = ko.pureComputed(\n      () => this.teamFeatures()?.selfDeletingMessages?.status === FeatureStatus.ENABLED,\n    );\n    this.getEnforcedSelfDeletingMessagesTimeout = ko.pureComputed(\n      () =>\n        (this.teamFeatures()?.selfDeletingMessages?.config?.enforcedTimeoutSeconds || SelfDeletingTimeout.OFF) * 1000,\n    );\n    this.isSelfDeletingMessagesEnforced = ko.pureComputed(\n      () => this.getEnforcedSelfDeletingMessagesTimeout() > SelfDeletingTimeout.OFF,\n    );\n\n    this.isVideoCallingEnabled = ko.pureComputed(\n      // TODO connect to video calling feature config\n      () => true || this.teamFeatures()?.videoCalling?.status === FeatureStatus.ENABLED,\n    );\n\n    this.isMLSEnabled = ko.pureComputed(() => this.teamFeatures()?.mls?.status === FeatureStatus.ENABLED ?? false);\n\n    this.isProtocolToggleEnabledForUser = ko.pureComputed(\n      () => this.teamFeatures()?.mls?.config.protocolToggleUsers.includes(this.userState.self().id) ?? false,\n    );\n\n    this.isConferenceCallingEnabled = ko.pureComputed(\n      () => this.teamFeatures()?.conferenceCalling?.status === FeatureStatus.ENABLED,\n    );\n    this.isAppLockEnabled = ko.pureComputed(() => this.teamFeatures()?.appLock?.status === FeatureStatus.ENABLED);\n    this.isAppLockEnforced = ko.pureComputed(() => this.teamFeatures()?.appLock?.config?.enforceAppLock);\n    this.appLockInactivityTimeoutSecs = ko.pureComputed(\n      () => this.teamFeatures()?.appLock?.config?.inactivityTimeoutSecs,\n    );\n    this.isGuestLinkEnabled = ko.pureComputed(\n      () => this.teamFeatures()?.conversationGuestLinks?.status === FeatureStatus.ENABLED,\n    );\n  }\n\n  readonly isExternal = (userId: string): boolean => {\n    return this.memberRoles()[userId] === ROLE.PARTNER;\n  };\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/**\n * Definition of events used for user analytics (defined by Business Intelligence Team)\n */\nexport const EventName = {\n  APP_OPEN: 'app.open',\n  CALLING: {\n    ENDED_CALL: 'calling.ended_call',\n    ESTABLISHED_CALL: 'calling.established_call',\n    INITIATED_CALL: 'calling.initiated_call',\n    JOINED_CALL: 'calling.joined_call',\n    RECEIVED_CALL: 'calling.received_call',\n    SCREEN_SHARE: 'calling.screen_share',\n  },\n  CONTRIBUTED: 'contributed',\n  E2EE: {\n    FAILED_MESSAGE_DECRYPTION: 'e2ee.failed_message_decryption',\n  },\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport getSlug from 'speakingurl';\n\nimport {randomElement} from 'Util/ArrayUtil';\nimport {getRandomNumber} from 'Util/NumberUtil';\n\nconst MIN_HANDLE_LENGTH = 2;\nexport const MAX_HANDLE_LENGTH = 256;\n\nconst RANDOM_WORDS_1 = [\n  ...['acid', 'agate', 'agile', 'amber', 'aqua', 'arid', 'avid', 'azure', 'baby', 'basic', 'beige', 'best', 'black'],\n  ...['blond', 'blue', 'brass', 'brave', 'brown', 'busy', 'chief', 'chill', 'clear', 'cold', 'cool', 'coral', 'cosy'],\n  ...['cozy', 'cream', 'curly', 'cyan', 'dear', 'dry', 'early', 'even', 'fancy', 'fast', 'fit', 'folk', 'gold'],\n  ...['green', 'grey', 'happy', 'hazy', 'icy', 'iron', 'kind', 'large', 'lazy', 'lemon', 'light', 'lilac', 'lime'],\n  ...['lord', 'lucid', 'mauve', 'melt', 'merry', 'mint', 'nice', 'noir', 'ochre', 'odd', 'olive', 'opal', 'peach'],\n  ...['pearl', 'pink', 'plain', 'purple', 'quiet', 'rapid', 'red', 'rock', 'rose', 'ruby', 'rust', 'sand', 'sassy'],\n  ...['shiny', 'shy', 'silly', 'slow', 'small', 'stone', 'sweet', 'swift', 'talc', 'tame', 'tiny', 'topaz', 'torn'],\n  ...['total', 'vinyl', 'violet', 'warm', 'white', 'wise', 'witty', 'yellow', 'young', 'zinc'],\n];\n\nconst RANDOM_WORDS_2 = [\n  ...['alligator', 'alpaca', 'ant', 'antelope', 'asp', 'badger', 'bat', 'bear', 'bee', 'beetle', 'bird', 'bison'],\n  ...['bobcat', 'buffalo', 'buzzard', 'camel', 'caribou', 'carp', 'cat', 'catfish', 'cheetah', 'clam', 'cobra', 'cod'],\n  ...['condor', 'cow', 'coyote', 'crane', 'crayfish', 'cricket', 'crow', 'deer', 'dog', 'dolphin', 'donkey', 'dove'],\n  ...['duck', 'eagle', 'eel', 'elk', 'falcon', 'ferret', 'finch', 'fly', 'fox', 'frog', 'gazelle', 'giraffe', 'gnu'],\n  ...['goat', 'goose', 'gopher', 'grouse', 'gull', 'halibut', 'hamster', 'hare', 'hawk', 'heron', 'herring', 'horse'],\n  ...['husky', 'impala', 'jackal', 'jaguar', 'kangaroo', 'koala', 'lemur', 'lion', 'lizard', 'llama', 'lobster'],\n  ...['mackerel', 'mole', 'moose', 'moth', 'mouse', 'mule', 'mussel', 'newt', 'octopus', 'orca', 'ostrich', 'otter'],\n  ...['owl', 'ox', 'oyster', 'panda', 'panther', 'parrot', 'pelican', 'penguin', 'pigeon', 'pike', 'pony', 'quail'],\n  ...['rabbit', 'racoon', 'ram', 'raven', 'salmon', 'sardine', 'seal', 'shark', 'sheep', 'sloth', 'snail', 'snake'],\n  ...['squid', 'sturgeon', 'swan', 'tiger', 'tilapia', 'toad', 'trout', 'tuna', 'turkey', 'turtle', 'walrus', 'wapiti'],\n  ...['wasp', 'weasel', 'whale', 'wolf', 'wombat', 'yak', 'zebra'],\n];\n\nconst getRandomWordCombination = () => `${randomElement(RANDOM_WORDS_1)}${randomElement(RANDOM_WORDS_2)}`;\n\n/**\n * Validates that a character can be used for a handle.\n */\nexport const validateCharacter = (character: string): boolean => {\n  const isAlphaNumeric = /[a-z0-9_.-]/.test(character);\n  const isString = typeof character === 'string' && character.length === 1;\n  return isAlphaNumeric && isString;\n};\n\n/**\n * Appends random digits from 1 to 9 to the end of the string.\n */\nexport const appendRandomDigits = (handle: string, additionalNumbers?: number): string => {\n  const randomDigits = Array.from({length: additionalNumbers}, () => getRandomNumber(1, 8));\n  return `${handle}${randomDigits.join('')}`;\n};\n\n/**\n * Creates a handle based on the users name.\n */\nexport const normalizeName = (name: string): string =>\n  getSlug(name, {custom: ['.', '-']})\n    .toLowerCase()\n    .replace(/[^a-z0-9_.-]/g, '')\n    .substring(0, MAX_HANDLE_LENGTH);\n\n/**\n * Validates that an input is a valid handle.\n */\nexport const validateHandle = (handle: string = '', domain?: string): boolean => {\n  if (!handle.length || handle.length < MIN_HANDLE_LENGTH || handle.length > MAX_HANDLE_LENGTH) {\n    return false;\n  }\n\n  const isValidDomain =\n    !domain ||\n    /^((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(domain);\n  const isValidName = handle.split('').every(validateCharacter);\n\n  return isValidDomain && isValidName;\n};\n\n/**\n * Creates variations of the given handle by appending random digits.\n */\nexport const generateHandleVariations = (handle: string, numberOfVariations: number = 5): string[] => {\n  return Array.from({length: numberOfVariations}, (element, index) => {\n    const value = index + 1;\n    return appendRandomDigits(handle.slice(0, MAX_HANDLE_LENGTH - value), value);\n  });\n};\n\n/**\n * Create a set of suggestions based on the name.\n */\nexport const createSuggestions = (name: string): string[] => {\n  const normalizedName = normalizeName(name);\n  const randomName = getRandomWordCombination();\n  const suggestions = [];\n\n  if (normalizedName) {\n    suggestions.push(normalizedName);\n    const normalizedNameVariations = generateHandleVariations(normalizedName);\n    suggestions.push(...normalizedNameVariations);\n  }\n\n  suggestions.push(appendRandomDigits(randomName));\n  const randomNameVariations = generateHandleVariations(randomName);\n  suggestions.push(...randomNameVariations);\n  return suggestions;\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {PermissionsData} from '@wireapp/api-client/lib/team/member/PermissionsData';\n\nimport {capitalizeFirstChar} from 'Util/StringUtil';\n\nimport {TeamError} from '../error/TeamError';\n\n/**\n * Enum for various team permissions.\n */\nconst TEAM_FEATURES = {\n  NONE: 0,\n  CREATE_CONVERSATION: 1 << 0,\n  DELETE_CONVERSATION: 1 << 1,\n  ADD_TEAM_MEMBER: 1 << 2,\n  REMOVE_TEAM_MEMBER: 1 << 3,\n  ADD_CONVERSATION_MEMBER: 1 << 4,\n  REMOVE_CONVERSATION_MEMBER: 1 << 5,\n  GET_BILLING: 1 << 6,\n  SET_BILLING: 1 << 7,\n  SET_TEAM_DATA: 1 << 8,\n  GET_MEMBER_PERMISSIONS: 1 << 9,\n  GET_TEAM_CONVERSATIONS: 1 << 10,\n  DELETE_TEAM: 1 << 11,\n  SET_MEMBER_PERMISSIONS: 1 << 12,\n};\n\n/*\n * While the values for team features are set by the backend,\n * the public features are set by the webapp.\n * To avoid duplications, the values for the public features\n * need to be higher than the values for team features.\n * Additionally, we also don't want to change them manually\n * every time there is a new team feature.\n */\nlet bitsCounter = Object.keys(TEAM_FEATURES).length - 1;\n\nconst PUBLIC_FEATURES = {\n  CHAT_WITH_SERVICES: 1 << bitsCounter++,\n  CREATE_GROUP_CONVERSATION: 1 << bitsCounter++,\n  CREATE_GUEST_ROOM: 1 << bitsCounter++,\n  INVITE_TEAM_MEMBERS: 1 << bitsCounter++,\n  MANAGE_SERVICES: 1 << bitsCounter++,\n  MANAGE_TEAM: 1 << bitsCounter++,\n  SEARCH_UNCONNECTED_USERS: 1 << bitsCounter++,\n  UPDATE_CONVERSATION_SETTINGS: 1 << bitsCounter++,\n  UPDATE_GROUP_PARTICIPANTS: 1 << bitsCounter++,\n};\n\nexport const FEATURES = {...TEAM_FEATURES, ...PUBLIC_FEATURES};\n\nfunction teamPermissionsForRole(teamRole: ROLE): number {\n  switch (teamRole) {\n    case ROLE.OWNER: {\n      return combinePermissions([\n        teamPermissionsForRole(ROLE.ADMIN),\n        TEAM_FEATURES.DELETE_TEAM,\n        TEAM_FEATURES.GET_BILLING,\n        TEAM_FEATURES.SET_BILLING,\n      ]);\n    }\n    case ROLE.ADMIN: {\n      return combinePermissions([\n        teamPermissionsForRole(ROLE.MEMBER),\n        TEAM_FEATURES.ADD_TEAM_MEMBER,\n        TEAM_FEATURES.REMOVE_TEAM_MEMBER,\n        TEAM_FEATURES.SET_MEMBER_PERMISSIONS,\n        TEAM_FEATURES.SET_TEAM_DATA,\n      ]);\n    }\n    case ROLE.MEMBER: {\n      return combinePermissions([\n        teamPermissionsForRole(ROLE.PARTNER),\n        TEAM_FEATURES.ADD_CONVERSATION_MEMBER,\n        TEAM_FEATURES.DELETE_CONVERSATION,\n        TEAM_FEATURES.GET_MEMBER_PERMISSIONS,\n        TEAM_FEATURES.REMOVE_CONVERSATION_MEMBER,\n      ]);\n    }\n    case ROLE.PARTNER: {\n      return combinePermissions([TEAM_FEATURES.CREATE_CONVERSATION, TEAM_FEATURES.GET_TEAM_CONVERSATIONS]);\n    }\n    default: {\n      return 0;\n    }\n  }\n}\n\nfunction publicPermissionsForRole(role: ROLE): number {\n  switch (role) {\n    case ROLE.OWNER:\n      return combinePermissions([publicPermissionsForRole(ROLE.ADMIN), PUBLIC_FEATURES.INVITE_TEAM_MEMBERS]);\n    case ROLE.ADMIN:\n      return combinePermissions([\n        publicPermissionsForRole(ROLE.MEMBER),\n        PUBLIC_FEATURES.MANAGE_SERVICES,\n        PUBLIC_FEATURES.MANAGE_TEAM,\n      ]);\n    case ROLE.MEMBER:\n      return combinePermissions([\n        publicPermissionsForRole(ROLE.NONE),\n        PUBLIC_FEATURES.CREATE_GROUP_CONVERSATION,\n        PUBLIC_FEATURES.CREATE_GUEST_ROOM,\n      ]);\n    case ROLE.NONE:\n      return combinePermissions([\n        PUBLIC_FEATURES.CREATE_GROUP_CONVERSATION,\n        PUBLIC_FEATURES.UPDATE_CONVERSATION_SETTINGS,\n        PUBLIC_FEATURES.UPDATE_GROUP_PARTICIPANTS,\n        PUBLIC_FEATURES.CHAT_WITH_SERVICES,\n        PUBLIC_FEATURES.SEARCH_UNCONNECTED_USERS,\n      ]);\n    case ROLE.PARTNER:\n      return 0;\n    default:\n      return 0;\n  }\n}\n\n/** Enum describing all the roles of a team member */\nexport enum ROLE {\n  ADMIN = 'z.team.TeamRole.ROLE.ADMIN',\n  INVALID = 'z.team.TeamRole.ROLE.INVALID',\n  MEMBER = 'z.team.TeamRole.ROLE.MEMBER',\n  NONE = 'z.team.TeamRole.ROLE.NONE',\n  OWNER = 'z.team.TeamRole.ROLE.OWNER',\n  PARTNER = 'z.team.TeamRole.ROLE.PARTNER',\n}\n\n/** Roles sorted by priority, highest first. */\nconst RolesByPriority = [ROLE.OWNER, ROLE.ADMIN, ROLE.MEMBER, ROLE.PARTNER, ROLE.NONE, ROLE.INVALID];\n\nexport function roleFromTeamPermissions(permissions: PermissionsData): ROLE {\n  if (!permissions) {\n    throw new TeamError(TeamError.TYPE.NO_PERMISSIONS, TeamError.MESSAGE.NO_PERMISSIONS);\n  }\n\n  const invalidRoles = [ROLE.INVALID, ROLE.NONE];\n  const detectedRole = RolesByPriority.filter(role => !invalidRoles.includes(role)).find(role =>\n    hasPermissionForRole(permissions.self, role),\n  );\n\n  return detectedRole || ROLE.INVALID;\n}\n\n/**\n * Will generate a bunch of helper functions that can be consumed to know what features this role has access to.\n * The function generated will have the following format:\n *   `can<camel cased feature name>: () => boolean`\n *\n * @param boundRole Default role that will be used by default in every helper. Can be overridden by passing a role when calling the helper\n * @returns helpers\n */\nexport function generatePermissionHelpers(boundRole = ROLE.NONE): Record<string, (role?: ROLE) => boolean> {\n  return Object.entries(FEATURES).reduce<Record<string, (role: ROLE) => boolean>>(\n    (helpers, [featureKey, featureValue]: [string, number]) => {\n      const camelCasedFeature = featureKey.toLowerCase().split('_').map(capitalizeFirstChar).join('');\n      helpers[`can${camelCasedFeature}`] = (role = boundRole) => hasAccessToFeature(featureValue, role);\n      return helpers;\n    },\n    {},\n  );\n}\n\nexport function hasAccessToFeature(feature: number, role: ROLE): boolean {\n  const permissions = combinePermissions([teamPermissionsForRole(role), publicPermissionsForRole(role)]);\n  return !!(feature & permissions);\n}\n\nexport function combinePermissions(permissions: number[]): number {\n  return permissions.reduce((acc, permission) => acc | permission, 0);\n}\n\nexport function hasPermissions(memberPermissions: number, expectedPermissions: number): boolean {\n  return Number.isSafeInteger(memberPermissions) && (memberPermissions & expectedPermissions) === expectedPermissions;\n}\n\nfunction hasPermissionForRole(memberPermissions: number, role: ROLE): boolean {\n  const rolePermissions = teamPermissionsForRole(role);\n  return hasPermissions(memberPermissions, rolePermissions);\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport ko from 'knockout';\nimport {singleton} from 'tsyringe';\n\nimport {sortUsersByPriority} from 'Util/StringUtil';\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nimport {User} from '../entity/User';\n\n@singleton()\nexport class UserState {\n  public directlyConnectedUsers: ko.PureComputed<User[]>;\n  public isTeam: ko.Observable<boolean> | ko.PureComputed<boolean>;\n  /** All the users that are directly connect to the self user (do not include users that are connected through conversations) */\n  public readonly connectedUsers: ko.PureComputed<User[]>;\n  public readonly users: ko.ObservableArray<User>;\n  public teamMembers: ko.PureComputed<User[]>;\n  /** Note: this does not include the self user */\n  public teamUsers: ko.PureComputed<User[]>;\n  public readonly connectRequests: ko.PureComputed<User[]>;\n  public readonly isActivatedAccount: ko.PureComputed<boolean>;\n  public readonly isTemporaryGuest: ko.PureComputed<boolean>;\n  public readonly numberOfContacts: ko.PureComputed<number>;\n  public readonly self: ko.Observable<User>;\n\n  constructor() {\n    this.self = ko.observable();\n    this.users = ko.observableArray([]);\n\n    this.connectRequests = ko\n      .pureComputed(() => this.users().filter(userEntity => userEntity.isIncomingRequest()))\n      .extend({rateLimit: 50});\n\n    this.connectedUsers = ko\n      .pureComputed(() => {\n        return this.users()\n          .filter(userEntity => userEntity.isConnected())\n          .sort(sortUsersByPriority);\n      })\n      .extend({rateLimit: TIME_IN_MILLIS.SECOND});\n\n    this.isActivatedAccount = ko.pureComputed(() => !this.self()?.isTemporaryGuest());\n    this.isTemporaryGuest = ko.pureComputed(() => this.self()?.isTemporaryGuest());\n\n    this.isTeam = ko.observable();\n    this.teamMembers = ko.pureComputed((): User[] => []);\n    this.teamUsers = ko.pureComputed((): User[] => []);\n\n    this.directlyConnectedUsers = ko.pureComputed((): User[] => []);\n\n    this.numberOfContacts = ko.pureComputed(() => {\n      const contacts = this.isTeam() ? this.teamUsers() : this.connectedUsers();\n      return contacts.filter(userEntity => !userEntity.isService).length;\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function chunk<T>(array: T[], size: number): T[][];\n\nexport function chunk(array: Float32Array, size: number): Float32Array[];\n\nexport function chunk<T>(array: T[] | Float32Array, size: number) {\n  const chunks = [];\n  for (let index = 0, length = array.length; index < length; index += size) {\n    chunks.push(array.slice(index, index + size));\n  }\n  return chunks;\n}\n\n/**\n * Gets all the values that are in array2 which are not in array1.\n *\n * @param array1 the base array\n * @param array2 the array to compare with\n * @param matcher a custom matching function in case referencial equality is not enough\n * @returns the array containing values in array2 that are not in array1\n */\nexport const getDifference = <T>(array1: T[] = [], array2: T[] = [], matcher?: (t1: T, t2: T) => boolean): T[] => {\n  if (matcher) {\n    return array2.filter(el1 => !array1.some(el2 => matcher(el1, el2)));\n  }\n  return array2.filter(element => !array1.includes(element));\n};\n\nexport const getNextItem = <T>(array: T[], currentItem: T): T | undefined => {\n  const currentIndex = array.indexOf(currentItem);\n\n  // couldn't find the item\n  if (currentIndex === -1) {\n    return undefined;\n  }\n\n  const nextIndex = currentIndex + 1;\n\n  // item is last item in the array\n  if (nextIndex === array.length) {\n    return currentIndex > 0 ? array[currentIndex - 1] : undefined;\n  }\n\n  return array[nextIndex];\n};\n\n/**\n * Interpolates an array of numbers using linear interpolation\n *\n * @param array source\n * @param length new length\n * @returns new array with interpolated values\n */\nexport const interpolate = (array: number[], length: number) => {\n  const newArray = [];\n  const scaleFactor = (array.length - 1) / (length - 1);\n\n  newArray[0] = array[0];\n  newArray[length - 1] = array[array.length - 1];\n\n  for (let index = 1; index < length - 1; index++) {\n    const originalIndex = index * scaleFactor;\n    const before = Math.floor(originalIndex);\n    const after = Math.ceil(originalIndex);\n    const point = originalIndex - before;\n    newArray[index] = array[before] + (array[after] - array[before]) * point; // linear interpolation\n  }\n\n  return newArray;\n};\n\nexport const isLastItem = <T>(array: T[], item: T) => array.indexOf(item) === array.length - 1;\n\nexport const iterateIndex = <T>(array: T, currentIndex: number, reverse = false): number | undefined => {\n  if (Array.isArray(array) && array.length && Number.isFinite(currentIndex)) {\n    if (reverse) {\n      const isZeroIndex = currentIndex === 0;\n      return isZeroIndex ? array.length - 1 : (currentIndex - 1) % array.length;\n    }\n\n    return (currentIndex + 1) % array.length;\n  }\n  return undefined;\n};\n\nexport const iterateItem = <T>(array: T[], currentItem: T, reverse = false): T | undefined => {\n  if (Array.isArray(array) && array.length) {\n    const currentIndex = array.indexOf(currentItem);\n\n    // If item could not be found\n    const isNegativeIndex = currentIndex === -1;\n    return isNegativeIndex ? undefined : array[iterateIndex(array, currentIndex, reverse)];\n  }\n  return undefined;\n};\n\n/**\n * Returns random element\n * @param array source\n * @returns random element\n */\nexport const randomElement = <T>(array: T[] = []) => array[Math.floor(Math.random() * array.length)];\n\n/**\n * Remove given element from array\n * @param array source\n * @param element Element which should be removed\n * @returns containing the removed element\n */\nexport const removeElement = <T>(array: T[] = [], element: T): T[] | undefined => {\n  const index = array.indexOf(element);\n  if (index > -1) {\n    return array.splice(index, 1);\n  }\n  return undefined;\n};\n\nexport const deArrayify = <T>(value: T[] | T): T => (value instanceof Array ? value[0] : value);\n\nexport const uniquify = <T>(elements: T[]): T[] => Array.from(new Set<T>(elements));\n\nexport const flatten = <T>(arrays: T[][]): T[] => ([] as T[]).concat(...arrays);\n\nexport const partition = <T>(array: T[], condition: (element: T) => boolean): [T[], T[]] => {\n  const matching: T[] = [];\n  const notMatching: T[] = [];\n  array.forEach(element => {\n    if (condition(element)) {\n      matching.push(element);\n    } else {\n      notMatching.push(element);\n    }\n  });\n  return [matching, notMatching];\n};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CSSObject} from '@emotion/serialize';\n\nexport const CSS_ABSOLUTE_CENTER: CSSObject = {\n  left: '50%',\n  position: 'absolute',\n  top: '50%',\n  transform: 'translate(-50%, -50%)',\n};\n\nexport const CSS_SQUARE: (size: number | string) => CSSObject = size => ({\n  height: size,\n  width: size,\n});\n\nexport const CSS_FILL_PARENT: CSSObject = {\n  bottom: 0,\n  left: 0,\n  position: 'absolute',\n  right: 0,\n  top: 0,\n};\n\nexport const CSS_FLEX_CENTER: CSSObject = {\n  alignItems: 'center',\n  display: 'flex',\n  justifyContent: 'center',\n};\n\nexport const CSS_ICON: (code: string, iconSize?: string | number) => CSSObject = (code, iconSize = '16px') => ({\n  MozOsxFontSmoothing: 'grayscale',\n  WebkitFontSmoothing: 'antialiased',\n  content: `'${code}'`,\n  fontFamily: 'Wire',\n  fontSize: iconSize,\n  fontStyle: 'normal',\n  fontVariant: 'normal',\n  fontWeight: 'normal',\n  lineHeight: 1,\n  speak: 'none',\n  textTransform: 'none',\n});\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Runtime} from '@wireapp/commons';\n\nexport function copyText(text: string): Promise<void> {\n  if (Runtime.isSupportingClipboard()) {\n    return navigator.clipboard.writeText(text);\n  }\n\n  try {\n    const fallbackSource = document.createElement('textarea');\n    fallbackSource.value = text;\n\n    let selectedRange;\n\n    if (window.getSelection) {\n      selectedRange = window.getSelection().rangeCount ? window.getSelection().getRangeAt(0) : undefined;\n    }\n\n    document.body.appendChild(fallbackSource);\n    fallbackSource.select();\n    document.execCommand('copy');\n    document.body.removeChild(fallbackSource);\n\n    if (window.getSelection && selectedRange) {\n      const currentSelection = window.getSelection();\n      currentSelection.removeAllRanges();\n      currentSelection.addRange(selectedRange);\n    }\n\n    return Promise.resolve();\n  } catch (error) {\n    return Promise.reject(error);\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {useEffect, useState} from 'react';\n\nimport ko, {Unwrapped} from 'knockout';\n\ntype Subscribables<T> = {\n  [Key in keyof T]: T[Key] extends ko.Subscribable ? T[Key] : never;\n};\n\ntype UnwrappedValues<T, S = Subscribables<T>> = {\n  [Key in keyof S]: Unwrapped<S[Key]>;\n};\n\nconst resolveObservables = <C extends keyof Subscribables<P>, P extends Partial<Record<C, ko.Subscribable>>>(\n  object: P,\n  children?: C[],\n): UnwrappedValues<P> => {\n  const properties = children ?? (Object.keys(object).filter(key => key !== '$raw') as C[]);\n  return properties.reduce<UnwrappedValues<P>>((acc, child) => {\n    acc[child] = ko.unwrap(object?.[child]);\n    return acc;\n  }, {} as UnwrappedValues<P>);\n};\n\n/**\n * Will subscribe to all the observable properties of the object and call the onUpdate callback everytime one observable updates\n *\n * @param object The object containinig some observable properties\n * @param onUpdate The callback called everytime an observable emits. It will only give back the slice of the object that have updates\n * @param children? An optional list of properties to watch (by default will watch for all the observable properties)\n */\nconst subscribeProperties = <C extends keyof Subscribables<P>, P extends Partial<Record<C, ko.Subscribable>>>(\n  object: P,\n  onUpdate: (updates: Partial<UnwrappedValues<P>>) => void,\n  children?: C[],\n) => {\n  const properties = children ?? (Object.keys(object).filter(key => key !== '$raw') as C[]);\n  onUpdate(resolveObservables(object, children));\n\n  const subscriptions = properties\n    .filter(child => ko.isSubscribable(object?.[child]))\n    .map(child => {\n      const subscribable = object[child];\n      return subscribable?.subscribe((value: Unwrapped<typeof subscribable>) => {\n        onUpdate({[child]: value} as Partial<UnwrappedValues<P>>);\n      });\n    });\n\n  return {\n    dispose: () => subscriptions.forEach(subscription => subscription?.dispose()),\n  };\n};\n\nexport const useKoSubscribableChildren = <\n  C extends keyof Subscribables<P>,\n  P extends Partial<Record<C, ko.Subscribable>>,\n>(\n  parent: P,\n  children: C[],\n): UnwrappedValues<P> => {\n  const [state, setState] = useState<UnwrappedValues<P>>(resolveObservables(parent, children));\n  useEffect(() => {\n    const subscription = subscribeProperties(\n      parent,\n      updates => setState(currentState => ({...currentState, ...updates})),\n      children,\n    );\n    return () => subscription.dispose();\n  }, [parent]);\n\n  return state;\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n// http://www.unicode.org/Public/emoji/11.0/emoji-data.txt\n// This is the exact copy of unicode-range definition for `emoji` font in CSS.\nexport const EMOJI_RANGES =\n  'U+1f000-1f003, U+1f004, U+1f005-1f0ce, U+1f0cf, U+1f0d0-1f0ff, U+1f10d-1f10f, U+1f12f, U+1f16c-1f16f, U+1f170-1f171, U+1f17e-1f17f, U+1f18e, U+1f191-1f19a, U+1f1ad-1f1e5, U+1f1e6-1f1ff, U+1f201, U+1f201-1f202, U+1f203-1f20f, U+1f21a, U+1f22f, U+1f232-1f236, U+1f232-1f23a, U+1f238-1f23a, U+1f23c-1f23f, U+1f249-1f24f, U+1f250-1f251, U+1f252-1f2ff, U+1f300-1f320, U+1f300-1f321, U+1f322-1f323, U+1f324-1f393, U+1f32d-1f335, U+1f337-1f37c, U+1f37e-1f393, U+1f385, U+1f394-1f395, U+1f396-1f397, U+1f398, U+1f399-1f39b, U+1f39c-1f39d, U+1f39e-1f3f0, U+1f3a0-1f3ca, U+1f3c2-1f3c4, U+1f3c7, U+1f3ca-1f3cc, U+1f3cf-1f3d3, U+1f3e0-1f3f0, U+1f3f1-1f3f2, U+1f3f3-1f3f5, U+1f3f4, U+1f3f6, U+1f3f7-1f3fa, U+1f3f7-1f4fd, U+1f3f8-1f43e, U+1f3fb-1f3ff, U+1f400-1f4fd, U+1f440, U+1f442-1f443, U+1f442-1f4fc, U+1f446-1f450, U+1f466-1f478, U+1f47c, U+1f481-1f483, U+1f485-1f487, U+1f48f, U+1f491, U+1f4aa, U+1f4fe, U+1f4ff-1f53d, U+1f546-1f548, U+1f549-1f54e, U+1f54b-1f54e, U+1f54f, U+1f550-1f567, U+1f568-1f56e, U+1f56f-1f570, U+1f571-1f572, U+1f573-1f579, U+1f574-1f575, U+1f57a, U+1f57b-1f586, U+1f587, U+1f588-1f589, U+1f58a-1f58d, U+1f58e-1f58f, U+1f590, U+1f591-1f594, U+1f595-1f596, U+1f597-1f5a3, U+1f5a4, U+1f5a5, U+1f5a6-1f5a7, U+1f5a8, U+1f5a9-1f5b0, U+1f5b1-1f5b2, U+1f5b3-1f5bb, U+1f5bc, U+1f5bd-1f5c1, U+1f5c2-1f5c4, U+1f5c5-1f5d0, U+1f5d1-1f5d3, U+1f5d4-1f5db, U+1f5dc-1f5de, U+1f5df-1f5e0, U+1f5e1, U+1f5e2, U+1f5e3, U+1f5e4-1f5e7, U+1f5e8, U+1f5e9-1f5ee, U+1f5ef, U+1f5f0-1f5f2, U+1f5f3, U+1f5f4-1f5f9, U+1f5fa-1f64f, U+1f5fb-1f64f, U+1f645-1f647, U+1f64b-1f64f, U+1f680-1f6c5, U+1f6a3, U+1f6b4-1f6b6, U+1f6c0, U+1f6c6-1f6ca, U+1f6cb-1f6d0, U+1f6cc, U+1f6d0, U+1f6d1-1f6d2, U+1f6d3-1f6d4, U+1f6d5, U+1f6d6-1f6df, U+1f6e0-1f6e5, U+1f6e6-1f6e8, U+1f6e9, U+1f6ea, U+1f6eb-1f6ec, U+1f6ed-1f6ef, U+1f6f0, U+1f6f1-1f6f2, U+1f6f3, U+1f6f4-1f6f6, U+1f6f7-1f6f8, U+1f6f9, U+1f6fa, U+1f6fb-1f6ff, U+1f774-1f77f, U+1f7d5-1f7df, U+1f7e0-1f7eb, U+1f7ec-1f7ff, U+1f80c-1f80f, U+1f848-1f84f, U+1f85a-1f85f, U+1f888-1f88f, U+1f8ae-1f8ff, U+1f90c, U+1f90d-1f90f, U+1f90f, U+1f910-1f918, U+1f918, U+1f919-1f91e, U+1f91f, U+1f920-1f927, U+1f926, U+1f928-1f92f, U+1f930, U+1f931-1f932, U+1f933-1f939, U+1f933-1f93a, U+1f93c-1f93e, U+1f93f, U+1f940-1f945, U+1f947-1f94b, U+1f94c, U+1f94d-1f94f, U+1f950-1f95e, U+1f95f-1f96b, U+1f96c-1f970, U+1f971, U+1f972, U+1f973-1f976, U+1f977-1f979, U+1f97a, U+1f97b, U+1f97c-1f97f, U+1f980-1f984, U+1f985-1f991, U+1f992-1f997, U+1f998-1f9a2, U+1f9a3-1f9a4, U+1f9a5-1f9aa, U+1f9ab-1f9ad, U+1f9ae-1f9af, U+1f9b0-1f9b3, U+1f9b0-1f9b9, U+1f9b5-1f9b6, U+1f9b8-1f9b9, U+1f9ba-1f9bf, U+1f9bb, U+1f9c0, U+1f9c1-1f9c2, U+1f9c3-1f9ca, U+1f9cb-1f9cc, U+1f9cd-1f9cf, U+1f9d0-1f9e6, U+1f9d1-1f9dd, U+1f9e7-1f9ff, U+1fa00-1fa6f, U+1fa70-1fa73, U+1fa74-1fa77, U+1fa78-1fa7a, U+1fa7b-1fa7f, U+1fa80-1fa82, U+1fa83-1fa8f, U+1fa90-1fa95, U+1fa96-1fffd, U+200d, U+203c, U+2049, U+20e3, U+2139, U+2194-2199, U+21a9-21aa, U+231a-231b, U+2328, U+2388, U+23cf, U+23e9-23ec, U+23e9-23f3, U+23f0, U+23f3, U+23f8-23fa, U+24c2, U+25aa-25ab, U+25b6, U+25c0, U+25fb-25fe, U+25fd-25fe, U+2600-2604, U+2605, U+2607-260d, U+260e, U+260f-2610, U+2611, U+2612, U+2614-2615, U+2616-2617, U+2618, U+2619-261c, U+261d, U+261e-261f, U+2620, U+2621, U+2622-2623, U+2624-2625, U+2626, U+2627-2629, U+262a, U+262b-262d, U+262e-262f, U+2630-2637, U+2638-263a, U+263b-263f, U+2640, U+2641, U+2642, U+2643-2647, U+2648-2653, U+2654-265e, U+265f, U+2660, U+2661-2662, U+2663, U+2664, U+2665-2666, U+2667, U+2668, U+2669-267a, U+267b, U+267c-267d, U+267e, U+267f, U+2680-2685, U+2690-2691, U+2692-2694, U+2693, U+2695, U+2696-2697, U+2698, U+2699, U+269a, U+269b-269c, U+269d-269f, U+26a0-26a1, U+26a1, U+26a2-26a9, U+26aa-26ab, U+26ac-26af, U+26b0-26b1, U+26b2-26bc, U+26bd-26be, U+26bf-26c3, U+26c4-26c5, U+26c6-26c7, U+26c8, U+26c9-26cd, U+26ce, U+26ce-26cf, U+26d0, U+26d1, U+26d2, U+26d3-26d4, U+26d4, U+26d5-26e8, U+26e9-26ea, U+26ea, U+26eb-26ef, U+26f0-26f5, U+26f2-26f3, U+26f5, U+26f6, U+26f7-26fa, U+26f9, U+26fa, U+26fb-26fc, U+26fd, U+26fe-2701, U+2702, U+2703-2704, U+2705, U+2708-270d, U+270a-270b, U+270a-270d, U+270e, U+270f, U+2710-2711, U+2712, U+2714, U+2716, U+271d, U+2721, U+2728, U+2733-2734, U+2744, U+2747, U+274c, U+274e, U+2753-2755, U+2757, U+2763-2764, U+2765-2767, U+2795-2797, U+27a1, U+27b0, U+27bf, U+2934-2935, U+2b05-2b07, U+2b1b-2b1c, U+2b50, U+2b55, U+3030, U+303d, U+3297, U+3299, U+e0020-e007f, U+fe0f'\n    .replace(/U\\+/g, '')\n    .split(', ')\n    .reduce((list, codepoint) => {\n      const hexBase = 16;\n      const [start, end = start]: number[] = codepoint.split('-').map(code => parseInt(code, hexBase));\n      for (let code = start; code <= end; code++) {\n        list.push(String.fromCodePoint(code));\n      }\n      return list;\n    }, []);\n\nconst UNICODE_RANGE_REGEXP = new RegExp(`[${EMOJI_RANGES.join('')}]`, 'g');\nconst removeWhitespace = (string: string) => string.replace(/\\s+/g, '');\nconst removeEmojis = (string: string) => string.replace(UNICODE_RANGE_REGEXP, '');\nconst isValidString = (string: string) => typeof string === 'string' && string.length > 0;\n\nexport const includesOnlyEmojis = (text: string) =>\n  isValidString(text) && removeEmojis(removeWhitespace(text)).length === 0;\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {Config} from '../Config';\nimport {BackendEnvironment} from '../service/BackendEnvironment';\n\nconst APP_ENV = {\n  LOCALHOST: 'localhost',\n  PRODUCTION: 'wire.com',\n  VIRTUAL_HOST: 'wire.ms', // The domain \"wire.ms\" is our virtual host for testing contact uploads\n};\n\nconst getElectronVersion = (userAgent: string): string => {\n  // [match, version]\n  const [, electronVersion] = /Wire(?:Internal)?\\/(\\S+)/i.exec(userAgent) || [];\n  return electronVersion;\n};\n\nconst isLocalhost = (): boolean => [APP_ENV.LOCALHOST, APP_ENV.VIRTUAL_HOST].includes(window.location.hostname);\nconst isProduction = (): boolean => {\n  return window.wire.env.ENVIRONMENT === BackendEnvironment.PRODUCTION;\n};\n\ninterface Environment {\n  backend: {\n    current?: string;\n  };\n  electronVersion: typeof getElectronVersion;\n  frontend: {\n    isLocalhost: typeof isLocalhost;\n    isProduction: typeof isProduction;\n  };\n  version: (showWrapperVersion?: boolean) => string;\n}\n\nexport const Environment: Environment = {\n  backend: {},\n  electronVersion: getElectronVersion,\n  frontend: {\n    isLocalhost,\n    isProduction,\n  },\n  version: (showWrapperVersion = true): string => {\n    if (Environment.frontend.isLocalhost()) {\n      return 'dev';\n    }\n\n    const electronVersion = getElectronVersion(Runtime.getUserAgent());\n    const showElectronVersion = electronVersion && showWrapperVersion;\n    return showElectronVersion ? electronVersion : Config.getConfig().VERSION;\n  },\n};\n","/*\n * Wire\n * Copyright (C) 2020 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {partition} from 'Util/ArrayUtil';\n\nimport {Config} from '../Config';\n\nexport const allowsAllFiles = (): boolean => {\n  const allowedExtensions = Config.getConfig().FEATURE.ALLOWED_FILE_UPLOAD_EXTENSIONS;\n  return allowedExtensions.some(extension => ['*', '.*', '*.*'].includes(extension));\n};\n\nexport const hasAllowedExtension = (fileName: string): boolean => {\n  const allowedExtensions = Config.getConfig().FEATURE.ALLOWED_FILE_UPLOAD_EXTENSIONS;\n\n  // Creates a regex like this: (\\.txt|\\.pdf)$\n  const fileExtRegex = new RegExp(`(\\\\${allowedExtensions.join('|\\\\')})$`);\n  return fileExtRegex.test(fileName.toLowerCase());\n};\n\nexport const isAllowedFile = (name: string, type: string): boolean => {\n  const [imageFileExtensions, imageContentTypes] = partition(Config.getConfig().ALLOWED_IMAGE_TYPES, allowedImageType =>\n    allowedImageType.startsWith('.'),\n  );\n  if (imageContentTypes.includes(type)) {\n    return true;\n  }\n  const allowedExtensions = [...imageFileExtensions, ...Config.getConfig().FEATURE.ALLOWED_FILE_UPLOAD_EXTENSIONS];\n  const fileExtRegex = new RegExp(`(\\\\${allowedExtensions.join('|\\\\')})$`);\n  return fileExtRegex.test(name.toLowerCase());\n};\n\nexport const getFileExtensionOrName = (fileName: string): string => fileName.match(/(\\.?[^.]*)$/)[0];\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {KeyboardEvent as ReactKeyboardEvent} from 'react';\n\nimport {Runtime} from '@wireapp/commons';\n\nexport const KEY = {\n  ARROW_DOWN: Runtime.isEdge() ? 'Down' : 'ArrowDown',\n  ARROW_LEFT: Runtime.isEdge() ? 'Left' : 'ArrowLeft',\n  ARROW_RIGHT: Runtime.isEdge() ? 'Right' : 'ArrowRight',\n  ARROW_UP: Runtime.isEdge() ? 'Up' : 'ArrowUp',\n  BACKSPACE: 'Backspace',\n  DELETE: 'Delete',\n  ENTER: 'Enter',\n  ESC: 'Escape',\n  KEY_V: 'v',\n  PAGE_DOWN: 'PageDown',\n  PAGE_UP: 'PageUp',\n  SPACE: ' ',\n  TAB: 'Tab',\n};\n\nexport const isOneOfKeys = (keyboardEvent: KeyboardEvent | ReactKeyboardEvent, expectedKeys: string[] = []) => {\n  expectedKeys = expectedKeys.map(key => key.toLowerCase());\n  const eventKey = keyboardEvent.key?.toLowerCase() || '';\n  return !!expectedKeys.find(key => key === eventKey);\n};\n\nexport const isArrowKey = (keyboardEvent: KeyboardEvent): boolean =>\n  isOneOfKeys(keyboardEvent, [KEY.ARROW_DOWN, KEY.ARROW_LEFT, KEY.ARROW_RIGHT, KEY.ARROW_UP]);\n\nexport const isPageUpDownKey = (keyboardEvent: KeyboardEvent): boolean =>\n  isOneOfKeys(keyboardEvent, [KEY.PAGE_UP, KEY.PAGE_DOWN]);\n\nexport const isKey = (keyboardEvent?: KeyboardEvent | ReactKeyboardEvent, expectedKey = '') => {\n  const eventKey = keyboardEvent?.key?.toLowerCase() || '';\n  return eventKey === expectedKey.toLowerCase();\n};\n\nexport const isTabKey = (keyboardEvent: KeyboardEvent | ReactKeyboardEvent): boolean => isKey(keyboardEvent, KEY.TAB);\n\nexport const isEnterKey = (keyboardEvent: KeyboardEvent | ReactKeyboardEvent): boolean =>\n  isKey(keyboardEvent, KEY.ENTER);\n\nexport const isSpaceKey = (keyboardEvent: KeyboardEvent): boolean => isKey(keyboardEvent, KEY.SPACE);\n\nexport const isEscapeKey = (keyboardEvent: KeyboardEvent): boolean => isKey(keyboardEvent, KEY.ESC);\n\nexport const isFunctionKey = (keyboardEvent: KeyboardEvent | ReactKeyboardEvent): boolean =>\n  keyboardEvent.altKey || keyboardEvent.ctrlKey || keyboardEvent.metaKey || keyboardEvent.shiftKey;\n\n/** On macOS the meta key is '⌘', which represents 'Ctrl' in the Windows world: https://www.oreilly.com/library/view/switching-to-the/9781449372927/ch01s08.html */\nexport const isMetaKey = (keyboardEvent: KeyboardEvent): boolean =>\n  keyboardEvent.metaKey || keyboardEvent.ctrlKey || keyboardEvent.key?.toLowerCase() === 'control';\n\nexport const isPasteAction = (keyboardEvent: KeyboardEvent): boolean =>\n  isMetaKey(keyboardEvent) && isKey(keyboardEvent, KEY.KEY_V);\n\nexport const isRemovalAction = (key: string): boolean => [KEY.BACKSPACE, KEY.DELETE].includes(key);\n\nexport const insertAtCaret = (areaId: string, text: string) => {\n  // http://stackoverflow.com/a/1064139\n  const textArea = document.getElementById(areaId) as HTMLTextAreaElement;\n  if (!textArea) {\n    return;\n  }\n\n  const scrollPos = textArea.scrollTop;\n  let strPos = 0;\n  const br =\n    textArea.selectionStart || textArea.selectionStart === 0 ? 'ff' : (document as any).selection ? 'ie' : false;\n\n  if (br === 'ie') {\n    textArea.focus();\n    const range = (document as any).selection.createRange();\n    range.moveStart('character', -textArea.value.length);\n    strPos = range.text.length;\n  } else if (br === 'ff') {\n    strPos = textArea.selectionStart;\n  }\n\n  const front = textArea.value.substring(0, strPos);\n  const back = textArea.value.substring(strPos, textArea.value.length);\n\n  textArea.value = `${front}${text}${back}`;\n  strPos = strPos + text.length;\n\n  if (br === 'ie') {\n    textArea.focus();\n    const ieRange = (document as any).selection.createRange();\n    ieRange.moveStart('character', -textArea.value.length);\n    ieRange.moveStart('character', strPos);\n    ieRange.moveEnd('character', 0);\n    ieRange.select();\n  } else if (br === 'ff') {\n    textArea.selectionStart = strPos;\n    textArea.selectionEnd = strPos;\n    textArea.focus();\n  }\n\n  textArea.scrollTop = scrollPos;\n};\n\ntype KeyboardHandler = (event: KeyboardEvent) => void;\n\nconst escKeyHandlers: KeyboardHandler[] = [];\n\ndocument.addEventListener('keydown', event => {\n  if (event.key === 'Escape') {\n    escKeyHandlers.forEach(handler => handler(event));\n  } else if (isMetaKey(event) && event.shiftKey && (isKey(event, '1') || isKey(event, '!'))) {\n    handleDebugKey();\n  }\n});\n\nexport const onEscKey = (handler: KeyboardHandler) => escKeyHandlers.push(handler);\n\nexport const offEscKey = (handler: KeyboardHandler) => {\n  const index = escKeyHandlers.indexOf(handler);\n  if (index >= 0) {\n    escKeyHandlers.splice(index, 1);\n  }\n};\n\nexport const handleKeyDown = (\n  event: React.KeyboardEvent<Element> | KeyboardEvent,\n  callback: (event?: React.KeyboardEvent<Element> | KeyboardEvent) => void,\n) => {\n  if (event.key === KEY.ENTER || event.key === KEY.SPACE) {\n    callback(event);\n  }\n  return true;\n};\n\nexport const handleEnterDown = (event: React.KeyboardEvent<HTMLElement> | KeyboardEvent, callback: () => void) => {\n  if (event.key === KEY.ENTER) {\n    callback();\n  }\n  return true;\n};\n\nconst handleDebugKey = () => {\n  const removeDebugInfo = (els: NodeListOf<HTMLElement>) => els.forEach(el => el.parentNode?.removeChild(el));\n\n  const addDebugInfo = (els: NodeListOf<HTMLElement>) =>\n    els.forEach(el => {\n      const debugInfo = document.createElement('div');\n      debugInfo.classList.add('debug-info');\n      if (el.dataset.uieUid) {\n        debugInfo.textContent = el.dataset.uieUid;\n      }\n      el.appendChild(debugInfo);\n    });\n\n  const debugInfos = document.querySelectorAll<HTMLElement>('.debug-info');\n  const isShowingDebugInfo = debugInfos.length > 0;\n\n  if (isShowingDebugInfo) {\n    removeDebugInfo(debugInfos);\n  } else {\n    const debugElements = document.querySelectorAll<HTMLElement>(\n      '.message[data-uie-uid], .conversation-list-cell[data-uie-uid]',\n    );\n    addDebugInfo(debugElements);\n  }\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {escape} from 'underscore';\n\nimport en from 'I18n/en-US.json';\n\nimport {getSelfName} from './SanitizationUtil';\nimport {sortUsersByPriority} from './StringUtil';\n\nimport type {User} from '../entity/User';\n\ntype Substitutes = Record<string, string> | string | number;\n\nexport const DEFAULT_LOCALE = 'en';\n\nlet locale = DEFAULT_LOCALE;\nlet strings: Record<string, Record<string, string>> = {};\n\nconst isStringOrNumber = (toTest: any): toTest is string | number =>\n  typeof toTest === 'string' || typeof toTest === 'number';\n\nconst replaceSubstituteEscaped = (string: string, regex: RegExp | string, substitutes: Substitutes): string => {\n  if (isStringOrNumber(substitutes)) {\n    return string.replace(regex, escape(substitutes.toString()));\n  }\n  return string.replace(regex, (found: string, content: string): string =>\n    substitutes.hasOwnProperty(content) ? escape(substitutes[content]) : found,\n  );\n};\n\nconst replaceSubstitute = (string: string, regex: RegExp | string, substitutes: Substitutes): string => {\n  if (isStringOrNumber(substitutes)) {\n    return string.replace(regex, substitutes.toString());\n  }\n  return string.replace(regex, (found: string, content: string): string =>\n    substitutes.hasOwnProperty(content) ? substitutes[content] : found,\n  );\n};\n\nexport const LocalizerUtil = {\n  joinNames: (userEntities: User[], declension = Declension.ACCUSATIVE, skipAnd = false, boldNames = false) => {\n    const containsSelfUser = userEntities.some(userEntity => userEntity.isMe);\n    if (containsSelfUser) {\n      userEntities = userEntities.filter(userEntity => !userEntity.isMe);\n    }\n\n    const userNames = userEntities.sort(sortUsersByPriority).map(userEntity => {\n      const userName = userEntity.name();\n      return boldNames ? `[bold]${userName}[/bold]` : userName;\n    });\n\n    if (containsSelfUser) {\n      userNames.push(getSelfName(declension));\n    }\n\n    const numberOfNames = userNames.length;\n    const joinByAnd = !skipAnd && numberOfNames >= 2;\n    if (joinByAnd) {\n      const [secondLastName, lastName] = userNames.splice(userNames.length - 2, 2);\n\n      const exactlyTwoNames = numberOfNames === 2;\n      const additionalNames = exactlyTwoNames\n        ? `${secondLastName} ${t('and')} ${lastName}`\n        : `${secondLastName}${t('enumerationAnd')}${lastName}`;\n      userNames.push(additionalNames);\n    }\n\n    return userNames.join(', ');\n  },\n\n  translate: (\n    identifier: string,\n    substitutions: Substitutes = {},\n    dangerousSubstitutions: Record<string, string> = {},\n    skipEscape: boolean = false,\n  ): string => {\n    const localeValue = strings[locale] && strings[locale][identifier];\n    const defaultValue =\n      strings[DEFAULT_LOCALE] && strings[DEFAULT_LOCALE].hasOwnProperty(identifier)\n        ? strings[DEFAULT_LOCALE][identifier]\n        : identifier;\n    const value = localeValue || defaultValue;\n\n    const replaceDangerously = {\n      '/bold': '</strong>',\n      '/italic': '</i>',\n      bold: '<strong>',\n      italic: '<i>',\n      ...dangerousSubstitutions,\n    };\n\n    const substitutedEscaped = skipEscape\n      ? replaceSubstitute(value, /{{(.+?)}}/g, substitutions)\n      : replaceSubstituteEscaped(value, /{{(.+?)}}/g, substitutions);\n\n    return replaceSubstitute(substitutedEscaped, /\\[(.+?)\\]/g, replaceDangerously);\n  },\n};\n\nexport const Declension = {\n  ACCUSATIVE: 'accusative',\n  DATIVE: 'dative',\n  NOMINATIVE: 'nominative',\n};\n\nexport const setLocale = (newLocale: string): void => {\n  locale = newLocale;\n};\n\nexport const setStrings = (newStrings: typeof strings): void => {\n  strings = newStrings;\n};\n\nexport type StringIdentifer = keyof typeof en | '';\n\nexport function t(\n  identifier: StringIdentifer,\n  substitutions?: Substitutes,\n  dangerousSubstitutions?: Record<string, string>,\n  skipEscape: boolean = false,\n): string {\n  return LocalizerUtil.translate(identifier, substitutions, dangerousSubstitutions, skipEscape);\n}\n\nexport const joinNames = LocalizerUtil.joinNames;\n\nexport const replaceLink = (href: string, className: string = '', uieName: string = '') => ({\n  '/link': '</a>',\n  link: `<a href=\"${href}\" data-uie-name=\"${uieName}\" class=\"${className}\" rel=\"nofollow noopener noreferrer\" target=\"_blank\">`,\n});\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {LogFactory, Logger} from '@wireapp/commons';\n\nconst LOGGER_NAMESPACE = '@wireapp/webapp';\n\nfunction getLogger(name: string): Logger {\n  return LogFactory.getLogger(name, {\n    namespace: LOGGER_NAMESPACE,\n    separator: '/',\n  });\n}\n\nexport {getLogger, LOGGER_NAMESPACE, Logger};\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {getStorage} from './localStorage';\n\nexport function enableLogging(force = false, search = window.location.search): void {\n  const storage = getStorage();\n\n  const namespace = new URLSearchParams(search).get('enableLogging');\n\n  if (namespace) {\n    storage?.setItem('debug', namespace);\n  } else if (force) {\n    storage?.setItem('debug', '*');\n  } else {\n    storage?.removeItem('debug');\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {User} from '../entity/User';\nimport {MentionEntity} from '../message/MentionEntity';\n\nexport const findMentionAtPosition = (position: number, mentions: MentionEntity[]) =>\n  mentions.find(({startIndex, endIndex}) => position > startIndex && position < endIndex);\n\nexport const getMentionCandidate = (\n  currentMentions: MentionEntity[],\n  selectionStart: number,\n  selectionEnd: number,\n  value: string,\n) => {\n  const textInSelection = value.substring(selectionStart, selectionEnd);\n  const wordBeforeSelection = value.substring(0, selectionStart).replace(/[^]*\\s/, '');\n  const isSpaceSelected = /\\s/.test(textInSelection);\n\n  const startOffset = wordBeforeSelection.length ? wordBeforeSelection.length - 1 : 1;\n  const isSelectionStartMention = findMentionAtPosition(selectionStart - startOffset, currentMentions);\n  const isSelectionEndMention = findMentionAtPosition(selectionEnd, currentMentions);\n  const isOverMention = isSelectionStartMention || isSelectionEndMention;\n  const isOverValidMentionString = /^@\\S*$/.test(wordBeforeSelection);\n\n  if (!isSpaceSelected && !isOverMention && isOverValidMentionString) {\n    const wordAfterSelection = value.substring(selectionEnd).replace(/\\s[^]*/, '');\n\n    const term = `${wordBeforeSelection.replace(/^@/, '')}${textInSelection}${wordAfterSelection}`;\n    const startIndex = selectionStart - wordBeforeSelection.length;\n    return {startIndex, term};\n  }\n\n  return undefined;\n};\n\nexport const detectMentionEdgeDeletion = (\n  textarea: HTMLTextAreaElement,\n  currentMentions: MentionEntity[],\n  selectionStart: number,\n  selectionEnd: number,\n  lengthDifference: number,\n) => {\n  const hadSelection = selectionStart !== selectionEnd;\n\n  if (hadSelection || lengthDifference >= 0) {\n    return null;\n  }\n\n  const currentSelectionStart = textarea.selectionStart;\n  const forwardDeleted = currentSelectionStart === selectionStart;\n  const checkPosition = forwardDeleted ? currentSelectionStart + 1 : currentSelectionStart;\n\n  return findMentionAtPosition(checkPosition, currentMentions);\n};\n\nexport const updateMentionRanges = (\n  currentMentions: MentionEntity[],\n  start: number,\n  end: number,\n  difference: number,\n): MentionEntity[] => {\n  const remainingMentions = currentMentions.filter(({startIndex, endIndex}) => endIndex <= start || startIndex >= end);\n\n  return remainingMentions.map(mention => {\n    if (mention.startIndex >= end) {\n      return new MentionEntity(mention.startIndex + difference, mention.length, mention.userId, mention.domain);\n    }\n\n    return mention;\n  });\n};\n\nexport const createMentionEntity = (\n  userEntity: User,\n  editedMention?: {startIndex: number; term: string},\n): MentionEntity | null => {\n  const mentionLength = userEntity.name().length + 1;\n\n  if (typeof editedMention?.startIndex === 'number') {\n    return new MentionEntity(editedMention.startIndex, mentionLength, userEntity.id, userEntity.domain);\n  }\n\n  return null;\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function capToByte(value: number): number {\n  const MAX_VALUE = 255;\n  return Math.min(Math.abs(Math.trunc(value * MAX_VALUE)), MAX_VALUE);\n}\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, value));\n}\n\nexport function getRandomNumber(minimum: number, maximum: number): number {\n  return Math.floor(Math.random() * (maximum - minimum + 1) + minimum);\n}\n\nexport function inRange(value: number, lowerBound: number, upperBound: number): boolean {\n  return value >= lowerBound && value <= upperBound;\n}\n\nexport const rootMeanSquare = (floatArray: number[] | Float32Array): number => {\n  const sum = (floatArray as number[]).reduce((power, number) => power + number ** 2, 0);\n  return Math.sqrt(sum) / floatArray.length;\n};\n\n/**\n * The rounding is logarithmic, meaning that small numbers will be slightly\n * rounded (if at all) whereas larger numbers will be rounded more.\n * This kind of rounding is roughly equivalent to having buckets with increasing size.\n * @param exactValue number to be rounded\n * @param factor determines by how much the value is rounded\n */\nexport const roundLogarithmic = (exactValue: number, factor: number): number => {\n  return Math.ceil(2 ** (Math.floor(factor * Math.log2(exactValue)) / factor));\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport interface QualifiedEntity {\n  [index: string]: any;\n  domain: string | null;\n  id: string;\n}\n\n/**\n * Will match the domain and id of the entities given.\n * If one of the entities has a `null` domain then it will fallback to only comparing ids\n *\n * @param entity1 - The first entity to compare\n * @param entity2 - The second entity to compare\n * @return boolean - do the entities match\n */\nexport function matchQualifiedIds(entity1: QualifiedEntity, entity2: QualifiedEntity) {\n  const idsMatch = entity1.id === entity2.id;\n  const domainsMatch = !entity1.domain || !entity2.domain || entity1.domain === entity2.domain;\n  return idsMatch && domainsMatch;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {escape} from 'underscore';\n\nimport {Declension, t} from 'Util/LocalizerUtil';\nimport {prependProtocol} from 'Util/UrlUtil';\nimport {isValidEmail} from 'Util/ValidationUtil';\n\nimport type {User} from '../entity/User';\n\nexport const escapeRegex = (string: string): string => string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\nexport const getSelfName = (declension = Declension.NOMINATIVE, bypassSanitization = false) => {\n  const selfNameDeclensions = {\n    [Declension.NOMINATIVE]: t('conversationYouNominative'),\n    [Declension.DATIVE]: t('conversationYouDative'),\n    [Declension.ACCUSATIVE]: t('conversationYouAccusative'),\n  };\n  const selfName = selfNameDeclensions[declension];\n  return bypassSanitization ? selfName : escape(selfName);\n};\n\nexport const getUserName = (userEntity: User, declension?: string, bypassSanitization: boolean = false): string => {\n  if (userEntity.isMe) {\n    return getSelfName(declension, bypassSanitization);\n  }\n  return bypassSanitization ? userEntity.name() : escape(userEntity.name());\n};\n\n/**\n * Opens a new browser tab (target=\"_blank\") with a given URL in a safe environment.\n * @see https://mathiasbynens.github.io/rel-noopener/\n * @param url URL you want to open in a new browser tab\n * @param focus `true`, if the new windows should get browser focus\n * @returns New window handle\n */\nexport const safeWindowOpen = (url: string, focus: boolean = true): Window => {\n  const newWindow = window.open(prependProtocol(url));\n\n  if (newWindow) {\n    newWindow.opener = null;\n    if (focus) {\n      newWindow.focus();\n    }\n  }\n\n  return newWindow;\n};\n\nexport const safeMailOpen = (email: string): void => {\n  const pureEmail = email.replace(/^(mailto:)?/i, '');\n\n  if (!isValidEmail(pureEmail)) {\n    return;\n  }\n\n  const newWindow = window.open(`mailto:${pureEmail}`);\n  if (newWindow) {\n    window.setTimeout(() => newWindow.close(), 10);\n  }\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport {amplify} from 'amplify';\n\nimport {TIME_IN_MILLIS} from 'Util/TimeUtil';\n\nexport function loadValue<T>(key: string): T | undefined {\n  return amplify.store(key);\n}\n\nexport function resetStoreValue(key: string): void {\n  return storeValue(key, null);\n}\n\nexport function storeValue(key: string, value: any, secondsToExpire?: number): void {\n  const config = secondsToExpire ? {expires: secondsToExpire * TIME_IN_MILLIS.SECOND} : undefined;\n  return amplify.store(key, value, config);\n}\n\nexport function constructUserPrimaryKey({id, domain}: QualifiedId): string {\n  if (domain) {\n    return `${domain}@${id}`;\n  }\n  return id;\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport getSlug from 'speakingurl';\n\nimport {randomElement} from 'Util/ArrayUtil';\n\nimport type {User} from '../entity/User';\n\nexport const startsWith = (string = '', query: string): boolean => string.toLowerCase().startsWith(query.toLowerCase());\nexport const includesString = (string = '', query = ''): boolean => string.toLowerCase().includes(query.toLowerCase());\nexport const getFirstChar = (string: string): string => [...string][0]; // the destructuring is needed to properly return unicode characters\n\n/**\n * @param bytes bytes to convert\n * @returns bytes as hex string\n */\nexport const bytesToHex = (bytes: number[]): string => {\n  const hexBase = 16;\n  const padIndex = 2;\n  return Array.from(bytes, byte => byte.toString(hexBase).padStart(padIndex, '0')).join('');\n};\n\nexport const capitalizeFirstChar = (string = ''): string => `${string.charAt(0).toUpperCase()}${string.substring(1)}`;\n\nexport const computeTransliteration = (string: string, excludedChars = {}): string => {\n  const options = {custom: excludedChars, uric: true};\n  return getSlug(string, options);\n};\n\nexport const getRandomChar = (): string => {\n  const charArray = Array.from('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ');\n  return randomElement(charArray);\n};\n\nexport const obfuscate = (text: string): string => {\n  /* cspell:disable-next-line */\n  const alphabet = Array.from('abcdefghijklmnopqrstuvwxyz');\n  return Array.from(text, char => (/\\s/.test(char) ? char : randomElement(alphabet))).join('');\n};\n\n/**\n * Returns `true` if the string and the query match by applying transliteration first.\n *\n * @param string the string to compare the query against\n * @param query the query to compare to the string\n * @param excludedChars extra characters to ignore when creating a slug\n * @param fromStart should the query match the string from the beginning of the string\n * @returns does the string match the query\n */\nexport const compareTransliteration = (\n  string: string,\n  query: string,\n  excludedChars: Record<string, string> = {},\n  fromStart = false,\n): boolean => {\n  const nameSlug = computeTransliteration(string, excludedChars);\n  const querySlug = computeTransliteration(query, excludedChars);\n  return fromStart ? nameSlug.startsWith(querySlug) : includesString(nameSlug, querySlug);\n};\n\nexport const transliterationIndex = (nameSlug: string, querySlug: string): number => nameSlug.indexOf(querySlug);\n\nexport const truncate = (string: string, outputLength: number, wordBoundary = true): string => {\n  if (string.length > outputLength) {\n    let truncateIndex = outputLength - 1;\n    if (wordBoundary && string.lastIndexOf(' ', outputLength - 1) > outputLength - 25) {\n      truncateIndex = string.lastIndexOf(' ', outputLength - 1);\n    }\n    string = `${string.slice(0, truncateIndex)}…`;\n  }\n  return string;\n};\n\n/**\n * Replaces designated places in the source string with the additional arguments\n * e.g. `formatString('{0} {1}!!!', 'Hello', 'World') => 'Hello World!!!'`\n *\n * @param string source string\n * @param args replacements for placeholders in source string\n * @returns source string with replacements applied\n */\nexport const formatString = (string: string, ...args: any[]): string => {\n  args.forEach((arg, index) => {\n    const reg = new RegExp(`\\\\{${index}\\\\}`, 'gm');\n    string = string.replace(reg, arg);\n  });\n  return string;\n};\n\nexport const removeLineBreaks = (string = ''): string => string.replace(/[\\r\\n]/gm, '');\n\nexport const replaceInRange = (text: string, replacement: string, startIndex: number, endIndex: number): string => {\n  const beforePartial = text.slice(0, startIndex);\n  const afterPartial = text.slice(endIndex);\n  return `${beforePartial}${replacement}${afterPartial}`;\n};\n\nexport const sortByPriority = (stringA: string = '', stringB: string = '', query: string = ''): number => {\n  stringA = stringA.toLowerCase();\n  stringB = stringB.toLowerCase();\n  query = query.toLowerCase();\n\n  if (query) {\n    if (stringA.startsWith(query) && !stringB.startsWith(query)) {\n      return -1;\n    } else if (stringB.startsWith(query) && !stringA.startsWith(query)) {\n      return 1;\n    }\n  }\n\n  return stringA.localeCompare(stringB);\n};\n\nexport const sortUsersByPriority = (userA: User, userB: User): number => sortByPriority(userA.name(), userB.name());\n\n/**\n * @param str The string to convert\n * @returns Converted string as byte array\n */\nexport const utf8ToUtf16BE = (str = ''): number[] => {\n  const BOMChar = '\\uFEFF';\n\n  str = `${BOMChar}${str}`;\n\n  const bytes: number[] = [];\n  str\n    .split('')\n    .map(char => char.charCodeAt(0))\n    .forEach(charCode => {\n      bytes.push((charCode & 0xff00) >> 8);\n      bytes.push(charCode & 0xff);\n    });\n\n  return bytes;\n};\n\nexport const splitFingerprint = (fingerprint: string): string[] => fingerprint?.padStart(16, '0').match(/(..?)/g) ?? [];\n\n// When we receive strings via Websocket, it will have been converted to utf-8,\n// In order to keep Emojis and other unicode characters, we need to run the TextDecoder\n// over the numeric values of the single characters of the received string.\nexport const fixWebsocketString = (originalString: string): string => {\n  const charArray = Uint8Array.from([...originalString].map(c => c.charCodeAt(0)));\n  const decoder = new TextDecoder();\n  return decoder.decode(charArray);\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  differenceInDays,\n  differenceInHours,\n  differenceInMinutes,\n  format,\n  formatDistanceToNow,\n  fromUnixTime,\n  isBefore,\n  isSameDay,\n  isSameMonth,\n  isThisYear,\n  isToday,\n  isYesterday,\n  startOfToday,\n} from 'date-fns';\nimport {\n  cs,\n  da,\n  de,\n  el,\n  enUS,\n  es,\n  et,\n  fi,\n  fr,\n  hr,\n  hu,\n  it,\n  lt,\n  nl,\n  pl,\n  pt,\n  ro,\n  ru,\n  sk,\n  sl,\n  tr,\n  uk,\n} from 'date-fns/locale';\n\nimport {t} from './LocalizerUtil';\nimport {zeroPadding} from './util';\n\nexport type FnDate = number | Date;\n\ninterface DiscreteTimeUnit {\n  longUnit: string;\n  symbol: string;\n  value: number;\n}\n\nexport interface DurationUnit {\n  symbol: string;\n  text: string;\n  value: number;\n}\n\nexport enum TIME_IN_MILLIS {\n  SECOND = 1000,\n  MINUTE = SECOND * 60,\n  HOUR = MINUTE * 60,\n  DAY = HOUR * 24,\n  WEEK = DAY * 7,\n  YEAR = DAY * 365,\n}\nconst locales = {cs, da, de, el, es, et, fi, fr, hr, hu, it, lt, nl, pl, pt, ro, ru, sk, sl, tr, uk};\nconst defaultLocale = enUS;\nlet locale = defaultLocale;\nexport type LocaleType = keyof typeof locales;\nexport const setDateLocale = (newLocale: LocaleType) => (locale = locales[newLocale] || defaultLocale);\n\nexport const formatLocale = (date: FnDate | string | number, formatString: string) =>\n  format(new Date(date), formatString, {locale});\n\n/**\n * Format the time as `12:00 AM`.\n * This is equivalent to momentjs' `LT` formatting\n */\nexport const formatTimeShort = (date: FnDate | string | number) => formatLocale(date, 'p');\n\n/**\n * Format the date as `May 29, 2020`.\n * This is equivalent to momentjs' `LL` formatting\n */\nexport const formatDateShort = (date: FnDate | string | number) => formatLocale(date, 'PP');\nexport const formatDayMonth = (date: FnDate | string | number) =>\n  formatDateShort(date)\n    .replace(/[0-9]{4}/g, '')\n    .replace(locale === de ? /^\\s*|\\s*$/g : /^\\W|\\W$|\\W\\W/, '');\n\n/**\n * Format the date as `05/29/2020`.\n * This is equivalent to momentjs' `L` formatting\n */\nexport const formatDateNumeral = (date: FnDate | string | number) => formatLocale(date, 'P');\nexport const formatDayMonthNumeral = (date: FnDate | string | number) =>\n  formatDateNumeral(date)\n    .replace(/[0-9]{4}/g, '')\n    .replace(locale === de ? /^\\s*|\\s*$/g : /^\\W|\\W$|\\W\\W/, '');\n\nconst durationUnits = () => [\n  {\n    plural: t('ephemeralUnitsYears'),\n    singular: t('ephemeralUnitsYear'),\n    symbol: 'y',\n    value: TIME_IN_MILLIS.YEAR,\n  },\n  {\n    plural: t('ephemeralUnitsWeeks'),\n    singular: t('ephemeralUnitsWeek'),\n    symbol: 'w',\n    value: TIME_IN_MILLIS.WEEK,\n  },\n  {\n    plural: t('ephemeralUnitsDays'),\n    singular: t('ephemeralUnitsDay'),\n    symbol: 'd',\n    value: TIME_IN_MILLIS.DAY,\n  },\n  {\n    plural: t('ephemeralUnitsHours'),\n    singular: t('ephemeralUnitsHour'),\n    symbol: 'h',\n    value: TIME_IN_MILLIS.HOUR,\n  },\n  {\n    plural: t('ephemeralUnitsMinutes'),\n    singular: t('ephemeralUnitsMinute'),\n    symbol: 'm',\n    value: TIME_IN_MILLIS.MINUTE,\n  },\n  {\n    plural: t('ephemeralUnitsSeconds'),\n    singular: t('ephemeralUnitsSecond'),\n    symbol: 's',\n    value: TIME_IN_MILLIS.SECOND,\n  },\n];\n\n/**\n * Calculate the discrete time units (years, weeks, days, hours, minutes, seconds) for a given duration\n * @note Implementation based on: https://gist.github.com/deanrobertcook/7168b38150c303a2b4196216913d34c1\n * @param duration duration in milliseconds\n * @param rounded should the units be rounded as opposed to floored\n * @returns calculated time units\n */\nconst mapUnits = (duration: number, rounded: boolean): DiscreteTimeUnit[] => {\n  const mappedUnits = durationUnits().map((unit, index, units) => {\n    let value = duration;\n    if (index > 0) {\n      value %= units[index - 1].value;\n    }\n    value /= unit.value;\n    value = rounded && value >= 1 ? Math.round(value) : Math.floor(value);\n    const longUnit = value === 1 ? unit.singular : unit.plural;\n    return {\n      longUnit,\n      symbol: unit.symbol,\n      value,\n    };\n  });\n  return mappedUnits;\n};\n\n/**\n * Format milliseconds into 15s, 2m.\n * @param duration Duration to format in milliseconds\n * @returns Unit, value and localized string\n */\nexport const formatDuration = (duration: number): DurationUnit => {\n  const mappedUnits = mapUnits(duration, true);\n  const firstNonZeroUnit = mappedUnits.find(unit => unit.value > 0);\n\n  if (!firstNonZeroUnit) {\n    const seconds = durationUnits().pop();\n\n    return {\n      symbol: seconds.symbol,\n      text: `0 ${seconds.plural}`,\n      value: 0,\n    };\n  }\n\n  return {\n    symbol: firstNonZeroUnit.symbol,\n    text: `${firstNonZeroUnit.value} ${firstNonZeroUnit.longUnit}`,\n    value: firstNonZeroUnit.value,\n  };\n};\n\n/**\n * Generate a human readable string of the remaining time\n * @param duration the remaining time in milliseconds\n * @returns readable representation of the remaining time\n */\nexport const formatDurationCaption = (duration: number): string => {\n  const mappedUnits = mapUnits(duration, false);\n  const hours = mappedUnits.find(unit => unit.symbol === 'h');\n  const minutes = mappedUnits.find(unit => unit.symbol === 'm');\n  const hasHours = hours.value > 0;\n  const validUnitStrings = [];\n  for (let index = 0; index < mappedUnits.length; index++) {\n    const unit = mappedUnits[index];\n    if (unit === hours && hasHours) {\n      validUnitStrings.push(`${zeroPadding(hours.value)}:${zeroPadding(minutes.value)}`);\n      break;\n    }\n    if (unit.value > 0) {\n      validUnitStrings.push(`${unit.value} ${unit.longUnit}`);\n    }\n    if (validUnitStrings.length === 2) {\n      break;\n    }\n    const nextUnit = mappedUnits[index + 1];\n    if (validUnitStrings.length > 0 && nextUnit?.value === 0) {\n      break;\n    }\n  }\n  const joiner = ` ${t('and')} `;\n  return validUnitStrings.join(joiner);\n};\n\n/**\n * Format seconds into hh:mm:ss.\n * @param duration duration to format in seconds\n * @returns Formatted string\n */\nexport const formatSeconds = (duration: number): string => {\n  duration = Math.round(duration || 0);\n\n  const hours = Math.floor(duration / (60 * 60));\n\n  const divisorForMinutes = duration % (60 * 60);\n  const minutes = Math.floor(divisorForMinutes / 60);\n\n  const divisor_for_seconds = divisorForMinutes % 60;\n  const seconds = Math.ceil(divisor_for_seconds);\n\n  const components = [zeroPadding(minutes), zeroPadding(seconds)];\n\n  if (hours > 0) {\n    components.unshift(hours.toString());\n  }\n\n  return components.join(':');\n};\n\n/**\n * Human readable format of a timestamp.\n * @note: Not testable due to timezones :(\n * @param timestamp Timestamp\n * @param longFormat `true`, if output should have leading numbers\n * @returns Human readable format of a timestamp.\n */\nexport const formatTimestamp = (timestamp: number | string, longFormat: boolean = true): string => {\n  const time = new Date(timestamp);\n  let format = 'P (HH:mm:ss)';\n\n  if (longFormat) {\n    format = isThisYear(new Date(timestamp)) ? 'eee dd MMM, HH:mm' : 'eee dd MMM yyyy, HH:mm';\n  }\n\n  return formatLocale(time, format);\n};\n\nexport const getCurrentDate = () => new Date().toISOString().substring(0, 10);\nexport const getUnixTimestamp = () => Math.floor(Date.now() / TIME_IN_MILLIS.SECOND);\nexport const isBeforeToday = (date: FnDate): boolean => isBefore(date, startOfToday());\nexport const isYoungerThan2Minutes = (date: FnDate): boolean => differenceInMinutes(new Date(), date) < 2;\nexport const isYoungerThan1Hour = (date: FnDate) => differenceInHours(new Date(), date) < 1;\nexport const isYoungerThan7Days = (date: FnDate) => differenceInDays(new Date(), date) < 7;\n\nexport const fromNowLocale = (date: FnDate) => formatDistanceToNow(date, {addSuffix: true, locale});\n\nexport {isToday, fromUnixTime, isYesterday, isSameDay, isSameMonth, isThisYear, differenceInHours, differenceInMinutes};\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport type {BackendError} from '@wireapp/api-client/lib/http/';\nimport type {QualifiedId} from '@wireapp/api-client/lib/user/';\nimport {AxiosError} from 'axios';\n\nimport {QualifiedUserClientEntityMap} from '../client';\nimport {Conversation} from '../entity/Conversation';\nimport {User} from '../entity/User';\nimport {ClientRecord} from '../storage/record/ClientRecord';\n\nexport function isAxiosError(errorCandidate: any): errorCandidate is AxiosError {\n  return errorCandidate && errorCandidate.isAxiosError === true;\n}\n\nexport function isBackendError(errorCandidate: any): errorCandidate is BackendError {\n  return errorCandidate && typeof errorCandidate.label === 'string' && typeof errorCandidate.message === 'string';\n}\n\nexport function isUser(userCandidate: any): userCandidate is User {\n  return userCandidate instanceof User;\n}\n\nexport function isQualifiedIdArray(ids: string[] | QualifiedId[]): ids is QualifiedId[] {\n  return !!ids.length && isQualifiedId(ids[0]);\n}\n\nexport function isQualifiedId(userId: string | QualifiedId): userId is QualifiedId {\n  return typeof userId === 'object' && 'domain' in userId;\n}\n\nexport function isConversationEntity(conversation: any): conversation is Conversation {\n  return conversation instanceof Conversation;\n}\n\nexport function isClientRecord(record: any): record is ClientRecord {\n  return !!record.meta;\n}\n\nexport function isQualifiedUserClientEntityMap(map: any): map is QualifiedUserClientEntityMap {\n  return Object.keys(map)[0]?.includes('.');\n}\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {includesString} from 'Util/StringUtil';\n\nexport const appendParameter = (url: string, parameter: string) => {\n  const separator = includesString(url, '?') ? '&' : '?';\n  return `${url}${separator}${parameter}`;\n};\n\nexport const getParameter = (parameterName: string, locationSearch = window.location.search) => {\n  const searchParameters = locationSearch.substring(1).split('&');\n  for (const searchParam of searchParameters) {\n    const [parameter, value] = searchParam.split('=');\n    const isExpectedParameter = parameter === parameterName;\n    if (isExpectedParameter) {\n      if (value) {\n        const decodedValue = decodeURI(value);\n\n        if (decodedValue === 'false') {\n          return false;\n        }\n\n        if (decodedValue === 'true') {\n          return true;\n        }\n\n        return value;\n      }\n\n      return true;\n    }\n  }\n\n  return null;\n};\n\nexport const forwardParameter = (\n  url: string,\n  parameterName: string,\n  locationSearch = window.location.search,\n): string => {\n  const parameterValue = getParameter(parameterName, locationSearch);\n  const hasValue = parameterValue != null;\n  return hasValue ? appendParameter(url, `${parameterName}=${parameterValue}`) : url;\n};\n\n/**\n * Removes protocol, www and trailing slashes in the given url\n * @param url URL to be cleaned\n * @returns Plain URL\n */\nexport const cleanURL = (url: string = ''): string => {\n  // force a protocol if there is none\n  url = url.replace(/^(?!https?:\\/\\/)/i, 'http://');\n  try {\n    const {hostname, pathname, search, hash} = new URL(url);\n    return `${hostname.replace(/^www./, '')}${pathname.replace(/\\/$/, '')}${search}${hash}`;\n  } catch (error) {\n    return '';\n  }\n};\n\n/**\n * Extracts a (sub)domain name from a URL\n *\n * e.g. `wire.com -> wire`\n *\n * or `https://wire.example.com -> wire`\n *\n * @param url The URL to get the domain name from\n */\nexport function getDomainName(url: string): string {\n  return url.replace(/^(?:.*:\\/\\/)?([^.]+)\\..*/, '$1');\n}\n\nexport const getLinksFromHtml = <T extends HTMLElement>(html: string): T[] => {\n  if (!html) {\n    return [];\n  }\n\n  const anchorTags = new RegExp(/<a[\\s]+([^>]+)>((?:.(?!\\<\\/a\\>))*.)<\\/a>/, 'g');\n  const links = html.match(anchorTags);\n\n  const hasLinks = links?.length;\n  return hasLinks ? links.map(element => $<T>(element)[0]) : [];\n};\n\n/**\n * Prepends \"http\" to given URL if protocol is missing\n * @param url URL to be prepended\n * @returns prepended URL\n */\nexport const prependProtocol = (url: string) => (!url.match(/^http[s]?:\\/\\//i) ? `http://${url}` : url);\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Config} from '../Config';\n\nexport class ValidationUtilError extends Error {\n  constructor(message = 'Unknown ValidationUtilError') {\n    super();\n\n    this.message = message;\n    this.name = this.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      this.stack = new Error(message).stack;\n    }\n  }\n}\n\nexport const isValidUsername = (username: string) => /^@?[a-z_0-9.-]{2,256}$/.test(username);\nexport const isValidFederationUsername = (username: string) => {\n  const federationUsernameRegex =\n    /^(@?[a-z_0-9.-]{2,256})@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return federationUsernameRegex.test(username);\n};\n\n/**\n * Checks if input has the format of an international phone number\n * @note Begins with + and contains only numbers\n * @param phoneNumber Input\n * @returns `true`, if the input a phone number\n */\nexport const isValidPhoneNumber = (phoneNumber: string): boolean => {\n  const allowDebugPhoneNumbers = Config.getConfig().FEATURE.ENABLE_DEBUG;\n  const regularExpression = allowDebugPhoneNumbers ? /^\\+[0-9]\\d{1,14}$/ : /^\\+[1-9]\\d{1,14}$/;\n\n  return regularExpression.test(phoneNumber);\n};\n\nexport const isValidEmail = (email: string): boolean => {\n  const regExp =\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return regExp.test(email);\n};\n\n// Since some special chars are allowed, remember to always\n// encode Bearer tokens using encodeURIComponents afterwards!\nexport const isBearerToken = (token: string): boolean => /^[a-zA-Z0-9\\-._~+/]+[=]{0,2}$/.test(token);\n\nexport const isUUID = (string: string): boolean =>\n  /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(string);\n\nexport const isBase64 = (string: string): boolean => {\n  try {\n    // Will raise a DOM exception if base64 string is invalid\n    window.atob(string);\n  } catch (error) {\n    return false;\n  }\n  return true;\n};\n\nexport const isValidApiPath = (path: string): boolean => {\n  const [urlPath] = path.split('?');\n  if (!/^\\/[a-zA-Z0-9\\-_/,]+$/.test(urlPath)) {\n    throw new ValidationUtilError(`Non-compliant path creation attempt. Details: ${path}`);\n  }\n  return true;\n};\n\nexport const isTweetUrl = (url: string): boolean => {\n  const regex =\n    /^http(?:s)?:\\/\\/(?:(?:www|mobile|0)\\.)?twitter\\.com\\/(?:(?:\\w{1,15})\\/status(?:es|\\/i)?|i\\/moments)\\/(?:\\d{2,21})(?:(?:\\?|\\/).*)?$/;\n  return regex.test(url);\n};\n\nexport const legacyAsset = (assetId: string, conversationId: string): true => {\n  if (!isUUID(assetId) || !isUUID(conversationId)) {\n    throw new ValidationUtilError('Invalid assetId / conversationId');\n  }\n  return true;\n};\n\n// https://github.com/wireapp/wire-server/blob/dc3e9a8af5250c0d045e96a31aa23c255b4e01a3/libs/cargohold-types/src/CargoHold/Types/V3.hs#L156-L177\nexport const assetRetentionPolicy = (policyId: number | string): boolean => policyId > 0 && policyId < 6;\n\nexport const assetV3 = (assetKey: string, assetToken?: string): true => {\n  if (!assetKey) {\n    throw new ValidationUtilError('Asset key not defined');\n  }\n\n  const SEPARATOR = '-';\n  const [version, type, ...uuid] = assetKey.split(SEPARATOR);\n\n  if (version !== '3') {\n    throw new ValidationUtilError('Invalid asset key (version)');\n  }\n  if (!assetRetentionPolicy(type)) {\n    throw new ValidationUtilError('Invalid asset key (type)');\n  }\n  if (!isUUID(uuid.join(SEPARATOR))) {\n    throw new ValidationUtilError('Invalid asset key (UUID)');\n  }\n  if (assetToken && !isBearerToken(assetToken)) {\n    throw new ValidationUtilError('Invalid asset token');\n  }\n  return true;\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\n/**\n * Gives back the browser's instance of localstorage if present.\n * Will prevent failing if localStorage is not accessible because cookies are disabled\n * @returns {any}\n */\nexport function getStorage() {\n  try {\n    /**\n     * If users disable cookies in their browsers, they won't have access to the localStorage API.\n     * The following check will fix this error:\n     * > Failed to read the 'localStorage' property from 'Window': Access is denied for this document\n     * (note: Some version of Firefox do not throw an error but, instead, return a null object, we also need to account for that scenario)\n     */\n    return window.localStorage;\n  } catch (error) {\n    return undefined;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {QualifiedId} from '@wireapp/api-client/lib/user';\nimport hljs from 'highlight.js';\nimport MarkdownIt from 'markdown-it';\nimport type Token from 'markdown-it/lib/token';\nimport {escape} from 'underscore';\n\nimport {replaceInRange} from './StringUtil';\n\nimport type {MentionEntity} from '../message/MentionEntity';\n\ninterface MentionText {\n  domain: string | null;\n  isSelfMentioned: boolean;\n  text: string;\n  userId: string;\n}\n\ninterface MarkdownItWithOptions extends MarkdownIt {\n  options: MarkdownIt.Options;\n}\n\n// Note: We are using \"Underscore.js\" to escape HTML in the original message\nconst markdownit = new MarkdownIt('zero', {\n  breaks: true,\n  html: false,\n  langPrefix: 'lang-',\n  linkify: true,\n}).enable(['autolink', 'backticks', 'code', 'emphasis', 'escape', 'fence', 'heading', 'link', 'linkify', 'newline']);\n\nconst originalFenceRule = markdownit.renderer.rules.fence;\n\nmarkdownit.renderer.rules.fence = (tokens, idx, options, env, self) => {\n  const highlighted = originalFenceRule(tokens, idx, options, env, self);\n  tokens[idx].map[1] += 1;\n  return highlighted.replace(/\\n$/, '');\n};\n\nmarkdownit.renderer.rules.heading_open = () => '<div class=\"md-heading\">';\nmarkdownit.renderer.rules.heading_close = () => '</div>';\n\nmarkdownit.renderer.rules.softbreak = () => '<br>';\nmarkdownit.renderer.rules.hardbreak = () => '<br>';\nmarkdownit.renderer.rules.paragraph_open = (tokens, idx) => {\n  const [position] = tokens[idx].map;\n  const previousWithMap = tokens\n    .slice(0, idx)\n    .reverse()\n    .find(({map}) => map?.length);\n  const previousPosition = previousWithMap ? previousWithMap.map[1] - 1 : 0;\n  const count = position - previousPosition;\n  return '<br>'.repeat(Math.max(count, 0));\n};\nmarkdownit.renderer.rules.paragraph_close = () => '';\n\nmarkdownit.normalizeLinkText = text => text;\n\nexport const renderMessage = (message: string, selfId: QualifiedId | null, mentionEntities: MentionEntity[] = []) => {\n  const createMentionHash = (mention: MentionEntity) => `@@${window.btoa(JSON.stringify(mention)).replace(/=/g, '')}`;\n  const renderMention = (mentionData: MentionText) => {\n    const elementClasses = mentionData.isSelfMentioned ? ' self-mention' : '';\n    let elementAttributes = mentionData.isSelfMentioned\n      ? ' data-uie-name=\"label-self-mention\" role=\"button\"'\n      : ` data-uie-name=\"label-other-mention\" data-user-id=\"${escape(mentionData.userId)}\" role=\"button\"`;\n    if (!mentionData.isSelfMentioned && mentionData.domain) {\n      elementAttributes += ` data-user-domain=\"${escape(mentionData.domain)}\"`;\n    }\n\n    const mentionText = mentionData.text.replace(/^@/, '');\n    const content = `<span class=\"mention-at-sign\">@</span>${escape(mentionText)}`;\n    return `<div class=\"message-mention${elementClasses}\"${elementAttributes}>${content}</div>`;\n  };\n\n  const mentionTexts: Record<string, MentionText> = {};\n\n  let mentionlessText = mentionEntities\n    .slice()\n    // sort mentions to start with the latest mention first (in order not to have to recompute the index every time we modify the original text)\n    .sort((mention1, mention2) => mention2.startIndex - mention1.startIndex)\n    .reduce((strippedText, mention) => {\n      const mentionText = message.slice(mention.startIndex, mention.startIndex + mention.length);\n      const mentionKey = createMentionHash(mention);\n      mentionTexts[mentionKey] = {\n        domain: mention.domain,\n        isSelfMentioned: !!selfId && mention.targetsUser(selfId),\n        text: mentionText,\n        userId: mention.userId,\n      };\n      return replaceInRange(strippedText, mentionKey, mention.startIndex, mention.startIndex + mention.length);\n    }, message);\n\n  markdownit.set({\n    highlight: function (code, lang): string {\n      const containsMentions = mentionEntities.some(mention => {\n        const hash = createMentionHash(mention);\n        return code.includes(hash);\n      });\n      if (containsMentions) {\n        // disable code highlighting if there is a mention in there\n        // highlighting will be wrong anyway because this is not valid code\n        return escape(code);\n      }\n      return hljs.highlightAuto(code, lang && [lang]).value;\n    },\n  });\n\n  markdownit.renderer.rules.link_open = (tokens, idx, options, env, self) => {\n    const cleanString = (hashedString: string) =>\n      escape(\n        Object.entries(mentionTexts).reduce(\n          (text, [mentionHash, mention]) => text.replace(mentionHash, () => mention.text),\n          hashedString,\n        ),\n      );\n    const link = tokens[idx];\n    const href = link.attrGet('href');\n    const isEmail = href.startsWith('mailto:');\n    const isWireDeepLink = href.toLowerCase().startsWith('wire://');\n    const nextToken = tokens[idx + 1];\n    const text = nextToken?.type === 'text' ? nextToken.content : '';\n\n    if (!href || !text.trim()) {\n      nextToken.content = '';\n      const closeToken = tokens.slice(idx).find(token => token.type === 'link_close');\n      closeToken.type = 'text';\n      closeToken.content = '';\n      return `[${cleanString(text)}](${cleanString(href)})`;\n    }\n    if (isEmail) {\n      link.attrPush(['data-email-link', 'true']);\n    } else {\n      link.attrPush(['target', '_blank']);\n      link.attrPush(['rel', 'nofollow noopener noreferrer']);\n    }\n    if (!isWireDeepLink && !['autolink', 'linkify'].includes(link.markup)) {\n      const title = link.attrGet('title');\n      if (title) {\n        link.attrSet('title', title);\n      }\n      link.attrSet('href', href);\n      if (nextToken?.type === 'text') {\n        nextToken.content = text;\n      }\n      link.attrPush(['data-md-link', 'true']);\n      link.attrPush(['data-uie-name', 'markdown-link']);\n    }\n    if (isWireDeepLink) {\n      link.attrPush(['data-uie-name', 'wire-deep-link']);\n    }\n    if (link.markup === 'linkify') {\n      nextToken.content = encodeURI(nextToken.content);\n    }\n    return self.renderToken(tokens, idx, options);\n  };\n  const originalTokens = markdownit.parse(mentionlessText, {});\n  const modifiedLinksTokens = markdownit.parse(mentionlessText, {});\n  const fixCodeTokens = (modifiedTokens: Token[], originalTokens: Token[]) =>\n    modifiedTokens.map((modifiedToken, index) => {\n      const originalToken = originalTokens[index];\n      if (modifiedToken.tag === 'code') {\n        return originalToken;\n      }\n      if (modifiedToken.children) {\n        modifiedToken.children = fixCodeTokens(modifiedToken.children, originalToken.children);\n      }\n      return modifiedToken;\n    });\n  const fixedTokens = fixCodeTokens(modifiedLinksTokens, originalTokens);\n  mentionlessText = markdownit.renderer.render(fixedTokens, (markdownit as MarkdownItWithOptions).options, {});\n  // Remove <br> and \\n if it is the last thing in a message\n  mentionlessText = mentionlessText.replace(/(<br>|\\n)*$/, '');\n\n  const parsedText = Object.keys(mentionTexts).reduce((text, mentionHash) => {\n    const mentionMarkup = renderMention(mentionTexts[mentionHash]);\n\n    return text.replace(mentionHash, () => mentionMarkup);\n  }, mentionlessText);\n  return parsedText;\n};\n\nexport const getRenderedTextContent = (text: string): string => {\n  const renderedMessage = renderMessage(text, {domain: '', id: ''});\n  const messageWithLinebreaks = renderedMessage.replace(/<br>/g, '\\n');\n  const strippedMessage = messageWithLinebreaks.replace(/<.+?>/g, '');\n  return markdownit.utils.unescapeAll(strippedMessage);\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Decoder, Encoder} from 'bazinga64';\nimport {StatusCodes as HTTP_STATUS} from 'http-status-codes';\nimport type {ObservableArray} from 'knockout';\nimport UUID from 'uuidjs';\n\nimport {UrlUtil, Runtime} from '@wireapp/commons';\n\nimport {isTabKey} from 'Util/KeyboardUtil';\nimport {findMentionAtPosition} from 'Util/MentionUtil';\n\nimport {loadValue} from './StorageUtil';\n\nimport {QUERY_KEY} from '../auth/route';\nimport {Config} from '../Config';\nimport type {Conversation} from '../entity/Conversation';\nimport {AuthError} from '../error/AuthError';\nimport {MentionEntity} from '../message/MentionEntity';\nimport {StorageKey} from '../storage/StorageKey';\n\nexport const isTemporaryClientAndNonPersistent = (persist: boolean): boolean => {\n  if (persist === undefined) {\n    throw new Error('Type of client is unspecified.');\n  }\n\n  const isNonPersistentByUrl = UrlUtil.getURLParameter(QUERY_KEY.PERSIST_TEMPORARY_CLIENTS) === 'false';\n  const isNonPersistentByServerConfig = Config.getConfig().FEATURE?.PERSIST_TEMPORARY_CLIENTS === false;\n  const isNonPersistent = isNonPersistentByUrl || isNonPersistentByServerConfig;\n\n  const isTemporary = persist === false;\n  return isTemporary && isNonPersistent;\n};\n\nexport const checkIndexedDb = (): Promise<void> => {\n  if (isTemporaryClientAndNonPersistent(loadValue(StorageKey.AUTH.PERSIST))) {\n    return Promise.resolve();\n  }\n\n  if (!Runtime.isSupportingIndexedDb()) {\n    const errorType = Runtime.isEdge() ? AuthError.TYPE.PRIVATE_MODE : AuthError.TYPE.INDEXED_DB_UNSUPPORTED;\n    const errorMessage = Runtime.isEdge() ? AuthError.MESSAGE.PRIVATE_MODE : AuthError.MESSAGE.INDEXED_DB_UNSUPPORTED;\n    return Promise.reject(new AuthError(errorType, errorMessage));\n  }\n\n  if (Runtime.isFirefox()) {\n    let dbOpenRequest: IDBOpenDBRequest;\n\n    try {\n      dbOpenRequest = window.indexedDB.open('test');\n      dbOpenRequest.onerror = event => {\n        if (dbOpenRequest.error) {\n          event.preventDefault();\n          return Promise.reject(new AuthError(AuthError.TYPE.PRIVATE_MODE, AuthError.MESSAGE.PRIVATE_MODE));\n        }\n        return undefined;\n      };\n    } catch (error) {\n      return Promise.reject(new AuthError(AuthError.TYPE.PRIVATE_MODE, AuthError.MESSAGE.PRIVATE_MODE));\n    }\n\n    return new Promise((resolve, reject) => {\n      let currentAttempt = 0;\n      const interval = 10;\n      const maxRetry = 50;\n\n      const interval_id = window.setInterval(() => {\n        currentAttempt += 1;\n\n        if (dbOpenRequest.readyState === 'done' && !dbOpenRequest.result) {\n          window.clearInterval(interval_id);\n          return reject(new AuthError(AuthError.TYPE.PRIVATE_MODE, AuthError.MESSAGE.PRIVATE_MODE));\n        }\n\n        const tooManyAttempts = currentAttempt >= maxRetry;\n        if (tooManyAttempts) {\n          window.clearInterval(interval_id);\n          resolve();\n        }\n      }, interval);\n    });\n  }\n\n  return Promise.resolve();\n};\n\nexport const loadDataUrl = (file: Blob): Promise<string | ArrayBuffer> => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(file);\n  });\n};\n\nexport const loadUrlBuffer = (\n  url: string,\n  xhrAccessorFunction?: (xhr: XMLHttpRequest) => void,\n): Promise<{buffer: ArrayBuffer; mimeType: string}> => {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', url, true);\n    xhr.responseType = 'arraybuffer';\n\n    xhr.onload = () => {\n      const isStatusOK = xhr.status === HTTP_STATUS.OK;\n      return isStatusOK\n        ? resolve({buffer: xhr.response, mimeType: xhr.getResponseHeader('content-type')})\n        : reject(new Error(xhr.status.toString(10)));\n    };\n\n    xhr.onerror = reject;\n\n    if (typeof xhrAccessorFunction === 'function') {\n      xhrAccessorFunction(xhr);\n    }\n    xhr.send();\n  });\n};\n\nexport const loadImage = function (blob: Blob): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const object_url = window.URL.createObjectURL(blob);\n    const img = new Image();\n    img.onload = () => {\n      resolve(img);\n      window.URL.revokeObjectURL(object_url);\n    };\n    img.onerror = reject;\n    img.src = object_url;\n  });\n};\n\nexport const loadFileBuffer = (file: Blob | File): Promise<ArrayBuffer> => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result as ArrayBuffer);\n    reader.onerror = reject;\n    reader.readAsArrayBuffer(file);\n  });\n};\n\nexport const loadUrlBlob = (url: string): Promise<Blob> => {\n  return loadUrlBuffer(url).then(({buffer, mimeType}) => new Blob([new Uint8Array(buffer)], {type: mimeType}));\n};\n\nexport const getFileExtension = (filename: string): string => {\n  const extensionMatch = filename?.match(/\\.(tar\\.gz|[^.]*)$/i);\n  const foundExtension = extensionMatch?.[1];\n  return foundExtension || '';\n};\n\nexport const trimFileExtension = (filename: string): string => {\n  if (typeof filename === 'string') {\n    if (filename.endsWith('.tar.gz')) {\n      filename = filename.replace(/\\.tar\\.gz$/, '');\n    }\n\n    return filename.replace(/\\.[^/.]+$/, '');\n  }\n\n  return '';\n};\n\nexport const formatBytes = (bytes: number, decimals: number = 1): string => {\n  if (bytes === 0) {\n    return '0 B';\n  }\n\n  const kilobytes = 1024;\n  decimals += 1;\n  const unit = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n  const index = Math.floor(Math.log(bytes) / Math.log(kilobytes));\n  return `${parseFloat((bytes / Math.pow(kilobytes, index)).toFixed(decimals))} ${unit[index]}`;\n};\n\nexport const getContentTypeFromDataUrl = (dataUrl: string): string => {\n  return dataUrl.match(/^.*:(.*);.*,/)[1];\n};\n\nexport const stripDataUri = (string: string): string => string.replace(/^data:.*,/, '');\n\n/**\n * Convert a base64 string to an Uint8Array.\n * @note Function will remove \"data-uri\" attribute if present.\n */\nexport const base64ToArray = (base64: string): Uint8Array => {\n  return Decoder.fromBase64(stripDataUri(base64)).asBytes;\n};\n\n/**\n * Convert an ArrayBuffer or an Uint8Array to a base64 string\n */\nexport const arrayToBase64 = (array: ArrayBuffer | Uint8Array): string => {\n  return Encoder.toBase64(array).asString;\n};\n\n/**\n * Convert base64 dataURI to Blob\n */\nexport const base64ToBlob = (base64: string): Blob => {\n  const mimeType = getContentTypeFromDataUrl(base64);\n  const bytes = base64ToArray(base64);\n  return new Blob([bytes], {type: mimeType});\n};\n\n/**\n * Downloads blob using a hidden link element.ƒ\n */\nexport const downloadBlob = (blob: Blob, filename: string, mimeType?: string): number => {\n  if (blob) {\n    const url = window.URL.createObjectURL(blob);\n    return downloadFile(url, filename, mimeType);\n  }\n\n  throw new Error('Failed to download blob: Resource not provided');\n};\n\nexport const downloadFile = (url: string, fileName: string, mimeType?: string): number => {\n  const anchor = document.createElement('a');\n  anchor.download = fileName;\n  anchor.href = url;\n  anchor.style.display = 'none';\n  if (mimeType) {\n    anchor.type = mimeType;\n  }\n\n  // Firefox needs the element to be in the DOM for the download to start:\n  // @see https://stackoverflow.com/a/32226068\n  document.body.appendChild(anchor);\n  anchor.click();\n\n  // Wait before removing resource and link. Needed in FF.\n  return window.setTimeout(() => {\n    const objectURL = anchor.href;\n    document.body.removeChild(anchor);\n    window.URL.revokeObjectURL(objectURL);\n  }, 100);\n};\n\nexport const createRandomUuid = (version: 4 | 1 = 4): string =>\n  (version === 4 ? UUID.genV4() : UUID.genV1()).toString();\n\n// Note: IE10 listens to \"transitionend\" instead of \"animationend\"\nexport const alias = {\n  animationend: 'transitionend animationend oAnimationEnd MSAnimationEnd mozAnimationEnd webkitAnimationEnd',\n};\n\nexport const koPushDeferred = (target: ObservableArray, src: any[], number = 100, delay = 300) => {\n  /** push array deferred to knockout's `observableArray` */\n  let interval: number;\n\n  return (interval = window.setInterval(() => {\n    const chunk = src.splice(0, number);\n    target.push(...chunk);\n\n    if (src.length === 0) {\n      return window.clearInterval(interval);\n    }\n  }, delay));\n};\n\n/**\n * Add zero padding until limit is reached.\n */\nexport const zeroPadding = (value: string | number, length = 2): string => {\n  const zerosNeeded = Math.max(0, length - value.toString().length);\n  return `${'0'.repeat(zerosNeeded)}${value}`;\n};\n\nexport const sortGroupsByLastEvent = (groupA: Conversation, groupB: Conversation): number =>\n  groupB.last_event_timestamp() - groupA.last_event_timestamp();\n\nexport const sortObjectByKeys = (object: Record<string, any>, reverse: boolean) => {\n  const keys = Object.keys(object);\n  keys.sort();\n\n  if (reverse) {\n    keys.reverse();\n  }\n\n  // Returns a copy of an object, which is ordered by the keys of the original object.\n  return keys.reduce<Record<string, any>>((sortedObject, key: string) => {\n    sortedObject[key] = object[key];\n    return sortedObject;\n  }, {});\n};\n\n// Removes url(' and url(\" from the beginning of the string and also \") and ') from the end\nexport const stripUrlWrapper = (url: string) => url.replace(/^url\\([\"']?/, '').replace(/[\"']?\\)$/, '');\n\nexport const validateProfileImageResolution = (file: File, minWidth: number, minHeight: number): Promise<boolean> => {\n  return new Promise((resolve, reject) => {\n    const image = new Image();\n    image.onload = () => resolve(image.width >= minWidth && image.height >= minHeight);\n    image.onerror = () => reject(new Error('Failed to load profile picture for size validation'));\n    image.src = window.URL.createObjectURL(file);\n  });\n};\n\n// https://developer.mozilla.org/en-US/Firefox/Performance_best_practices_for_Firefox_fe_engineers\nexport const afterRender = (callback: TimerHandler): number =>\n  window.requestAnimationFrame(() => window.setTimeout(callback, 0));\n\n/**\n * No operation\n */\nexport const noop = (): void => {};\n\nexport function throttle(callback: Function, wait: number, immediate = false) {\n  let timeout: number | null = null;\n  let initialCall = true;\n\n  return function () {\n    const callNow = immediate && initialCall;\n    const next = () => {\n      // eslint-disable-next-line prefer-rest-params\n      callback.apply(this, arguments);\n      timeout = null;\n    };\n\n    if (callNow) {\n      initialCall = false;\n      next();\n    }\n\n    if (!timeout) {\n      timeout = window.setTimeout(next, wait);\n    }\n  };\n}\n\nexport const focusableElementsSelector =\n  'button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"])';\n\nexport const preventFocusOutside = (event: KeyboardEvent, parentId: string): void => {\n  if (!isTabKey(event)) {\n    return;\n  }\n  event.preventDefault();\n  const parent = document.getElementById(parentId);\n  const focusableContent = parent ? [...parent.querySelectorAll(focusableElementsSelector)] : [];\n  const focusedItemIndex = focusableContent.indexOf(document.activeElement);\n  if (event.shiftKey && focusedItemIndex != 0) {\n    (focusableContent[focusedItemIndex - 1] as HTMLElement)?.focus();\n    return;\n  }\n  if (event.shiftKey && focusedItemIndex === 0) {\n    (focusableContent[focusableContent.length - 1] as HTMLElement)?.focus();\n    return;\n  }\n  if (!event.shiftKey && focusedItemIndex === focusableContent.length - 1) {\n    (focusableContent[0] as HTMLElement)?.focus();\n    return;\n  }\n  (focusableContent[focusedItemIndex + 1] as HTMLElement)?.focus();\n};\n\nexport const setContextMenuPosition = (event: React.KeyboardEvent) => {\n  event.stopPropagation();\n  event.preventDefault();\n\n  const {top, left, height} = (event.target as Element).getBoundingClientRect();\n  return new MouseEvent('MouseEvent', {\n    ...(event as unknown as MouseEvent),\n    clientX: left,\n    clientY: top + height,\n  });\n};\n\nexport const generateConversationInputStorageKey = (conversationEntity: Conversation): string =>\n  `${StorageKey.CONVERSATION.INPUT}|${conversationEntity.id}`;\n\nexport const getSelectionPosition = (element: HTMLTextAreaElement, currentMentions: MentionEntity[]) => {\n  const {selectionStart: start, selectionEnd: end} = element;\n  const defaultRange = {endIndex: 0, startIndex: Infinity};\n\n  const firstMention = findMentionAtPosition(start, currentMentions) || defaultRange;\n  const lastMention = findMentionAtPosition(end, currentMentions) || defaultRange;\n\n  const mentionStart = Math.min(firstMention.startIndex, lastMention.startIndex);\n  const mentionEnd = Math.max(firstMention.endIndex, lastMention.endIndex);\n\n  const newStart = Math.min(mentionStart, start);\n  const newEnd = Math.max(mentionEnd, end);\n\n  return {newEnd, newStart};\n};\n\nconst supportsSecretStorage = () => !Runtime.isDesktopApp() || !!window.systemCrypto;\n\n// disables mls for old 'broken' desktop clients, see https://github.com/wireapp/wire-desktop/pull/6094\nexport const supportsMLS = () => Config.getConfig().FEATURE.ENABLE_MLS && supportsSecretStorage();\n\nexport const supportsCoreCryptoProteus = () =>\n  Config.getConfig().FEATURE.ENABLE_PROTEUS_CORE_CRYPTO && supportsSecretStorage();\n\nexport const incomingCssClass = 'content-animation-incoming-horizontal-left';\n\nexport const removeAnimationsClass = (element: HTMLElement | null) => {\n  if (element) {\n    element.addEventListener('animationend', () => {\n      if (element.classList.contains(incomingCssClass)) {\n        element.classList.remove(incomingCssClass);\n      }\n    });\n  }\n};\n","/*\n * Wire\n * Copyright (C) 2018 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport class WebWorker {\n  private readonly uri: string;\n\n  constructor(uri: string) {\n    this.uri = uri;\n  }\n\n  post<T>(data: string | ArrayBuffer | Record<string, any>): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const worker = new Worker(this.uri);\n      worker.onmessage = event => resolve(event.data);\n      worker.onerror = error => reject(error);\n      worker.postMessage(data);\n    });\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2019 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {amplify} from 'amplify';\n\nimport {Runtime} from '@wireapp/commons';\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {Environment} from './Environment';\n\nimport {ROLE} from '../user/UserPermission';\n\nexport function exposeWrapperGlobals(): void {\n  if (Runtime.isDesktopApp()) {\n    window.amplify = amplify;\n    window.z ||= {};\n\n    window.z.event ||= {};\n    window.z.event.WebApp = WebAppEvents;\n\n    window.z.util ||= {};\n    window.z.util.Environment = Environment;\n\n    window.z.team ||= {};\n    window.z.team.ROLE = ROLE;\n  }\n}\n","/*\n * Wire\n * Copyright (C) 2021 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport React, {useEffect} from 'react';\n\nimport cx from 'classnames';\n\nimport {Runtime} from '@wireapp/commons';\n\nimport {Icon} from 'Components/Icon';\nimport {t} from 'Util/LocalizerUtil';\nimport {afterRender} from 'Util/util';\n\nimport {closeWarning, useWarningsState} from './WarningsState';\nimport {CONFIG, TYPE} from './WarningsTypes';\n\nimport {Config} from '../../Config';\n\ninterface WarningProps {\n  onRefresh: () => void;\n}\n\nconst WarningsContainer: React.FC<WarningProps> = ({onRefresh}) => {\n  const name = useWarningsState(state => state.name);\n  const warnings = useWarningsState(state => state.warnings);\n  const type = TYPE;\n  const visibleWarning = warnings[warnings.length - 1];\n  const warningDimmed = warnings.some(warning => CONFIG.DIMMED_MODES.includes(warning));\n\n  useEffect(() => {\n    const visibleWarning = warnings[warnings.length - 1];\n    const isConnectivityRecovery = visibleWarning === TYPE.CONNECTIVITY_RECOVERY;\n    const hasOffset = warnings.length > 0 && !isConnectivityRecovery;\n    const isMiniMode = CONFIG.MINI_MODES.includes(visibleWarning);\n\n    const app = document.querySelector('#app');\n    if (app) {\n      app.classList.toggle('app--small-offset', hasOffset && isMiniMode);\n      app.classList.toggle('app--large-offset', hasOffset && !isMiniMode);\n    }\n\n    afterRender(() => window.dispatchEvent(new Event('resize')));\n  }, [warnings]);\n\n  const brandName = Config.getConfig().BRAND_NAME;\n  const URL = Config.getConfig().URL;\n\n  const closeButton = (\n    <button\n      type=\"button\"\n      data-uie-name=\"do-close-warning\"\n      className=\"warning-bar-close icon-close button-round button-round-dark button-reset-default\"\n      onClick={closeWarning}\n    />\n  );\n\n  if (warnings.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className={cx('warning', {'warning-dimmed': warningDimmed})}>\n      {visibleWarning === type.REQUEST_CAMERA && (\n        <div data-uie-name=\"request-camera\" className=\"warning-bar warning-bar-feature\">\n          <div\n            className=\"warning-bar-message\"\n            dangerouslySetInnerHTML={{\n              __html: t(\n                'warningPermissionRequestCamera',\n                {},\n                {icon: \"<span class='warning-bar-icon icon-camera'></span>\"},\n              ),\n            }}\n          />\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.DENIED_CAMERA && (\n        <div data-uie-name=\"denied-camera\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningPermissionDeniedCamera')}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              href={URL.SUPPORT.CAMERA_ACCESS_DENIED}\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n            >\n              {t('warningLearnMore')}\n            </a>\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.REQUEST_MICROPHONE && (\n        <div data-uie-name=\"request-microphone\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <Icon.MicOn className=\"warning-bar-icon\" />\n            <span dangerouslySetInnerHTML={{__html: t('warningPermissionRequestMicrophone', {}, {icon: ''})}} />\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.DENIED_MICROPHONE && (\n        <div data-uie-name=\"denied-microphone\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningPermissionDeniedMicrophone')}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n              href={URL.SUPPORT.MICROPHONE_ACCESS_DENIED}\n            >\n              {t('warningLearnMore')}\n            </a>\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.REQUEST_SCREEN && (\n        <div data-uie-name=\"request-screen\" className=\"warning-bar warning-bar-feature\">\n          <div\n            className=\"warning-bar-message\"\n            dangerouslySetInnerHTML={{\n              __html: t(\n                'warningPermissionRequestScreen',\n                {},\n                {icon: \"<span class='warning-bar-icon icon-screensharing'></span>\"},\n              ),\n            }}\n          />\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.DENIED_SCREEN && (\n        <div data-uie-name=\"denied-screen\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningPermissionDeniedScreen')}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n              href={URL.SUPPORT.SCREEN_ACCESS_DENIED}\n            >\n              {t('warningLearnMore')}\n            </a>\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.NOT_FOUND_CAMERA && (\n        <div data-uie-name=\"not-found-camera\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningNotFoundCamera')}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n              href={URL.SUPPORT.DEVICE_NOT_FOUND}\n            >\n              {t('warningLearnMore')}\n            </a>\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.NOT_FOUND_MICROPHONE && (\n        <div data-uie-name=\"not-found-microphone\" className=\"warning-bar warning-bar-feature\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningNotFoundMicrophone')}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n              href={URL.SUPPORT.DEVICE_NOT_FOUND}\n            >\n              {t('warningLearnMore')}\n            </a>\n          </div>\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.REQUEST_NOTIFICATION && (\n        <div data-uie-name=\"request-notification\" className=\"warning-bar warning-bar-feature\">\n          <div\n            className=\"warning-bar-message\"\n            dangerouslySetInnerHTML={{\n              __html: t(\n                'warningPermissionRequestNotification',\n                {},\n                {icon: \"<span class='warning-bar-icon icon-envelope'></span>\"},\n              ),\n            }}\n          />\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.UNSUPPORTED_INCOMING_CALL && (\n        <div data-uie-name=\"unsupported-incoming-call\" className=\"warning-bar warning-bar-feature\">\n          {!Runtime.isChrome() && (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallUnsupportedIncoming', name)}</span>&nbsp;\n              <a\n                className=\"warning-bar-link\"\n                rel=\"nofollow noopener noreferrer\"\n                target=\"_blank\"\n                href={URL.SUPPORT.CALLING}\n              >\n                {t('warningLearnMore')}\n              </a>\n            </div>\n          )}\n          {Runtime.isChrome() && Runtime.isDesktopApp() ? (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallIssues', brandName)}</span>&nbsp;\n              <a\n                className=\"warning-bar-link\"\n                rel=\"nofollow noopener noreferrer\"\n                target=\"_blank\"\n                href={window.wire.env.APP_BASE}\n              >\n                {t('wire_for_web', brandName)}\n              </a>\n            </div>\n          ) : (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallUpgradeBrowser')}</span>\n            </div>\n          )}\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.UNSUPPORTED_OUTGOING_CALL && (\n        <div data-uie-name=\"unsupported-outgoing-call\" className=\"warning-bar warning-bar-feature\">\n          {!Runtime.isChrome() && (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallUnsupportedOutgoing')}</span>&nbsp;\n              <a\n                className=\"warning-bar-link\"\n                rel=\"nofollow noopener noreferrer\"\n                target=\"_blank\"\n                href={URL.SUPPORT.CALLING}\n              >\n                {t('warningLearnMore')}\n              </a>\n            </div>\n          )}\n          {Runtime.isChrome() && Runtime.isDesktopApp() ? (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallIssues', brandName)}</span>&nbsp;\n              <a\n                className=\"warning-bar-link\"\n                rel=\"nofollow noopener noreferrer\"\n                target=\"_blank\"\n                href={window.wire.env.APP_BASE}\n              >\n                {t('wire_for_web', brandName)}\n              </a>\n            </div>\n          ) : (\n            <div className=\"warning-bar-message\">\n              <span>{t('warningCallUpgradeBrowser')}</span>\n            </div>\n          )}\n          {closeButton}\n        </div>\n      )}\n      {visibleWarning === type.CONNECTIVITY_RECONNECT && (\n        <div data-uie-name=\"connectivity-reconnect\" className=\"warning-bar warning-bar-connection\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningConnectivityConnectionLost', brandName)}</span>\n            <Icon.Loading className=\"warning-bar-spinner\" data-uie-name=\"status-loading\" />\n          </div>\n        </div>\n      )}\n      {visibleWarning === type.CALL_QUALITY_POOR && (\n        <div\n          data-uie-name=\"call-quality-poor\"\n          className=\"warning-bar warning-bar-connection warning-bar-poor-call-quality\"\n        >\n          <div className=\"warning-bar-message\">\n            <span>{t('warningCallQualityPoor')}</span>\n          </div>\n        </div>\n      )}\n      {visibleWarning === type.CONNECTIVITY_RECOVERY && (\n        <div data-uie-name=\"connectivity-recovery\" className=\"warning-bar warning-bar-progress\" />\n      )}\n      {visibleWarning === type.NO_INTERNET && (\n        <div data-uie-name=\"no-internet\" className=\"warning-bar warning-bar-connection\">\n          <div className=\"warning-bar-message\">{t('warningConnectivityNoInternet')}</div>\n        </div>\n      )}\n      {visibleWarning === type.LIFECYCLE_UPDATE && (\n        <div data-uie-name=\"lifecycle-update\" className=\"warning-bar warning-bar-connection\">\n          <div className=\"warning-bar-message\">\n            <span>{t('warningLifecycleUpdate', brandName)}</span>&nbsp;\n            <a\n              className=\"warning-bar-link\"\n              href={URL.WHATS_NEW}\n              rel=\"nofollow noopener noreferrer\"\n              target=\"_blank\"\n              data-uie-name=\"go-whats-new\"\n            >\n              {t('warningLifecycleUpdateNotes')}\n            </a>\n            &nbsp;·&nbsp;\n            <button\n              type=\"button\"\n              className=\"warning-bar-link button-reset-default\"\n              onClick={onRefresh}\n              data-uie-name=\"do-update\"\n            >\n              {t('warningLifecycleUpdateLink')}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport {WarningsContainer};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {amplify} from 'amplify';\nimport create from 'zustand';\n\nimport {WebAppEvents} from '@wireapp/webapp-events';\n\nimport {PrimaryModal} from 'Components/Modals/PrimaryModal';\nimport {t} from 'Util/LocalizerUtil';\nimport {getLogger} from 'Util/Logger';\nimport {safeWindowOpen} from 'Util/SanitizationUtil';\n\nimport {TYPE} from './WarningsTypes';\n\nimport {Config} from '../../Config';\nimport {PermissionState} from '../../notification/PermissionState';\n\nconst logger = getLogger('WarningsViewModel');\n\ntype WarningsState = {\n  name: string;\n  warnings: TYPE[];\n  setName: (newName: string) => void;\n  addWarning: (warning: TYPE) => void;\n  removeWarning: (warning: TYPE) => void;\n};\n\nconst useWarningsState = create<WarningsState>((set, get) => ({\n  addWarning: type => set(state => ({...state, warnings: [...state.warnings, type]})),\n  name: '',\n  removeWarning: type => set(state => ({...state, warnings: [...state.warnings.filter(warning => warning !== type)]})),\n  setName: newName => set(state => ({...state, name: newName})),\n  warnings: [],\n}));\n\nconst getVisibleWarning = (): TYPE => {\n  const {warnings} = useWarningsState.getState();\n  const visibleWarning = warnings[warnings.length - 1];\n  return visibleWarning;\n};\n\nconst hideWarning = (type = getVisibleWarning()) => {\n  const {warnings, removeWarning} = useWarningsState.getState();\n  if (warnings.includes(type)) {\n    removeWarning(type);\n    logger.info(`Dismissed warning of type '${type}'`);\n  }\n};\n\nconst showWarning = (type: TYPE, info?: {name: string}) => {\n  const {setName, addWarning} = useWarningsState.getState();\n  const visibleWarning = getVisibleWarning();\n  const connectivityTypes = [TYPE.CONNECTIVITY_RECONNECT, TYPE.NO_INTERNET];\n  const isConnectivityWarning = connectivityTypes.includes(type);\n  const visibleWarningIsLifecycleUpdate = visibleWarning === TYPE.LIFECYCLE_UPDATE;\n  if (isConnectivityWarning && !visibleWarningIsLifecycleUpdate) {\n    hideWarning(visibleWarning);\n  }\n\n  logger.warn(`Showing warning of type '${type}'`);\n\n  if (info) {\n    setName(info.name);\n  }\n\n  addWarning(type);\n};\n\n/**\n * Close warning.\n * @note Used to close a warning banner by clicking the close button\n */\nconst closeWarning = (): void => {\n  const {warnings, removeWarning} = useWarningsState.getState();\n  const visibleWarning = warnings[warnings.length - 1];\n  const warningToClose = visibleWarning;\n  const URL = Config.getConfig().URL;\n\n  if (warnings.includes(warningToClose)) {\n    removeWarning(warningToClose);\n    logger.info(`Dismissed warning of type '${warningToClose}'`);\n  }\n\n  switch (warningToClose) {\n    case TYPE.REQUEST_MICROPHONE: {\n      PrimaryModal.show(PrimaryModal.type.ACKNOWLEDGE, {\n        primaryAction: {\n          action: () => {\n            safeWindowOpen(URL.SUPPORT.MICROPHONE_ACCESS_DENIED);\n          },\n          text: t('modalCallNoMicrophoneAction'),\n        },\n        text: {\n          message: t('modalCallNoMicrophoneMessage'),\n          title: t('modalCallNoMicrophoneHeadline'),\n        },\n      });\n      break;\n    }\n\n    case TYPE.REQUEST_NOTIFICATION: {\n      // We block subsequent permission requests for notifications when the user ignores the request.\n      amplify.publish(WebAppEvents.NOTIFICATION.PERMISSION_STATE, PermissionState.IGNORED);\n      break;\n    }\n  }\n};\n\nexport {useWarningsState, showWarning, hideWarning, closeWarning};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum TYPE {\n  CALL_QUALITY_POOR = 'call_quality_poor',\n  CONNECTIVITY_RECONNECT = 'connectivity_reconnect',\n  CONNECTIVITY_RECOVERY = 'connectivity_recovery',\n  DENIED_CAMERA = 'camera_access_denied',\n  DENIED_MICROPHONE = 'mic_access_denied',\n  DENIED_SCREEN = 'screen_access_denied',\n  LIFECYCLE_UPDATE = 'lifecycle_update',\n  NOT_FOUND_CAMERA = 'not_found_camera',\n  NOT_FOUND_MICROPHONE = 'not_found_microphone',\n  NO_INTERNET = 'no_internet',\n  REQUEST_CAMERA = 'request_camera',\n  REQUEST_MICROPHONE = 'request_microphone',\n  REQUEST_NOTIFICATION = 'request_notification',\n  REQUEST_SCREEN = 'request_screen',\n  UNSUPPORTED_INCOMING_CALL = 'unsupported_incoming_call',\n  UNSUPPORTED_OUTGOING_CALL = 'unsupported_outgoing_call',\n}\n\nexport const CONFIG = {\n  DIMMED_MODES: [TYPE.REQUEST_CAMERA, TYPE.REQUEST_MICROPHONE, TYPE.REQUEST_NOTIFICATION, TYPE.REQUEST_SCREEN],\n  MINI_MODES: [TYPE.CONNECTIVITY_RECONNECT, TYPE.LIFECYCLE_UPDATE, TYPE.NO_INTERNET, TYPE.CALL_QUALITY_POOR],\n};\n","/*\n * Wire\n * Copyright (C) 2022 Wire Swiss GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport './WarningsContainer';\nimport {hideWarning, showWarning} from './WarningsState';\nimport {CONFIG, TYPE} from './WarningsTypes';\n\nconst Warnings = {\n  CONFIG,\n  TYPE,\n  hideWarning,\n  showWarning,\n};\n\nexport {Warnings};\n","var parent = require('../../stable/object');\n\nmodule.exports = parent;\n","require('../../modules/es.symbol');\nrequire('../../modules/es.object.assign');\nrequire('../../modules/es.object.create');\nrequire('../../modules/es.object.define-property');\nrequire('../../modules/es.object.define-properties');\nrequire('../../modules/es.object.entries');\nrequire('../../modules/es.object.freeze');\nrequire('../../modules/es.object.from-entries');\nrequire('../../modules/es.object.get-own-property-descriptor');\nrequire('../../modules/es.object.get-own-property-descriptors');\nrequire('../../modules/es.object.get-own-property-names');\nrequire('../../modules/es.object.get-prototype-of');\nrequire('../../modules/es.object.has-own');\nrequire('../../modules/es.object.is');\nrequire('../../modules/es.object.is-extensible');\nrequire('../../modules/es.object.is-frozen');\nrequire('../../modules/es.object.is-sealed');\nrequire('../../modules/es.object.keys');\nrequire('../../modules/es.object.prevent-extensions');\nrequire('../../modules/es.object.proto');\nrequire('../../modules/es.object.seal');\nrequire('../../modules/es.object.set-prototype-of');\nrequire('../../modules/es.object.values');\nrequire('../../modules/es.object.to-string');\nrequire('../../modules/es.object.define-getter');\nrequire('../../modules/es.object.define-setter');\nrequire('../../modules/es.object.lookup-getter');\nrequire('../../modules/es.object.lookup-setter');\nrequire('../../modules/es.json.to-string-tag');\nrequire('../../modules/es.math.to-string-tag');\nrequire('../../modules/es.reflect.to-string-tag');\nvar path = require('../../internals/path');\n\nmodule.exports = path.Object;\n","var parent = require('../../actual/object');\n// TODO: Remove from `core-js@4`\nrequire('../../modules/esnext.object.has-own');\nrequire('../../modules/esnext.object.iterate-entries');\nrequire('../../modules/esnext.object.iterate-keys');\nrequire('../../modules/esnext.object.iterate-values');\n\nmodule.exports = parent;\n","'use strict';\nvar InternalStateModule = require('../internals/internal-state');\nvar createIteratorConstructor = require('../internals/iterator-create-constructor');\nvar createIterResultObject = require('../internals/create-iter-result-object');\nvar hasOwn = require('../internals/has-own-property');\nvar objectKeys = require('../internals/object-keys');\nvar toObject = require('../internals/to-object');\n\nvar OBJECT_ITERATOR = 'Object Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(OBJECT_ITERATOR);\n\nmodule.exports = createIteratorConstructor(function ObjectIterator(source, mode) {\n  var object = toObject(source);\n  setInternalState(this, {\n    type: OBJECT_ITERATOR,\n    mode: mode,\n    object: object,\n    keys: objectKeys(object),\n    index: 0\n  });\n}, 'Object', function next() {\n  var state = getInternalState(this);\n  var keys = state.keys;\n  while (true) {\n    if (keys === null || state.index >= keys.length) {\n      state.object = state.keys = null;\n      return createIterResultObject(undefined, true);\n    }\n    var key = keys[state.index++];\n    var object = state.object;\n    if (!hasOwn(object, key)) continue;\n    switch (state.mode) {\n      case 'keys': return createIterResultObject(key, false);\n      case 'values': return createIterResultObject(object[key], false);\n    } /* entries */ return createIterResultObject([key, object[key]], false);\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\n// Forced replacement object prototype accessors methods\nmodule.exports = IS_PURE || !fails(function () {\n  // This feature detection crashes old WebKit\n  // https://github.com/zloirock/core-js/issues/232\n  if (WEBKIT && WEBKIT < 535) return;\n  var key = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call, es/no-legacy-object-prototype-accessor-methods -- required for testing\n  __defineSetter__.call(null, key, function () { /* empty */ });\n  delete global[key];\n});\n","var call = require('../internals/function-call');\nvar getBuiltIn = require('../internals/get-built-in');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar defineBuiltIn = require('../internals/define-built-in');\n\nmodule.exports = function () {\n  var Symbol = getBuiltIn('Symbol');\n  var SymbolPrototype = Symbol && Symbol.prototype;\n  var valueOf = SymbolPrototype && SymbolPrototype.valueOf;\n  var TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n  if (SymbolPrototype && !SymbolPrototype[TO_PRIMITIVE]) {\n    // `Symbol.prototype[@@toPrimitive]` method\n    // https://tc39.es/ecma262/#sec-symbol.prototype-@@toprimitive\n    // eslint-disable-next-line no-unused-vars -- required for .length\n    defineBuiltIn(SymbolPrototype, TO_PRIMITIVE, function (hint) {\n      return call(valueOf, this);\n    }, { arity: 1 });\n  }\n};\n","var NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\n\n/* eslint-disable es/no-symbol -- safe */\nmodule.exports = NATIVE_SYMBOL && !!Symbol['for'] && !!Symbol.keyFor;\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\n\nvar $stringify = getBuiltIn('JSON', 'stringify');\nvar exec = uncurryThis(/./.exec);\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar replace = uncurryThis(''.replace);\nvar numberToString = uncurryThis(1.0.toString);\n\nvar tester = /[\\uD800-\\uDFFF]/g;\nvar low = /^[\\uD800-\\uDBFF]$/;\nvar hi = /^[\\uDC00-\\uDFFF]$/;\n\nvar WRONG_SYMBOLS_CONVERSION = !NATIVE_SYMBOL || fails(function () {\n  var symbol = getBuiltIn('Symbol')();\n  // MS Edge converts symbol values to JSON as {}\n  return $stringify([symbol]) != '[null]'\n    // WebKit converts symbol values to JSON as null\n    || $stringify({ a: symbol }) != '{}'\n    // V8 throws on boxed symbols\n    || $stringify(Object(symbol)) != '{}';\n});\n\n// https://github.com/tc39/proposal-well-formed-stringify\nvar ILL_FORMED_UNICODE = fails(function () {\n  return $stringify('\\uDF06\\uD834') !== '\"\\\\udf06\\\\ud834\"'\n    || $stringify('\\uDEAD') !== '\"\\\\udead\"';\n});\n\nvar stringifyWithSymbolsFix = function (it, replacer) {\n  var args = arraySlice(arguments);\n  var $replacer = replacer;\n  if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n  if (!isArray(replacer)) replacer = function (key, value) {\n    if (isCallable($replacer)) value = call($replacer, this, key, value);\n    if (!isSymbol(value)) return value;\n  };\n  args[1] = replacer;\n  return apply($stringify, null, args);\n};\n\nvar fixIllFormed = function (match, offset, string) {\n  var prev = charAt(string, offset - 1);\n  var next = charAt(string, offset + 1);\n  if ((exec(low, match) && !exec(hi, next)) || (exec(hi, match) && !exec(low, prev))) {\n    return '\\\\u' + numberToString(charCodeAt(match, 0), 16);\n  } return match;\n};\n\nif ($stringify) {\n  // `JSON.stringify` method\n  // https://tc39.es/ecma262/#sec-json.stringify\n  $({ target: 'JSON', stat: true, arity: 3, forced: WRONG_SYMBOLS_CONVERSION || ILL_FORMED_UNICODE }, {\n    // eslint-disable-next-line no-unused-vars -- required for `.length`\n    stringify: function stringify(it, replacer, space) {\n      var args = arraySlice(arguments);\n      var result = apply(WRONG_SYMBOLS_CONVERSION ? stringifyWithSymbolsFix : $stringify, null, args);\n      return ILL_FORMED_UNICODE && typeof result == 'string' ? replace(result, tester, fixIllFormed) : result;\n    }\n  });\n}\n","var global = require('../internals/global');\nvar setToStringTag = require('../internals/set-to-string-tag');\n\n// JSON[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-json-@@tostringtag\nsetToStringTag(global.JSON, 'JSON', true);\n","var setToStringTag = require('../internals/set-to-string-tag');\n\n// Math[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-math-@@tostringtag\nsetToStringTag(Math, 'Math', true);\n","// TODO: Remove from `core-js@4`\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar create = require('../internals/object-create');\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\n$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {\n  create: create\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineGetter__: function __defineGetter__(P, getter) {\n      definePropertyModule.f(toObject(this), P, { get: aCallable(getter), enumerable: true, configurable: true });\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar defineProperties = require('../internals/object-define-properties').f;\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\n$({ target: 'Object', stat: true, forced: Object.defineProperties !== defineProperties, sham: !DESCRIPTORS }, {\n  defineProperties: defineProperties\n});\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\n// eslint-disable-next-line es/no-object-defineproperty -- safe\n$({ target: 'Object', stat: true, forced: Object.defineProperty !== defineProperty, sham: !DESCRIPTORS }, {\n  defineProperty: defineProperty\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineSetter__: function __defineSetter__(P, setter) {\n      definePropertyModule.f(toObject(this), P, { set: aCallable(setter), enumerable: true, configurable: true });\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\n\n// eslint-disable-next-line es/no-object-freeze -- safe\nvar $freeze = Object.freeze;\nvar FAILS_ON_PRIMITIVES = fails(function () { $freeze(1); });\n\n// `Object.freeze` method\n// https://tc39.es/ecma262/#sec-object.freeze\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  freeze: function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names-external').f;\n\n// eslint-disable-next-line es/no-object-getownpropertynames -- required for testing\nvar FAILS_ON_PRIMITIVES = fails(function () { return !Object.getOwnPropertyNames(1); });\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  getOwnPropertyNames: getOwnPropertyNames\n});\n","var $ = require('../internals/export');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\nvar fails = require('../internals/fails');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar toObject = require('../internals/to-object');\n\n// V8 ~ Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\nvar FORCED = !NATIVE_SYMBOL || fails(function () { getOwnPropertySymbolsModule.f(1); });\n\n// `Object.getOwnPropertySymbols` method\n// https://tc39.es/ecma262/#sec-object.getownpropertysymbols\n$({ target: 'Object', stat: true, forced: FORCED }, {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    var $getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n    return $getOwnPropertySymbols ? $getOwnPropertySymbols(toObject(it)) : [];\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar hasOwn = require('../internals/has-own-property');\n\n// `Object.hasOwn` method\n// https://github.com/tc39/proposal-accessible-object-hasownproperty\n$({ target: 'Object', stat: true }, {\n  hasOwn: hasOwn\n});\n","var $ = require('../internals/export');\nvar $isExtensible = require('../internals/object-is-extensible');\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\n// eslint-disable-next-line es/no-object-isextensible -- safe\n$({ target: 'Object', stat: true, forced: Object.isExtensible !== $isExtensible }, {\n  isExtensible: $isExtensible\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isfrozen -- safe\nvar $isFrozen = Object.isFrozen;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isFrozen(1); });\n\n// `Object.isFrozen` method\n// https://tc39.es/ecma262/#sec-object.isfrozen\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isFrozen: function isFrozen(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isFrozen ? $isFrozen(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-issealed -- safe\nvar $isSealed = Object.isSealed;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isSealed(1); });\n\n// `Object.isSealed` method\n// https://tc39.es/ecma262/#sec-object.issealed\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE }, {\n  isSealed: function isSealed(it) {\n    if (!isObject(it)) return true;\n    if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return true;\n    return $isSealed ? $isSealed(it) : false;\n  }\n});\n","var $ = require('../internals/export');\nvar is = require('../internals/same-value');\n\n// `Object.is` method\n// https://tc39.es/ecma262/#sec-object.is\n$({ target: 'Object', stat: true }, {\n  is: is\n});\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupGetter__: function __lookupGetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.get;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupSetter__: function __lookupSetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.set;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-preventextensions -- safe\nvar $preventExtensions = Object.preventExtensions;\nvar FAILS_ON_PRIMITIVES = fails(function () { $preventExtensions(1); });\n\n// `Object.preventExtensions` method\n// https://tc39.es/ecma262/#sec-object.preventextensions\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  preventExtensions: function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(onFreeze(it)) : it;\n  }\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// eslint-disable-next-line es/no-object-getprototypeof -- safe\nvar getPrototypeOf = Object.getPrototypeOf;\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nvar setPrototypeOf = Object.setPrototypeOf;\nvar ObjectPrototype = Object.prototype;\nvar PROTO = '__proto__';\n\n// `Object.prototype.__proto__` accessor\n// https://tc39.es/ecma262/#sec-object.prototype.__proto__\nif (DESCRIPTORS && getPrototypeOf && setPrototypeOf && !(PROTO in ObjectPrototype)) try {\n  defineBuiltInAccessor(ObjectPrototype, PROTO, {\n    configurable: true,\n    get: function __proto__() {\n      return getPrototypeOf(toObject(this));\n    },\n    set: function __proto__(proto) {\n      var O = requireObjectCoercible(this);\n      if (!isObject(proto) && proto !== null || !isObject(O)) return;\n      setPrototypeOf(O, proto);\n    }\n  });\n} catch (error) { /* empty */ }\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar onFreeze = require('../internals/internal-metadata').onFreeze;\nvar FREEZING = require('../internals/freezing');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-seal -- safe\nvar $seal = Object.seal;\nvar FAILS_ON_PRIMITIVES = fails(function () { $seal(1); });\n\n// `Object.seal` method\n// https://tc39.es/ecma262/#sec-object.seal\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !FREEZING }, {\n  seal: function seal(it) {\n    return $seal && isObject(it) ? $seal(onFreeze(it)) : it;\n  }\n});\n","var $ = require('../internals/export');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n$({ target: 'Object', stat: true }, {\n  setPrototypeOf: setPrototypeOf\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\nvar fails = require('../internals/fails');\nvar hasOwn = require('../internals/has-own-property');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar $toString = require('../internals/to-string');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar nativeObjectCreate = require('../internals/object-create');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternal = require('../internals/object-get-own-property-names-external');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar defineBuiltIn = require('../internals/define-built-in');\nvar shared = require('../internals/shared');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar uid = require('../internals/uid');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineWellKnownSymbol = require('../internals/well-known-symbol-define');\nvar defineSymbolToPrimitive = require('../internals/symbol-define-to-primitive');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\nvar $forEach = require('../internals/array-iteration').forEach;\n\nvar HIDDEN = sharedKey('hidden');\nvar SYMBOL = 'Symbol';\nvar PROTOTYPE = 'prototype';\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SYMBOL);\n\nvar ObjectPrototype = Object[PROTOTYPE];\nvar $Symbol = global.Symbol;\nvar SymbolPrototype = $Symbol && $Symbol[PROTOTYPE];\nvar TypeError = global.TypeError;\nvar QObject = global.QObject;\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyNames = getOwnPropertyNamesExternal.f;\nvar nativePropertyIsEnumerable = propertyIsEnumerableModule.f;\nvar push = uncurryThis([].push);\n\nvar AllSymbols = shared('symbols');\nvar ObjectPrototypeSymbols = shared('op-symbols');\nvar WellKnownSymbolsStore = shared('wks');\n\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar USE_SETTER = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDescriptor = DESCRIPTORS && fails(function () {\n  return nativeObjectCreate(nativeDefineProperty({}, 'a', {\n    get: function () { return nativeDefineProperty(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (O, P, Attributes) {\n  var ObjectPrototypeDescriptor = nativeGetOwnPropertyDescriptor(ObjectPrototype, P);\n  if (ObjectPrototypeDescriptor) delete ObjectPrototype[P];\n  nativeDefineProperty(O, P, Attributes);\n  if (ObjectPrototypeDescriptor && O !== ObjectPrototype) {\n    nativeDefineProperty(ObjectPrototype, P, ObjectPrototypeDescriptor);\n  }\n} : nativeDefineProperty;\n\nvar wrap = function (tag, description) {\n  var symbol = AllSymbols[tag] = nativeObjectCreate(SymbolPrototype);\n  setInternalState(symbol, {\n    type: SYMBOL,\n    tag: tag,\n    description: description\n  });\n  if (!DESCRIPTORS) symbol.description = description;\n  return symbol;\n};\n\nvar $defineProperty = function defineProperty(O, P, Attributes) {\n  if (O === ObjectPrototype) $defineProperty(ObjectPrototypeSymbols, P, Attributes);\n  anObject(O);\n  var key = toPropertyKey(P);\n  anObject(Attributes);\n  if (hasOwn(AllSymbols, key)) {\n    if (!Attributes.enumerable) {\n      if (!hasOwn(O, HIDDEN)) nativeDefineProperty(O, HIDDEN, createPropertyDescriptor(1, {}));\n      O[HIDDEN][key] = true;\n    } else {\n      if (hasOwn(O, HIDDEN) && O[HIDDEN][key]) O[HIDDEN][key] = false;\n      Attributes = nativeObjectCreate(Attributes, { enumerable: createPropertyDescriptor(0, false) });\n    } return setSymbolDescriptor(O, key, Attributes);\n  } return nativeDefineProperty(O, key, Attributes);\n};\n\nvar $defineProperties = function defineProperties(O, Properties) {\n  anObject(O);\n  var properties = toIndexedObject(Properties);\n  var keys = objectKeys(properties).concat($getOwnPropertySymbols(properties));\n  $forEach(keys, function (key) {\n    if (!DESCRIPTORS || call($propertyIsEnumerable, properties, key)) $defineProperty(O, key, properties[key]);\n  });\n  return O;\n};\n\nvar $create = function create(O, Properties) {\n  return Properties === undefined ? nativeObjectCreate(O) : $defineProperties(nativeObjectCreate(O), Properties);\n};\n\nvar $propertyIsEnumerable = function propertyIsEnumerable(V) {\n  var P = toPropertyKey(V);\n  var enumerable = call(nativePropertyIsEnumerable, this, P);\n  if (this === ObjectPrototype && hasOwn(AllSymbols, P) && !hasOwn(ObjectPrototypeSymbols, P)) return false;\n  return enumerable || !hasOwn(this, P) || !hasOwn(AllSymbols, P) || hasOwn(this, HIDDEN) && this[HIDDEN][P]\n    ? enumerable : true;\n};\n\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(O, P) {\n  var it = toIndexedObject(O);\n  var key = toPropertyKey(P);\n  if (it === ObjectPrototype && hasOwn(AllSymbols, key) && !hasOwn(ObjectPrototypeSymbols, key)) return;\n  var descriptor = nativeGetOwnPropertyDescriptor(it, key);\n  if (descriptor && hasOwn(AllSymbols, key) && !(hasOwn(it, HIDDEN) && it[HIDDEN][key])) {\n    descriptor.enumerable = true;\n  }\n  return descriptor;\n};\n\nvar $getOwnPropertyNames = function getOwnPropertyNames(O) {\n  var names = nativeGetOwnPropertyNames(toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (!hasOwn(AllSymbols, key) && !hasOwn(hiddenKeys, key)) push(result, key);\n  });\n  return result;\n};\n\nvar $getOwnPropertySymbols = function (O) {\n  var IS_OBJECT_PROTOTYPE = O === ObjectPrototype;\n  var names = nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE ? ObjectPrototypeSymbols : toIndexedObject(O));\n  var result = [];\n  $forEach(names, function (key) {\n    if (hasOwn(AllSymbols, key) && (!IS_OBJECT_PROTOTYPE || hasOwn(ObjectPrototype, key))) {\n      push(result, AllSymbols[key]);\n    }\n  });\n  return result;\n};\n\n// `Symbol` constructor\n// https://tc39.es/ecma262/#sec-symbol-constructor\nif (!NATIVE_SYMBOL) {\n  $Symbol = function Symbol() {\n    if (isPrototypeOf(SymbolPrototype, this)) throw TypeError('Symbol is not a constructor');\n    var description = !arguments.length || arguments[0] === undefined ? undefined : $toString(arguments[0]);\n    var tag = uid(description);\n    var setter = function (value) {\n      if (this === ObjectPrototype) call(setter, ObjectPrototypeSymbols, value);\n      if (hasOwn(this, HIDDEN) && hasOwn(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDescriptor(this, tag, createPropertyDescriptor(1, value));\n    };\n    if (DESCRIPTORS && USE_SETTER) setSymbolDescriptor(ObjectPrototype, tag, { configurable: true, set: setter });\n    return wrap(tag, description);\n  };\n\n  SymbolPrototype = $Symbol[PROTOTYPE];\n\n  defineBuiltIn(SymbolPrototype, 'toString', function toString() {\n    return getInternalState(this).tag;\n  });\n\n  defineBuiltIn($Symbol, 'withoutSetter', function (description) {\n    return wrap(uid(description), description);\n  });\n\n  propertyIsEnumerableModule.f = $propertyIsEnumerable;\n  definePropertyModule.f = $defineProperty;\n  definePropertiesModule.f = $defineProperties;\n  getOwnPropertyDescriptorModule.f = $getOwnPropertyDescriptor;\n  getOwnPropertyNamesModule.f = getOwnPropertyNamesExternal.f = $getOwnPropertyNames;\n  getOwnPropertySymbolsModule.f = $getOwnPropertySymbols;\n\n  wrappedWellKnownSymbolModule.f = function (name) {\n    return wrap(wellKnownSymbol(name), name);\n  };\n\n  if (DESCRIPTORS) {\n    // https://github.com/tc39/proposal-Symbol-description\n    nativeDefineProperty(SymbolPrototype, 'description', {\n      configurable: true,\n      get: function description() {\n        return getInternalState(this).description;\n      }\n    });\n    if (!IS_PURE) {\n      defineBuiltIn(ObjectPrototype, 'propertyIsEnumerable', $propertyIsEnumerable, { unsafe: true });\n    }\n  }\n}\n\n$({ global: true, constructor: true, wrap: true, forced: !NATIVE_SYMBOL, sham: !NATIVE_SYMBOL }, {\n  Symbol: $Symbol\n});\n\n$forEach(objectKeys(WellKnownSymbolsStore), function (name) {\n  defineWellKnownSymbol(name);\n});\n\n$({ target: SYMBOL, stat: true, forced: !NATIVE_SYMBOL }, {\n  useSetter: function () { USE_SETTER = true; },\n  useSimple: function () { USE_SETTER = false; }\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL, sham: !DESCRIPTORS }, {\n  // `Object.create` method\n  // https://tc39.es/ecma262/#sec-object.create\n  create: $create,\n  // `Object.defineProperty` method\n  // https://tc39.es/ecma262/#sec-object.defineproperty\n  defineProperty: $defineProperty,\n  // `Object.defineProperties` method\n  // https://tc39.es/ecma262/#sec-object.defineproperties\n  defineProperties: $defineProperties,\n  // `Object.getOwnPropertyDescriptor` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertydescriptors\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor\n});\n\n$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Object.getOwnPropertyNames` method\n  // https://tc39.es/ecma262/#sec-object.getownpropertynames\n  getOwnPropertyNames: $getOwnPropertyNames\n});\n\n// `Symbol.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@toprimitive\ndefineSymbolToPrimitive();\n\n// `Symbol.prototype[@@toStringTag]` property\n// https://tc39.es/ecma262/#sec-symbol.prototype-@@tostringtag\nsetToStringTag($Symbol, SYMBOL);\n\nhiddenKeys[HIDDEN] = true;\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar hasOwn = require('../internals/has-own-property');\nvar toString = require('../internals/to-string');\nvar shared = require('../internals/shared');\nvar NATIVE_SYMBOL_REGISTRY = require('../internals/symbol-registry-detection');\n\nvar StringToSymbolRegistry = shared('string-to-symbol-registry');\nvar SymbolToStringRegistry = shared('symbol-to-string-registry');\n\n// `Symbol.for` method\n// https://tc39.es/ecma262/#sec-symbol.for\n$({ target: 'Symbol', stat: true, forced: !NATIVE_SYMBOL_REGISTRY }, {\n  'for': function (key) {\n    var string = toString(key);\n    if (hasOwn(StringToSymbolRegistry, string)) return StringToSymbolRegistry[string];\n    var symbol = getBuiltIn('Symbol')(string);\n    StringToSymbolRegistry[string] = symbol;\n    SymbolToStringRegistry[symbol] = string;\n    return symbol;\n  }\n});\n","// TODO: Remove this module from `core-js@4` since it's split to modules listed below\nrequire('../modules/es.symbol.constructor');\nrequire('../modules/es.symbol.for');\nrequire('../modules/es.symbol.key-for');\nrequire('../modules/es.json.stringify');\nrequire('../modules/es.object.get-own-property-symbols');\n","var $ = require('../internals/export');\nvar hasOwn = require('../internals/has-own-property');\nvar isSymbol = require('../internals/is-symbol');\nvar tryToString = require('../internals/try-to-string');\nvar shared = require('../internals/shared');\nvar NATIVE_SYMBOL_REGISTRY = require('../internals/symbol-registry-detection');\n\nvar SymbolToStringRegistry = shared('symbol-to-string-registry');\n\n// `Symbol.keyFor` method\n// https://tc39.es/ecma262/#sec-symbol.keyfor\n$({ target: 'Symbol', stat: true, forced: !NATIVE_SYMBOL_REGISTRY }, {\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(tryToString(sym) + ' is not a symbol');\n    if (hasOwn(SymbolToStringRegistry, sym)) return SymbolToStringRegistry[sym];\n  }\n});\n","// TODO: Remove from `core-js@4`\nrequire('../modules/es.object.has-own');\n","'use strict';\n// TODO: Remove from `core-js@4`\nvar $ = require('../internals/export');\nvar ObjectIterator = require('../internals/object-iterator');\n\n// `Object.iterateEntries` method\n// https://github.com/tc39/proposal-object-iteration\n$({ target: 'Object', stat: true, forced: true }, {\n  iterateEntries: function iterateEntries(object) {\n    return new ObjectIterator(object, 'entries');\n  }\n});\n","'use strict';\n// TODO: Remove from `core-js@4`\nvar $ = require('../internals/export');\nvar ObjectIterator = require('../internals/object-iterator');\n\n// `Object.iterateKeys` method\n// https://github.com/tc39/proposal-object-iteration\n$({ target: 'Object', stat: true, forced: true }, {\n  iterateKeys: function iterateKeys(object) {\n    return new ObjectIterator(object, 'keys');\n  }\n});\n","'use strict';\n// TODO: Remove from `core-js@4`\nvar $ = require('../internals/export');\nvar ObjectIterator = require('../internals/object-iterator');\n\n// `Object.iterateValues` method\n// https://github.com/tc39/proposal-object-iteration\n$({ target: 'Object', stat: true, forced: true }, {\n  iterateValues: function iterateValues(object) {\n    return new ObjectIterator(object, 'values');\n  }\n});\n","var parent = require('../../es/object');\nrequire('../../modules/web.dom-collections.iterator');\n\nmodule.exports = parent;\n","/**\n * @license React\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var b=Symbol.for(\"react.element\"),c=Symbol.for(\"react.portal\"),d=Symbol.for(\"react.fragment\"),e=Symbol.for(\"react.strict_mode\"),f=Symbol.for(\"react.profiler\"),g=Symbol.for(\"react.provider\"),h=Symbol.for(\"react.context\"),k=Symbol.for(\"react.server_context\"),l=Symbol.for(\"react.forward_ref\"),m=Symbol.for(\"react.suspense\"),n=Symbol.for(\"react.suspense_list\"),p=Symbol.for(\"react.memo\"),q=Symbol.for(\"react.lazy\"),t=Symbol.for(\"react.offscreen\"),u=Symbol.for(\"react.module.reference\");\nfunction v(a){if(\"object\"===typeof a&&null!==a){var r=a.$$typeof;switch(r){case b:switch(a=a.type,a){case d:case f:case e:case m:case n:return a;default:switch(a=a&&a.$$typeof,a){case k:case h:case l:case q:case p:case g:return a;default:return r}}case c:return r}}}exports.ContextConsumer=h;exports.ContextProvider=g;exports.Element=b;exports.ForwardRef=l;exports.Fragment=d;exports.Lazy=q;exports.Memo=p;exports.Portal=c;exports.Profiler=f;exports.StrictMode=e;exports.Suspense=m;\nexports.SuspenseList=n;exports.isAsyncMode=function(){return!1};exports.isConcurrentMode=function(){return!1};exports.isContextConsumer=function(a){return v(a)===h};exports.isContextProvider=function(a){return v(a)===g};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===b};exports.isForwardRef=function(a){return v(a)===l};exports.isFragment=function(a){return v(a)===d};exports.isLazy=function(a){return v(a)===q};exports.isMemo=function(a){return v(a)===p};\nexports.isPortal=function(a){return v(a)===c};exports.isProfiler=function(a){return v(a)===f};exports.isStrictMode=function(a){return v(a)===e};exports.isSuspense=function(a){return v(a)===m};exports.isSuspenseList=function(a){return v(a)===n};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===d||a===f||a===e||a===m||a===n||a===t||\"object\"===typeof a&&null!==a&&(a.$$typeof===q||a.$$typeof===p||a.$$typeof===g||a.$$typeof===h||a.$$typeof===l||a.$$typeof===u||void 0!==a.getModuleId)?!0:!1};exports.typeOf=v;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","'use strict';\n\nvar compose = require('redux').compose;\n\nexports.__esModule = true;\nexports.composeWithDevTools =\n  process.env.NODE_ENV !== 'production' &&\n  typeof window !== 'undefined' &&\n  window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n    ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n    : function () {\n        if (arguments.length === 0) return undefined;\n        if (typeof arguments[0] === 'object') return compose;\n        return compose.apply(null, arguments);\n      };\n\nexports.devToolsEnhancer =\n  process.env.NODE_ENV !== 'production' &&\n  typeof window !== 'undefined' &&\n  window.__REDUX_DEVTOOLS_EXTENSION__\n    ? window.__REDUX_DEVTOOLS_EXTENSION__\n    : function () {\n        return function (noop) {\n          return noop;\n        };\n      };\n","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.logdown=e():t.logdown=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,\"a\",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=0)}([function(t,e,r){var n=r(1)(),o=r(3),i=r(5),s=r(8)();n.prefixColors=[\"#F2777A\",\"#F99157\",\"#FFCC66\",\"#99CC99\",\"#66CCCC\",\"#6699CC\",\"#CC99CC\"],n._setPrefixRegExps=function(){try{s.localStorage&&\"string\"==typeof s.localStorage.getItem(\"debug\")&&(n._prefixRegExps=[],s.localStorage.getItem(\"debug\").split(\",\").forEach(function(t){var e=\"enable\";\"-\"===(t=t.trim())[0]&&(t=t.substr(1),e=\"disable\");var r=n._prepareRegExpForPrefixSearch(t);n._prefixRegExps.push({type:e,regExp:r})}))}catch(t){}},n._getNextPrefixColor=function(){var t=0;return function(){return t+=1,n.prefixColors[t%n.prefixColors.length]}}(),n.prototype._getDecoratedPrefix=function(){var t=[];return i()?(t.push(\"%c\"+this.opts.prefix+\"%c \"),t.push(\"color:\"+this.opts.prefixColor+\"; font-weight:bold;\",\"\")):t.push(\"[\"+this.opts.prefix+\"] \"),t},n.prototype._prepareOutput=function(t){var e,r=this._getDecoratedPrefix();return\"string\"==typeof t[0]?this.opts.markdown&&i()?(e=o.parse(t[0]),r[0]=r[0]+e.text,r=r.concat(e.styles)):r[0]=r[0]+t[0]:r.push(t[0]),t.length>1&&(r=r.concat(t.slice(1))),r},n._setPrefixRegExps(),t.exports=n},function(t,e,r){var n=r(2);t.exports=function(){function t(e,r){return this instanceof t?t._isPrefixAlreadyInUse(e)?t._getInstanceByPrefix(e):(this.opts=t._normalizeOpts(e,r),this.state=t._getInitialState(this.opts),t._decorateLoggerMethods(this),t._instances.push(this),this):new t(e,r)}return t.transports=[],t._instances=[],t._prefixRegExps=[],t._prepareRegExpForPrefixSearch=function(t){return new RegExp(\"^\"+t.replace(/\\*/g,\".*?\")+\"$\")},t._isPrefixAlreadyInUse=function(e){return t._instances.some(function(t){return t.opts.prefix===e})},t._getInstanceByPrefix=function(e){return t._instances.filter(function(t){return t.opts.prefix===e})[0]},t._normalizeOpts=function(e,r){if(\"string\"!=typeof e)throw new TypeError(\"prefix must be a string\");var n=void 0===(r=r||{}).markdown||Boolean(r.markdown),o=r.prefixColor||t._getNextPrefixColor();return{logger:r.logger||console,markdown:n,prefix:e,prefixColor:o}},t._getInitialState=function(e){return{isEnabled:t._getEnableState(e)}},t._getEnableState=function(e){var r=!1;return t._prefixRegExps.forEach(function(t){\"enable\"===t.type&&t.regExp.test(e.prefix)?r=!0:\"disable\"===t.type&&t.regExp.test(e.prefix)&&(r=!1)}),r},t._decorateLoggerMethods=function(e){var r=e.opts.logger,o=Object.keys(r).filter(function(t){return\"function\"==typeof r[t]});0===o.length&&(o=[\"log\",\"warn\",\"error\"]),o.forEach(function(o){e[o]=function(){var e=n(arguments),i=this.opts.prefix;if(t.transports.length){var s=\"[\"+i+\"] \"+e.filter(function(t){return\"object\"!=typeof t}).join(\" \");t.transports.forEach(function(t){t({state:this.state,instance:i,level:o,args:e,msg:s})}.bind(this))}if(this.state.isEnabled){var f=this._prepareOutput(e,o);r[o].apply(r,f)}}})},t}},function(t,e){t.exports=function(t){return Array.prototype.slice.call(t,0)}},function(t,e,r){function n(t){return function(e){return o.push(t),o.push(\"\"),\"%c\"+e+\"%c\"}}var o=[],i=new(r(4))({renderer:{\"*\":n(\"font-weight:bold;\"),_:n(\"font-style:italic;\"),\"`\":n(\"background-color:rgba(255,204,102, 0.1);color:#FFCC66;padding:2px 5px;border-radius:2px;\")}});t.exports={parse:function(t){var e={text:i.parse(t),styles:[].concat(o)};return o.length=0,e}}},function(t,e){function r(t){this.renderer=t.renderer}function n(t){return i.test(t)}var o=/([_*`\\\\]|[^_*`\\\\]+)/g,i=/[_*`]/;r.prototype.parse=function(t){function e(t){for(var e=\"\";r&&r.tag!==t;)e=r.tag+r.text+e,u[r.tag]=!1,r=c.pop();return e}for(var r,i,s,f=t.match(o),p=this.renderer,a=\"\",c=[],u={},l=0;s=f[l];){if(i=\"\",l++,n(s))if(u[s])i=e(s),i=p[r.tag](r.text+i),u[s]=!1,r=c.pop();else{var x=\"\";if(\"`\"===s){var g=f.indexOf(s,l);-1!==g&&(a+=e(),x=f.slice(l,g).join(\"\"),l=g)}r&&c.push(r),u[s]=!0,r={tag:s,text:x}}else if(i=s,\"\\\\\"===s){var h=f[l];(n(h)||\"\\\\\"===h)&&(i=h,l++)}i&&(r?r.text+=i:a+=i,i=\"\")}return a+=e()},t.exports=r},function(t,e,r){var n=r(6),o=r(7);t.exports=function(){return n()||o()}},function(t,e){t.exports=function(){try{return\"WebkitAppearance\"in document.documentElement.style&&!/Edge/.test(navigator.userAgent)}catch(t){return!1}}},function(t,e){t.exports=function(){try{return/firefox\\/(\\d+)/i.test(navigator.userAgent)}catch(t){return!1}}},function(t,e,r){(function(e){function r(t,e){return\"object\"==typeof t&&t.self===t&&t||\"object\"==typeof e&&e.global===e&&e||this}t.exports=r.bind(this,self,e),t.exports.getGlobal=r}).call(e,r(9))},function(t,e){var r;r=function(){return this}();try{r=r||Function(\"return this\")()||(0,eval)(\"this\")}catch(t){\"object\"==typeof window&&(r=window)}t.exports=r}])});\n","const logdown = require('logdown')\n\nconst reduxLogdown = (name, opts = {}) => {\n  const logger = opts.logger || logdown(name)\n  const prevLogger = opts.logger || logdown('prev state', { prefixColor: '#999999' })\n  const actionLogger = opts.logger || logdown('action', { prefixColor: '#FFCC66' })\n  const nextLogger = opts.logger || logdown('next state', { prefixColor: '#6699CC' })\n  prevLogger.state = actionLogger.state = nextLogger.state = logger.state\n  let prevState\n  let recursionLevel = -1\n  let accumulator = []\n\n  return store => next => action => {\n    ++recursionLevel\n    accumulator[recursionLevel] = []\n\n    if (!logger.state.isEnabled) {\n      return next(action)\n    }\n\n    prevState = store.getState()\n\n    if (opts.diff && typeof logger.groupCollapsed === 'function') {\n      accumulator[recursionLevel].push(() => logger.groupCollapsed('*action* `' + action.type + '`'))\n    } else {\n      accumulator[recursionLevel].push(() => logger.log('*action* `' + action.type + '`'))\n    }\n\n    if (opts.diff && typeof logger.groupCollapsed === 'function') {\n      accumulator[recursionLevel].push(() => prevLogger.log(prevState))\n      accumulator[recursionLevel].push(() => actionLogger.log(action))\n    }\n\n    let result = next(action)\n\n    if (opts.diff && typeof logger.groupCollapsed === 'function') {\n      accumulator[recursionLevel].push(() => nextLogger.log(store.getState()))\n      accumulator[recursionLevel].push(() => logger.groupEnd('*action* `' + action.type + '`'))\n    }\n\n    if (recursionLevel === 0) {\n      for (let i = 0; i < accumulator.length; ++i) {\n        accumulator[i].forEach(thunk => thunk())\n      }\n      accumulator = []\n    }\n\n    --recursionLevel\n\n    return result\n  }\n}\n\nmodule.exports = reduxLogdown\n","import _objectSpread from '@babel/runtime/helpers/esm/objectSpread2';\n\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n}\n\n// Inlined version of the `symbol-observable` polyfill\nvar $$observable = (function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n})();\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n// Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\n\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\n\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\n\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\n\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n\n  return typeOfVal;\n}\n\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Creates a Redux store that holds the state tree.\n *\n * **We recommend using `configureStore` from the\n * `@reduxjs/toolkit` package**, which replaces `createStore`:\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nvar legacy_createStore = createStore;\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + kindOf(inputState) + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(12) : \"The slice reducer for key \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(13) : \"The slice reducer for key \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle '\" + ActionTypes.INIT + \"' or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning(\"No reducer provided for key \\\"\" + key + \"\\\"\");\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers); // This is used to make sure we don't warn about the same\n  // keys multiple times.\n\n  var unexpectedKeyCache;\n\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var actionType = action && action.type;\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(14) : \"When called with an action of type \" + (actionType ? \"\\\"\" + String(actionType) + \"\\\"\" : '(unknown type)') + \", the slice reducer for key \\\"\" + _key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\");\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    hasChanged = hasChanged || finalReducerKeys.length !== Object.keys(state).length;\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass an action creator as the first argument,\n * and get a dispatch wrapped function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(16) : \"bindActionCreators expected an object or a function, but instead received: '\" + kindOf(actionCreators) + \"'. \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var boundActionCreators = {};\n\n  for (var key in actionCreators) {\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(15) : 'Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.');\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread(_objectSpread({}, store), {}, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { ActionTypes as __DO_NOT_USE__ActionTypes, applyMiddleware, bindActionCreators, combineReducers, compose, createStore, legacy_createStore };\n","module.exports = \"<svg width=\\\"16\\\" height=\\\"14\\\" viewBox=\\\"0 0 16 14\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M10.9 13.4c2.8 0 5.1-2.3 5.1-5.2V.4h-1.9v7.8a3.2 3.2 0 0 1-3.2 3.3 3.2 3.2 0 0 1-2-.7l.1.8a5.2 5.2 0 0 0 1.3-3.4v-6A2.3 2.3 0 0 0 8 0a2.3 2.3 0 0 0-2.3 2.3v6A5 5 0 0 0 7 11.5v-.8a3.4 3.4 0 0 1-1.9.7A3.3 3.3 0 0 1 2 8.2V.4H0v7.8c0 2.9 2.3 5.2 5.2 5.2a5.2 5.2 0 0 0 3.1-1.1h-.6a5 5 0 0 0 3.2 1zM8.4 2.3v6c0 .7-.3 1.4-.8 2h.8a3.2 3.2 0 0 1-.8-2v-6c0-.2.2-.4.4-.4s.4.2.4.4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M12 2V0h2v2h2v2h-2v2h-2V4h-2V2h2zm-2.57 8.57A2.57 2.57 0 0 1 12 13.14v1.1a12.8 12.8 0 0 1-12 0v-1.1a2.57 2.57 0 0 1 2.57-2.57h.34a5.97 5.97 0 0 0 6.18 0h.34zM6 8.86A3.43 3.43 0 1 1 6 2a3.43 3.43 0 0 1 0 6.86z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"12\\\" viewBox=\\\"0 0 16 12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path stroke-dasharray=\\\"20.65\\\" stroke=\\\"#000\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" d=\\\"M.7 5.5l5 4.9L15.3.7\\\"><animate attributeName=\\\"stroke-dashoffset\\\" from=\\\"20.65\\\" to=\\\"0\\\" dur=\\\"500ms\\\" repeatCount=\\\"1\\\"></animate></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M1 7h14v7a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7zm6 2a1 1 0 1 0 0 2h2a1 1 0 0 0 0-2H7zM2.5 0h11c.8 0 1.2 0 1.5.3.3.1.6.4.7.7.2.3.3.7.3 1.5V4c0 .6-.4 1-1 1H1a1 1 0 0 1-1-1V2.5C0 1.7 0 1.3.3 1 .4.7.7.4 1 .3c.3-.2.7-.3 1.5-.3z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"53\\\" viewBox=\\\"0 0 16 53\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M13.9 43l1.4 1.4-7.6 7.7L0 44.4 1.4 43l5.3 5.2V0h2v48.2z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path d=\\\"M4.83 9l5.24 5.24-1.41 1.41L1 8 8.66.34l1.41 1.41L4.83 7H15v2z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M12.572 9l-7.657 7.656L3.5 15.242 9.743 9 3.5 2.757l1.415-1.414z\\\" fill=\\\"#FFF\\\" fill-rule=\\\"evenodd\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path d=\\\"M1.63 7.7l4.74-4.78a3.33 3.33 0 0 1 4.73 0 3.4 3.4 0 0 1 0 4.78L9.75 9.07l-4.4 4.43a1.9 1.9 0 0 1-2.7 0 1.94 1.94 0 0 1 0-2.73L4 9.41l4.4-4.45a.47.47 0 0 1 .68 0c.18.2.19.5 0 .69l-4.75 4.79a.97.97 0 0 0 0 1.36c.38.38.98.38 1.36 0l4.74-4.79c.94-.94.93-2.46 0-3.4a2.37 2.37 0 0 0-3.38-.01l-4.4 4.44-1.36 1.37a3.89 3.89 0 0 0 0 5.46 3.8 3.8 0 0 0 5.42 0l4.4-4.44 1.35-1.37a5.34 5.34 0 0 0 0-7.5 5.23 5.23 0 0 0-7.44 0L.28 6.32a.97.97 0 0 0 0 1.37c.37.38.98.38 1.35 0z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"16\\\" viewBox=\\\"0 0 12 16\\\"><path d=\\\"M10.5 12l1.4 1.4a8 8 0 0 1-11.9 0L1.4 12a6 6 0 0 0 9.1 0zM6 12a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4 4 4 0 0 1 4 4v4a4 4 0 0 1-4 4z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M0 1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V1zm5 13h6v2H5v-2zm-3-4v1h3v-1H2zm0-2v1h3V8H2zm0-2v1h3V6H2zm0-2v1h3V4H2zm4.5 6v1h3v-1h-3zm0-2v1h3V8h-3zm4.5 2v1h3v-1h-3zm0-2v1h3V8h-3zm0-2v1h3V6h-3z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"10\\\" height=\\\"10\\\" viewBox=\\\"0 0 10 10\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"5\\\" cy=\\\"5\\\" r=\\\"5\\\" stroke=\\\"none\\\"></circle></svg>\"","module.exports = \"<svg width=\\\"10\\\" height=\\\"10\\\" viewBox=\\\"0 0 10 10\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"5\\\" cy=\\\"5\\\" r=\\\"4\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\"></circle></svg>\"","module.exports = \"<svg width=\\\"10\\\" height=\\\"10\\\" viewBox=\\\"0 0 10 10\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M5 10A5 5 0 1 1 5 0a5 5 0 0 1 0 10zM3 4a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2H3z\\\" stroke=\\\"none\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm4.9-11.48l-.2.19-8.18 8.18a6 6 0 0 0 8.37-8.37zm-1.42-1.41a6 6 0 0 0-8.37 8.37l8.18-8.19.19-.18z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" height=\\\"16\\\"><path d=\\\"M2.564 2h4.872c.892 0 1.215.093 1.54.267.327.174.583.43.757.756.174.326.267.65.267 1.54v6.873c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 01-.756.757c-.326.174-.65.267-1.54.267H2.563c-.892 0-1.215-.093-1.54-.267a1.81 1.81 0 01-.757-.756C.093 12.65 0 12.327 0 11.437V4.563c0-.892.093-1.215.267-1.54a1.81 1.81 0 01.756-.757C1.35 2.093 1.673 2 2.563 2zm8.729 5.296l3.001-2.992A1 1 0 0116 5.012v5.984a1 1 0 01-1.706.708l-3.001-2.991a1.001 1.001 0 01-.002-1.415l.002-.002z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" height=\\\"16\\\"><g fill=\\\"#000\\\" fill-rule=\\\"evenodd\\\"><path d=\\\"M.061 3.62l9.552 9.552a1.808 1.808 0 01-.636.56c-.301.162-.6.253-1.345.266L2.564 14c-.892 0-1.215-.093-1.54-.267a1.81 1.81 0 01-.757-.756c-.16-.301-.252-.6-.265-1.345L0 4.564c0-.422.02-.716.061-.944zm15.647.686c.187.188.292.442.292.706v5.984a1 1 0 01-1.706.708l-3.001-2.991a1 1 0 01-.085-1.32l.085-.097 3.001-2.992a1 1 0 011.414.002zM10 11.44L.9 2.34l.123-.072c.31-.166.618-.258 1.415-.266L10 9.56v1.878zM7.436 2c.892 0 1.215.093 1.54.267.327.174.583.43.757.756.16.301.252.6.265 1.345L10 7.439 4.56 2h2.876z\\\"></path><path fill-rule=\\\"nonzero\\\" d=\\\"M1.03.47l13.5 13.5-1.06 1.06-13.5-13.5z\\\"></path></g></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"12\\\" viewBox=\\\"0 0 16 12\\\"><path d=\\\"M5.7 11.9L16 1.4 14.6 0 5.7 9 1.4 4.8 0 6.2z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"7\\\" height=\\\"4\\\" viewBox=\\\"0 0 7 4\\\"><path d=\\\"M3.65 3.65L6.44.85A.5.5 0 0 0 6.09 0H.5a.5.5 0 0 0-.35.85l2.79 2.8c.2.2.51.2.7 0z\\\"></path></svg>\"","module.exports = \"<svg fill=\\\"none\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path clip-rule=\\\"evenodd\\\" d=\\\"m12.5355 8.03553-7.65681-7.656855-1.41421 1.414215 6.24264 6.24264-6.24264 6.24267 1.41421 1.4142z\\\" fill=\\\"#000\\\" fill-rule=\\\"evenodd\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"14\\\" viewBox=\\\"0 0 14 14\\\"><path d=\\\"M1.41 13.31l5.25-5.24 5.24 5.24 1.41-1.41-5.24-5.24 5.24-5.25L11.9 0 6.66 5.24 1.41 0 0 1.41l5.24 5.25L0 11.9z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M14.93 4.59L4.87 4.57c-1.49 0-1.98 1.67-1.98 2.41L2 14.22c.56 0 .95-.38 1-.8.43-3.1.43-3.33.7-5.53.1-.75.54-1.29 1.3-1.29h9.69c.76 0 1.4.44 1.3 1.29-.32 2.14-.52 3.49-.73 5.07-.21 1.58-1.1 2.48-2.48 2.48H1.88A1.84 1.84 0 010 13.56V1.82C0 1.09.54.55 1.28.55h3.16c.69 0 1.05.02 1.43.59l.43.64c.4.57 1.1.75 1.81.75h5.58c.8 0 1.43.54 1.33 1.32l-.09.74z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M14.97 9.08H1.03a1.03 1.03 0 110-2.06h13.94a1.03 1.03 0 110 2.06zM14.97 4.96H1.03a1.03 1.03 0 110-2.06h13.94a1.03 1.03 0 110 2.06zM9.82 13.3H1.03a1.03 1.03 0 110-2.06h8.79a1.03 1.03 0 110 2.06z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M6 10h8V2H6v8zM5 0h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1zM2 4v10h10v1a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h1z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path d=\\\"M5 2a2 2 0 1 1 4 0h4a1 1 0 0 1 1 1v1H0V3a1 1 0 0 1 1-1h4zM1 6h12l-.8 8c-.11 1.1-1.09 2-2.2 2H4c-1.1 0-2.09-.89-2.2-2L1 6zm5.5 2v5.54h1V8h-1z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M1.3 0h13.4l.8.1.4.4.1.8v10.4l-.1.8-.4.4-.8.1H1.3l-.8-.1a1 1 0 0 1-.4-.4l-.1-.8V1.3L.1.5.5.1l.8-.1zM2 2v9h12V2H2zm3 12h6v2H5v-2z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M11 4h2.4c1 0 1.2.1 1.6.3.3.1.6.4.7.7.2.3.3.7.3 1.6v6.8c0 1-.1 1.2-.3 1.6-.1.3-.4.6-.7.7-.3.2-.7.3-1.6.3H2.6c-1 0-1.2-.1-1.6-.3a1.8 1.8 0 0 1-.7-.7c-.2-.3-.3-.7-.3-1.6V2.6C0 1.6.1 1.4.3 1 .4.7.7.4 1 .3c.4-.2.7-.3 1.6-.3h5.8c1 0 1.2.1 1.6.3.3.1.6.4.7.7.2.4.3.7.3 1.6V4zM9 4V3a1 1 0 0 0-1-1h-.5a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5.5.5 0 0 0-.5-.5H3a1 1 0 0 0-1 1v9.7l.1.8.4.4.8.1H7a8.2 8.2 0 0 1 0-.6V6.6c0-1 .1-1.3.3-1.6.1-.3.4-.6.7-.7.3-.2.5-.3 1-.3zm1.3 2l-.8.1a.9.9 0 0 0-.4.4l-.1.8v5.4l.1.8.4.4.8.1h2.4l.8-.1a.9.9 0 0 0 .4-.4l.1-.8V7.3l-.1-.8a.9.9 0 0 0-.4-.4l-.8-.1h-2.4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"5\\\" height=\\\"8\\\" viewBox=\\\"0 0 5 8\\\"><path d=\\\"M0 .92L.94 0 5 4 .94 8 0 7.08 3.13 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M14.55 4.85l.75-.75A2.4 2.4 0 0 0 11.9.7l-.75.75 3.4 3.4zm-.7.7l-9.6 9.6L0 16l.85-4.25 9.6-9.6 3.4 3.4zM4 13.6L2 14l.4-2L4 13.6z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"4\\\" viewBox=\\\"0 0 16 4\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M2 4a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm12 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4zM8 4a2 2 0 1 0 0-4 2 2 0 0 0 0 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M14.9 11.7h-4.5l5.1-5.1c.8-.8.8-2 0-2.8L12.4.7A2 2 0 0 0 11 .1a2 2 0 0 0-1.4.6L2.9 7.4a3 3 0 0 0-.1 4.1l1.6 1.7h10.4c.4 0 .7-.3.7-.7.1-.5-.2-.8-.6-.8zM4 8.5l1.7-1.7 3.7 3.7-1.1 1.2H5.1L4 10.4c-.6-.5-.5-1.4 0-1.9zM2.3 12.4c0-.4-.3-.7-.7-.7H.7c-.4 0-.7.3-.7.7 0 .4.3.7.7.7h.8c.5.1.8-.3.8-.7zM2.8 14.1l-.6.6c-.3.3-.3.8 0 1 .1.2.3.2.5.2l.5-.2.6-.6c.3-.3.3-.8 0-1-.2-.3-.7-.3-1 0z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14ZM9 4V9H7V4H9ZM9 12V10H7V12H9Z\\\" fill=\\\"#C20013\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M2 2h12c1.1 0 2 .77 2 1.71v8.58c0 .94-.9 1.71-2 1.71H2c-1.1 0-2-.77-2-1.71V3.7C0 2.77.9 2 2 2zm3.38 4v1H3.25v1h2v.92h-2v1h2.13v1.01H2V6h3.38zm1.65 0l.9 1.67h.04L8.87 6h1.4L8.69 8.45v.01l1.56 2.47h-1.4l-.97-1.6h-.03l-.95 1.6H5.57l1.5-2.48v-.02L5.57 6h1.46zm7.34 0v1h-1.42v3.93H11.7V7.01h-1.43V6h4.1z\\\" fill-rule=\\\"evenodd\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M13 11a2 2 0 00-1 .3l-1.5-1.6a3 3 0 000-3.4L12 4.7c.3.2.6.3 1 .3a2 2 0 10-2-2c0 .4.1.7.3 1L9.7 5.5a3 3 0 00-3.4 0L4.7 4c.2-.3.3-.6.3-1a2 2 0 10-2 2 2 2 0 001-.3l1.5 1.6a3 3 0 000 3.4L4 11.3a2 2 0 00-1-.3 2 2 0 102 2 2 2 0 00-.3-1l1.6-1.5a3 3 0 003.4 0l1.6 1.5a2 2 0 00-.3 1 2 2 0 102-2zm-5-1a2 2 0 110-4 2 2 0 010 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"16\\\" viewBox=\\\"0 0 12 16\\\"><path d=\\\"M1 0a1 1 0 0 0-1 1v14c0 .6.5 1 1 1h10c.6 0 1-.5 1-1V6H8a2 2 0 0 1-2-2V0H1zm11 5H8.4C7.7 5 7 4.4 7 3.7V0l5 5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M16 7V0H9v2h3.6L8 6.6 9.4 8 14 3.4V7h2zM0 9v7h7v-2H3.4L8 9.4 6.6 8 2 12.6V9H0z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"13\\\" viewBox=\\\"0 0 16 13\\\"><path d=\\\"M12 7.2v5h-2V.2h6v2h-4v3h3v2h-3zm-5-7h2v12H7V.2zm-2 5h1v4.2a3 3 0 0 1-6 0V3a3 3 0 0 1 6 0v.2H4V3a1 1 0 0 0-1-1 1 1 0 0 0-1 1v6.4a1 1 0 0 0 1 1 1 1 0 0 0 1-1V7.2H3v-2h2z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M13.82 0C15.02 0 16 .97 16 2.18v8.21c0 1.2-.97 2.18-2.18 2.18H4.26L0 16V2.18C0 .98.97 0 2.18 0zM6.37 2.37c-.12-.12-.23-.1-.33-.04l-.8.48c-.13.07-.17.16-.14.31.14.9-.17 1.67-.95 2.33a.87.87 0 01-.12.09c-.1.06-.23.1-.34.15l-.03.01a.5.5 0 00-.08.04c-.1.05-.14.13-.14.25v.61L3.43 7c0 .14.05.23.18.28.46.17.82.5 1.11 1.04.3.53.38 1.06.26 1.63-.03.12.01.21.12.28.3.2.56.37.83.53.03.03.08.04.12.05.04 0 .08 0 .11-.03a.32.32 0 00.07-.06c.1-.1.2-.18.31-.25.35-.2.84-.3 1.32-.25.5.05.93.25 1.18.54.03.04.08.07.13.1h.06c.06 0 .13-.01.18-.05l.38-.23.39-.22c.18-.11.17-.25.15-.36-.1-.39-.03-.88.2-1.35.21-.47.54-.86.9-1.07.12-.07.24-.12.36-.15.06-.01.13-.04.17-.13A62.17 62.17 0 0012 6.13c0-.12-.05-.2-.16-.25a2.1 2.1 0 01-1.16-1.1 2.3 2.3 0 01-.23-1.56c.03-.14-.01-.24-.13-.3l-.28-.2L10 2.7l-.46-.3a.25.25 0 00-.28 0 .51.51 0 00-.07.05l-.03.02c-.09.08-.19.16-.3.22a2.7 2.7 0 01-1.24.26 1.94 1.94 0 01-1.24-.57zm1.34 2.2a2 2 0 110 4 2 2 0 010-4z\\\" fill-rule=\\\"nonzero\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M8 4a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 12a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM2 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm12 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0-6a2 2 0 1 1 0-4 2 2 0 0 1 0 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path d=\\\"M5 1a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3c0-1.1.9-2 2-2h3zm.5 1a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zM7 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm-2 1a2 2 0 0 0-2 2v1h8v-1a2 2 0 0 0-2-2H5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"8\\\" viewBox=\\\"0 0 20 8\\\"><path d=\\\"M.6 2.7C2.2 1.2 6 0 9.7 0c3.8 0 7.6 1.2 9 2.7 1 .9.9 2.9 0 4.6l-.3.3H18A216 216 0 0 0 14 6c-.4-.1-.3-.1-.3-.5V3.4l-1-.2a13 13 0 0 0-6.2 0l-.9.2V6l-.4.2a155.4 155.4 0 0 0-3.8 1.5c-.4.1-.4.1-.6-.3-1-1.7-1-3.7-.2-4.6z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M0 1c0-.6.4-1 1-1h14c.6 0 1 .4 1 1v14c0 .6-.4 1-1 1H1a1 1 0 0 1-1-1V1zm14 1H2v9l4-2 8 3.5V2zm-4 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path id=\\\"a\\\" d=\\\"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm0-2A6 6 0 1 0 8 2a6 6 0 0 0 0 12zm0-7c.6 0 1 .4 1 1v3a1 1 0 0 1-2 0V8c0-.6.4-1 1-1zm0-1a1 1 0 1 1 0-2 1 1 0 0 1 0 2z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M2 14h7v2H0V0h9v2H2v12zm3-7v2h7v4l4-5-4-5v4H5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"14\\\" viewBox=\\\"0 0 16 14\\\"><path d=\\\"M8.2 11.6c.9-.5 1.7-1.1 2.5-1.8 2.1-1.7 3.3-3.5 3.3-5 0-1-.2-1.7-.7-2.1-.9-1-2.4-1-3.3 0l-2 2-2-2c-1-1-2.4-1-3.3 0-.5.4-.7 1-.7 2.1 0 1.5 1.2 3.3 3.3 5a21.7 21.7 0 0 0 2.7 2l.2-.2zM8 1.9l.6-.6a4.4 4.4 0 0 1 6.1 0c.9.8 1.3 2 1.3 3.5C16 10 8 14 8 14s-8-4-8-9.2c0-1.5.4-2.7 1.3-3.5a4.4 4.4 0 0 1 6 0l.7.6z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M5 3.25A5.79 5.79 0 0 1 10.213 0C13.409 0 16 2.574 16 5.75s-2.591 5.75-5.787 5.75A5.79 5.79 0 0 1 5 8.25h2.4a3.775 3.775 0 0 0 2.813 1.25c2.084 0 3.774-1.679 3.774-3.75 0-2.071-1.69-3.75-3.774-3.75A3.775 3.775 0 0 0 7.4 3.25H5zm6 4.5H8.6A3.775 3.775 0 0 0 5.787 6.5c-2.084 0-3.774 1.679-3.774 3.75 0 2.071 1.69 3.75 3.774 3.75A3.775 3.775 0 0 0 8.6 12.75H11A5.79 5.79 0 0 1 5.787 16C2.591 16 0 13.426 0 10.25S2.591 4.5 5.787 4.5A5.79 5.79 0 0 1 11 7.75z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path transform=\\\"rotate(0 8 8)\\\" d=\\\"M12.42 12.42a6.17 6.17 0 0 1-8.72-.12 6.16 6.16 0 0 1-.12-8.72A6.07 6.07 0 0 1 9.93 2.2a.92.92 0 1 0 .6-1.73A7.91 7.91 0 0 0 2.3 2.3 8 8 0 0 0 2.4 13.6a8 8 0 0 0 11.31.11 7.91 7.91 0 0 0 1.83-8.25.92.92 0 0 0-1.73.61 6.08 6.08 0 0 1-1.4 6.35z\\\"><animateTransform attributeName=\\\"transform\\\" attributeType=\\\"XML\\\" type=\\\"rotate\\\" from=\\\"0 8 8\\\" to=\\\"360 8 8\\\" dur=\\\"1s\\\" repeatCount=\\\"indefinite\\\"></animateTransform></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"16\\\" viewBox=\\\"0 0 12 16\\\"><path d=\\\"M12 6c0 6-6 10-6 10S0 12 0 6a6 6 0 1 1 12 0zM6 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"78\\\" height=\\\"25\\\" viewBox=\\\"0 0 78 25\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M14.73 19.79a7.25 7.25 0 0 1-1.74-4.7V3.43a1.73 1.73 0 0 1 3.47 0v11.64a7.2 7.2 0 0 1-1.73 4.7zm13-4.7A7.32 7.32 0 0 1 16 20.95a8.94 8.94 0 0 0 2.18-5.88V3.44a3.46 3.46 0 1 0-6.93 0v11.64c0 2.25.87 4.3 2.24 5.88a7.4 7.4 0 0 1-11.77-5.88V.88H0v14.2a9.1 9.1 0 0 0 14.78 7.08 9.05 9.05 0 0 0 14.67-7.08V.88h-1.73v14.2zm6.92 8.57h1.74V.84h-1.74v22.82zM51.55.44a9.99 9.99 0 0 0-8.23 4.33V.84h-1.74v22.82h1.74V10.34c0-4.5 3.7-8.18 8.23-8.18V.44zM54.8 18.8a10.1 10.1 0 0 1 .59-13.68 10.23 10.23 0 0 1 13.75-.58L54.8 18.8zM71.6 4.54a11.97 11.97 0 0 0-17.44-.63 11.8 11.8 0 0 0 0 16.74 11.97 11.97 0 0 0 16.85 0l-1.23-1.21a10.23 10.23 0 0 1-13.75.58l7.17-7.13 8.4-8.35zm2.72-3.07v-.34h-1.88v.34h.74v1.9h.4v-1.9h.74zm2.8 1.9V1.14h-.56l-.64 1.75-.65-1.75h-.58v2.25h.39V1.55l.66 1.83h.33l.67-1.84v1.84h.39z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"48\\\" height=\\\"39\\\" viewBox=\\\"0 0 48 39\\\"><path d=\\\"M23.2 0c3 0 5.4 2.5 5.4 5.5V24c0 3.6-1.3 6.9-3.4 9.4A11.5 11.5 0 0043.6 24V1.4h2.7V24c0 8-6.4 14.4-14.2 14.4a14 14 0 01-8.9-3.1c-2.4 2-5.5 3.1-8.8 3.1C6.4 38.4 0 31.9 0 24V1.4h2.7V24a11.7 11.7 0 0018.5 9.4 14.4 14.4 0 01-3.5-9.4V5.5c0-3 2.5-5.5 5.5-5.5zm0 2.7a2.7 2.7 0 00-2.8 2.8V24c0 2.9 1 5.5 2.8 7.5 1.7-2 2.7-4.6 2.7-7.5V5.5c0-1.5-1.2-2.8-2.7-2.8z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"15\\\" height=\\\"14\\\" viewBox=\\\"0 0 15 14\\\"><path d=\\\"M3.1 0h1.66l3.1 13.88h-2l-.58-2.98h-2.7l-.6 2.98H0L3.1 0zm9.38 12.87h-.04c-.26.36-.52.64-.79.84-.27.2-.64.29-1.12.29-.23 0-.48-.04-.72-.1a1.8 1.8 0 0 1-.7-.4 2.04 2.04 0 0 1-.52-.8c-.14-.34-.2-.79-.2-1.33 0-.56.04-1.05.13-1.47.1-.43.26-.78.5-1.06s.56-.48.96-.62a4.88 4.88 0 0 1 1.97-.19l.53.04V7.04c0-.34-.07-.62-.22-.84-.14-.22-.4-.33-.78-.33-.26 0-.5.08-.7.25a1.2 1.2 0 0 0-.43.74H8.42c.07-.9.37-1.6.9-2.14.26-.26.57-.47.94-.62a3.45 3.45 0 0 1 2.4-.03 2.58 2.58 0 0 1 1.57 1.57c.16.39.24.84.24 1.36v6.88h-2v-1.01zm0-3.24c-.22-.04-.4-.06-.55-.06-.43 0-.8.1-1.1.3-.3.2-.46.57-.46 1.1 0 .38.1.69.28.92a.9.9 0 0 0 .76.36c.33 0 .6-.12.79-.34.18-.22.28-.53.28-.93V9.63zM3.94 4H3.9l-.98 5.03h2L3.93 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M8 6.2c-.8 0-1.4.8-1.4 2 0 1.3.6 2 1.4 2 1 0 1.5-.7 1.5-2 0-1.2-.6-2-1.5-2zM8.4 0C13 0 16 3 16 7.3c0 3-1.2 5-3.7 5-1.2 0-2.1-.6-2.4-1.5h-.2c-.4 1-1.1 1.5-2.3 1.5-2 0-3.3-1.7-3.3-4.1 0-2.4 1.3-4 3.2-4a2.4 2.4 0 0 1 2.2 1.3h.2c0-.6.5-1 1-1h.3c.6 0 1 .4 1 1v3.9c0 .7.3 1 .8 1 .9 0 1.3-1 1.3-2.9 0-3.5-2.2-5.8-5.8-5.8C4.6 1.7 2 4.4 2 8.2c0 3.9 2.6 6 6.8 6a11.3 11.3 0 0 0 1.5-.1.7.7 0 0 1 .8.7c0 .5-.4 1-.9 1H10l-1.4.2C3.5 16 0 13 0 8c0-4.7 3.4-8 8.4-8z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M3 0h10a3 3 0 0 1 3 3v7a3 3 0 0 1-3 3H6a3 3 0 0 0-1.8.7l-2.6 2.1A1 1 0 0 1 0 15V3a3 3 0 0 1 3-3z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"18\\\" height=\\\"18\\\" viewBox=\\\"0 0 18 18\\\"><path d=\\\"M12 2a4 4 0 0 0 4 4v6a3 3 0 0 1-3 3H6a3 3 0 0 0-1.8.7l-2.6 2A1 1 0 0 1 0 17V5a3 3 0 0 1 3-3h9zm4 2a2 2 0 1 1 0-4 2 2 0 0 1 0 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" height=\\\"16\\\"><path d=\\\"M3.75 7.25V8a4.25 4.25 0 007.225 3.035l1.06 1.06a5.73 5.73 0 01-3.285 1.606V16h-1.5v-2.298a5.752 5.752 0 01-4.996-5.481L2.25 8v-.75h1.5zM5 5.06l5.091 5.091A3 3 0 015 8V5.06zm8.75 2.19V8c0 1.06-.286 2.052-.786 2.904l-1.11-1.11a4.223 4.223 0 00.391-1.588L12.25 8v-.75h1.5zM8 1a3 3 0 013 3v4c0 .286-.04.563-.115.825L5.143 3.083A3.001 3.001 0 018 1z\\\"></path><path fill-rule=\\\"nonzero\\\" d=\\\"M1.03.97l14 14-1.06 1.06-14-14z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M11 4a3 3 0 00-6 0v4a3 3 0 006 0V4z\\\"></path><path d=\\\"M3.75 7.25V8a4.25 4.25 0 008.5.2v-.95h1.5V8a5.75 5.75 0 01-5 5.7V16h-1.5v-2.3a5.75 5.75 0 01-5-5.48v-.97h1.5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"2\\\" viewBox=\\\"0 0 16 2\\\"><path d=\\\"M0 0h16v2H0z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M12 3.2l2-1.4a1 1 0 0 1 1.2 1.6L1.6 13a1 1 0 0 1-1.1-1.6l1.3-.9v-.2S2.7 8.5 3 7.5c.4-1.2 1-4.3 1-4.3C4.3 1.4 6 0 8 0a4 4 0 0 1 4 3.2zm1 4.2v.1l1.2 2.7c.4 1-.1 1.8-1.2 1.8H6.4L13 7.4zM10 14a2 2 0 1 1-4 0h4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path fill=\\\"#0097F8\\\" d=\\\"M14 1.9V8c0 4-3 7-7 8-4-1-7-4-7-8V2l7-2 7 1.9zm-7-1L.8 2.5V8c0 3.4 2.5 6.3 6.2 7.2V.8z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M7 0C5 0 3.3 1.4 3 3.2c0 0-.5 3-1 4.3L.8 10.2C.4 11.2 1 12 2 12h10c1.1 0 1.6-.8 1.2-1.8L12 7.5c-.4-1.2-1-4.3-1-4.3A4 4 0 0 0 7 0zm2 14a2 2 0 1 1-4 0h4z\\\"></path></svg>\"","module.exports = \"<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M9.7 15H15a1 1 0 1 0 0-2H9.7a2 2 0 0 0-3.4 0H1a1 1 0 1 0 0 2h5.3a2 2 0 0 0 3.4 0zm-3-6H15a1 1 0 1 0 0-2H6.7a2 2 0 0 0-3.4 0H1a1 1 0 1 0 0 2h2.3a2 2 0 0 0 3.4 0zm6-6H15a1 1 0 1 0 0-2h-2.3a2 2 0 0 0-3.4 0H1a1 1 0 1 0 0 2h8.3a2 2 0 0 0 3.4 0z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M4 9a2 2 0 110-4 2 2 0 010 4zm4 4.27a5.85 5.85 0 01-1.2.98 5.43 5.43 0 01-3.08.74A5.4 5.4 0 010 13.12V12a2 2 0 012-2h4a2 2 0 012 2v1.27zM12 5a2 2 0 110-4 2 2 0 010 4zm4 4.27a5.85 5.85 0 01-1.2.98 5.43 5.43 0 01-3.08.74A5.4 5.4 0 018 9.13V8a2 2 0 012-2h4a2 2 0 012 2v1.27z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12zm0 2A8 8 0 1 1 8 0a8 8 0 0 1 0 16zM7 7h5v2H7V7zm0-4h2v6H7V3z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path d=\\\"M10.6 10h.4a3 3 0 0 1 3 3v1.27a14.93 14.93 0 0 1-14 0V13a3 3 0 0 1 3-3h.4a6.97 6.97 0 0 0 7.2 0zM7 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M12.7 16c-2 0-5.6-1.8-8.2-4.5C1.8 9 0 5.3 0 3.3 0 2 1.4.6 3.4.1l.3-.1.3.3a216 216 0 0 0 1.7 3.8c.1.4.1.4-.1.6l-1 1-.5.6.4.7A13 13 0 0 0 9 11.5l.7.4 1.6-1.5.1-.1.1-.1.4.1a155.4 155.4 0 0 0 3.8 1.7c.4.2.3.2.2.6-.5 2-1.9 3.4-3.2 3.4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M5.95 4.273a1.016 1.016 0 0 0 1.963-.527L7.11.754a1.016 1.016 0 1 0-1.964.526l.802 2.993zm4.101 7.455a1.016 1.016 0 0 0-1.963.526l.802 2.993a1.016 1.016 0 1 0 1.963-.526l-.802-2.993zM3.746 7.913a1.016 1.016 0 0 0 .527-1.964L1.28 5.147a1.016 1.016 0 1 0-.526 1.964l2.992.802zm8.508.175a1.016 1.016 0 1 0-.526 1.963l2.992.802a1.016 1.016 0 0 0 .527-1.963l-2.993-.802zM5.798 11.64a1.016 1.016 0 1 0-1.438-1.437l-2.19 2.19a1.016 1.016 0 1 0 1.436 1.438l2.192-2.19zm4.405-7.28a1.016 1.016 0 1 0 1.437 1.438l2.191-2.191a1.016 1.016 0 0 0-1.437-1.438L10.203 4.36z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M0 7v2h7v7h2V9h7V7H9V0H7v7z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zM2 8c0 1.5.56 2.88 1.47 3.94l.08-.46c.15-.82.93-1.48 1.76-1.48h5.38c.83 0 1.61.67 1.76 1.48l.08.46A6 6 0 1 0 2 8zm6 1a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"12\\\" viewBox=\\\"0 0 16 12\\\"><path d=\\\"M16 6a8.5 8.5 0 0 1-8 6 8.5 8.5 0 0 1-8-6c1.2-3.5 4.3-6 8-6s6.8 2.5 8 6zM8 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"15\\\" viewBox=\\\"0 0 16 15\\\"><path d=\\\"M3.3 4h7.1C13.5 4 16 6.6 16 9.6c0 3-2.5 5.4-5.6 5.4H7a1 1 0 0 1 0-2h3.4c2 0 3.6-1.4 3.6-3.4S12.5 6 10.4 6h-7l2.4 2.4a1 1 0 0 1 0 1.3 1 1 0 0 1-1.4 0l-4.1-4a1 1 0 0 1-.2-.3 1 1 0 0 1 .2-1l4-4.1a1 1 0 0 1 1.5 0 1 1 0 0 1 0 1.3L3.3 4z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" height=\\\"16\\\"><path d=\\\"M12 13v2H4v-2zm2.124-12c.484 0 .876.379.876.845v9.31c0 .467-.39.845-.876.845H9V8h4L8 3 3 8h4l-.001 4H1.876C1.392 12 1 11.621 1 11.155v-9.31C1 1.378 1.39 1 1.876 1h12.248z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\" height=\\\"16\\\"><path d=\\\"M11.094 13l.905.9L12 15H4v-2h7.094zM1 2.949l9.029 8.99H1.876c-.484 0-.876-.344-.876-.768V2.949zm2.849-1.01l10.046 10h-1.954l-10.045-10h1.953zm10.275 0c.484 0 .876.344.876.768v8.429L5.762 1.939h8.362z\\\"></path><path d=\\\"M2.03-.03l14 14-1.06 1.06-14-14z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M0 14.3c0 1.5 1 2.1 2.3 1.4L15 9.2c1.3-.7 1.3-1.7 0-2.4L2.3.3C1.1-.4 0 .3 0 1.7V8h12L0 10v4.3z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"32\\\" height=\\\"32\\\" viewBox=\\\"0 0 32 32\\\"><path d=\\\"M10.5 12A6.5 6.5 0 0 0 4 18.5V24a1 1 0 0 0 1 1h22a1 1 0 0 0 1-1v-5.5a6.5 6.5 0 0 0-6.5-6.5h-11zm-7.12-1.22L.24 4.95a2 2 0 1 1 3.52-1.9L6.8 8.68C7.94 8.24 9.19 8 10.5 8h11C27.3 8 32 12.7 32 18.5V24a5 5 0 0 1-5 5H5a5 5 0 0 1-5-5v-5.5c0-3.05 1.3-5.8 3.38-7.72zM11 19a2 2 0 1 1-4 0 2 2 0 0 1 4 0m7 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0m5 2a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm5.26-9.55a2 2 0 0 1-3.52-1.9l3.5-6.5a2 2 0 0 1 3.52 1.9l-3.5 6.5z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M2.8 11a6 6 0 0 1-.6-1.5H0v-3h2.2c.1-.6.3-1 .6-1.5L1.3 3.4l2.1-2.1L5 2.8a6 6 0 0 1 1.5-.6V0h3v2.2c.6.1 1 .3 1.5.6l1.6-1.5 2.1 2.1L13.2 5c.3.4.5 1 .6 1.5H16v3h-2.2a6 6 0 0 1-.6 1.5l1.5 1.6-2.1 2.1-1.6-1.5a6 6 0 0 1-1.5.6V16h-3v-2.2a6 6 0 0 1-1.5-.6l-1.6 1.5-2.1-2.1L2.8 11zM8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 16 16\\\" height=\\\"16\\\" width=\\\"16\\\"><path d=\\\"m.5 4-.4.2-.1.4v6.8l.1.4.4.2H5l5 4V0L5 4ZM12 6V4q.8 0 1.6.3.7.3 1.2.9.6.5.9 1.2.3.8.3 1.6t-.3 1.6q-.3.7-.9 1.2-.5.6-1.2.9-.8.3-1.6.3v-2q.8 0 1.4-.6.6-.6.6-1.4 0-.8-.6-1.4Q12.8 6 12 6Z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"15\\\" height=\\\"16\\\" viewBox=\\\"0 0 15 16\\\"><path d=\\\"M7.44 2v1.08a6.48 6.48 0 0 1 5.45 6.42c0 3.59-2.89 6.5-6.45 6.5A6.47 6.47 0 0 1 0 9.5a6.48 6.48 0 0 1 5.45-6.42V2h-.5a1 1 0 0 1-.98-1 1 1 0 0 1 .99-1h2.97a1 1 0 0 1 1 1 1 1 0 0 1-1 1h-.5zm-1 12a4.48 4.48 0 0 0 4.47-4.5c0-2.49-2-4.5-4.47-4.5a4.48 4.48 0 0 0-4.46 4.5c0 2.49 2 4.5 4.46 4.5zm0-1a3.49 3.49 0 0 1-3.47-3.5C2.97 7.57 4.53 6 6.44 6v3.5l2.47 2.47A3.44 3.44 0 0 1 6.44 13zm6.57-10.3l.7.71a1 1 0 0 1 0 1.42.99.99 0 0 1-1.4 0l-.7-.7a1 1 0 0 1 0-1.42.99.99 0 0 1 1.4 0z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\"><path d=\\\"M2.3 2.3a8.3 8.3 0 0 1 4-2.1 8.2 8.2 0 0 1 7.4 2.1A8 8 0 1 1 .3 10h2a6.1 6.1 0 0 0 2.2 2.9A6 6 0 0 0 14 8a6 6 0 0 0-8.3-5.5c-.8.3-1.4.7-2 1.3L7 7H0V0l2.3 2.3z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"14\\\" height=\\\"16\\\" viewBox=\\\"0 0 14 16\\\"><path fill=\\\"#0097F8\\\" d=\\\"M14 1.9L7 0 0 2v6c0 4 3 7.1 7 8 4-.9 7-4 7-8V1.9z\\\"></path><path fill=\\\"#0079B6\\\" d=\\\"M14 1.9L7 0v16c4-.9 7-4 7-8V1.9z\\\"></path></svg>\"","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"288\\\" height=\\\"374\\\" viewBox=\\\"0 0 288 374\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M5.65 140.47a2.82 2.82 0 1 1-5.65 0V48.7a2.82 2.82 0 0 1 2.82-2.83c8.83 0 18.21-.87 28.09-2.56 20.7-3.53 42.84-10.47 65.42-19.81a446.55 446.55 0 0 0 33.32-15.44 362.62 362.62 0 0 0 9.54-5.08 221.3 221.3 0 0 0 3.17-1.78c1.1-.64 2.19-.64 3.07-.12l.85.49 2.53 1.42a363.75 363.75 0 0 0 9.54 5.07 446.55 446.55 0 0 0 33.32 15.44c22.58 9.34 44.73 16.28 65.42 19.81a167.63 167.63 0 0 0 28.09 2.56A2.82 2.82 0 0 1 288 48.7v36.7a2.82 2.82 0 1 1-5.65 0V51.5a177.14 177.14 0 0 1-26.2-2.62c-21.17-3.62-43.7-10.67-66.64-20.17a452.25 452.25 0 0 1-33.74-15.62 367.54 367.54 0 0 1-9.7-5.16L144 6.77l-2.07 1.16a368.54 368.54 0 0 1-9.7 5.16A452.27 452.27 0 0 1 98.5 28.72C75.56 38.2 53.02 45.27 31.86 48.88a177 177 0 0 1-26.21 2.61v88.98zm240 125.63a18.35 18.35 0 1 1 0-36.7 18.35 18.35 0 0 1 0 36.7m0-42.35a24 24 0 1 0 0 48 24 24 0 0 0 0-48m12.74 26.9a2.82 2.82 0 0 0-3.89.9c-1.66 2.66-4.27 3.97-8.2 3.97-3.98 0-6.88-1.37-8.98-4.17a2.82 2.82 0 0 0-4.52 3.39c3.2 4.26 7.79 6.42 13.5 6.42 5.8 0 10.24-2.22 13-6.62a2.82 2.82 0 0 0-.9-3.89m-5.47-4.89a3.3 3.3 0 1 0 0-6.61 3.3 3.3 0 0 0 0 6.61m-13.24 0a3.3 3.3 0 1 0 0-6.61 3.3 3.3 0 0 0 0 6.61m39.84-151.88h-50.84a2.82 2.82 0 1 1 0-5.64c.15 0 .32.01.5.05a2.82 2.82 0 0 0 3.16-3.74 14.06 14.06 0 0 1-.84-4.78c0-7.8 6.33-14.12 14.12-14.12a14.12 14.12 0 0 1 13.33 9.45 2.83 2.83 0 0 0 2.9 1.88c.33-.03.53-.04.72-.04a8.47 8.47 0 0 1 8.47 8.47 2.82 2.82 0 0 0 5.65 0c0-7.48-5.82-13.6-13.19-14.09A19.77 19.77 0 0 0 245.64 60a19.77 19.77 0 0 0-19.51 22.98 8.47 8.47 0 0 0 2.56 16.55h50.84c2.2 0 2.82.62 2.82 2.82v127.06c0 41.97-19.5 77.42-52.6 103.67-27.03 21.45-61.57 34.69-85.79 34.69-12.76 0-29.3-3.89-46.04-11.04a172.47 172.47 0 0 1-50.8-33.25 2.82 2.82 0 1 0-3.9 4.09c29.33 27.96 71.15 45.84 100.74 45.84 25.56 0 61.32-13.7 89.31-35.9C267.63 310.24 288 273.22 288 229.4V102.35c0-5.32-3.15-8.47-8.47-8.47M53.65 110.81H19.77a2.82 2.82 0 0 1-2.83-2.82V62.8a2.82 2.82 0 0 1 2.83-2.82h22.58c.75 0 1.47.3 2 .82l11.3 11.3c.52.53.82 1.24.82 2v33.88a2.82 2.82 0 0 1-2.82 2.82zm-2.83-5.65V75.27l-9.64-9.64h-18.6v39.53h28.24zM31.18 84a2.88 2.88 0 0 1-2.95-2.83 2.88 2.88 0 0 1 2.95-2.82h11.05a2.88 2.88 0 0 1 2.95 2.82A2.88 2.88 0 0 1 42.23 84H31.18zm0 9.88a2.88 2.88 0 0 1-2.95-2.83 2.88 2.88 0 0 1 2.95-2.82h11.05a2.88 2.88 0 0 1 2.95 2.83 2.88 2.88 0 0 1-2.95 2.82H31.18zM144 187.04a8.47 8.47 0 1 1 0 16.94 8.47 8.47 0 0 1 0-16.94m0 22.6a14.12 14.12 0 1 0 0-28.24 14.12 14.12 0 0 0 0 28.23m14.12 16.94h-28.24v-8.47c0-1.36.43-2 1.27-2.41.3-.16.67-.27 1.03-.34l10.56 5.28c.8.4 1.73.4 2.52 0l10.64-5.32c.95.12 1.46.53 1.81 1.23a4.11 4.11 0 0 1 .4 1.56v8.47zm5.52-9.81a9.63 9.63 0 0 0-.88-2.74c-1.34-2.7-3.89-4.39-7.47-4.39-.43 0-.87.1-1.26.3L144 214.95l-10.03-5.02a2.82 2.82 0 0 0-1.26-.3c-.33 0-.79.04-1.35.13a9.63 9.63 0 0 0-2.74.88c-2.69 1.34-4.39 3.88-4.39 7.46v11.3a2.82 2.82 0 0 0 2.83 2.82h33.88a2.82 2.82 0 0 0 2.82-2.82v-11.3c0-.32-.03-.78-.12-1.34zM144 131.28a8.47 8.47 0 1 1 0 16.94 8.47 8.47 0 0 1 0-16.94m0 22.59a14.12 14.12 0 1 0 0-28.24 14.12 14.12 0 0 0 0 28.24m14.12 16.94h-28.24v-8.47c0-1.36.43-2 1.27-2.42.3-.15.67-.27 1.03-.33l10.56 5.28c.8.4 1.73.4 2.52 0l10.64-5.32c.95.11 1.46.52 1.81 1.23a4.08 4.08 0 0 1 .4 1.56v8.47zm5.52-9.82a9.63 9.63 0 0 0-.88-2.74c-1.34-2.69-3.89-4.38-7.47-4.38-.43 0-.87.1-1.26.3L144 159.18l-10.03-5.01a2.83 2.83 0 0 0-1.26-.3c-.33 0-.79.03-1.35.12a9.65 9.65 0 0 0-2.74.88c-2.69 1.35-4.39 3.89-4.39 7.47v11.3a2.82 2.82 0 0 0 2.83 2.82h33.88a2.82 2.82 0 0 0 2.82-2.83v-11.3c0-.31-.03-.77-.12-1.34zM192 170.1a8.47 8.47 0 1 1 0 16.94 8.47 8.47 0 0 1 0-16.94m0 22.6a14.12 14.12 0 1 0 0-28.24 14.12 14.12 0 0 0 0 28.23m14.12 16.94h-28.24v-8.47c0-1.36.43-2 1.27-2.41a3.97 3.97 0 0 1 1.03-.34l10.56 5.28c.8.4 1.73.4 2.52 0l10.64-5.32c.95.12 1.46.53 1.81 1.23a4.1 4.1 0 0 1 .4 1.56v8.47zm5.52-9.81a9.63 9.63 0 0 0-.88-2.74c-1.34-2.7-3.89-4.39-7.47-4.39-.43 0-.87.1-1.26.3L192 198.01l-10.03-5.02a2.82 2.82 0 0 0-1.26-.3c-.33 0-.79.04-1.35.13a9.63 9.63 0 0 0-2.74.88c-2.69 1.34-4.39 3.88-4.39 7.46v11.3a2.82 2.82 0 0 0 2.83 2.82h33.88a2.82 2.82 0 0 0 2.83-2.82v-11.3c0-.32-.04-.78-.13-1.34zM96 170.8a8.47 8.47 0 1 1 0 16.94 8.47 8.47 0 0 1 0-16.94m0 22.59a14.12 14.12 0 1 0 0-28.24 14.12 14.12 0 0 0 0 28.24m14.12 16.94H81.88v-8.47c0-1.36.43-2 1.27-2.42.3-.15.67-.27 1.03-.33l10.56 5.27c.8.4 1.73.4 2.52 0l10.64-5.31c.95.11 1.46.52 1.81 1.23a4.1 4.1 0 0 1 .4 1.56v8.47zm5.52-9.82a9.68 9.68 0 0 0-.88-2.74c-1.34-2.69-3.89-4.38-7.47-4.38-.43 0-.87.1-1.26.3L96 198.7l-10.03-5.01a2.82 2.82 0 0 0-1.26-.3c-.33 0-.79.03-1.35.13a9.63 9.63 0 0 0-2.74.87c-2.69 1.35-4.39 3.89-4.39 7.47v11.3a2.82 2.82 0 0 0 2.83 2.82h33.88a2.82 2.82 0 0 0 2.82-2.83v-11.3c0-.31-.03-.78-.12-1.34zM67.76 311.28h-3.53c-.23 0-.25 0-.82-.58-1.54-1.55-2.7-2.24-4.82-2.24s-3.28.7-4.82 2.24c-.58.57-.6.58-.83.58-.24 0-.25 0-.83-.58-1.54-1.55-2.7-2.24-4.82-2.24-2.11 0-3.28.7-4.82 2.24-.57.57-.59.58-.82.58-.24 0-.25 0-.83-.58-1.54-1.55-2.7-2.24-4.82-2.24-.46 0-1.65-.64-3.11-1.89a36.09 36.09 0 0 1-4.5-4.74A126.21 126.21 0 0 1 5.64 229.4v-66.25-.05-.05c0-8.65 4.34-12.63 14.14-12.71h23.27c.75 0 1.47-.3 2-.83l6.47-6.47v3.06a2.82 2.82 0 0 0 5.65 0v-9.88c0-.19-.02-.37-.06-.54l-.01-.08a2.72 2.72 0 0 0-.16-.48 2.76 2.76 0 0 0-.97-1.2l-.1-.06a2.98 2.98 0 0 0-.38-.21l-.06-.03a2.92 2.92 0 0 0-.47-.15l-.1-.02a2.83 2.83 0 0 0-.65-.05h-9.75a2.82 2.82 0 0 0 0 5.65h3.06l-5.64 5.64H19.76C6.96 144.8 0 151.17 0 163.04v66.36c0 27.82 8.52 53.67 23.8 75.72l.06.08.05.08c4.19 5.23 8.42 8.82 12.09 8.82.24 0 .25.01.83.59 1.54 1.54 2.7 2.24 4.82 2.24s3.28-.7 4.82-2.24c.57-.58.59-.59.82-.59s.25.01.83.59c1.54 1.54 2.7 2.24 4.82 2.24s3.28-.7 4.82-2.24c.58-.58.6-.59.83-.59s.25.01.82.59c1.55 1.54 2.7 2.24 4.82 2.24h3.53a2.82 2.82 0 0 0 0-5.65m31.06-14.78l-2.49-4.99h4.98l-2.49 4.98zm-4.23-46.63h8.47v-3.53h-8.47v3.53zm0 36h8.47V255.5h-8.47v30.36zm14.11 2.84V243.52a2.82 2.82 0 0 0-2.82-2.83H91.77a2.82 2.82 0 0 0-2.83 2.83V288.7a2.8 2.8 0 0 0 .26 1.14l.04.1 7.06 14.12a2.82 2.82 0 0 0 5.05 0l7.06-14.12.04-.1a2.77 2.77 0 0 0 .25-1.14zm1.42 19.75a2.82 2.82 0 0 1 0-5.65c1.41 0 2.01-.36 3.65-2 2.6-2.6 4.35-3.65 7.64-3.65 3.3 0 5.05 1.05 7.65 3.65 1.63 1.64 2.23 2 3.65 2 1.4 0 2.01-.36 3.65-2 2.6-2.6 4.35-3.65 7.64-3.65s5.04 1.05 7.64 3.65c1.64 1.64 2.24 2 3.65 2 1.42 0 2.02-.36 3.65-2 2.6-2.6 4.36-3.65 7.65-3.65 3.3 0 5.04 1.05 7.64 3.65 1.64 1.64 2.24 2 3.65 2a2.82 2.82 0 0 1 0 5.65c-3.29 0-5.04-1.05-7.64-3.65-1.64-1.64-2.24-2-3.65-2-1.41 0-2.02.36-3.65 2-2.6 2.6-4.35 3.65-7.65 3.65-3.29 0-5.04-1.05-7.64-3.65-1.63-1.64-2.24-2-3.65-2-1.41 0-2.01.36-3.65 2-2.6 2.6-4.35 3.65-7.64 3.65s-5.05-1.05-7.65-3.65c-1.63-1.64-2.23-2-3.65-2-1.41 0-2.01.36-3.65 2-2.6 2.6-4.35 3.65-7.64 3.65m28.23-227.99h11.3v-5.65h-11.3v5.65zm-8.47-25.41a14.12 14.12 0 1 1 16.94 13.83v-8.18a2.82 2.82 0 0 0-.82-2l-.83-.83h4.48a2.82 2.82 0 0 0 0-5.65h-11.3a2.82 2.82 0 0 0-2 4.83l4.83 4.81v7.02c-6.45-1.3-11.3-7-11.3-13.83zm33.89 0a19.77 19.77 0 1 0-31.06 16.22V83.3a2.82 2.82 0 0 0 2.82 2.82h16.94a2.82 2.82 0 0 0 2.82-2.83V71.27a19.73 19.73 0 0 0 8.47-16.21zm-16.95-25.43a2.82 2.82 0 0 1-5.64 0V24a2.82 2.82 0 0 1 5.64 0v5.64zm17.53 9.06a2.82 2.82 0 1 1-4-4l4.24-4.23a2.82 2.82 0 1 1 4 4l-4.24 4.23zm5.06 19.2a2.82 2.82 0 0 1 0-5.66h5.65a2.82 2.82 0 0 1 0 5.65h-5.65zm-45.76-19.2a2.82 2.82 0 0 0 4-4l-4.24-4.23a2.82 2.82 0 0 0-4 4l4.24 4.23zm-10.7 19.2a2.82 2.82 0 0 1 0-5.66h5.64a2.82 2.82 0 0 1 0 5.65h-5.65zm87.52 16.23h11.01a14.13 14.13 0 0 0-11-11.01v11zm-2.82 5.64a2.82 2.82 0 0 1-2.83-2.82V60a2.82 2.82 0 0 1 2.83-2.82 19.77 19.77 0 0 1 19.76 19.76 2.82 2.82 0 0 1-2.82 2.83h-16.94zm-9.18 9.18a2.82 2.82 0 0 1-2.82-2.82V69.41a16.95 16.95 0 0 0 2.82 33.65 17.1 17.1 0 0 0 16.67-14.12h-16.67zm2.83-5.64h16.94a2.82 2.82 0 0 1 2.82 2.85c-.13 12.4-10.23 22.56-22.59 22.56a22.6 22.6 0 0 1 0-45.18 2.82 2.82 0 0 1 2.83 2.82V83.3zm74.66 54.1a2.82 2.82 0 0 0-3.86 1 15.62 15.62 0 0 1-13.5 7.7 15.6 15.6 0 0 1-14.36-9.4 2.82 2.82 0 0 0 2.5-5l-4.7-3.16a2.81 2.81 0 0 0-.88-.53 2.82 2.82 0 0 0-3.58 1.12l-3.42 5.75a2.82 2.82 0 1 0 4.58 3.26 21.24 21.24 0 0 0 19.86 13.6c7.65 0 14.59-4.04 18.37-10.48a2.82 2.82 0 0 0-1-3.87m5.92-14.89a2.82 2.82 0 0 0-3.46.47 21.25 21.25 0 0 0-19.85-13.57 21.27 21.27 0 0 0-18.37 10.5 2.82 2.82 0 0 0 4.87 2.85 15.62 15.62 0 0 1 13.5-7.7 15.6 15.6 0 0 1 14.43 9.57 2.82 2.82 0 0 0-2.7 4.93l5.15 3.46a2.82 2.82 0 0 0 4-.9l3.42-5.74a2.82 2.82 0 0 0-.99-3.87M62.12 221.63H44.78a2.81 2.81 0 0 0-2.43-1.4 2.81 2.81 0 0 0-2.43 1.4H22.6V193.4h8.47a2.82 2.82 0 0 0 2.82-2.83c0-1.36.42-2 1.26-2.41a4.08 4.08 0 0 1 1.57-.4H48c1.36 0 2 .41 2.42 1.25a4.07 4.07 0 0 1 .4 1.56 2.82 2.82 0 0 0 2.83 2.83h8.47v28.23zm2.82-33.88h-8.96a9.19 9.19 0 0 0-.51-1.26c-1.35-2.7-3.9-4.39-7.47-4.39H36.7c-.32 0-.78.04-1.34.13a9.65 9.65 0 0 0-2.74.88 7.6 7.6 0 0 0-3.98 4.64h-8.88a2.82 2.82 0 0 0-2.82 2.82v33.89a2.82 2.82 0 0 0 2.83 2.82h19.76v2.82a2.82 2.82 0 0 0 5.65 0v-2.82h19.76a2.82 2.82 0 0 0 2.83-2.82v-33.89a2.82 2.82 0 0 0-2.83-2.82zm-22.59 25.41a7.06 7.06 0 1 1 0-14.12 7.06 7.06 0 0 1 0 14.12m0-19.76a12.7 12.7 0 1 0 0 25.4 12.7 12.7 0 0 0 0-25.4m0 60.7a2.82 2.82 0 0 0-2.82 2.83v7.06a2.82 2.82 0 0 0 5.65 0v-7.06a2.82 2.82 0 0 0-2.83-2.83m0-16.94a2.82 2.82 0 0 0-2.82 2.83v7.06a2.82 2.82 0 0 0 5.65 0v-7.06a2.82 2.82 0 0 0-2.83-2.83m0 33.89a2.82 2.82 0 0 0-2.82 2.82v7.06a2.82 2.82 0 0 0 5.65 0v-7.06a2.82 2.82 0 0 0-2.83-2.83m152.47 7.06a2.82 2.82 0 1 0 0 5.65 2.82 2.82 0 0 0 0-5.65m11.3 7.77h-22.6v-39.53h22.6v39.53zm2.82-45.18H180.71a2.82 2.82 0 0 0-2.83 2.83v45.17a2.82 2.82 0 0 0 2.83 2.83h28.23a2.82 2.82 0 0 0 2.83-2.83v-45.17a2.82 2.82 0 0 0-2.83-2.83zM86.12 88.22a14.12 14.12 0 1 1 0-28.23 14.12 14.12 0 0 1 0 28.23m2.82-33.68v-3.03h2.82a2.82 2.82 0 0 0 0-5.64H80.47a2.82 2.82 0 0 0 0 5.64h2.82v3.03a19.77 19.77 0 1 0 5.65 0m0 18.4l4.82 4.81a2.82 2.82 0 1 1-4 4l-5.64-5.65a2.82 2.82 0 0 1-.83-2v-7.76a2.82 2.82 0 0 1 5.65 0v6.6zm59.42 32.59l3.3-3.31a2.82 2.82 0 0 0-3.99-4l-3.3 3.31-3.31-3.3a2.82 2.82 0 0 0-4 3.99l3.31 3.3-3.3 3.32a2.82 2.82 0 0 0 3.99 3.99l3.3-3.31 3.31 3.31a2.82 2.82 0 0 0 4-4l-3.31-3.3zM81.88 122.1h33.89v-11.3H81.88v11.3zm-2.82 5.65a2.82 2.82 0 0 1-2.82-2.82v-16.94a2.82 2.82 0 0 1 2.82-2.83h39.53a2.82 2.82 0 0 1 2.82 2.83v16.94a2.82 2.82 0 0 1-2.82 2.82H79.06zm29.65-8.47a2.82 2.82 0 1 0 0-5.65 2.82 2.82 0 0 0 0 5.65m-26.83 28.23h33.89v-11.29H81.88v11.3zm-2.82 5.65a2.82 2.82 0 0 1-2.82-2.82V133.4a2.82 2.82 0 0 1 2.82-2.83h39.53a2.82 2.82 0 0 1 2.82 2.83v16.94a2.82 2.82 0 0 1-2.82 2.82H79.06zm29.65-8.47a2.82 2.82 0 1 0 0-5.65 2.82 2.82 0 0 0 0 5.65m73.4-8.47a2.82 2.82 0 1 0 0 5.65 2.82 2.82 0 0 0 0-5.65m9.89 0a2.82 2.82 0 1 0 0 5.65 2.82 2.82 0 0 0 0-5.65m10.59 0a2.82 2.82 0 1 0 0 5.65 2.82 2.82 0 0 0 0-5.65m7.76 11.3c0 .77-.63 1.4-1.4 1.4h-33.89c-.78 0-1.41-.62-1.41-1.4v-9.18c0-5.85 4.74-10.59 10.59-10.59h15.53c5.84 0 10.58 4.74 10.58 10.59v9.17zm4.86-32.85a2.82 2.82 0 0 0-3.82 1.16l-4.28 8.03a16.16 16.16 0 0 0-7.35-1.76h-15.52a16.16 16.16 0 0 0-7.35 1.76l-4.28-8.03a2.82 2.82 0 1 0-4.98 2.66l4.7 8.82a16.17 16.17 0 0 0-4.33 11.03v9.18a7.06 7.06 0 0 0 7.06 7.05h33.88a7.06 7.06 0 0 0 7.06-7.05v-9.18c0-4.26-1.64-8.14-4.33-11.03l4.7-8.82a2.82 2.82 0 0 0-1.16-3.82zm6.44 178.26a2.82 2.82 0 0 0-5.65 0 2.82 2.82 0 0 1-2.82 2.82 2.82 2.82 0 0 0 0 5.65 8.47 8.47 0 0 0 8.47-8.47m11.3 0a2.82 2.82 0 0 0-5.66 0c0 7.8-6.32 14.12-14.11 14.12a2.82 2.82 0 0 0 0 5.64 19.77 19.77 0 0 0 19.76-19.76m11.3 0a2.82 2.82 0 0 0-5.65 0 25.41 25.41 0 0 1-25.41 25.4 2.82 2.82 0 0 0 0 5.66 31.06 31.06 0 0 0 31.06-31.06m-18.36-94.6h4.24v-11.29h-4.24v11.3zm-2.82 5.66h9.88a2.82 2.82 0 0 0 2.83-2.83v-16.94a2.82 2.82 0 0 0-2.83-2.82h-9.88a2.82 2.82 0 0 0-2.83 2.82v16.94a2.82 2.82 0 0 0 2.83 2.83zm20.47-5.65h4.24V170.1h-4.24v28.24zm-2.82 5.65h9.88a2.82 2.82 0 0 0 2.82-2.83v-33.88a2.82 2.82 0 0 0-2.82-2.82h-9.88a2.82 2.82 0 0 0-2.83 2.82v33.88a2.82 2.82 0 0 0 2.83 2.83zm20.47-5.65h4.23v-23.3h-4.23v23.3zm7.06-28.94h-9.89a2.82 2.82 0 0 0-2.82 2.82v28.94a2.82 2.82 0 0 0 2.82 2.83h9.88a2.82 2.82 0 0 0 2.83-2.83v-28.94a2.82 2.82 0 0 0-2.82-2.82zm0 40.23h-45.18a2.82 2.82 0 0 0 0 5.65h45.18a2.82 2.82 0 0 0 0-5.65m-144 64.94h39.53v-28.23h-39.53v28.23zm42.35-33.88H121.4a2.82 2.82 0 0 0-2.82 2.83v33.88a2.82 2.82 0 0 0 2.82 2.82h45.18a2.82 2.82 0 0 0 2.82-2.82v-33.88a2.82 2.82 0 0 0-2.82-2.83zm-11.3 42.36h-22.58a2.82 2.82 0 0 0 0 5.64h22.58a2.82 2.82 0 0 0 0-5.64M70.6 299.4l-5.65-1.06v-4.01h5.65v5.07zm3.67-53.07l1.82 33.94a2.86 2.86 0 0 0-.55-.06H59.45l1.82-33.88h13zm-12.51 39.53h12.03l-1.88 2.82h-8.27l-1.88-2.82zm20.13-2.98l-2.12-39.53a2.82 2.82 0 0 0-2.82-2.67H58.6a2.82 2.82 0 0 0-2.82 2.67l-2.12 39.53c-.03.61.13 1.21.47 1.72l5.17 7.76v8.32c0 1.36.97 2.53 2.3 2.78l11.3 2.11a2.82 2.82 0 0 0 3.35-2.77v-10.44l5.17-7.76a2.82 2.82 0 0 0 .47-1.72zM64.94 122.1H19.77a2.82 2.82 0 0 0-2.83 2.83v11.3a2.82 2.82 0 0 0 5.65 0v-8.48h39.53V156H19.77a2.82 2.82 0 0 0 0 5.64h6.72l-3.6 7.21a2.82 2.82 0 0 0 5.05 2.53l4.86-9.74h19.8l4.87 9.74a2.82 2.82 0 0 0 5.06-2.53l-3.6-7.2h6.01a2.82 2.82 0 0 0 2.83-2.83v-33.88a2.82 2.82 0 0 0-2.83-2.83m91.52 228.79l-10.47 10.4a2.82 2.82 0 0 1-4.81-2.01V325.4a8.47 8.47 0 0 1 8.47-8.47h33.8a8.55 8.55 0 0 1 8.55 8.55v16.94a8.47 8.47 0 0 1-8.47 8.47h-27.07zm-9.64 1.6l6.48-6.43a2.82 2.82 0 0 1 2-.82h28.23a2.82 2.82 0 0 0 2.82-2.82v-16.95a2.9 2.9 0 0 0-2.9-2.9h-33.8a2.82 2.82 0 0 0-2.83 2.83v27.1zm11.3-18.55a2.82 2.82 0 1 1-5.65 0 2.82 2.82 0 0 1 5.65 0m11.3 0a2.82 2.82 0 1 1-5.66 0 2.82 2.82 0 0 1 5.65 0m8.47 2.83a2.82 2.82 0 1 1 0-5.65 2.82 2.82 0 0 1 0 5.65m-47.3-1.83c0 16.68-16.35 16.59-16.94 16.59H99.53s-2.82 0-2.82-2.8 2.82-2.8 2.82-2.8l14.11-.05c.05 0 11.3.42 11.3-10.94s-11.2-11-11.3-11.01H91.07s-6.35.06-6.35 6.41c0 4.24 2.11 6.36 6.35 6.36H114s1.76.01 1.76-1.76-1.76-1.83-1.76-1.83l-22.94.06s-2.83 0-2.83-2.83 2.83-2.82 2.83-2.82h22.58s7.77-.35 7.77 7.42-7.76 7.4-7.76 7.4h-22.4s-12.2 0-12.2-12c0-11.99 12-11.99 12-11.99h22.6s16.94-.1 16.94 16.59\\\"></path></svg>\"","var map = {\n\t\"./about-icon.svg\": \"./resource/image/icon/about-icon.svg\",\n\t\"./add-participants-icon.svg\": \"./resource/image/icon/add-participants-icon.svg\",\n\t\"./animated-check-icon.svg\": \"./resource/image/icon/animated-check-icon.svg\",\n\t\"./archive-icon.svg\": \"./resource/image/icon/archive-icon.svg\",\n\t\"./arrow-down-long-icon.svg\": \"./resource/image/icon/arrow-down-long-icon.svg\",\n\t\"./arrow-left-icon.svg\": \"./resource/image/icon/arrow-left-icon.svg\",\n\t\"./arrow-next-icon.svg\": \"./resource/image/icon/arrow-next-icon.svg\",\n\t\"./attachment-icon.svg\": \"./resource/image/icon/attachment-icon.svg\",\n\t\"./audio-icon.svg\": \"./resource/image/icon/audio-icon.svg\",\n\t\"./av-icon.svg\": \"./resource/image/icon/av-icon.svg\",\n\t\"./availability-available-icon.svg\": \"./resource/image/icon/availability-available-icon.svg\",\n\t\"./availability-away-icon.svg\": \"./resource/image/icon/availability-away-icon.svg\",\n\t\"./availability-busy-icon.svg\": \"./resource/image/icon/availability-busy-icon.svg\",\n\t\"./block-icon.svg\": \"./resource/image/icon/block-icon.svg\",\n\t\"./camera-icon.svg\": \"./resource/image/icon/camera-icon.svg\",\n\t\"./camera-off-icon.svg\": \"./resource/image/icon/camera-off-icon.svg\",\n\t\"./check-icon.svg\": \"./resource/image/icon/check-icon.svg\",\n\t\"./chevron-icon.svg\": \"./resource/image/icon/chevron-icon.svg\",\n\t\"./chevron-right.svg\": \"./resource/image/icon/chevron-right.svg\",\n\t\"./close-icon.svg\": \"./resource/image/icon/close-icon.svg\",\n\t\"./conversations-folder-icon.svg\": \"./resource/image/icon/conversations-folder-icon.svg\",\n\t\"./conversations-recent-icon.svg\": \"./resource/image/icon/conversations-recent-icon.svg\",\n\t\"./copy-icon.svg\": \"./resource/image/icon/copy-icon.svg\",\n\t\"./delete-icon.svg\": \"./resource/image/icon/delete-icon.svg\",\n\t\"./desktop-icon.svg\": \"./resource/image/icon/desktop-icon.svg\",\n\t\"./devices-icon.svg\": \"./resource/image/icon/devices-icon.svg\",\n\t\"./disclose-icon.svg\": \"./resource/image/icon/disclose-icon.svg\",\n\t\"./edit-icon.svg\": \"./resource/image/icon/edit-icon.svg\",\n\t\"./ellipsis-icon.svg\": \"./resource/image/icon/ellipsis-icon.svg\",\n\t\"./eraser-icon.svg\": \"./resource/image/icon/eraser-icon.svg\",\n\t\"./exclamation-mark.svg\": \"./resource/image/icon/exclamation-mark.svg\",\n\t\"./external-icon.svg\": \"./resource/image/icon/external-icon.svg\",\n\t\"./federation-icon.svg\": \"./resource/image/icon/federation-icon.svg\",\n\t\"./file-icon.svg\": \"./resource/image/icon/file-icon.svg\",\n\t\"./fullscreen-icon.svg\": \"./resource/image/icon/fullscreen-icon.svg\",\n\t\"./gif-icon.svg\": \"./resource/image/icon/gif-icon.svg\",\n\t\"./group-admin-icon.svg\": \"./resource/image/icon/group-admin-icon.svg\",\n\t\"./group-icon.svg\": \"./resource/image/icon/group-icon.svg\",\n\t\"./guest-icon.svg\": \"./resource/image/icon/guest-icon.svg\",\n\t\"./hangup-icon.svg\": \"./resource/image/icon/hangup-icon.svg\",\n\t\"./image-icon.svg\": \"./resource/image/icon/image-icon.svg\",\n\t\"./info-icon.svg\": \"./resource/image/icon/info-icon.svg\",\n\t\"./leave-icon.svg\": \"./resource/image/icon/leave-icon.svg\",\n\t\"./like-icon.svg\": \"./resource/image/icon/like-icon.svg\",\n\t\"./link-icon.svg\": \"./resource/image/icon/link-icon.svg\",\n\t\"./loading-icon.svg\": \"./resource/image/icon/loading-icon.svg\",\n\t\"./location-icon.svg\": \"./resource/image/icon/location-icon.svg\",\n\t\"./logo-full-icon.svg\": \"./resource/image/icon/logo-full-icon.svg\",\n\t\"./logo-icon.svg\": \"./resource/image/icon/logo-icon.svg\",\n\t\"./markdown-icon.svg\": \"./resource/image/icon/markdown-icon.svg\",\n\t\"./mention-icon.svg\": \"./resource/image/icon/mention-icon.svg\",\n\t\"./message-icon.svg\": \"./resource/image/icon/message-icon.svg\",\n\t\"./message-unread-icon.svg\": \"./resource/image/icon/message-unread-icon.svg\",\n\t\"./mic-off-icon.svg\": \"./resource/image/icon/mic-off-icon.svg\",\n\t\"./mic-on-icon.svg\": \"./resource/image/icon/mic-on-icon.svg\",\n\t\"./minus-icon.svg\": \"./resource/image/icon/minus-icon.svg\",\n\t\"./mute-icon.svg\": \"./resource/image/icon/mute-icon.svg\",\n\t\"./not-verified-icon.svg\": \"./resource/image/icon/not-verified-icon.svg\",\n\t\"./notification-icon.svg\": \"./resource/image/icon/notification-icon.svg\",\n\t\"./options-icon.svg\": \"./resource/image/icon/options-icon.svg\",\n\t\"./partner-icon.svg\": \"./resource/image/icon/partner-icon.svg\",\n\t\"./pending-icon.svg\": \"./resource/image/icon/pending-icon.svg\",\n\t\"./people-icon.svg\": \"./resource/image/icon/people-icon.svg\",\n\t\"./pickup-icon.svg\": \"./resource/image/icon/pickup-icon.svg\",\n\t\"./ping-icon.svg\": \"./resource/image/icon/ping-icon.svg\",\n\t\"./plus-icon.svg\": \"./resource/image/icon/plus-icon.svg\",\n\t\"./profile-icon.svg\": \"./resource/image/icon/profile-icon.svg\",\n\t\"./read-icon.svg\": \"./resource/image/icon/read-icon.svg\",\n\t\"./reply-icon.svg\": \"./resource/image/icon/reply-icon.svg\",\n\t\"./screenshare-icon.svg\": \"./resource/image/icon/screenshare-icon.svg\",\n\t\"./screenshare-off-icon.svg\": \"./resource/image/icon/screenshare-off-icon.svg\",\n\t\"./send-icon.svg\": \"./resource/image/icon/send-icon.svg\",\n\t\"./service-icon.svg\": \"./resource/image/icon/service-icon.svg\",\n\t\"./settings-icon.svg\": \"./resource/image/icon/settings-icon.svg\",\n\t\"./speaker-icon.svg\": \"./resource/image/icon/speaker-icon.svg\",\n\t\"./timer-icon.svg\": \"./resource/image/icon/timer-icon.svg\",\n\t\"./undo-icon.svg\": \"./resource/image/icon/undo-icon.svg\",\n\t\"./verified-icon.svg\": \"./resource/image/icon/verified-icon.svg\",\n\t\"./watermark-icon.svg\": \"./resource/image/icon/watermark-icon.svg\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./resource/image/icon sync recursive .+\\\\.svg$\";","var map = {\n\t\"./about-icon\": \"./resource/image/icon/about-icon.svg\",\n\t\"./about-icon.svg\": \"./resource/image/icon/about-icon.svg\",\n\t\"./add-participants-icon\": \"./resource/image/icon/add-participants-icon.svg\",\n\t\"./add-participants-icon.svg\": \"./resource/image/icon/add-participants-icon.svg\",\n\t\"./animated-check-icon\": \"./resource/image/icon/animated-check-icon.svg\",\n\t\"./animated-check-icon.svg\": \"./resource/image/icon/animated-check-icon.svg\",\n\t\"./archive-icon\": \"./resource/image/icon/archive-icon.svg\",\n\t\"./archive-icon.svg\": \"./resource/image/icon/archive-icon.svg\",\n\t\"./arrow-down-long-icon\": \"./resource/image/icon/arrow-down-long-icon.svg\",\n\t\"./arrow-down-long-icon.svg\": \"./resource/image/icon/arrow-down-long-icon.svg\",\n\t\"./arrow-left-icon\": \"./resource/image/icon/arrow-left-icon.svg\",\n\t\"./arrow-left-icon.svg\": \"./resource/image/icon/arrow-left-icon.svg\",\n\t\"./arrow-next-icon\": \"./resource/image/icon/arrow-next-icon.svg\",\n\t\"./arrow-next-icon.svg\": \"./resource/image/icon/arrow-next-icon.svg\",\n\t\"./attachment-icon\": \"./resource/image/icon/attachment-icon.svg\",\n\t\"./attachment-icon.svg\": \"./resource/image/icon/attachment-icon.svg\",\n\t\"./audio-icon\": \"./resource/image/icon/audio-icon.svg\",\n\t\"./audio-icon.svg\": \"./resource/image/icon/audio-icon.svg\",\n\t\"./av-icon\": \"./resource/image/icon/av-icon.svg\",\n\t\"./av-icon.svg\": \"./resource/image/icon/av-icon.svg\",\n\t\"./availability-available-icon\": \"./resource/image/icon/availability-available-icon.svg\",\n\t\"./availability-available-icon.svg\": \"./resource/image/icon/availability-available-icon.svg\",\n\t\"./availability-away-icon\": \"./resource/image/icon/availability-away-icon.svg\",\n\t\"./availability-away-icon.svg\": \"./resource/image/icon/availability-away-icon.svg\",\n\t\"./availability-busy-icon\": \"./resource/image/icon/availability-busy-icon.svg\",\n\t\"./availability-busy-icon.svg\": \"./resource/image/icon/availability-busy-icon.svg\",\n\t\"./block-icon\": \"./resource/image/icon/block-icon.svg\",\n\t\"./block-icon.svg\": \"./resource/image/icon/block-icon.svg\",\n\t\"./camera-icon\": \"./resource/image/icon/camera-icon.svg\",\n\t\"./camera-icon.svg\": \"./resource/image/icon/camera-icon.svg\",\n\t\"./camera-off-icon\": \"./resource/image/icon/camera-off-icon.svg\",\n\t\"./camera-off-icon.svg\": \"./resource/image/icon/camera-off-icon.svg\",\n\t\"./check-icon\": \"./resource/image/icon/check-icon.svg\",\n\t\"./check-icon.svg\": \"./resource/image/icon/check-icon.svg\",\n\t\"./chevron-icon\": \"./resource/image/icon/chevron-icon.svg\",\n\t\"./chevron-icon.svg\": \"./resource/image/icon/chevron-icon.svg\",\n\t\"./chevron-right\": \"./resource/image/icon/chevron-right.svg\",\n\t\"./chevron-right.svg\": \"./resource/image/icon/chevron-right.svg\",\n\t\"./close-icon\": \"./resource/image/icon/close-icon.svg\",\n\t\"./close-icon.svg\": \"./resource/image/icon/close-icon.svg\",\n\t\"./conversations-folder-icon\": \"./resource/image/icon/conversations-folder-icon.svg\",\n\t\"./conversations-folder-icon.svg\": \"./resource/image/icon/conversations-folder-icon.svg\",\n\t\"./conversations-recent-icon\": \"./resource/image/icon/conversations-recent-icon.svg\",\n\t\"./conversations-recent-icon.svg\": \"./resource/image/icon/conversations-recent-icon.svg\",\n\t\"./copy-icon\": \"./resource/image/icon/copy-icon.svg\",\n\t\"./copy-icon.svg\": \"./resource/image/icon/copy-icon.svg\",\n\t\"./delete-icon\": \"./resource/image/icon/delete-icon.svg\",\n\t\"./delete-icon.svg\": \"./resource/image/icon/delete-icon.svg\",\n\t\"./desktop-icon\": \"./resource/image/icon/desktop-icon.svg\",\n\t\"./desktop-icon.svg\": \"./resource/image/icon/desktop-icon.svg\",\n\t\"./devices-icon\": \"./resource/image/icon/devices-icon.svg\",\n\t\"./devices-icon.svg\": \"./resource/image/icon/devices-icon.svg\",\n\t\"./disclose-icon\": \"./resource/image/icon/disclose-icon.svg\",\n\t\"./disclose-icon.svg\": \"./resource/image/icon/disclose-icon.svg\",\n\t\"./edit-icon\": \"./resource/image/icon/edit-icon.svg\",\n\t\"./edit-icon.svg\": \"./resource/image/icon/edit-icon.svg\",\n\t\"./ellipsis-icon\": \"./resource/image/icon/ellipsis-icon.svg\",\n\t\"./ellipsis-icon.svg\": \"./resource/image/icon/ellipsis-icon.svg\",\n\t\"./eraser-icon\": \"./resource/image/icon/eraser-icon.svg\",\n\t\"./eraser-icon.svg\": \"./resource/image/icon/eraser-icon.svg\",\n\t\"./exclamation-mark\": \"./resource/image/icon/exclamation-mark.svg\",\n\t\"./exclamation-mark.svg\": \"./resource/image/icon/exclamation-mark.svg\",\n\t\"./external-icon\": \"./resource/image/icon/external-icon.svg\",\n\t\"./external-icon.svg\": \"./resource/image/icon/external-icon.svg\",\n\t\"./federation-icon\": \"./resource/image/icon/federation-icon.svg\",\n\t\"./federation-icon.svg\": \"./resource/image/icon/federation-icon.svg\",\n\t\"./file-icon\": \"./resource/image/icon/file-icon.svg\",\n\t\"./file-icon.svg\": \"./resource/image/icon/file-icon.svg\",\n\t\"./fullscreen-icon\": \"./resource/image/icon/fullscreen-icon.svg\",\n\t\"./fullscreen-icon.svg\": \"./resource/image/icon/fullscreen-icon.svg\",\n\t\"./gif-icon\": \"./resource/image/icon/gif-icon.svg\",\n\t\"./gif-icon.svg\": \"./resource/image/icon/gif-icon.svg\",\n\t\"./group-admin-icon\": \"./resource/image/icon/group-admin-icon.svg\",\n\t\"./group-admin-icon.svg\": \"./resource/image/icon/group-admin-icon.svg\",\n\t\"./group-icon\": \"./resource/image/icon/group-icon.svg\",\n\t\"./group-icon.svg\": \"./resource/image/icon/group-icon.svg\",\n\t\"./guest-icon\": \"./resource/image/icon/guest-icon.svg\",\n\t\"./guest-icon.svg\": \"./resource/image/icon/guest-icon.svg\",\n\t\"./hangup-icon\": \"./resource/image/icon/hangup-icon.svg\",\n\t\"./hangup-icon.svg\": \"./resource/image/icon/hangup-icon.svg\",\n\t\"./image-icon\": \"./resource/image/icon/image-icon.svg\",\n\t\"./image-icon.svg\": \"./resource/image/icon/image-icon.svg\",\n\t\"./info-icon\": \"./resource/image/icon/info-icon.svg\",\n\t\"./info-icon.svg\": \"./resource/image/icon/info-icon.svg\",\n\t\"./leave-icon\": \"./resource/image/icon/leave-icon.svg\",\n\t\"./leave-icon.svg\": \"./resource/image/icon/leave-icon.svg\",\n\t\"./like-icon\": \"./resource/image/icon/like-icon.svg\",\n\t\"./like-icon.svg\": \"./resource/image/icon/like-icon.svg\",\n\t\"./link-icon\": \"./resource/image/icon/link-icon.svg\",\n\t\"./link-icon.svg\": \"./resource/image/icon/link-icon.svg\",\n\t\"./loading-icon\": \"./resource/image/icon/loading-icon.svg\",\n\t\"./loading-icon.svg\": \"./resource/image/icon/loading-icon.svg\",\n\t\"./location-icon\": \"./resource/image/icon/location-icon.svg\",\n\t\"./location-icon.svg\": \"./resource/image/icon/location-icon.svg\",\n\t\"./logo-full-icon\": \"./resource/image/icon/logo-full-icon.svg\",\n\t\"./logo-full-icon.svg\": \"./resource/image/icon/logo-full-icon.svg\",\n\t\"./logo-icon\": \"./resource/image/icon/logo-icon.svg\",\n\t\"./logo-icon.svg\": \"./resource/image/icon/logo-icon.svg\",\n\t\"./markdown-icon\": \"./resource/image/icon/markdown-icon.svg\",\n\t\"./markdown-icon.svg\": \"./resource/image/icon/markdown-icon.svg\",\n\t\"./mention-icon\": \"./resource/image/icon/mention-icon.svg\",\n\t\"./mention-icon.svg\": \"./resource/image/icon/mention-icon.svg\",\n\t\"./message-icon\": \"./resource/image/icon/message-icon.svg\",\n\t\"./message-icon.svg\": \"./resource/image/icon/message-icon.svg\",\n\t\"./message-unread-icon\": \"./resource/image/icon/message-unread-icon.svg\",\n\t\"./message-unread-icon.svg\": \"./resource/image/icon/message-unread-icon.svg\",\n\t\"./mic-off-icon\": \"./resource/image/icon/mic-off-icon.svg\",\n\t\"./mic-off-icon.svg\": \"./resource/image/icon/mic-off-icon.svg\",\n\t\"./mic-on-icon\": \"./resource/image/icon/mic-on-icon.svg\",\n\t\"./mic-on-icon.svg\": \"./resource/image/icon/mic-on-icon.svg\",\n\t\"./minus-icon\": \"./resource/image/icon/minus-icon.svg\",\n\t\"./minus-icon.svg\": \"./resource/image/icon/minus-icon.svg\",\n\t\"./mute-icon\": \"./resource/image/icon/mute-icon.svg\",\n\t\"./mute-icon.svg\": \"./resource/image/icon/mute-icon.svg\",\n\t\"./not-verified-icon\": \"./resource/image/icon/not-verified-icon.svg\",\n\t\"./not-verified-icon.svg\": \"./resource/image/icon/not-verified-icon.svg\",\n\t\"./notification-icon\": \"./resource/image/icon/notification-icon.svg\",\n\t\"./notification-icon.svg\": \"./resource/image/icon/notification-icon.svg\",\n\t\"./options-icon\": \"./resource/image/icon/options-icon.svg\",\n\t\"./options-icon.svg\": \"./resource/image/icon/options-icon.svg\",\n\t\"./partner-icon\": \"./resource/image/icon/partner-icon.svg\",\n\t\"./partner-icon.svg\": \"./resource/image/icon/partner-icon.svg\",\n\t\"./pending-icon\": \"./resource/image/icon/pending-icon.svg\",\n\t\"./pending-icon.svg\": \"./resource/image/icon/pending-icon.svg\",\n\t\"./people-icon\": \"./resource/image/icon/people-icon.svg\",\n\t\"./people-icon.svg\": \"./resource/image/icon/people-icon.svg\",\n\t\"./pickup-icon\": \"./resource/image/icon/pickup-icon.svg\",\n\t\"./pickup-icon.svg\": \"./resource/image/icon/pickup-icon.svg\",\n\t\"./ping-icon\": \"./resource/image/icon/ping-icon.svg\",\n\t\"./ping-icon.svg\": \"./resource/image/icon/ping-icon.svg\",\n\t\"./plus-icon\": \"./resource/image/icon/plus-icon.svg\",\n\t\"./plus-icon.svg\": \"./resource/image/icon/plus-icon.svg\",\n\t\"./profile-icon\": \"./resource/image/icon/profile-icon.svg\",\n\t\"./profile-icon.svg\": \"./resource/image/icon/profile-icon.svg\",\n\t\"./read-icon\": \"./resource/image/icon/read-icon.svg\",\n\t\"./read-icon.svg\": \"./resource/image/icon/read-icon.svg\",\n\t\"./reply-icon\": \"./resource/image/icon/reply-icon.svg\",\n\t\"./reply-icon.svg\": \"./resource/image/icon/reply-icon.svg\",\n\t\"./screenshare-icon\": \"./resource/image/icon/screenshare-icon.svg\",\n\t\"./screenshare-icon.svg\": \"./resource/image/icon/screenshare-icon.svg\",\n\t\"./screenshare-off-icon\": \"./resource/image/icon/screenshare-off-icon.svg\",\n\t\"./screenshare-off-icon.svg\": \"./resource/image/icon/screenshare-off-icon.svg\",\n\t\"./send-icon\": \"./resource/image/icon/send-icon.svg\",\n\t\"./send-icon.svg\": \"./resource/image/icon/send-icon.svg\",\n\t\"./service-icon\": \"./resource/image/icon/service-icon.svg\",\n\t\"./service-icon.svg\": \"./resource/image/icon/service-icon.svg\",\n\t\"./settings-icon\": \"./resource/image/icon/settings-icon.svg\",\n\t\"./settings-icon.svg\": \"./resource/image/icon/settings-icon.svg\",\n\t\"./speaker-icon\": \"./resource/image/icon/speaker-icon.svg\",\n\t\"./speaker-icon.svg\": \"./resource/image/icon/speaker-icon.svg\",\n\t\"./timer-icon\": \"./resource/image/icon/timer-icon.svg\",\n\t\"./timer-icon.svg\": \"./resource/image/icon/timer-icon.svg\",\n\t\"./undo-icon\": \"./resource/image/icon/undo-icon.svg\",\n\t\"./undo-icon.svg\": \"./resource/image/icon/undo-icon.svg\",\n\t\"./verified-icon\": \"./resource/image/icon/verified-icon.svg\",\n\t\"./verified-icon.svg\": \"./resource/image/icon/verified-icon.svg\",\n\t\"./watermark-icon\": \"./resource/image/icon/watermark-icon.svg\",\n\t\"./watermark-icon.svg\": \"./resource/image/icon/watermark-icon.svg\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./resource/image/icon sync recursive ^\\\\.\\\\/.*$\";","var map = {\n\t\"./ar-SA.json\": \"./src/i18n/ar-SA.json\",\n\t\"./bn-BD.json\": \"./src/i18n/bn-BD.json\",\n\t\"./ca-ES.json\": \"./src/i18n/ca-ES.json\",\n\t\"./cs-CZ.json\": \"./src/i18n/cs-CZ.json\",\n\t\"./da-DK.json\": \"./src/i18n/da-DK.json\",\n\t\"./de-DE.json\": \"./src/i18n/de-DE.json\",\n\t\"./el-GR.json\": \"./src/i18n/el-GR.json\",\n\t\"./en-US.json\": \"./src/i18n/en-US.json\",\n\t\"./es-ES.json\": \"./src/i18n/es-ES.json\",\n\t\"./et-EE.json\": \"./src/i18n/et-EE.json\",\n\t\"./fa-IR.json\": \"./src/i18n/fa-IR.json\",\n\t\"./fi-FI.json\": \"./src/i18n/fi-FI.json\",\n\t\"./fr-FR.json\": \"./src/i18n/fr-FR.json\",\n\t\"./ga-IE.json\": \"./src/i18n/ga-IE.json\",\n\t\"./he-IL.json\": \"./src/i18n/he-IL.json\",\n\t\"./hi-IN.json\": \"./src/i18n/hi-IN.json\",\n\t\"./hr-HR.json\": \"./src/i18n/hr-HR.json\",\n\t\"./hu-HU.json\": \"./src/i18n/hu-HU.json\",\n\t\"./id-ID.json\": \"./src/i18n/id-ID.json\",\n\t\"./is-IS.json\": \"./src/i18n/is-IS.json\",\n\t\"./it-IT.json\": \"./src/i18n/it-IT.json\",\n\t\"./ja-JP.json\": \"./src/i18n/ja-JP.json\",\n\t\"./lt-LT.json\": \"./src/i18n/lt-LT.json\",\n\t\"./lv-LV.json\": \"./src/i18n/lv-LV.json\",\n\t\"./ms-MY.json\": \"./src/i18n/ms-MY.json\",\n\t\"./nl-NL.json\": \"./src/i18n/nl-NL.json\",\n\t\"./no-NO.json\": \"./src/i18n/no-NO.json\",\n\t\"./pl-PL.json\": \"./src/i18n/pl-PL.json\",\n\t\"./pt-BR.json\": \"./src/i18n/pt-BR.json\",\n\t\"./pt-PT.json\": \"./src/i18n/pt-PT.json\",\n\t\"./ro-RO.json\": \"./src/i18n/ro-RO.json\",\n\t\"./ru-RU.json\": \"./src/i18n/ru-RU.json\",\n\t\"./si-LK.json\": \"./src/i18n/si-LK.json\",\n\t\"./sk-SK.json\": \"./src/i18n/sk-SK.json\",\n\t\"./sl-SI.json\": \"./src/i18n/sl-SI.json\",\n\t\"./sr-SP.json\": \"./src/i18n/sr-SP.json\",\n\t\"./sv-SE.json\": \"./src/i18n/sv-SE.json\",\n\t\"./th-TH.json\": \"./src/i18n/th-TH.json\",\n\t\"./tr-TR.json\": \"./src/i18n/tr-TR.json\",\n\t\"./uk-UA.json\": \"./src/i18n/uk-UA.json\",\n\t\"./uz-UZ.json\": \"./src/i18n/uz-UZ.json\",\n\t\"./vi-VN.json\": \"./src/i18n/vi-VN.json\",\n\t\"./zh-CN.json\": \"./src/i18n/zh-CN.json\",\n\t\"./zh-HK.json\": \"./src/i18n/zh-HK.json\",\n\t\"./zh-TW.json\": \"./src/i18n/zh-TW.json\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./src/i18n sync recursive ^\\\\.\\\\/.*\\\\.json$\";","module.exports = {};"],"names":["exports","VerificationActionType","env","window","wire","ACCENT_ID","AMBER","BLUE","GREEN","PURPLE","RED","TURQUOISE","Configuration","APP_BASE","APP_NAME","createRandomUuid","BACKEND_NAME","BACKEND_REST","BACKEND_WS","BRAND_NAME","COUNTLY_API_KEY","ENABLE_DEV_BACKEND_API","ENVIRONMENT","FEATURE","ENABLE_EXTRA_CLIENT_ENTROPY","Runtime","FORCE_EXTRA_CLIENT_ENTROPY","MAX_GROUP_PARTICIPANTS","MAX_VIDEO_PARTICIPANTS","NEW_PASSWORD_MINIMUM_LENGTH","ValidationUtil","ACCOUNT_BASE","MOBILE_BASE","PRICING","PRIVACY_POLICY","SUPPORT","BUG_REPORT","CALLING","CAMERA_ACCESS_DENIED","CONTACT","DEVICE_ACCESS_DENIED","DEVICE_NOT_FOUND","EMAIL_EXISTS","HISTORY","INDEX","LEGAL_HOLD_BLOCK","MICROPHONE_ACCESS_DENIED","PRIVACY_VERIFY_FINGERPRINT","SCREEN_ACCESS_DENIED","TEAMS_BASE","TEAMS_BILLING","TEAMS_CREATE","TERMS_OF_USE_PERSONAL","TERMS_OF_USE_TEAMS","WEBSITE_BASE","WHATS_NEW","URL","VERSION","WEBSITE_LABEL","instance","Config","getConfig","decryptAesAsset","cipherText","keyBytes","referenceSha256","computedSha256","crypto","subtle","digest","equalHashes","Error","aesKey","importKey","initializationVector","slice","assetCipherText","decrypt","iv","name","bufferA","bufferB","arrayA","Uint32Array","arrayB","length","every","value","index","AssetRemoteData","constructor","identifier","urlData","otrKey","sha256","this","downloadProgress","ko","cancelDownload","static","assetKey","assetDomain","assetToken","baseProperties","forceCaching","version","conversationId","assetId","cache","Map","getAssetUrl","get","AssetRepository","singleton","assetService","container","AssetService","core","Core","logger","getLogger","assetCoreService","service","asset","getObjectUrl","objectUrl","blob","load","url","createObjectURL","set","setAssetUrl","plaintext","buffer","mimeType","loadBuffer","Uint8Array","from","Object","values","Blob","type","error","isAssetNotFound","message","endsWith","HTTP_STATUS","isServerError","generateAssetUrl","generateAssetUrlV3","generateAssetUrlV2","request","downloadAsset","fraction","cancel","response","download","fileName","downloadBlob","downloadFile","status","AssetTransferState","original_resource","file_name","uploadProfileImage","image","compressedBytes","previewImage","mediumImage","Promise","all","compressImage","options","expectsReadConfirmation","public","retention","AssetRetentionPolicy","previewImageKey","mediumImageKey","uploadRawAsset","useProfileImageSize","skipCompression","loadFileBuffer","worker","WebWorker","post","compressedImage","loadImage","getAssetRetention","userEntity","conversationEntity","isTeamMember","inTeam","isTeamConversation","isTeamUserInConversation","participating_user_ets","some","conversationParticipant","uploadFile","file","messageId","onCancel","bytes","progressObservable","uploadProgressQueue","push","progress","uploadAsset","Buffer","domain","uploadCancelTokens","removeFromUploadQueue","cancelUpload","cancelToken","getNumberOfOngoingUploads","getUploadProgress","findUploadStatus","find","upload","filter","apiClient","APIClient","legacyAsset","path","isValidApiPath","config","urls","rest","cachingParam","conversationIdParam","encodeURIComponent","accessToken","access_token","assetV3","assetTokenParam","downloadAssetV1","progressCallback","api","getAssetV1","downloadAssetV2","getAssetV2","downloadAssetV3","token","getAssetV3","AssetType","SIGN_OUT_REASON","URLParameter","supportedLocales","DEFAULT_CURRENCY","SupportedCurrency","DEFAULT_LANGUAGE","currentLanguage","mapLanguage","UrlUtil","QUERY_KEY","navigator","languages","language","currentCurrency","toUpperCase","normalizeLanguage","LANGUAGE_SHORTHAND_LENGTH","substring","findLanguage","Locales","locale","startsWith","batch","callback","getBatch","createContext","useSyncExternalStoreWithSelector","_excluded","pureFinalPropsSelectorFactory","mapStateToProps","mapDispatchToProps","mergeProps","dispatch","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","state","ownProps","stateProps","dispatchProps","mergedProps","hasRunAtLeastOnce","handleSubsequentCalls","nextState","nextOwnProps","propsChanged","stateChanged","dependsOnOwnProps","nextStateProps","statePropsChanged","handleNewState","wrapMapToPropsConstant","getConstant","constant","constantSelector","getDependsOnOwnProps","mapToProps","Boolean","wrapMapToPropsFunc","methodName","displayName","proxy","stateOrDispatch","undefined","props","createInvalidArgFactory","arg","wrappedComponentName","defaultMergeProps","nullListeners","notify","createSubscription","store","parentSub","unsubscribe","listeners","handleChangeWrapper","subscription","onStateChange","trySubscribe","addNestedSub","subscribe","first","last","clear","listener","next","isSubscribed","prev","createListenerCollection","notifyNestedSubs","tryUnsubscribe","getListeners","useIsomorphicLayoutEffect","document","createElement","useLayoutEffect","useEffect","is","x","y","shallowEqual","objA","objB","keysA","keys","keysB","i","prototype","hasOwnProperty","call","useSyncExternalStore","NO_SUBSCRIPTION_ARRAY","captureWrapperProps","lastWrapperProps","lastChildProps","renderIsScheduled","wrapperProps","childPropsFromStoreUpdate","current","strictEqual","a","b","pure","areMergedPropsEqual","forwardRef","context","Context","initMapStateToProps","mapStateToPropsFactory","initMapDispatchToProps","actionCreators","boundActionCreators","key","actionCreator","args","bindActionCreators","mapDispatchToPropsFactory","initMergeProps","hasRunOnce","nextMergedProps","wrapMergePropsFunc","mergePropsFactory","shouldHandleStateChanges","WrappedComponent","selectorFactoryOptions","ConnectFunction","propsContext","reactReduxForwardedRef","useMemo","ContextToUse","Consumer","isContextConsumer","contextValue","useContext","didStoreComeFromProps","getState","didStoreComeFromContext","getServerState","childPropsSelector","_ref","bind","overriddenContextValue","useRef","isMounted","latestSubscriptionCallbackError","actualChildPropsSelector","subscribeForReact","reactListener","additionalSubscribeListener","didUnsubscribe","lastThrownError","checkForUpdates","latestStoreState","newChildProps","e","subscribeUpdates","effectFunc","effectArgs","dependencies","actualChildProps","err","stack","renderedWrappedComponent","ref","Provider","Connect","forwarded","children","serverState","previousState","fn","newBatch","initializeConnect","amplify","jQuery","$","createThunkMiddleware","extraArgument","action","thunk","withExtraArgument","AUTH_ACTION","CLIENT_ACTION","CONVERSATION_ACTION","INVITATION_ACTION","LANGUAGE_ACTION","LOCAL_STORAGE_ACTION","RUNTIME_ACTION","SELF_ACTION","USER_ACTION","AuthActionCreator","LOGIN_START","LOGIN_SUCCESS","LOGIN_FAILED","SEND_PHONE_LOGIN_CODE_START","expiresIn","payload","SEND_PHONE_LOGIN_CODE_SUCCESS","SEND_PHONE_LOGIN_CODE_FAILED","SEND_TWO_FACTOR_CODE_START","SEND_TWO_FACTOR_CODE_SUCCESS","SEND_TWO_FACTOR_CODE_FAILED","REGISTER_TEAM_START","authData","REGISTER_TEAM_SUCCESS","REGISTER_TEAM_FAILED","REGISTER_PERSONAL_START","REGISTER_PERSONAL_SUCCESS","REGISTER_PERSONAL_FAILED","REGISTER_WIRELESS_START","REGISTER_WIRELESS_SUCCESS","REGISTER_WIRELESS_FAILED","REGISTER_JOIN_START","REGISTER_JOIN_SUCCESS","REGISTER_JOIN_FAILED","REFRESH_START","REFRESH_SUCCESS","REFRESH_FAILED","GET_SSO_SETTINGS_START","ssoSettings","GET_SSO_SETTINGS_SUCCESS","GET_SSO_SETTINGS_FAILED","LOGOUT_SUCCESS","LOGOUT_FAILED","SILENT_LOGOUT_SUCCESS","SILENT_LOGOUT_FAILED","AUTH_RESET_ERROR","REGISTER_RESET_ACCOUNT_DATA","accountData","REGISTER_PUSH_ACCOUNT_DATA","entropy","REGISTER_PUSH_ENTROPY_DATA","loginData","PUSH_LOGIN_DATA","RESET_LOGIN_DATA","ENTER_TEAM_CREATION_FLOW","ENTER_PERSONAL_CREATION_FLOW","ENTER_GENERIC_INVITATION_FLOW","ClientActionCreator","CLIENTS_FETCH_START","clients","CLIENTS_FETCH_SUCCESS","CLIENTS_FETCH_FAILED","CLIENT_REMOVE_START","deletedClientId","CLIENT_REMOVE_SUCCESS","CLIENT_REMOVE_FAILED","creationStatus","CLIENT_INIT_SUCCESS","CLIENT_RESET_ERROR","ConversationActionCreator","CONVERSATION_CODE_CHECK_START","CONVERSATION_CODE_CHECK_SUCCESS","CONVERSATION_CODE_CHECK_FAILED","CONVERSATION_CODE_JOIN_START","data","CONVERSATION_CODE_JOIN_SUCCESS","CONVERSATION_CODE_JOIN_FAILED","InvitationActionCreator","INVITE_ADD_START","invite","INVITE_ADD_SUCCESS","INVITE_ADD_FAILED","INVITE_RESET_ERROR","LanguageActionCreator","SWITCH_LANGUAGE_START","SWITCH_LANGUAGE_SUCCESS","SWITCH_LANGUAGE_FAILED","LocalStorageActionCreator","LOCAL_STORAGE_SET_START","LOCAL_STORAGE_SET_SUCCESS","LOCAL_STORAGE_SET_FAILED","LOCAL_STORAGE_GET_START","LOCAL_STORAGE_GET_SUCCESS","LOCAL_STORAGE_GET_FAILED","LOCAL_STORAGE_DELETE_START","LOCAL_STORAGE_DELETE_SUCCESS","LOCAL_STORAGE_DELETE_FAILED","RuntimeActionCreator","RUNTIME_CHECK_INDEXEDDB_START","result","RUNTIME_CHECK_INDEXEDDB_FINISH","RUNTIME_CHECK_COOKIE_START","RUNTIME_CHECK_COOKIE_FINISH","RUNTIME_CONFIRM_SUPPORTED_BROWSER","SelfActionCreator","HANDLE_SET_START","selfUser","HANDLE_SET_SUCCESS","HANDLE_SET_FAILED","SELF_SET_PASSWORD_STATE_START","hasPassword","SELF_SET_PASSWORD_STATE_SUCCESS","SELF_SET_PASSWORD_STATE_FAILED","SELF_FETCH_START","SELF_FETCH_SUCCESS","SELF_FETCH_FAILED","CONSENT_GET_START","consents","CONSENT_GET_SUCCESS","CONSENT_GET_FAILED","CONSENT_SET_START","consent","CONSENT_SET_SUCCESS","CONSENT_SET_FAILED","SELF_SET_EMAIL_START","email","SELF_SET_EMAIL_SUCCESS","SELF_SET_EMAIL_FAILED","SELF_SET_PASSWORD_START","SELF_SET_PASSWORD_SUCCESS","SELF_SET_PASSWORD_FAILED","UserActionCreator","USER_SEND_ACTIVATION_CODE_START","USER_SEND_ACTIVATION_CODE_SUCCESS","USER_SEND_ACTIVATION_CODE_FAILED","isChecking","runtimeState","isCheckingIndexedDb","isCheckingCookie","hasIndexedDbSupport","hasCookieSupport","isSupportedBrowser","hasToUseDesktopApplication","ENABLE_ENFORCE_DESKTOP_APPLICATION_ONLY","getSearchParams","additionalParams","whitelistParams","FORWARDED_QUERY_KEYS","searchParams","location","search","replace","split","searchParam","paramName","includes","entries","forEach","query","join","pathWithParams","params","runtimeAction","pwaAware","parameterName","map","parameter","isPwaEnabled","RuntimeSelector","confirmSupportedBrowser","actions","startCheckIndexedDb","finishCheckIndexedDb","startCheckCookie","finishCheckCookie","cookieName","resolve","reject","cookieEnabled","Cookies","supportIndexedDb","indexedDB","dbOpenRequest","open","connectionTimeout","setTimeout","onerror","event","clearTimeout","preventDefault","onsuccess","REGISTER_FLOW","unsetRegistrationData","accent_id","assets","email_code","invitation_code","label","password","phone","phone_code","team","termsAccepted","unsetTeam","creator","icon","id","isAuthenticated","authState","isFetching","fetching","isSendingTwoFactorCode","isFetchingSSOSettings","fetchingSSOSettings","getDefaultSSOCode","default_sso_code","hasDefaultSSOCode","getError","getLoginData","getCurrentFlow","currentFlow","getEntropy","getAccount","account","getAccountTeamName","getAccountTeam","isPersonalFlow","isTeamFlow","initialAuthState","fetched","clientType","DEFAULT_LOGIN_TEMPORARY_CLIENT","ClientType","initialClientState","currentClient","isNewClient","initialConversationState","initialInvitationState","invites","initialLanguageState","initialRuntimeState","initialSelfState","self","bindActionCreatorsRedux","reducers","clientState","client","isNew","conversationState","inviteState","languageState","selfState","reduce","consentAccumulator","reduxLogdown","require","createMiddleware","thunkArguments","middlewares","LOGGER_NAMESPACE","diff","composeWithDevTools","applyMiddleware","BackendError","super","code","BLACKLISTED_EMAIL","BLACKLISTED_PHONE","CODE_AUTHENTICATION_FAILED","CODE_AUTHENTICATION_REQUIRED","DOMAIN_BLOCKED_FOR_REGISTRATION","INVALID_CODE","INVALID_CREDENTIALS","INVALID_EMAIL","INVALID_INVITATION_CODE","INVALID_PHONE","KEY_EXISTS","MISSING_AUTH","PASSWORD_EXISTS","PENDING_ACTIVATION","PENDING_LOGIN","SUSPENDED","TOO_MANY_LOGINS","TOO_MANY_CLIENTS","CONVERSATION_CODE_NOT_FOUND","CONVERSATION_NOT_FOUND","CONVERSATION_TOO_MANY_MEMBERS","ACCESS_DENIED","BAD_REQUEST","INVALID_OPERATION","INVALID_PAYLOAD","NOT_FOUND","OPERATION_DENIED","TOO_MANY_REQUESTS","UNAUTHORIZED","HANDLE_EXISTS","HANDLE_TOO_SHORT","INVALID_HANDLE","NO_OTHER_OWNER","NO_TEAM","NO_TEAM_MEMBER","TOO_MANY_MEMBERS","ALREADY_INVITED","EXPIRED_CARD","SSO_FORBIDDEN","SSO_GENERIC_ERROR","SSO_INSUFFICIENT_PERMISSIONS","SSO_INVALID_FAILURE_REDIRECT","SSO_INVALID_SUCCESS_REDIRECT","SSO_INVALID_UPSTREAM","SSO_INVALID_USERNAME","SSO_NOT_FOUND","SSO_NO_MATCHING_AUTH","SSO_SERVER_ERROR","SSO_UNSUPPORTED_SAML","SSO_USER_CANCELLED_ERROR","AUTH_ERRORS","CONVERSATION_ERRORS","GENERAL_ERRORS","CLIENT_ERRORS","HANDLE_ERRORS","TEAM_ERRORS","TEAM_INVITE_ERRORS","PAYMENT_ERRORS","SSO_ERRORS","LabeledError","messageOrError","LOW_DISK_SPACE","LocalStorageKey","COOKIE_LABEL","LOGIN_CONVERSATION_KEY","PERSIST","localStorageAction","localStorage","startLocalStorageSet","setItem","JSON","stringify","successfulLocalStorageSet","failedLocalStorageSet","startLocalStorageGet","parse","getItem","successfulLocalStorageGet","failedLocalStorageGet","startLocalStorageDelete","removeItem","successfulLocalStorageDelete","failedLocalStorageDelete","authAction","storeEngine","SQLeetEngine","save","onBeforeLogin","doSilentLogout","doLoginPlain","uri","onAfterLogin","conversationAction","conversation","doJoinConversationByCode","qualified_conversation","setLocalStorage","global","clientAction","selfAction","startLogin","entropyData","login","persistClientData","fetchSelf","loadClient","doInitializeClient","String","verificationCode","successfulLogin","LABEL","LowDiskSpaceError","failedLogin","loginRequest","startSendPhoneLoginCode","expires_in","auth","postLoginSend","successfulSendPhoneLoginCode","failedSendPhoneLoginCode","startSendTwoFactorCode","user","postVerificationCode","successfulSendTwoFactorCode","failedSendTwoFactorCode","init","headInitiateLogin","mappedError","statusCode","mapError","persist","registration","pushAccountRegistrationData","pushLoginData","pushEntropyData","trim","currency","startRegisterTeam","register","successfulRegisterTeam","failedRegisterTeam","startRegisterPersonal","successfulRegisterPersonal","failedRegisterPersonal","registrationData","shouldInitializeClient","startRegisterWireless","doFlushDatabase","successfulRegisterWireless","failedRegisterWireless","isImmediateLogin","shouldValidateLocalClient","startRefresh","getLocalStorage","successfulRefresh","doLogout","deleteClientType","deleteLocalStorage","failedRefresh","getDomain","startGetSSOSettings","getSSOSettings","successfulGetSSOSettings","failedGetSSOSettings","logout","isTemporaryClientAndNonPersistent","reload","successfulLogout","failedLogout","successfulSilentLogout","enterPersonalCreationFlow","enterTeamCreationFlow","enterGenericInviteCreationFlow","resetError","capitalize","text","charAt","startGetAllClients","getClients","successfulGetAllClients","failedGetAllClients","clientId","startRemoveClient","deleteClient","successfulRemoveClient","failedRemoveClient","localClient","initClient","registerClient","generateClientPayload","successfulInitializeClient","deviceLabel","deviceModel","StringUtil","classification","ClientClassification","cookieLabel","model","startConversationCodeCheck","postConversationCodeCheck","successfulConversationCodeCheck","failedConversationCodeCheck","startJoinConversationByCode","conversationEvent","postJoinByCode","successfulJoinConversationByCode","failedJoinConversationByCode","getInvites","getLanguage","unsetSelf","expires_at","handle","sso_id","getSelf","getSelfName","hasSelfHandle","getSelfHandle","hasSelfEmail","getSelfEmail","hasSelfPassword","isSSOUser","isNoPasswordSSO","subject","isTemporaryGuest","hasUnsetConsent","consentType","CHECK_CONSENT","getConsents","getConsent","invitationAction","invitation","startAddInvite","inviteList","InviteSelector","invitationEmail","toLowerCase","inviteItem","failedAddInvite","newInvite","inviter_name","selfSelector","languageSelector","role","Role","teamId","createdInvite","teams","postInvitation","successfulAddInvite","navigationAction","assign","notificationAction","lastEventDate","notification","setLastEventDate","WebSocketAction","listen","dryRun","onEvent","USER_EVENT","SelfSelector","startFetchSelf","doCheckPasswordState","successfulFetchSelf","failedFetchSelf","startSetHandle","putHandle","successfulSetHandle","failedSetHandle","warn","startGetConsents","results","successfulGetConsents","failedGetConsents","startSetConsent","source","Environment","putConsent","successfulSetConsent","failedSetConsent","changePassword","startSetSelfPassword","putPassword","successfulSetSelfPassword","failedSetSelfPassword","startSetSelfEmail","putEmail","successfulSetSelfEmail","failedSetSelfEmail","startSetPasswordState","headPassword","successfulSetPasswordState","failedSetPasswordState","userAction","handles","availableHandle","postHandles","return","startSendActivationCode","postActivationCode","successfulSendActivationCode","failedSendActivationCode","WrapperChangeEnvironmentEvent","CustomEvent","WebAppEvents","detail","wrapperEventAction","dispatchEvent","actionRoot","extendStatics","d","setPrototypeOf","__proto__","Array","p","__extends","TypeError","__","create","t","s","n","arguments","apply","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","pack","ar","l","concat","IntlContext","ErrorKind","TYPE","SKELETON_TYPE","condition","Err","isLiteralElement","el","literal","isArgumentElement","argument","isNumberElement","number","isDateElement","date","isTimeElement","time","isSelectElement","select","isPluralElement","plural","isPoundElement","pound","isTagElement","tag","isNumberSkeleton","isDateTimeSkeleton","dateTime","SPACE_SEPARATOR_REGEX","DATE_TIME_REGEX","parseDateTimeSkeleton","skeleton","match","len","era","year","RangeError","month","day","weekday","hour12","hourCycle","hour","minute","second","timeZoneName","FRACTION_PRECISION_REGEX","SIGNIFICANT_PRECISION_REGEX","INTEGER_WIDTH_REGEX","CONCISE_INTEGER_WIDTH_REGEX","parseSignificantPrecision","str","roundingPriority","_","g1","g2","minimumSignificantDigits","maximumSignificantDigits","parseSign","signDisplay","currencySign","parseConciseScientificAndEngineeringStem","stem","notation","test","minimumIntegerDigits","parseNotationOptions","opt","signOpts","parseNumberSkeleton","tokens","_i","tokens_1","style","scale","useGrouping","maximumFractionDigits","unit","compactDisplay","currencyDisplay","unitDisplay","parseFloat","g3","g4","g5","minimumFractionDigits","trailingZeroDisplay","conciseScientificAndEngineeringOpts","_a","timeData","getDefaultHourSymbolFromLocale","hourCycles","regionTag","languageTag","maximize","region","SPACE_SEPARATOR_START_REGEX","RegExp","SPACE_SEPARATOR_END_REGEX","createLocation","start","end","hasNativeStartsWith","hasNativeFromCodePoint","fromCodePoint","hasNativeFromEntries","fromEntries","hasNativeCodePointAt","codePointAt","hasTrimStart","trimStart","hasTrimEnd","trimEnd","isSafeInteger","Number","isFinite","Math","floor","abs","REGEX_SUPPORTS_U_AND_Y","RE","exec","matchIdentifierAtIndex","position","codePoints","elements","fromCharCode","obj","entries_1","k","v","size","charCodeAt","flag","IDENTIFIER_PREFIX_RE_1","lastIndex","c","_isWhiteSpace","_isPatternSyntax","Parser","offset","line","column","ignoreTag","requiresOtherClause","shouldParseSkeletons","parseMessage","nestingLevel","parentArgType","expectingCloseTag","isEOF","char","parseArgument","val","peek","UNMATCHED_CLOSING_TAG","clonePosition","_isAlpha","parseTag","parseLiteral","bump","startPosition","tagName","parseTagName","bumpSpace","bumpIf","childrenResult","endTagStartPosition","INVALID_TAG","closingTagNameStartPosition","UNCLOSED_TAG","startOffset","parseQuoteResult","tryParseQuote","parseUnquotedResult","tryParseUnquoted","parseLeftAngleResult","tryParseLeftAngleBracket","codepoint","ch","openingBracePosition","EXPECT_ARGUMENT_CLOSING_BRACE","EMPTY_ARGUMENT","parseIdentifierIfPossible","MALFORMED_ARGUMENT","parseArgumentOptions","startingPosition","endOffset","bumpTo","typeStartPosition","argType","typeEndPosition","EXPECT_ARGUMENT_TYPE","styleAndLocation","styleStartPosition","parseSimpleArgStyleIfPossible","EXPECT_ARGUMENT_STYLE","styleLocation","argCloseResult","tryParseArgumentClose","location_1","parseNumberSkeletonFromString","EXPECT_DATE_TIME_SKELETON","dateTimePattern","skeletonCopy","patternPos","patternChar","extraLength","hourLen","dayPeriodLen","hourChar","getBestPattern","pattern","parsedOptions","typeEndPosition_1","EXPECT_SELECT_ARGUMENT_OPTIONS","identifierAndLocation","pluralOffset","EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE","tryParseDecimalInteger","INVALID_PLURAL_ARGUMENT_OFFSET_VALUE","optionsResult","tryParsePluralOrSelectOptions","location_2","pluralType","INVALID_ARGUMENT_TYPE","nestedBraces","apostrophePosition","bumpUntil","UNCLOSED_QUOTE_IN_ARGUMENT_STYLE","stringTokens_1","stemAndOptions","options_1","INVALID_NUMBER_SKELETON","expectCloseTag","parsedFirstIdentifier","hasOtherClause","parsedSelectors","Set","selector","selectorLocation","EXPECT_PLURAL_ARGUMENT_SELECTOR","INVALID_PLURAL_ARGUMENT_SELECTOR","has","DUPLICATE_SELECT_ARGUMENT_SELECTOR","DUPLICATE_PLURAL_ARGUMENT_SELECTOR","EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT","EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT","fragmentResult","add","EXPECT_SELECT_ARGUMENT_SELECTOR","MISSING_OTHER_CLAUSE","expectNumberError","invalidNumberError","sign","hasDigits","decimal","kind","prefix","currentOffset","targetOffset","min","nextCode","pruneLocation","els","opts","SyntaxError","originalMessage","captureLocation","memoize","cacheDefault","serializer","serializerDefault","strategy","strategyDefault","monadic","cacheKey","computedValue","variadic","assemble","serialize","ObjectWithoutPrototypeCache","ErrorCode","strategies","PART_TYPE","FormatError","_super","msg","_this","toString","InvalidValueError","variableId","INVALID_VALUE","InvalidValueTypeError","MissingValueError","MISSING_VALUE","isFormatXMLElementFn","formatToParts","locales","formatters","formats","currentPluralValue","els_1","getNumberFormat","format","varName","object","getDateTimeFormat","medium","value_1","formatFn","chunks","isArray","other","Intl","PluralRules","MISSING_INTL_API","rule","getPluralRules","parts","part","lastPart","mergeLiteral","mergeConfigs","defaultConfig","configs","c1","c2","createFastMemoizeCache","IntlErrorCode","IntlMessageFormat","overrideFormats","defaultLocale","formatterCache","pluralRules","ast","resolvedOptions","resolvedLocale","NumberFormat","supportedLocalesOf","getAst","resolveLocale","__parse","DateTimeFormat","defineProperty","memoizedDefaultLocale","enumerable","configurable","Locale","integer","percent","short","long","full","IntlError","exception","captureStackTrace","UnsupportedFormatterError","UNSUPPORTED_FORMATTER","InvalidConfigError","INVALID_CONFIG","MissingDataError","MISSING_DATA","IntlFormatError","FORMAT_ERROR","MessageFormatError","descriptor","defaultMessage","description","MissingTranslationError","MISSING_TRANSLATION","filterProps","allowlist","defaults","filtered","DEFAULT_INTL_CONFIG","messages","timeZone","defaultFormats","fallbackOnEmptyString","onError","onWarn","warning","getNamedFormat","formatType","intl","textComponent","aKeys","bKeys","setTimeZoneInOptions","deepMergeOptions","opts1","opts2","deepMergeFormatsAndSetTimeZone","f1","mfFormats","formatMessage","messageDescriptor","defaultRichTextElements","msgId","getMessageFormat","NUMBER_FORMAT_OPTIONS","getFormatter","formatNumber","formatNumberToParts","RELATIVE_TIME_FORMAT_OPTIONS","formatRelativeTime","getRelativeTimeFormat","RelativeTimeFormat","DATE_TIME_FORMAT_OPTIONS","filteredOptions","timeStyle","dateStyle","formatDate","_b","Date","formatTime","formatDateTimeRange","formatRange","formatDateToParts","formatTimeToParts","PLURAL_FORMAT_OPTIONS","formatPlural","LIST_FORMAT_OPTIONS","now","formatList","getListFormat","formatListToParts","ListFormat","richValues_1","serializedValues","generateToken","DISPLAY_NAMES_OPTONS","formatDisplayName","getDisplayNames","DisplayNames","of","verifyConfigMessages","createIntl","relativeTime","list","displayNames","createFormatters","resolvedConfig","$t","processIntlConfig","wrapRichTextChunksInFragment","assignUniqueKeysToFormatXMLElementFnArgument","acc","formatXMLElementFn","rawValues","rawDefaultRichTextElements","coreIntl","IntlProvider","prevConfig","getDerivedStateFromProps","render","defaultProps","_extends","target","Action","PopStateEventType","warning$1","cond","console","getHistoryState","usr","pathname","hash","parsePath","random","substr","parsedPath","hashIndex","searchIndex","createClientSideURL","base","origin","href","getUrlBasedHistory","getLocation","createHref","validateLocation","defaultView","v5Compat","globalHistory","history","Pop","handlePop","addEventListener","removeEventListener","encodeLocation","Push","historyState","pushState","Replace","replaceState","go","ResultType","matchRoutes","routes","locationArg","basename","stripBasename","branches","flattenRoutes","sort","score","compareIndexes","routesMeta","meta","childrenIndex","rankRouteBranches","matches","matchRouteBranch","safelyDecodeURI","parentsMeta","parentPath","flattenRoute","route","relativePath","caseSensitive","computeScore","_route$path","exploded","explodeOptionalSegments","segments","isOptional","required","restExploded","subpath","paramRe","isSplat","initialScore","segment","branch","matchedParams","matchedPathname","remainingPathname","pathnameBase","normalizePathname","matcher","paramNames","regexpSource","compilePath","captureGroups","memo","splatValue","decodeURIComponent","safelyDecodeURIComponent","decodeURI","startIndex","nextChar","getInvalidPathError","field","dest","getPathContributingMatches","resolveTo","toArg","routePathnames","locationPathname","isPathRelative","isEmptyPath","toPathname","routePathnameIndex","toSegments","shift","fromPathname","pop","resolvePathname","normalizeSearch","normalizeHash","resolvePath","hasExplicitTrailingSlash","hasCurrentTrailingSlash","paths","statusText","internal","isRouteErrorResponse","validMutationMethodsArr","validRequestMethodsArr","useState","useDebugValue","checkIfSnapshotChanged","inst","latestGetSnapshot","getSnapshot","prevValue","nextValue","DataStaticRouterContext","DataRouterContext","DataRouterStateContext","NavigationContext","LocationContext","RouteContext","outlet","RouteErrorContext","useInRouterContext","routePathnamesJson","activeRef","relative","_temp2","DefaultErrorElement","_state$errors","useDataRouterState","DataRouterStateHook","UseRouteError","routeId","useCurrentRouteId","errors","useRouteError","lightgrey","preStyles","padding","backgroundColor","codeStyles","fontStyle","RenderErrorBoundary","componentDidCatch","errorInfo","routeContext","component","RenderedRoute","dataStaticRouterContext","errorElement","_deepestRenderedBoundaryId","_renderMatches","parentMatches","dataRouterState","renderedMatches","errorIndex","findIndex","m","reduceRight","getChildren","element","DataRouterHook","hookName","useRouteContext","thisRoute","Navigate","_ref3","navigate","navigation","Route","_props","_ref4","basenameProp","locationProp","navigationType","staticProp","navigationContext","trailingPathname","Routes","_ref5","dataRouterContext","dataRouterStateContext","routeMatch","parentParams","parentPathnameBase","locationFromContext","_parsedLocationArg$pa","parsedLocationArg","useRoutes","router","createRoutesFromChildren","AwaitRenderStatus","AwaitErrorBoundary","promise","pending","renderError","catch","_tracked","_error","_data","success","then","AbortedDeferredError","neverSettledPromise","React","AwaitContext","treePath","loader","hasErrorBoundary","shouldRevalidate","_objectWithoutPropertiesLoose","excluded","sourceKeys","HashRouter","_ref2","historyRef","querySelector","getAttribute","setState","Link","onClick","reloadDocument","preventScrollReset","_temp","joinedPathname","useHref","internalOnClick","replaceProp","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","shouldProcessLinkClick","useLinkClickHandler","defaultPrevented","FormattedMessage","Text","Component","nodes","MemoizedFormattedMessage","prevProps","nextProps","otherProps","nextValues","nextOtherProps","DisplayName","DisplayNameParts","FormattedNumberParts","formatProps","createFormattedDateTimePartsComponent","ComponentParts","createFormattedComponent","formattedValue","ValidationError","getOwnPropertyNames","getPrototypeOf","fieldName","validationState","getFieldByName","validationStateKeys","getAllPropertyNames","ERROR","getErrorKeyByValue","PATTERN_MISMATCH","RANGE_OVERFLOW","RANGE_UNDERFLOW","STEP_MISMATCH","TOO_LONG","TYPE_MISMATCH","VALUE_MISSING","errorValue","EMAIL","mapErrorsToField","NAME","PASSWORD","PASSWORD_LOGIN","SSO_CODE","SSO_EMAIL_CODE","FIELD","footerStrings","copy","customEnvRedirectStrings","credentialsInfo","redirectHeadline","redirectTo","cookiePolicyStrings","bannerText","indexStrings","createAccount","enterprise","logIn","ssoLogin","welcome","setAccountTypeStrings","createAccountForOrganizations","createAccountForPersonalUse","createPersonalAccount","createTeam","goBack","teamNameStrings","headline","subhead","teamNamePlaceholder","whatIsWireTeamsLink","accountFormStrings","emailPersonalPlaceholder","emailTeamPlaceholder","namePlaceholder","passwordHelp","passwordPlaceholder","submitButton","terms","termsAndPrivacyPolicy","createAccountStrings","headLine","createPersonalAccountStrings","verifyStrings","changeEmail","resendCode","inviteStrings","emailPlaceholder","nextButton","skipForNow","chooseHandleStrings","handlePlaceholder","setEmailStrings","noMailHeadline","tryAgain","verifyHeadline","verifySubhead","setEntropyStrings","continue","subheadline","setPasswordStrings","appAlreadyOpenStrings","continueButton","acceptNewsModalStrings","confirmButton","declineButton","privacyDescription","unsubscribeDescription","unsupportedStrings","desktopOnlyMessage","headlineBrowser","headlineCookies","headlineIndexedDb","subheadBrowser","subheadCookies","subheadIndexedDb","unsupportedJoinStrings","unsupportedJoinHeadline","unsupportedJoinMobileSubhead","conversationJoinStrings","existentAccountHeadline","existentAccountJoinWithoutLink","existentAccountJoinWithoutText","existentAccountOpenButton","existentAccountSubhead","fullConversationHeadline","fullConversationSubhead","hasAccount","invalidCreateAccountLink","invalidCreateAccountText","invalidHeadline","invalidSubhead","loginLink","errorHandlerStrings","SyntheticErrorLabel","BackendClientError","BackendErrorLabel","learnMore","unexpected","validationErrorStrings","loginStrings","forgotPassword","phoneLogin","publicComputer","twoFactorLoginSubHead","twoFactorLoginTitle","ssoLoginStrings","codeInputPlaceholder","codeOrMailInputPlaceholder","overlayDescription","overlayFocusLink","subheadCode","subheadCodeOrEmail","subheadEmailEnvironmentSwitchWarning","phoneLoginStrings","accountCountryCode","errorCountryCodeInvalid","loginHead","verifyCodeChangePhone","verifyCodeDescription","verifyCodeResend","verifyPasswordHeadline","logoutReasonStrings","LOGOUT_REASON","clientManagerStrings","clientItemStrings","historyInfoStrings","noHistoryHeadline","noHistoryInfo","ok","EXTERNAL_ROUTE","PWA","PWA_LOGIN","WEBAPP","WIRE_ACCOUNT","WIRE_ACCOUNT_PASSWORD_RESET","WIRE_TEAM_FEATURES","WIRE_TERMS_PERSONAL","WIRE_TERMS_TEAMS","WIRE_WEBSITE","WirelessContainer","showCookiePolicyBanner","onCookiePolicyBannerClose","useIntl","display","flexDirection","minHeight","width","Header","height","margin","textAlign","fontSize","textTransform","bold","newline","strong","background","border","cursor","right","top","CloseIcon","Content","marginLeft","marginTop","SVGIcon","realWidth","realHeight","dangerouslySetInnerHTML","__html","getSVG","documentElement","innerHTML","flex","paddingLeft","Footer","justifyContent","Small","UnsupportedMessage","ContainerXS","verticalCenter","centerText","Logo","H1","center","css","brandName","UnsupportedBrowser","connect","isCheckingSupport","Loading","Container","H2","H3","fontWeight","redirects","AuthSelector","ROUTE","Page","isStateAuthenticated","hasAccountData","hasTeamData","hasInvalidAccountData","hasInvalidTeamData","Exception","Fragment","translatedErrors","ErrorMessage","minPasswordLength","MINIMUM_PASSWORD_LENGTH","supportEmailExistsLink","rel","CheckPassword","doLogin","resetAuthError","useNavigate","passwordInput","setError","setPassword","validPasswordInput","setValidPasswordInput","handleLogin","validationError","checkValidity","handleValidationState","validity","valid","Form","onSubmit","InputBlock","InputSubmitCombo","Input","onChange","autoComplete","placeholder","markInvalid","RoundIconButton","formNoValidate","disabled","showLoading","ArrowIcon","newWindow","opener","parseError","parseValidationErrors","isValidationError","ClientItem","selected","onClientRemoval","clientError","requirePassword","CONFIG","animationStep","setAnimationStep","isSelected","setIsSelected","isAnimating","setIsAnimating","isValidPassword","setIsValidPassword","setValidationError","isOpen","setIsOpen","requestAnimationFrame","executeAnimateOut","executeAnimateIn","step","handleWrapperClick","animatedCardSpacing","animationPosition","smoothHeight","smoothMarginTop","boxShadow","COLOR","borderRadius","transition","onKeyDown","isEnterKey","onWrapperEnter","outline","tabIndex","TabIndex","FlexBox","flexBasis","DeviceIcon","color","flexGrow","block","clazz","class","splitFingerprint","formatId","dateString","toLocaleString","IconButton","TrashIcon","Line","overflow","alignItems","maxHeight","marginRight","autoFocus","localValidationError","errorType","getCurrentSelfClient","hasLoadedClients","isNewCurrentSelfClient","getPermanentClients","ClientList","ClientSelector","permanentClients","ROOT_ACTIONS","doRemoveClient","removeLocalStorage","resetClientError","setShowLoading","currentlySelectedClient","setCurrentlySelectedClient","removeClient","SFAcode","LocalStorageAction","isSelectedClient","setSelectedClient","ClientManager","doGetAllClients","timeRemaining","startTimeout","useTimeout","Muted","marginBottom","Button","variant","ButtonVariant","alignSelf","shannonEntropy","frequencies","freq","sum","f","log2","calculateDeltaValues","EntropyData","frames","entropyBits","valuesPerFrame","deltaValues","deltaEntropy","delta2Values","delta2Entropy","delta3Entropy","addFrame","duplicateCheck","usePausableInterval","timer","intervalIdRef","totalTimeRun","intervalId","startTime","getTime","pause","setPause","clearInterval","interval","pauseInterval","startInterval","EntropyCanvas","sizeX","sizeY","onProgress","minEntropyBits","minFrames","canvasRef","setPercent","previousPoint","setPreviousPoint","lastPoint","setLastPoint","canvas","getContext","ctx","beginPath","moveTo","lineJoin","lineCap","lineWidth","strokeStyle","lineTo","stroke","onMouseMove","boundingRect","currentTarget","getBoundingClientRect","drawPoint","clientX","clientY","onMouseLeave","ProgressBar","EntropyContainer","onSetEntropy","containerSize","setEntropy","forwardEntropy","hashedValue","ContainerSM","CheckRoundIcon","KEY","percentage","AppAlreadyOpen","fullscreen","hasOtherInstance","killRunningInstance","useSingleInstance","Modal","maxWidth","Columns","Column","RRLink","RouterDOM","RouterLink","theme","linkStyle","randomArrayElement","array","randomInt","max","ACCENT_COLORS","RandomUtil","ConversationJoin","conversationError","ConversationSelector","selfName","doCheckConversationCode","doInit","doRegisterWireless","nameInput","accentColor","AccentColor","setIsPwaEnabled","conversationCode","setConversationCode","conversationKey","setConversationKey","enteredName","setEnteredName","setExpiresIn","forceNewTemporaryGuestAccount","setForceNewTemporaryGuestAccount","isValidLink","setIsValidLink","isValidName","setIsValidName","setShowCookiePolicyBanner","showEntropyForm","setShowEntropyForm","isEntropyRequired","localConversationCode","localConversationKey","localExpiresIn","parseInt","noop","isEnabled","routeToApp","redirectLocation","handleSubmit","focus","isFullConversation","renderTemporaryGuestAccountCreation","maxLength","minLength","ConversationJoinInvalid","AccountForm","authError","doSendActivationCode","setRegistrationData","validInputs","setValidInputs","validationErrors","setValidationErrors","inputs","prevState","newValidInputs","inputKey","currentInput","currentInputNode","beforeSubmit","setCustomValidity","Checkbox","checked","aligncenter","CheckboxLabel","htmlFor","ENABLE_ACCOUNT_REGISTRATION_ACCEPT_TERMS_AND_PRIVACY_POLICY","privacypolicy","submitText","CreateAccount","backArrow","direction","opacity","IsMobile","not","minWidth","CreatePersonalAccount","isMacOsWrapper","pageContent","CustomEnvironmentRedirect","doNavigate","doSendNavigationEvent","destinationUrl","setDestinationUrl","destinationParam","redirectTimeoutId","afterRender","justify","align","viewBox","fill","strokeDashoffset","cx","cy","r","strokeWidth","strokeLinecap","strokeDasharray","transform","HistoryInfo","isFeching","currentSelfClient","shouldLoadClients","onContinue","shouldShowHistoryInfo","Paragraph","Index","defaultSSOCode","logoutReason","setLogoutReason","queryLogoutReason","features","ENABLE_DOMAIN_DISCOVERY","ENABLE_SSO","ENABLE_ACCOUNT_REGISTRATION","InitialInvite","inviteError","LanguageSelector","resetInviteErrors","emailInput","enteredEmail","setEnteredEmail","onInviteDone","CheckIcon","renderEmail","PlaneIcon","LoginForm","validEmailInput","setValidEmailInput","setEmail","emailValidationError","passwordValidationError","localEmail","isValidEmail","isValidUsername","ENABLE_PHONE_LOGIN","isValidPhoneNumber","Login","doLoginAndJoin","doSendTwoFactorCode","doSendTwoFactorLoginCode","doSetLocalStorage","twoFactorSubmitError","setTwoFactorSubmitError","twoFactorLoginData","setTwoFactorLoginData","onEntropyGenerated","queryConversationCode","queryConversationKey","immediateLogin","formLoginData","isBackendError","backendError","resendTwoFactorCode","StatusCodes","storeEntropy","Label","CodeInput","onCodeComplete","TextLink","LinkVariant","paddingTop","COUNTRY_CODES","iso","population","PhoneLoginForm","phoneNumber","setPhoneNumber","countryCode","setCountryCode","country","setCountry","validInput","setValidInput","phoneInput","countryCodeInput","countryList","expandedCountryList","currentSelectValue","selectedCountry","isTiny","useMatchMedia","isMobile","QUERY","Select","selectedCountryValue","isoName","getCountryCode","dataUieName","codeNumbers","parsedCode","countryA","countryB","getCountryByCode","PhoneLogin","doSendPhoneLoginCode","PasswordExistsError","InvalidPhoneNumberError","ForbiddenPhoneNumberError","SetAccountType","iconStyles","ProfileIcon","Bold","light","TeamIcon","SetEmail","isSelfSSOUser","doSetEmail","setIsValidEmail","onSetEmail","SetEntropyPage","AcceptNewsModal","onConfirm","onDecline","RANDOM_WORDS_1","RANDOM_WORDS_2","generateHandleVariations","numberOfVariations","digitCount","appendRandomDigits","additionalNumbers","createSuggestions","normalizedName","getSlug","normalizeName","randomName","suggestions","normalizedNameVariations","randomNameVariations","SetHandle","hasUnsetMarketingConsent","ConsentType","checkHandles","doGetConsents","doSetConsent","doSetHandle","setHandle","updateConsent","onSetHandle","SetPassword","doSetPassword","onSetPassword","new_password","SingleSignOnForm","doFinalizeSSOLogin","doGetDomainInfo","validateSSOCode","initialCode","codeOrMailInput","codeOrMail","setCodeOrMail","disableInput","setDisableInput","setClientType","ssoError","setSsoError","isCodeOrMailInputValid","setIsCodeOrMailInputValid","isLoading","setIsLoading","shouldAutoLogin","setShouldAutoLogin","currentlyDisabled","currentValidationError","webapp_welcome_url","welcomeUrl","strippedCode","stripPrefix","prefixedCode","enableDomainDiscovery","inputName","inputPlaceholder","inputPattern","PATTERN","SingleSignOn","ssoWindowRef","useParams","isOverlayOpen","setIsOverlayOpen","calculateChildPosition","childHeight","childWidth","screenLeft","screenX","screenTop","screenY","hasInnerMeasurements","innerHeight","innerWidth","parentHeight","clientHeight","screen","left","clientWidth","Overlay","textDecoration","timerId","onReceiveChildWindowMessage","onParentWindowClose","onChildWindowClose","serializedEvent","log","closeSSOWindow","eventType","once","childPosition","close","setInterval","closed","TeamName","teamName","enteredTeamName","setEnteredTeamName","isValidTeamName","setIsValidTeamName","teamNameInput","addLocaleToUrl","linkButtonStyle","LinkButton","changeEmailRedirect","VerifyEmailCode","doRegisterPersonal","doRegisterTeam","VerifyEmailLink","VerifyPhoneCode","Title","title","Root","doGetSSOSettings","forceSlashAfterHash","isAuthenticatedCheck","page","loadLanguage","StyledApp","themeId","THEME_ID","exposeWrapperGlobals","mainId","createStore","combineReducers","checkIndexedDbSupport","checkCookieSupport","checkSupportedBrowser","configureStore","enableLogging","ENABLE_DEBUG","getElementById","createRoot","ACCOUNT_ID","CLIENT_TYPE","CONVERSATION_CODE","CONVERSATION_KEY","CURRENCY","DESTINATION_URL","IMMEDIATE_LOGIN","JOIN_EXPIRES","LANGUAGE","LOCALE","PERSIST_TEMPORARY_CLIENTS","PWA_AWARE","SSO_AUTO_LOGIN","TRACKING","ACCOUNT_REMOVED","CLIENT_REMOVED","NO_APP_CONFIG","SESSION_EXPIRED","CHECK_PASSWORD","CLIENTS","CONVERSATION_JOIN","CONVERSATION_JOIN_INVALID","CREATE_ACCOUNT","CREATE_TEAM","CREATE_TEAM_ACCOUNT","CUSTOM_ENV_REDIRECT","HISTORY_INFO","INITIAL_INVITE","LOGIN","LOGIN_PHONE","SET_ACCOUNT_TYPE","SET_EMAIL","SET_ENTROPY","SET_HANDLE","SET_PASSWORD","SSO","VERIFY_EMAIL_CODE","VERIFY_EMAIL_LINK","VERIFY_PHONE_CODE","fileList","svgs","parser","DOMParser","iconFileName","iconPath","iconName","lastIndexOf","svgString","parseFromString","getAllSVGs","LEAVE_CALL_REASON","TERMINATION_REASON","ClientEntity","isSelfClient","address","cookie","DEFAULT_VALUE","isVerified","primaryKey","isLegalHold","isPermanent","isTemporary","getName","toJson","jsonObject","ClientMapper","removeDefaultValues","is_verified","primary_key","memberName","constructClientId","userId","baseId","parseClientId","groups","CLIENT_PAYLOAD","SELF_CLIENT_PAYLOAD","clientPayload","clientEntity","_mapMember","isClientRecord","clientRecords","clientRecord","mapClient","clientData","updatePayload","containsUpdate","member","wasUpdated","payloadValue","ClientState","isTemporaryClient","ClientRepository","AVERAGE_NUMBER_OF_CLIENTS","PRIMARY_KEY_CURRENT_CLIENT","clientService","cryptographyRepository","storageRepository","deleteLocalTemporaryClient","PrimaryModal","preventClose","primaryAction","clearData","option","eventJson","onClientAdd","onClientRemove","devices","logoutClient","onUserEvent","info","deleteClientFromDb","deleteLocalClient","getAllClientsFromDb","loadAllClientsFromDb","recipients","skippedUserIds","getClientByIdFromBackend","getClientById","ClientError","getCurrentClientFromDb","loadClientFromDb","saveClientInDb","updateClientInDb","changes","verifyClient","updateClientSchemaInDb","backendFeatures","federationEndpoints","constructCookieLabelKey","loadCurrentClientType","loginHash","murmurhash","StorageKey","getValidLocalClient","putClientCapabilities","capabilities","ClientCapability","loadValue","qualifiedId","removeLocalClient","deleteCryptographyStores","shouldClearData","deleteSession","getClientsByUserIds","userIds","updateClients","clientEntityMap","qualifiedUserClientsMap","userClientMap","matchQualifiedIds","updateClientsOfUserById","getClientByUserIdFromDb","userQualifiedId","getClientsForSelf","addClient","isCurrentClientPermanent","updateClientsForSelf","clientsData","publish","clientsFromBackend","clientsStoredInDb","isSelfUser","clientsFromDatabase","promises","databaseClient","backendClient","isCurrentClient","newRecords","clientEntities","removedClient","ClientService","URL_CLIENTS","URL_USERS","storageService","StorageService","CLIENT_STORE_NAME","StorageSchemata","clientCapabilities","putClient","getClient","clientsMap","postListClients","qualified_users","qualified_user_map","postClients","newClient","postClient","delete","getAll","db","table","where","equals","update","CSS_SQUARE","buttonCommonStyles","AvailabilityState","availability","className","showArrow","isAvailable","Availability","isAway","isBusy","content","borderLeft","borderRight","borderTop","paddingBottom","wrappedContent","userSelect","newEvent","MouseEvent","nativeEvent","AvatarBackground","CSS_FILL_PARENT","AvatarBorder","AvatarImage","assetRepository","avatarAlt","avatarSize","devicePixelRatio","isGrey","mediumPicture","previewPicture","avatarImage","setAvatarImage","showTransition","setShowTransition","avatarLoadingBlocked","setAvatarLoadingBlocked","isSmall","AVATAR_SIZE","LARGE","X_LARGE","pictureResource","isCached","transitionImageStyles","entered","entering","Transition","in","timeout","objectFit","src","alt","AvatarWrapper","isResponsive","avatarDiameter","DIAMETER","ServiceAvatar","participant","Icon","mediumPictureResource","previewPictureResource","AvatarBadge","icons","STATE","PENDING","BLOCKED","CSS_FLEX_CENTER","CSS_ICON","AvatarInitials","initials","INITIALS_SIZE","lineHeight","X_SMALL","getFirstChar","shouldShowBadge","isTooSmall","XX_SMALL","XXX_SMALL","isBadgeState","UserAvatar","noBadge","noFilter","onAvatarInteraction","isImageGrey","IGNORED","UNKNOWN","accent_color","useKoSubscribableChildren","avatarImgAlt","TemporaryGuestAvatar","finalBorderWidth","normalizedRemainingTime","expirationRemaining","User","borderWidth","timerLength","PI","timerOffset","MEDIUM","SMALL","Avatar","onAvatarClick","handleAvatarInteraction","parentNode","handleKeyDown","isBlocked","isRequest","isIgnored","isCanceled","isUnknown","isServiceEntity","isMe","avatarState","NONE","SELF","DeviceId","deviceId","normalizeIconName","found","createSvgComponent","svg","SVGComponent","oProps","regex","componentName","useTypingIndicatorState","typingUsers","addTypingUser","typingUser","getTypingUser","removeTypingUser","getTypingUsersInConversation","clearTypingUsers","wrapperStyles","borderTopLeftRadius","borderTopRightRadius","img","indicatorAnimationWrapperStyles","bottom","animationStyles","animationFillMode","animationDirection","animationIterationCount","animationTimingFunction","animationDuration","dotStyles","transformBox","transformOrigin","editIconKeyFrams","keyframes","dot1KeyFrames","dot2KeyFrames","dot3KeyFrames","editIconStyles","dotOneStyles","dotTwoStyles","dotThreeStyles","indicatorTitleStyles","TypingIndicator","users","usersCount","user1","user2","count","TYPING_TIMEOUT","TIME_IN_MILLIS","LegalHoldDot","isInteractive","isPending","isMessage","large","showText","showRequestModal","showUsers","useLegalHoldModalState","stopPropagation","useMessageFocusedTabIndex","isMessageFocused","ModalOverlayStyles","overflowX","overflowY","zIndex","ModalOverlayVisibleStyles","ModalContentStyles","animation","ModalContentVisibleStyles","ModalComponent","isShown","onBgClick","onClosed","wrapperCSS","displayNone","setDisplayNone","hasVisibleClass","isMounting","trapId","useId","trapFocus","useCallback","preventFocusOutside","onkeydown","timeoutId","mounting","legalHoldModalDefaultState","fingerprint","isSelfInfo","closeModal","closeRequestModal","isInitialized","setFingerprint","formattedFingerprint","setIsModalOpen","setType","setUsers","initialize","LegalHoldModalType","LegalHoldModal","userState","conversationRepository","searchRepository","teamRepository","clientRepository","messageRepository","skipShowUsersRef","currentConversation","REQUEST","isUsers","USERS","setIsPending","isSendingApprove","setIsSendingApprove","passwordValue","setPasswordValue","requestError","setRequestError","userDevices","setUserDevices","requiresPassword","disableSubmit","userDevicesHistory","useUserDevicesHistory","showDeviceList","UserDevicesState","onClose","closeRequest","acceptRequest","teamService","sendLegalHoldApproval","hasPendingLegalHold","setModalParams","getLegalHoldState","LegalHoldMemberStatus","newFingerprint","getRemoteFingerprint","last_prekey","checkLegalHoldState","isPendingStatus","getLegalHoldUsers","updateAllClients","legalHoldUsers","getAllUsersInConversation","isOnLegalHold","br","ev","handleEnterDown","goTo","noPadding","noUnderline","defaultContent","checkboxLabel","closeBtnTitle","closeFn","currentType","messageHtml","messageText","modalUie","secondaryAction","titleText","usePrimaryModalState","addToQueue","modalItem","queue","currentModalContent","currentModalId","errorMessage","existsInQueue","queueItem","removeFirstItemInQueue","replaceInQueue","updateCurrentModalContent","nextCurrentModaContent","updateCurrentModalId","nextCurrentModalId","updateErrorMessage","nextErrorMessage","addNewModalToQueue","modalId","alreadyOpen","showNextModalInQueue","newModal","nextModalToShow","PrimaryModalType","closeOnConfirm","hideSecondary","showClose","closeBtnLabel","input","htmlMessage","removeCurrentModal","deviceList","device","deviceDate","deviceTime","isValid","formatLocale","escape","replaceLink","updatedSecondaryAction","uieNames","uieName","show","DeviceCard","click","showVerified","showIcon","messageFocusedTabIndex","deviceClass","clickable","showLegalHoldIcon","showDesktopIcon","showMobileIcon","clickOnDevice","VerifiedIcon","DeviceDetails","selectedClient","clickToShowSelfFingerprint","ConversationState","fingerprintRemote","setFingerprintRemote","isResettingSession","setIsResettingSession","clientMeta","userName","remoteFingerprint","isMLSConversation","activeConversation","isUsingMLSProtocol","defaultChecked","toggleVerified","_resetProgress","MotionDuration","getSelfProteusConversation","resetSession","DeviceList","getPrivacyWhyUrl","NoDevicesFound","getPrivacyPolicyUrl","SelfFingerprint","localFingerprint","setLocalFingerprint","getLocalFingerprint","FIND_MODE","setHistory","DEVICE_LIST","sortUserDevices","legalholdDevices","otherDevices","partition","UserDevices","deviceMode","setDeviceMode","REQUESTING","setClients","qualifiedUsersMap","qualifiedUsersMaps","FOUND","capitalizeFirstChar","DEVICE_DETAILS","SELF_FINGERPRINT","UserlistMode","UserList","infos","highlightedUsers","mode","DEFAULT","truncate","selectedUsers","maxVisibleUsers","reducedUserCount","showEmptyAdmin","noSelfInteraction","UserState","teamState","TeamState","onSelectUser","maxShownUsers","setMaxShownUsers","hasMoreUsers","highlightedUserIds","selfInTeam","isSelfVerified","isSelectEnabled","cssClasses","COMPACT","onUserKeyPressed","isSpaceKey","onClickOrKeyPressed","members","admins","adminCount","memberCount","isService","conversationRoleRepository","isUserGroupAdmin","noInteraction","highlighted","customInfo","canSelect","external","isExternal","truncatedUsers","onVisible","UserSearchableList","onUpdateSelectedUsers","selfFirst","userListProps","filteredUsers","setFilteredUsers","remoteTeamMembers","setRemoteTeamMembers","fetchMembersFromBackend","debounce","isHandle","ignoreMembers","resultUsers","searchByName","selfTeamId","foundMembers","ignoreIds","uniqueMembers","nonExternalMembers","filterExternals","connectedUsers","normalizedQuery","SearchRepository","trimmedQuery","validateHandle","SEARCHABLE_FIELDS","properties","USERNAME","searchUserInSet","isSelfConnectedTo","username","otherUsers","toggleUserSelection","selectedUser","userList","userA","userB","sortByPriority","foundUserEntities","isEmptyUserList","hasUsers","noResultsDataUieName","noResultsTranslationText","fadeAnimation","ParticipantMicOnIcon","isActive","ParticipantItem","badge","callParticipant","hideInfo","showDropdown","onContextMenu","checkboxId","isInViewport","setIsInViewport","isUser","ServiceEntity","isSelf","selfString","hasCustomInfo","hasUsernameInfo","isOthersMode","isDirectGuest","expirationText","participantName","isFederated","sharesCamera","sharesScreen","isActivelySpeaking","isMuted","contentInfoText","summary","RenderParticipant","dataUieValues","commonClassName","labelBeforeCheckbox","outlineOffset","setContextMenuPosition","overlayedElements","overlayCheckerInterval","checkOverlayedElements","isVisible","isOverlayed","removeElement","domElement","box","isNaN","middlePointX","middlePointY","elementAtPoint","elementFromPoint","contains","overlayedObserver","onElementVisible","trackElement","observedElements","thresholdSteps","stepCount","observer","IntersectionObserver","intersectionRatio","intersectionRect","isIntersecting","rootBounds","requireFullyInView","allowBiggerThanViewport","isFullyInView","root","rootMargin","threshold","unobserve","viewportObserver","onElementInViewport","observe","InViewport","checkOverlay","domNode","inViewport","visible","releaseTrackers","triggerCallbackIfVisible","parentElement","ConnectionEntity","lastUpdate","ConnectionStatus","isMissingLegalHoldConsent","isConnected","isIncomingRequest","isOutgoingRequest","AbstractConversationEventHandler","eventHandlingConfig","setEventHandlingConfig","handleConversationEvent","handler","PERSONAL","TEAM","OTHER","ACCESS_STATE","extractClientDiff","deleted","redundant","missing","defaultDomain","allDeleted","deletedClients","isQualifiedUserClients","flattenQualifiedUserClients","flattenUserClients","missingClients","toClientDiff","clientDiff","emptyUsers","missingUserIds","userClients","userDeletedClients","intersection","unknownMissingClients","difference","findDeletedClients","referenceRecipients","localRecipients","filterKnownClients","knownClients","missingUserClients","ACCESS_TYPES","GUEST","NON_TEAM_MEMBER","TEAM_MEMBER","SERVICE","ACCESS_MODES","INVITE","CODE","ACCESS","teamPermissionsForAccessState","combinePermissions","hasAccessToFeature","feature","isGettingAccessToFeature","featureFromStateChange","featureName","bitmask","featureBitmask","featString","CONVERSATION_ACCESS_ROLE","AccessStatesByPerm","accessFromPermissions","permissions","invalidRoles","memberPermissions","rolePermissions","hasPermissions","hasPermissionForRole","toggleFeature","updateAccessRights","accessState","newAccessRights","accessModes","accessRole","reverse","bit","CONVERSATION_ACCESS","ConversationEphemeralHandler","INTERVAL_TIME","TIMER_RANGE","MAX","MIN","messageTimer","clamp","eventService","eventListeners","messageEntity","timeOffset","StatusType","ephemeral_status","EphemeralStatusType","_timeoutEphemeralMessage","startMessageTimer","ephemeral_expires","ephemeral_started","updateEvent","defaultEventListeners","onMessageTimeout","CONVERSATION_EVENT","_updateEphemeralTimer","timedMessages","updateIntervalId","timedMessagesSubscription","messageEntities","_updateTimedMessages","validateMessage","_updateTimedMessage","conversation_id","matchingMessageEntity","timedMessageEntity","timedConversationId","timedMessageId","validateMessages","_obfuscateAssetMessage","content_type","getFirstAsset","file_type","_obfuscateImageMessage","assetEntity","_obfuscateMessage","hasAssetText","_obfuscateTextMessage","hasAsset","hasAssetImage","obfuscatedAsset","obfuscatedPreviews","previews","linkPreview","obfuscate","protoArticle","Article","permanentUrl","linkPreviewProto","LinkPreview","article","urlOffset","arrayToBase64","finish","isExpired","updates","globalMessageTimer","validateTimer","message_timer","ConversationMapper","remainingTime","ephemeral_remaining","expiredMessages","remove","expiredMessage","dispose","ConversationFilter","participating_user_ids","team_id","hasCall","isSupportedConversation","isGroup","is1to1","isActiveConversation","removed_from_conversation","TypedEventTarget","EventTarget","Event","LabelType","DefaultLabelIds","propertiesKey","createLabel","conversations","Custom","createLabelGroups","Groups","createLabelPeople","contacts","Contacts","createLabelFavorites","favorites","Favorites","ConversationLabelRepository","allConversations","propertiesService","labelJson","labels","putPropertiesByKey","marshal","labelProperties","getPropertiesByKey","unmarshal","allLabeledConversations","Favorite","labelId","getLabelConversations","getFavoriteLabel","getFavorites","addedConversation","favoriteLabel","saveLabels","removedConversation","ids","getConversationCustomLabel","includeFavorites","nameA","nameB","localeCompare","sensitivity","removeConversation","removeFromFavorites","isCustom","removeConversationFromAllLabels","newFolder","accumulated","conversationsData","timestamp","ConversationError","BASE_ERROR_TYPE","BaseError","conversationData","createConversationEntity","disablePersistence","setStateChangePersistence","archived_timestamp","cleared_timestamp","ephemeral_timer","last_event_timestamp","last_read_timestamp","last_server_timestamp","legal_hold_status","muted_timestamp","receipt_mode","verification_state","setTimestamp","Conversation","archivedState","archived_state","localMessageTimer","receiptMode","mutedState","muted_state","legalHoldStatus","otr_archived","otr_muted_status","archivedTimestamp","otr_archived_ref","mutedTimestamp","otr_muted_ref","initialTimestamp","isObject","others","qualified_others","group_id","epoch","protocol","cipher_suite","qualified_id","roles","groupId","cipherSuite","updateSelfStatus","participatingUserIds","is_guest","isGuest","access","access_role","accessRoleV2","access_role_v2","mapAccessState","localConversations","remoteConversations","failedConversations","failed","curr","convo","localArchives","remote","remoteConversationData","remoteConversationId","localConversationData","othersStates","conversation_role","mergedConversation","CONVERSATION_TYPE","noOthers","otherState","ConversationStatus","wrongServerTimestamp","isRemoteTimestampNewer","localTimestamp","remoteTimestamp","remoteArchivedTimestamp","remoteMutedTimestamp","remoteMutedState","accessCode","baseUrl","accessCodeUrl","mapAccessStateV2","mapLegacyAccessState","personalAccessState","isTeamRole","CONVERSATION_LEGACY_ACCESS_ROLE","includesInviteMode","isInviteModeOnly","isNonActivatedRole","isExpectedModes","PromiseQueue","UNBLOCK_INTERVAL","blocked","concurrent","paused","execute","queueEntry","logObject","pendingEntry","queueState","resume","resolveFn","rejectFn","getLength","shouldPause","unshift","Permissions","defaultAdminRole","renameConversation","addParticipants","removeParticipants","changeParticipantRoles","toggleEphemeralTimer","toggleGuestsAndServices","toggleReadReceipts","deleteConversation","leaveConversation","DefaultRole","defaultMemberRole","ConversationRoleRepository","conversationService","isTeam","getTeamConversationRoles","teamRoles","conversation_roles","newRoles","conversationRoles","getConversationById","roleUpdates","conversationRole","putMembers","getUserRole","getConversationRoles","userRole","permissionName","getUserPermissions","hasPermission","ConversationStateHandler","_mapConversationAccessState","_resetConversationAccessCode","_updateConversationAccessCode","changeAccessState","isConversationInTeam","isStateChange","prevAccessState","revokeAccessCode","putConversationAccess","messageString","_showModal","getAccessCode","getConversationCode","requestAccessCode","postConversationCode","deleteConversationCode","modalOptions","ConversationVerificationStateHandler","eventRepository","getActiveConversationsWithUsers","checkChangeToVerified","checkChangeToDegraded","VerificationMessageType","_clientEntity","onClientsAdded","onClientAdded","onClientRemoved","onClientsUpdated","onClientVerificationChanged","matchingUserIds","onConversationCreate","onMemberJoined","onMemberLeft","willChangeToVerified","allVerifiedEvent","EventBuilder","injectEvent","shouldShowDegradationWarning","willChangeToDegraded","ConversationVerificationState","filteredConversations","userIdInConversation","activeConversationInfo","isStateVerified","isConversationUnverified","DeleteConversationMessage","SystemMessage","TEAM_EVENT","system_message_type","SystemMessageType","caption","hasMessageLegalHoldFlag","mappedEvent","supportsLegalHoldFlag","CONVERSATION","hasLegalHoldFlag","LegalHoldStatus","UserFilter","ConversationRepository","CONFIRMATION_THRESHOLD","EXTERNAL_MESSAGE_THRESHOLD","GROUP","MAX_NAME_LENGTH","MAX_SIZE","connectionRepository","userRepository","propertyRepository","serverTimeHandler","updatedEvent","oldObj","oldEvent","findConversation","replacedMessageEntity","replaceMessageInConversation","updateMessageUserEntities","deletedEvent","removeMessageById","user_et","get1To1Conversation","skipNotification","nextConversation","getNextConversation","deletionMessage","conversationLabelRepository","deleteConversationFromRepository","deleteConversationFromDb","showNoConversationModal","showModal","conversationName","getConversationJoin","knownConversation","postConversationJoin","onMemberJoin","showTooManyMembersModal","connectionEntity","fetchConversationById","connection","updateParticipatingUserEntities","updatedConversationEntity","notifySubscribers","saveConversationStateInDb","handlingState","isFetchingFromStream","NOTIFICATION_HANDLING_STATE","isBlockingNotificationHandling","checkChangedConversations","isoDate","toServerTimestamp","getUserById","eventInjections","conversationInTeam","userIsParticipant","isParticipant","leaveEvent","isDeleted","beforeTimestamp","getNextTimestamp","legalHoldUpdateMessage","eventSource","EventRepository","eventObject","logMessage","pushToReceivingQueue","currentTimestamp","missed_event","isPing","deleteMessage","fromDomain","deleteMessageForEveryone","optimisticRemoval","targetedUsers","setClientMismatchHandler","mismatch","silent","allUserEntities","addMissingMember","removeClientFromUser","removedTeamUserIds","usersWithoutClients","getUserListFromBackend","teamMemberLeave","teamDomain","shouldWarnLegalHold","wasVerified","newDevices","updateMissingUsersClients","requestUserSendingPermission","event_mapper","EventMapper","verificationStateHandler","conversationsWithNewEvents","mapGuestStatusSelf","receiving_queue","initSubscriptions","stateHandler","ephemeralHandler","handleMessageExpiration","directlyConnectedUsers","visibleConversations","leaveCall","checkMessageTimer","getTimeOffset","deleteConversationLocally","onConversationEvent","mapConnection","onMissedEvents","setNotificationHandlingState","onUnblockUser","injectLegalHoldMessage","addEventUpdatedListener","updateLocalMessageEntity","addEventDeletedListener","deleteLocalMessageEntity","onConversationJoin","cleanupConversations","is_cleared","cleanupEphemeralMessages","createGroupConversation","userEntities","groupName","usersPayload","ConversationProtocol","creator_client","selfUserId","managed","teamid","accessRoleField","createMLSConversation","createProteusConversation","events","onCreate","last_event","last_event_time","toISOString","mlsConversationState","markAsEstablished","handleConversationCreateError","createGuestRoom","fetching_conversations","mapConversations","saveConversation","originalError","loadConversations","remoteConversationsPromise","getAllConversations","loadConversationStatesFromDb","saveConversationsInDb","conversationEntities","saveConversations","updateConversationStates","conversationsDataArray","handledConversationEntities","unknownConversations","localEntity","entity","handledConversationData","getPrecedingMessages","is_pending","firstMessageEntity","getOldestMessage","upperBound","getLatestTimestamp","loadPrecedingEvents","MESSAGES_FETCH_LIMIT","mappedMessageEntities","addPrecedingEventsToConversation","hasAdditionalMessages","addEventsToConversation","firstMessage","isMemberMessage","isCreation","groupCreationMessageIn1to1","isGroupCreation","one2oneConnectionMessageInGroup","isConnection","hasCreationMessage","addCreationMessage","allTeamMembersParticipate","teamMembers","teamMember","withAllTeamMembers","creationEvent","getMessagesWithOffset","messageDate","precedingMessages","followingMessages","loadFollowingEvents","getSubsequentMessages","getEventsForCategory","category","MessageCategory","loadEventsWithCategory","mapJsonEvents","updateMessagesUserEntities","searchInConversation","mappedMessages","getUnreadEvents","first_message","lower_bound","upper_bound","updateConversationsOnAppInit","updateUnarchivedConversations","updatePromises","updateArchivedConversations","updateConversations","archivedConversations","updateConversationFromBackend","mapOfUserIds","flatten","getUsersById","fetchUsersAndEvents","searchInLocalDB","localStateConversation","localDBConversation","loadConversation","getGroupsByName","queryString","compareTransliteration","display_name","nameString","conversationA","conversationB","getLatestEventTimestamp","increment","mostRecentConversation","getMostRecentConversation","getNextItem","getMostActiveConversations","getActiveConversationsFromDb","conversation_ids","matchingConversationEntity","isMessageRead","message_id","getMessageInConversationById","checkForDeletedConversations","mapConnections","connectionEntities","entities","_mapGuestStatusSelf","conversationTeamId","isConversationGuest","offline","updateGuests","sortUsersByPriority","addUsers","qualifiedUserIds","addUsersToMLSConversation","conversationMemberJoinEvent","addUsersToProteusConversation","handleAddToConversationError","sender","addService","providerId","serviceId","postBots","debug","handleUsersNotConnected","handleTooManyMembersError","getNumberOfParticipants","showLegalHoldConsentError","clearConversation","nextConversationEntity","updateClearedTimestamp","_clearConversation","removeMember","leaveGuestRoom","deleteMembers","removeMemberFromMLSConversation","removeUsersFromMLSConversation","removeMemberFromConversation","removeUserFromConversation","clearContent","isUserLeaving","removeService","deleteBots","hasResponse","updateConversationName","updateConversationMessageTimer","updateConversationReceiptMode","setNotificationState","notificationState","NOTIFICATION_STATE","getLastKnownTimestamp","updateMemberProperties","onMemberUpdate","mutedRef","mutedStatus","rejectError","archiveConversation","toggleArchiveConversation","unarchiveConversation","forceChange","trigger","sendTypingStart","sendTypingStop","newState","stateChange","is_archived","archiveTimestamp","sameTimestamp","updatePromise","shouldUnarchive","eventFromStreamMessage","deleteMessages","participants","openSpots","substitutions","number1","number2","replaceLinkLegalHold","injectFileTypeRestrictedMessage","isIncoming","fileExt","fileRestrictionMessage","EventSource","eventData","isSelfConversation","typesInSelfConversation","ClientEvent","onEventPromise","previouslyArchived","isPastMemberStatus","isMemberJoinType","isBackendTimestamp","updateTimestampServer","server_time","checkLegalHoldStatus","checkConversationParticipants","triggerFeatureEventHandlers","reactToConversationEvent","entityObject","handleConversationNotification","ignoredErrorTypes","senderId","user_ids","qualifiedSender","LegalHoldEvaluator","localConversationState","qualified_from","messageLegalHoldStatus","isoTimestamp","qualifiedConversation","qualifiedUser","onMemberLeave","onTyping","onRename","onAssetAdd","onGroupCreation","onMessageDeleted","onMessageHidden","on1to1Creation","onReaction","onReceiptModeChanged","onButtonActionConfirmation","edited_time","addEventToConversation","handlePromises","eventFromWebSocket","eventFromStream","sendConfirmationStatus","Confirmation","mapJsonEvent","otherUser","memberMessageType","addMessage","eventTimestamp","creatorId","creatorDomain","createdByParticipant","createdBySelfUser","isCreatedBySelf","creatorIsParticipant","updatedMessageEntity","getConnectionByConversationId","otherMember","otherId","isParticipatingUser","participatingUser","selfUserRejoins","updateConversationRoles","updateSequence","isEstablished","isMLSConversationEstablished","isFromSelf","removesSelfUser","selfLeavingClearedConversation","groupIdDecodedFromBase64","base64ToArray","wipeMLSConversation","clearExpirationTimeout","qualified_target","isBackendEvent","fromSelf","isRemoteFailure","isLocalCancel","reason","ProtobufAsset","updateTimestamps","getNewestMessage","allowsAllFiles","contentType","isAllowedFile","getFileExtensionOrName","firstAsset","isImage","eventId","deletedMessageEntity","addDeleteMessage","deleteMessageById","isContent","getUpdatedReactions","updateEventSequentially","prepareReactionNotification","buttonId","isComposite","getSelectionChange","fixWebsocketString","qualifiedUserId","oldUser","CONVERSATION_TYPING","initMessageEntity","newData","getMessage","updateMessageEvent","mappedEvents","updatedEvents","prepend","validatedMessages","prependMessages","addMessages","is_loaded","event_data","reaction","reactionMessageEntity","Message","SuperType","reactions","reactions_user_ets","removeAll","iso_date","deleteEvents","deleteEvent","expectReadReceipt","findConversationByGroupId","loadEphemeralEvents","sortedConversations","sortGroupsByLastEvent","selfProteusConversation","selfMLSConversation","unreadConversations","hasUnread","states_to_filter","inviterId","memberInviters","inviter","isNotService","isNotIncluded","getSelfConversations","includeMLS","baseConversations","proteusConversation","getSelfMLSConversation","mlsConversation","conv","isTeamDeleted","selfConversation","buildQualifiedId","build1to1Creation","buildAllVerified","buildAssetAdd","getNextIsoDate","buildCallingTimeoutEvent","buildDegraded","buildDelete","deleted_time","buildFileTypeRestricted","buildGroupCreation","allTeamMembers","buildIncomingMessageTooBig","messageError","errorCode","error_code","buildLegalHoldMessage","beforeMessage","buildMemberJoin","joiningUserIds","buildMemberLeave","removedBySelfUser","qualified_user_ids","buildMessageAdd","buildMissed","buildTeamMemberLeave","buildUnableToDecrypt","decryptionError","buildVoiceChannelActivate","protocolVersion","protocol_version","buildVoiceChannelDeactivate","duration","CallingTimeoutMessage","super_type","isNoOneJoined","AVS_REASON","isEveryOneLeft","CALL_MESSAGE_TYPE","CallMessage","call_message_type","finished_reason","isActivation","ACTIVATED","isDeactivation","DEACTIVATED","wasCompleted","DecryptErrorMessage","isRecoverable","isIdentityChanged","ProteusErrors","DeleteMessage","deleted_timestamp","FileAsset","Asset","file_size","preview_resource","upload_failed_reason","FileTypeRestrictedMessage","LegalHoldMessage","isActivationMessage","tweet","Location","latitude","longitude","zoom","MediumImage","correlation_id","resource","ratio","MessageTimerUpdateMessage","timeString","formatDuration","MissedMessage","affect_order","PingMessage","get_icon_classes","show_ping_animation","css_classes","ReceiptModeUpdateMessage","isReceiptEnabled","RenameMessage","VerificationMessage","verificationMessageType","messageUserId","isQualifiedId","fallbackDomain","reversedEvents","_mapJsonEvent","originalEntity","editedTime","quote","user_id","QuoteEntity","textAsset","_mapAssetText","_mapAsset","_mapAssetLinkPreviews","preview_id","preview_key","preview_domain","preview_otr_key","preview_sha256","preview_token","remoteDataPreview","selected_button_id","replacing_message_id","edited_timestamp","addMetadata","_mapEventMemberJoin","_mapEventMemberLeave","_mapEventReceiptModeUpdate","_mapEventMessageTimerUpdate","_mapEventRename","_mapEventAssetAdd","_mapEventCompositeMessageAdd","_mapEventDeleteEverywhere","_mapEventGroupCreation","_mapEventUnableToDecrypt","_mapEventPing","_mapEventCallingTimeout","_mapEventLegalHoldUpdate","_mapEventLocation","_mapEventMessageAdd","_mapEventMissedMessages","_mapEvent1to1Creation","_mapEventTeamMemberLeave","_mapEventVerification","_mapEventVoiceChannelActivate","_mapEventVoiceChannelDeactivate","_mapFileTypeRestricted","from_client_id","fromClientId","waiting_button_id","selectedButtonId","waitingButtonId","isReactable","has_service","hasService","MemberMessage","showServicesWarning","ContentMessage","isSingleModeConversation","messageFromCreator","creatorIndex","splice","CompositeMessage","items","item","assetInfo","_mapAssetImage","_mapAssetFile","content_length","otr_key","remoteData","_mapAssetLinkPreview","article_image","article_title","linkPreviewData","uploaded","LinkPreviewEntity","linkPreviews","base64","encodedLinkPreview","linkPreviewEntity","_mapAssetMentions","mentions","encodedMention","protoMention","Mention","MentionEntity","mentionEntity","allMentions","validate","mappedMentions","mappedLinkPreviews","read_receipts","expects_read_confirmation","readReceipts","EVERYTHING","MENTIONS_AND_REPLIES","NOTHING","getNotificationText","codeBlockRegex","linkify","Linkify","containsOnlyLink","textWithoutCode","raw","getFirstLinkWithOffset","links","firstLink","link","schema","CryptographyMapper","MAX_MENTIONS_PER_MESSAGE","mapGenericMessage","genericMessage","CryptographyError","_unwrapExternal","_mapGenericMessage","specificContent","GENERIC_MESSAGE_TYPE","_mapAvailability","_mapCalling","calling","_mapCleared","cleared","_mapConfirmation","confirmation","_mapDeleted","_mapEdited","edited","_mapEphemeral","_mapHidden","hidden","_mapImage","_mapKnock","knock","_mapLastRead","lastRead","_mapLocation","_mapReaction","_mapText","_mapComposite","composite","_mapButtonActionConfirmation","buttonActionConfirmation","_mapDataTransfer","dataTransfer","generic_message","senderClientId","protoMentions","referenceMessageId","original","preview","notUploaded","_mapAssetMetaData","audioData","audio","loudnessArray","normalizedLoudness","ArrayBuffer","durationInMillis","loudness","targetConversation","qualifiedConversationId","clearedTimestamp","firstMessageId","more_message_ids","moreMessageIds","mappedMessage","replacingMessageId","ephemeral","PROTO_MESSAGE_TYPE","embeddedMessage","externalMessageBuffer","GenericMessage","_mapImageMedium","lastReadTimestamp","trackingIdentifier","emoji","protoQuote","protoLinkPreviews","protoLinkPreview","mappedText","Quote","TIMESTAMP_TYPE","shouldPersistStateChanges","publishPersistState","firstUserEntity","availabilityOfUser","isManaged","isSameTeam","isSameDomain","isGuestRoom","isGuestAndServicesRoom","isServicesRoom","isTeamOnly","isTeam1to1","isGroupConversation","hasOneParticipant","hasDirectGuest","hasGuest","hasExternal","hasFederatedUsers","servicesCount","connectedUserId","extend","migratedMutedState","hasInitializedUsers","hasLegalHold","blockLegalHoldMessage","showNotificationsEverything","showNotificationsNothing","showNotificationsMentionsAndReplies","isActiveParticipant","isClearable","isLeavable","isMutable","RECEIPT_MODE","isSelfDeletingMessagesEnabled","getEnforcedSelfDeletingMessagesTimeout","hasGlobalMessageTimer","messages_unordered","message_a","message_b","lastDeliveredMessage","getLastDeliveredMessage","incomingMessages","messages_visible","trackArrayChanges","unreadState","allEvents","allMessages","calls","otherMessages","pings","selfMentions","selfReplies","isMissedCall","isCall","isSelfMentioned","isUserMentioned","isSelfQuoted","isUserQuoted","unreadMessages","unreadSelfMentions","unreadSelfReplies","isJustServices","joinedNames","_initSubscriptions","hasMappedUsers","property","persistState","persistChanges","release","removeMessages","entityTimestamp","forceUpdate","ARCHIVED","CLEARED","LAST_EVENT","LAST_READ","LAST_SERVER","MUTED","updatedTimestamp","_incrementTimeOnly","editedMessage","_findDuplicate","messageWithLinkPreview","isShowingLastReceivedMessage","message_ets","counter","message_et","_checkForDuplicate","messageIds","getFirstUnreadSelfMention","last_known_timestamp","sentMessages","lastMessageTimestamp","getNumberOfServices","countServices","adjustCountForSelf","adjustCountForServices","getNumberOfClients","accumulator","isNewerMessage","isCallActivation","wasSelfUserAdded","isMember","isMemberJoin","isUserAffected","existingMessageEntity","logData","additionalMessage","existingMessage","sameId","sameSender","timestamp_affects_order","getAllMessages","getPreviousMessage","message_index","getLastEditableMessage","isEditable","getTemporaryGuests","checkGuestExpiration","getUsersWithUnverifiedClients","supportsVideoCall","sftEnabled","global_message_timer","is_managed","ACCENT_COLOR","MANAGED_BY","SCIM","WIRE","TEMPORARY_GUEST","EXPIRATION_INTERVAL","EXPIRATION_THRESHOLD","LIFETIME","isSingleSignOn","providerName","joaatHash","managedBy","nameParts","rateLimit","method","isBlockedLegalHold","teamRole","TEAM_ROLE","client_et","_hasPendingLegalHold","owner","read","write","expirationIsUrgent","expirationRemainingText","expirationIntervalId","expirationTimeoutId","hasDomain","subscribeToChanges","new_client_et","client_a","client_b","hasActivatedIdentity","client_id","setGuestExpiration","_setRemainingExpirationTime","expirationInterval","expirationTime","remainingMinutes","ceil","timeValue","isDownloadable","isAudio","isFile","isVideo","isText","isLocation","canPlayType","isButton","errorButtonId","setButtonError","clearButtonError","formatTimeShort","was_edited","reactions_user_ids","isLikedProvisional","is_liked","reactionsUserEts","other_likes","like_caption","addAsset","asset_et","copyText","hasUser","shouldAdd","newReactions","isQuoteFromUser","isUserTargeted","getContentName","fileAsset","MAX_USERS_VISIBLE","MAX_WHOLE_TEAM_USERS_VISIBLE","REDUCED_USERS_COUNT","generateNameString","exceedsMaxVisibleUsers","hiddenUserCount","joinedUserEntities","visibleUsers","spliceCount","remoteUserEntities","senderName","getUserName","Declension","showNamedCreation","isConversationCreate","htmlCaption","replaceShowMore","showmore","dativeUsers","accusativeUsers","exceedsMaxTeam","guestCount","MemberLeaveReason","generateLegalHoldLeaveMessage","allUsers","htmlGroupCreationHeader","groupCreationString","skipAnd","declension","joinNames","isConnectionRequest","isConversationResume","isMemberChange","isMemberLeave","isTeamMemberLeave","isMemberRemoval","m1","m2","fromUnixTime","formatDateNumeral","messageTimerStarted","startingTimestamp","expirationTimestamp","ephemeral_caption","formatDurationCaption","isObfuscated","messageIsAtLeastSent","isEphemeralInactive","unsafeSenderName","headerSenderName","qualifiedFrom","hasAssetFile","hasAssetLocation","isDeletable","hasUnavailableAsset","isEdited","isLinkPreview","isSystem","isFileTypeRestricted","isDelete","isMissed","isCallTimeout","isUnableToDecrypt","isVerification","isCopyable","isEphemeral","includeFailedState","unavailableStatus","assetStatus","isReplyable","updateStatus","updated_status","isConversationRename","_createIFrameContainer","iFrameContainer","allowfullscreen","frameborder","video","formatString","_appendIFrame","iFrame","linkString","outerHTML","_getParameters","generateYouTubeEmbedUrl","MediaEmbeds","youtube","videoId","URLSearchParams","convertYouTubeTimestampToSeconds","_extractUnit","extracted","soundcloud","spotify","vimeo","linkSrc","linkPathName","isSingleTrack","slashesInLink","embed","group1","replaceSlashes","encodedParams","themeColor","vimeoColor","embedUrl","mediaParser","showEmbed","getLinksFromHtml","embeds","ENABLE_MEDIA_EMBEDS","settings","send","should_render_text","has_link_previews","selfId","renderMessage","renderMediaEmbeds","targetsUser","AUTH_ERROR_TYPE","AuthError","MESSAGE","COOKIES_DISABLED","INDEXED_DB_UNSUPPORTED","MULTIPLE_TABS","PRIVATE_MODE","GENERIC","BAD_GATEWAY","CLIENT_ERROR","NOT_CONNECTED","SERVER_ERROR","SERVICE_DISABLED","TOO_MANY_BOTS","UNKNOWN_CLIENT","INVALID_PARAMETER","MISSING_PARAMETER","CLIENT_ERROR_TYPE","CLIENT_NOT_SET","DATABASE_FAILURE","NO_CLIENT_ID","NO_USER_ID","NO_VALID_CLIENT","REQUEST_FAILURE","REQUEST_FORBIDDEN","CONVERSATION_ERROR_TYPE","DEGRADED_CONVERSATION_CANCELLATION","LEGAL_HOLD_CONVERSATION_CANCELLATION","MESSAGE_NOT_FOUND","NO_CHANGES","NO_CONVERSATION_ID","NO_MESSAGE_CHANGES","UNKNOWN_ACTIVITY","WRONG_CHANGE","WRONG_CONVERSATION","WRONG_TYPE","WRONG_USER","CRYPTOGRAPHY_ERROR_TYPE","BROKEN_EXTERNAL","IGNORED_ASSET","IGNORED_PREVIEW","NO_DATA_CONTENT","NO_GENERIC_MESSAGE","PREVIOUSLY_STORED","UNHANDLED_TYPE","STORAGE_ERROR_TYPE","StorageError","FAILED_TO_OPEN","INVALID_TIME","INVALID_TIMESTAMP","NON_SEQUENTIAL_UPDATE","NO_DATA","NO_SENDER_ID","NO_TIME","TEAM_ERROR_TYPE","TeamError","NO_PERMISSIONS","CALL","USER","EVENT_TYPE","EventValidation","EVENT_ERROR_TYPE","EventError","DEPRECATED_SCHEMA","NO_EVENT","NO_LAST_DATE","NO_LAST_ID","NO_NOTIFICATIONS","OUTDATED_E_CALL_EVENT","VALIDATION_FAILED","WEBSOCKET_DISCONNECT","E_CALL_EVENT_LIFETIME","IGNORED_ERRORS","NOTIFICATION_BATCHES","INITIAL","SUBSEQUENT","SOURCE","BACKEND_RESPONSE","INJECTED","STREAM","WEB_SOCKET","notificationService","ConnectionState","Warnings","notificationHandlingState","handleEvent","missedNotificationId","getMissedIdFromDb","saveMissedIdToDb","handling_state","notificationsHandled","notificationsTotal","eventProcessMiddlewares","setEventProcessMiddlewares","connectWebSocket","onNotificationStreamProgress","handleTimeDrift","disconnectWebSocket","onConnectionStateChanged","connectionState","updateConnectivitityStatus","handleIncomingEvent","onMissedNotifications","triggerMissedSystemEventMessageRendering","getServerTime","computeTimeOffset","errorResponse","getIsoDateFromEvent","defaultValue","eventDate","updateLastEventDate","saveLastEventDateToDb","distributeEvent","FEATURE_CONFIG","res","decryptedData","validationResult","eventTime","isFromNotificationStream","OUTDATED_TIMESTAMP","VALID","validateEvent","processEvent","ignoredCodes","EventName","cause","eventProcessMiddleware","EventTypeHandling","savedEvent","handleEventSaving","handleEventDistribution","mappedData","loadEvent","eventToReplace","hasLinkPreview","throwValidationError","handleEventReplacement","storedEvent","handleDuplicatedEvent","saveEvent","originalEvent","primaryKeyUpdate","isLinkPreviewEdit","commonUpdates","getCommonMessageUpdates","getUpdatesForLinkPreview","getUpdatesForEditMessage","identifiedUpdates","replaceEvent","handleAssetUpdate","handleLinkPreviewUpdate","newEventData","ASSET_PREVIEW","updatedData","fromOther","selfCancel","updateEventAsUploadFailed","originalData","categoryFromEvent","ephemeral_time","baseLogMessage","WebAppEventSource","NotificationSource","CONFIRM","STORE","ACCOUNT","TEAM_SETTINGS","INTERNAL","PRODUCTION","STAGING","WEBSITE","URL_PATH","DECRYPT_ERROR_1","DECRYPT_ERROR_2","MANAGE_SERVICES","MANAGE_TEAM","PASSWORD_RESET","PRIVACY_HOW","PRIVACY_WHY","SUPPORT_USERNAME","getTeamSettingsUrl","utmSource","teamSettingsUrl","getWebsiteUrl","pkCampaign","websiteUrl","getAccountPagesUrl","accountPagesUrl","getTermsOfUsePersonalUrl","getTermsOfUseTeamUrl","getManageServicesUrl","getManageTeamUrl","getCreateTeamUrl","websiteLanguage","isReadableMessage","isContentMessage","COOKIE_NAME","INTERVAL","isRunningInstance","instanceId","cookieValue","appInstanceId","killCurrentInstance","setHasOtherInstance","instanceIdRef","onNewInstance","poll","registerInstance","sameSite","serviceData","provider","tags","strings","cs","da","de","en","es","et","fi","fr","hr","hu","it","lt","nl","pl","pt","ro","ru","sk","sl","tr","uk","setAppLocale","queryParam","getParameter","currentBrowserLocale","storeValue","DEFAULT_LOCALE","setLocale","setDateLocale","getElementsByTagName","setAttribute","setStrings","endIndex","mentionIndex","mention","OVERLAPPING","MISSING_START_INDEX","MISSING_LENGTH","MISSING_USER_ID","INVALID_START_INDEX","INVALID_LENGTH","OUT_OF_BOUNDS","isUUID","INVALID_USER_ID","INVALID_START_CHAR","toJSON","toProto","_checkAsset","_checkLocation","_checkPing","_checkComposite","_checkText","eventReactions","categoryChecks","check","matchedCategory","quotedMessageId","quotedMessageSha256","INVALID_HASH","storageKey","storage","getStorage","initialState","storedState","established","pendingWelcome","parsedState","loadState","createVanilla","filterEstablishedConversations","isPendingWelcome","markAsPendingWelcome","sendExternalToPendingJoin","isAlreadyEstablished","sendExternalCommit","currentState","conversationsToJoin","pendingConversations","alreadyEstablishedConversations","useMLSConversationState","initMLSConversations","configureMLSCallbacks","authorize","groupIdBytes","groupIdFromConversationId","userAuthorize","mlsConversations","joinNewConversations","joinByExternalCommit","registerUninitializedConversations","selfClientId","uninitializedConversations","mls","registerConversation","PermissionState","MAX_DIRECTORY_RESULTS","MAX_SEARCH_RESULTS","searchService","term","excludedEmojis","emojis","EMOJI_RANGES","termSlug","computeTransliteration","matchWeight","weight","propertyWeight","result1","result2","excludedChars","nameSlug","nameIndex","transliterationIndex","indexWeight","tokenWeight","tokenIndex","maxResults","rawName","rawDomain","getContacts","documents","APIClientUnconfigured","ws","BackendEnvironment","ValueStoreActionType","secretKey","getRandomValues","hexKey","encryptionKey","saveEphemeralValue","sendMessage","getWorker","SAVE","serviceWorker","installing","waiting","active","messageChannel","MessageChannel","port1","onmessage","postMessage","port2","DexieDatabase","Dexie","dbName","upgrade","versionInstance","stores","transaction","conversation_events","prekeys","sessions","groupIds","SQLeetSchemata","SCHEMATA","SQLiteType","created","serialised","DatabaseTypes","providePermanentEngine","storeName","requestPersistentStorage","engine","IndexedDBEngine","initWithDb","provideTemporaryAndNonPersistentEngine","saveRandomEncryptionKey","getLatest","PERMANENT","ENCRYPTED","EFFEMERAL","MemoryEngine","Account","createStorageEngine","cryptoProtocolConfig","coreCrypoWasmFilePath","supportsMLS","keyingMaterialUpdateThreshold","MLS_CONFIG_KEYING_MATERIAL_UPDATE_THRESHOLD","proteus","supportsCoreCryptoProteus","systemCrypto","nbPrekeys","AUTH","ACCESS_TOKEN","EXPIRATION","TTL","VALUE","SHOW_LOGIN","EMOJI_USAGE_COUNT","INPUT","LOCALIZATION","SEARCH","SUGGESTED_SEARCH_ETS","ROOT_FONT_SIZE_KEY","OBJECT_STORE","AMPLIFY","CONVERSATIONS","CONVERSATION_EVENTS","EVENTS","GROUP_IDS","KEYS","LAST_KEY_MATERIAL_UPDATE_DATES","PENDING_PROPOSALS","PRE_KEYS","SESSIONS","toCollection","modify","database","eachKey","mapped","localClientPrimaryKey","each","isExpectedMetaPrimaryKey","isExpectedPrimaryKey","put","record","toArray","bulkPut","DEXIE_CRUD_EVENT","hasHookSupport","isTemporaryAndNonPersistent","_initCrudHooks","callListener","updatedObj","on","dbListeners","hook","UPDATING","modifications","DELETING","addUpdatedListener","addDeletedListener","clearStores","deleteStorePromises","purge","_dbSchema","deleteStore","oldRecord","deletedKey","notifyListeners","deleteDatabase","deleteAll","deleteStores","storeNames","deleteEventInConversation","deletedRecords","primaryKeys","readAllPrimaryKeys","and","deleteEventsByDate","readAll","getTables","tableNames","tableName","StoreEngineError","loadFromSimpleStorage","updateOrCreate","saveToSimpleStorage","terminate","newRecord","dbListener","numberOfUpdates","StorageRepository","CRYPTOGRAPHY_TABLES","AMPLIFY_STORE_NAME","getValue","saveValue","memberRoles","ROLE","teamFeatures","teamSize","teamUsers","supportsLegalHold","isFileSharingSendingEnabled","fileSharing","FeatureStatus","isFileSharingReceivingEnabled","classifiedDomains","domains","selfDeletingMessages","enforcedTimeoutSeconds","SelfDeletingTimeout","isSelfDeletingMessagesEnforced","isVideoCallingEnabled","isMLSEnabled","isProtocolToggleEnabledForUser","protocolToggleUsers","isConferenceCallingEnabled","conferenceCalling","isAppLockEnabled","appLock","isAppLockEnforced","enforceAppLock","appLockInactivityTimeoutSecs","inactivityTimeoutSecs","isGuestLinkEnabled","conversationGuestLinks","APP_OPEN","ENDED_CALL","ESTABLISHED_CALL","INITIATED_CALL","JOINED_CALL","RECEIVED_CALL","SCREEN_SHARE","CONTRIBUTED","E2EE","FAILED_MESSAGE_DECRYPTION","MAX_HANDLE_LENGTH","validateCharacter","character","isAlphaNumeric","isString","isValidDomain","TEAM_FEATURES","CREATE_CONVERSATION","DELETE_CONVERSATION","ADD_TEAM_MEMBER","REMOVE_TEAM_MEMBER","ADD_CONVERSATION_MEMBER","REMOVE_CONVERSATION_MEMBER","GET_BILLING","SET_BILLING","SET_TEAM_DATA","GET_MEMBER_PERMISSIONS","GET_TEAM_CONVERSATIONS","DELETE_TEAM","SET_MEMBER_PERMISSIONS","bitsCounter","PUBLIC_FEATURES","CHAT_WITH_SERVICES","CREATE_GROUP_CONVERSATION","CREATE_GUEST_ROOM","INVITE_TEAM_MEMBERS","SEARCH_UNCONNECTED_USERS","UPDATE_CONVERSATION_SETTINGS","UPDATE_GROUP_PARTICIPANTS","FEATURES","teamPermissionsForRole","OWNER","ADMIN","MEMBER","PARTNER","publicPermissionsForRole","RolesByPriority","INVALID","roleFromTeamPermissions","generatePermissionHelpers","boundRole","helpers","featureKey","featureValue","permission","expectedPermissions","connectRequests","isActivatedAccount","numberOfContacts","chunk","getDifference","array1","array2","el1","el2","currentItem","currentIndex","nextIndex","interpolate","newArray","scaleFactor","originalIndex","before","after","point","iterateIndex","iterateItem","randomElement","deArrayify","arrays","matching","notMatching","iconSize","MozOsxFontSmoothing","WebkitFontSmoothing","fontFamily","fontVariant","speak","clipboard","writeText","fallbackSource","selectedRange","getSelection","rangeCount","getRangeAt","body","appendChild","execCommand","removeChild","currentSelection","removeAllRanges","addRange","resolveObservables","child","parent","onUpdate","subscriptions","subscribable","subscribeProperties","UNICODE_RANGE_REGEXP","includesOnlyEmojis","isValidString","string","removeEmojis","removeWhitespace","APP_ENV","LOCALHOST","VIRTUAL_HOST","getElectronVersion","userAgent","electronVersion","backend","frontend","isLocalhost","hostname","isProduction","showWrapperVersion","showElectronVersion","ALLOWED_FILE_UPLOAD_EXTENSIONS","extension","hasAllowedExtension","allowedExtensions","imageFileExtensions","imageContentTypes","ALLOWED_IMAGE_TYPES","allowedImageType","ARROW_DOWN","ARROW_LEFT","ARROW_RIGHT","ARROW_UP","BACKSPACE","DELETE","ENTER","ESC","KEY_V","PAGE_DOWN","PAGE_UP","SPACE","TAB","isOneOfKeys","keyboardEvent","expectedKeys","eventKey","isArrowKey","isPageUpDownKey","isKey","expectedKey","isTabKey","isEscapeKey","isFunctionKey","isMetaKey","isPasteAction","isRemovalAction","insertAtCaret","areaId","textArea","scrollPos","scrollTop","strPos","selectionStart","selection","range","createRange","moveStart","front","back","ieRange","moveEnd","selectionEnd","escKeyHandlers","handleDebugKey","onEscKey","offEscKey","debugInfos","querySelectorAll","debugInfo","classList","dataset","uieUid","textContent","addDebugInfo","isStringOrNumber","toTest","replaceSubstituteEscaped","substitutes","replaceSubstitute","LocalizerUtil","ACCUSATIVE","boldNames","containsSelfUser","userNames","numberOfNames","joinByAnd","secondLastName","lastName","additionalNames","dangerousSubstitutions","skipEscape","localeValue","replaceDangerously","italic","substitutedEscaped","DATIVE","NOMINATIVE","newLocale","newStrings","LogFactory","namespace","separator","force","findMentionAtPosition","getMentionCandidate","currentMentions","textInSelection","wordBeforeSelection","isSpaceSelected","isSelectionStartMention","isSelectionEndMention","isOverMention","isOverValidMentionString","wordAfterSelection","detectMentionEdgeDeletion","textarea","lengthDifference","currentSelectionStart","updateMentionRanges","createMentionEntity","editedMention","mentionLength","capToByte","trunc","rootMeanSquare","floatArray","power","sqrt","roundLogarithmic","exactValue","factor","entity1","entity2","idsMatch","domainsMatch","escapeRegex","bypassSanitization","selfNameDeclensions","safeWindowOpen","prependProtocol","safeMailOpen","pureEmail","resetStoreValue","secondsToExpire","expires","constructUserPrimaryKey","includesString","custom","uric","alphabet","fromStart","querySlug","outputLength","wordBoundary","truncateIndex","reg","removeLineBreaks","replaceInRange","replacement","stringA","stringB","utf8ToUtf16BE","BOMChar","charCode","padStart","originalString","charArray","TextDecoder","decode","enUS","formatDateShort","formatDayMonth","formatDayMonthNumeral","durationUnits","singular","symbol","YEAR","WEEK","DAY","HOUR","MINUTE","SECOND","mapUnits","rounded","units","round","longUnit","firstNonZeroUnit","seconds","mappedUnits","hours","minutes","hasHours","validUnitStrings","zeroPadding","nextUnit","joiner","formatSeconds","divisorForMinutes","divisor_for_seconds","components","formatTimestamp","longFormat","isThisYear","getCurrentDate","isBeforeToday","isBefore","startOfToday","isYoungerThan2Minutes","differenceInMinutes","isYoungerThan1Hour","differenceInHours","isYoungerThan7Days","differenceInDays","fromNowLocale","formatDistanceToNow","addSuffix","isAxiosError","errorCandidate","isConversationEntity","appendParameter","locationSearch","searchParameters","decodedValue","cleanURL","html","anchorTags","ValidationUtilError","urlPath","isTweetUrl","uuid","policyId","markdownit","MarkdownIt","breaks","langPrefix","enable","originalFenceRule","renderer","rules","fence","idx","heading_open","heading_close","softbreak","hardbreak","paragraph_open","previousWithMap","repeat","paragraph_close","normalizeLinkText","mentionEntities","createMentionHash","btoa","renderMention","mentionData","elementClasses","elementAttributes","mentionText","mentionTexts","mentionlessText","mention1","mention2","strippedText","mentionKey","highlight","lang","hljs","link_open","cleanString","hashedString","mentionHash","attrGet","isEmail","isWireDeepLink","nextToken","closeToken","attrPush","markup","attrSet","encodeURI","renderToken","originalTokens","modifiedLinksTokens","fixCodeTokens","modifiedTokens","modifiedToken","originalToken","fixedTokens","parsedText","mentionMarkup","getRenderedTextContent","strippedMessage","utils","unescapeAll","isNonPersistentByUrl","isNonPersistentByServerConfig","checkIndexedDb","currentAttempt","interval_id","readyState","loadDataUrl","reader","FileReader","onload","readAsDataURL","object_url","Image","revokeObjectURL","readAsArrayBuffer","loadUrlBlob","xhrAccessorFunction","xhr","XMLHttpRequest","responseType","getResponseHeader","loadUrlBuffer","getFileExtension","filename","extensionMatch","trimFileExtension","formatBytes","decimals","kilobytes","pow","toFixed","getContentTypeFromDataUrl","dataUrl","Decoder","asBytes","Encoder","asString","anchor","objectURL","UUID","zerosNeeded","groupA","groupB","validateProfileImageResolution","parentId","focusableContent","focusedItemIndex","activeElement","generateConversationInputStorageKey","getSelectionPosition","defaultRange","Infinity","firstMention","lastMention","mentionStart","mentionEnd","newStart","newEnd","supportsSecretStorage","ENABLE_MLS","ENABLE_PROTEUS_CORE_CRYPTO","incomingCssClass","removeAnimationsClass","Worker","z","WebApp","util","WarningsContainer","onRefresh","useWarningsState","warnings","visibleWarning","warningDimmed","isConnectivityRecovery","hasOffset","isMiniMode","app","toggle","closeButton","closeWarning","REQUEST_CAMERA","DENIED_CAMERA","REQUEST_MICROPHONE","DENIED_MICROPHONE","REQUEST_SCREEN","DENIED_SCREEN","NOT_FOUND_CAMERA","NOT_FOUND_MICROPHONE","REQUEST_NOTIFICATION","UNSUPPORTED_INCOMING_CALL","UNSUPPORTED_OUTGOING_CALL","CONNECTIVITY_RECONNECT","CALL_QUALITY_POOR","CONNECTIVITY_RECOVERY","NO_INTERNET","LIFECYCLE_UPDATE","addWarning","removeWarning","setName","newName","getVisibleWarning","hideWarning","showWarning","isConnectivityWarning","visibleWarningIsLifecycleUpdate","warningToClose","DIMMED_MODES","MINI_MODES","module","InternalStateModule","createIteratorConstructor","createIterResultObject","hasOwn","objectKeys","toObject","OBJECT_ITERATOR","setInternalState","getInternalState","getterFor","IS_PURE","fails","WEBKIT","__defineSetter__","getBuiltIn","wellKnownSymbol","defineBuiltIn","Symbol","SymbolPrototype","valueOf","TO_PRIMITIVE","hint","arity","NATIVE_SYMBOL","keyFor","uncurryThis","isCallable","isSymbol","arraySlice","$stringify","numberToString","tester","low","hi","WRONG_SYMBOLS_CONVERSION","ILL_FORMED_UNICODE","stringifyWithSymbolsFix","replacer","$replacer","fixIllFormed","stat","forced","space","setToStringTag","sham","DESCRIPTORS","FORCED","aCallable","definePropertyModule","proto","__defineGetter__","P","getter","defineProperties","setter","FREEZING","onFreeze","$freeze","freeze","iterate","createProperty","iterable","AS_ENTRIES","toIndexedObject","nativeGetOwnPropertyDescriptor","FAILS_ON_PRIMITIVES","getOwnPropertyDescriptor","getOwnPropertySymbolsModule","$getOwnPropertySymbols","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","$isExtensible","isExtensible","classof","ARRAY_BUFFER_NON_EXTENSIBLE","$isFrozen","isFrozen","$isSealed","isSealed","nativeKeys","toPropertyKey","__lookupGetter__","desc","O","__lookupSetter__","$preventExtensions","preventExtensions","defineBuiltInAccessor","requireObjectCoercible","ObjectPrototype","PROTO","$seal","seal","isPrototypeOf","anObject","$toString","createPropertyDescriptor","nativeObjectCreate","getOwnPropertyNamesModule","getOwnPropertyNamesExternal","getOwnPropertyDescriptorModule","definePropertiesModule","propertyIsEnumerableModule","shared","sharedKey","hiddenKeys","uid","wrappedWellKnownSymbolModule","defineWellKnownSymbol","defineSymbolToPrimitive","$forEach","HIDDEN","SYMBOL","$Symbol","QObject","nativeDefineProperty","nativeGetOwnPropertyNames","nativePropertyIsEnumerable","AllSymbols","ObjectPrototypeSymbols","WellKnownSymbolsStore","USE_SETTER","findChild","setSymbolDescriptor","Attributes","ObjectPrototypeDescriptor","wrap","$defineProperty","$defineProperties","Properties","$propertyIsEnumerable","V","$getOwnPropertyDescriptor","$getOwnPropertyNames","names","IS_OBJECT_PROTOTYPE","unsafe","useSetter","useSimple","NATIVE_SYMBOL_REGISTRY","StringToSymbolRegistry","SymbolToStringRegistry","tryToString","sym","ObjectIterator","iterateEntries","iterateKeys","iterateValues","for","g","h","q","u","$$typeof","compose","o","__esModule","default","prefixColors","_setPrefixRegExps","_prefixRegExps","_prepareRegExpForPrefixSearch","regExp","_getNextPrefixColor","_getDecoratedPrefix","prefixColor","_prepareOutput","markdown","styles","_isPrefixAlreadyInUse","_getInstanceByPrefix","_normalizeOpts","_getInitialState","_decorateLoggerMethods","_instances","transports","_getEnableState","level","getGlobal","Function","eval","logdown","prevLogger","actionLogger","nextLogger","recursionLevel","groupCollapsed","groupEnd","formatProdErrorMessage","$$observable","observable","randomString","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","isPlainObject","reducer","preloadedState","enhancer","currentReducer","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","replaceReducer","nextReducer","outerSubscribe","observeState","reducerKeys","finalReducers","shapeAssertionError","finalReducerKeys","assertReducerShape","hasChanged","_key","previousStateForKey","nextStateForKey","bindActionCreator","_len","funcs","_dispatch","middlewareAPI","chain","middleware","webpackContext","req","webpackContextResolve","__webpack_require__"],"sourceRoot":""}