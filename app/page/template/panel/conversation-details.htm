<div id="conversation-details" class="panel__page panel__page--visible conversation-details" data-bind="with: $root.conversationDetails">
  <!-- ko if: isVisible() -->
    <div class="right-panel-header">
      <!-- ko if: !conversationEntity().is_request() && !conversationEntity().removed_from_conversation() -->
        <mute-icon class="right-panel-mute icon-button" data-bind="click: clickToToggleMute, css: {'right-panel-mute--active': conversationEntity().is_muted()} " data-uie-name="do-mute"></mute-icon>
      <!-- /ko -->
      <close-icon class="right-panel-close icon-button" data-bind="click: clickOnClose" data-uie-name="do-close"></close-icon>
    </div>
    <div class="right-panel-content">
      <div class="conversation-details__header">
        <!-- ko if: isNameEditable() -->

          <div class="conversation-details__name conversation-details__name--editable" data-bind="visible: !isEditingName(), click: clickToEditGroupName, l10n_tooltip: z.string.tooltipPeopleRename" data-uie-name="status-name">
            <div data-bind="text: conversationEntity().display_name()"></div>
            <edit-icon class="conversation-details__name__icon"></edit-icon>
          </div>
          <textarea class="conversation-details__name" data-bind="visible: isEditingName, value: conversationEntity().display_name(), enter: renameConversation, hasFocus: isEditingName, resize" maxlength="64" dir="auto" data-uie-name="enter-name"></textarea>
        <!-- /ko -->
        <!-- ko ifnot: isNameEditable() -->
          <div class="conversation-details__name" data-bind="text: conversationEntity().display_name()" data-uie-name="status-name"></div>
        <!-- /ko -->
        <!-- ko if: conversationEntity().is_group() -->
          <div class="conversation-details__participant_count">
            <!-- ko if: userParticipants().length -->
              <span class="conversation-details__participant_count__number" data-bind="text: userParticipants().length" data-uie-name="status-user-count"></span>
              <span class="conversation-details__participant_count__text" data-bind="l10n_text: participantsUserText"></span>
            <!-- /ko -->
            <!-- ko if: serviceParticipants().length -->
              <span class="conversation-details__participant_count__number" data-bind="text: serviceParticipants().length" data-uie-name="status-service-count"></span>
              <span class="conversation-details__participant_count__text" data-bind="l10n_text: participantsServiceText"></span>
            <!-- /ko -->
          </div>
        <!-- /ko -->
      </div>

      <!-- ko if: isActiveParticipant() -->
        <div class="conversation-details-top-actions">
          <!-- ko if: conversationEntity().is_group() -->
            <div class="panel__action-item" data-bind="click: clickOnAddParticipants, attr:{'title': addPeopleTooltip}" data-uie-name="go-add-people">
              <add-participants-icon class="panel__action-item__icon"></add-participants-icon>
              <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionAddParticipants"></div>
            </div>
          <!-- /ko -->

          <!-- ko if: conversationEntity().team_id -->
            <div class="panel__action-item conversation-details__guest-options" data-bind="click: clickOnGuestOptions" data-uie-name="go-guest-options">
              <guest-icon class="panel__action-item__icon"></guest-icon>
              <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionGuestOptions"></div>
              <div class="panel__action-item__status" data-bind="l10n_text: guestOptionsText" data-uie-name="status-allow-guests"></div>
              <disclose-icon></disclose-icon>
            </div>
          <!-- /ko -->
        </div>
      <!-- /ko -->

      <div class="conversation-details-participants">
        <!-- ko if: conversationEntity().is_group() -->
          <!-- ko if: userParticipants().length -->
            <div class="conversation-details__list-head" data-bind="text: z.string.conversationDetailsPeople"></div>
            <user-list params="user: userParticipants, click: clickOnShowParticipant" data-uie-name="list-users"></user-list>
          <!-- /ko -->

          <!-- ko if: serviceParticipants().length -->
            <div data-bind="text: z.string.conversationDetailsServices"></div>
            <service-list params="services: serviceParticipants, click: clickOnShowParticipant" data-uie-name="list-services"></service-list>
          <!-- /ko -->
        <!-- /ko -->
        <!-- ko if: conversationEntity().is_one2one() -->
          <participant-avatar params="participant: conversationEntity().firstUserEntity(), size: z.components.ParticipantAvatar.SIZE.X_LARGE"></participant-avatar>
        <!-- /ko -->
      </div>

      <div class="conversation-details-bottom-actions">
        <!-- ko if: conversationEntity().is_one2one() -->
          <div class="panel__action-item"  data-bind="click: clickOnCreateGroup" data-uie-name="go-create-group">
            <group-icon class="panel__action-item__icon"></group-icon>
            <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionCreateGroup"></div>
          </div>
        <!-- /ko -->
        <div class="panel__action-item"  data-bind="click: clickToArchive" data-uie-name="do-archive">
          <archive-icon class="panel__action-item__icon"></archive-icon>
          <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionArchive"></div>
        </div>
        <!-- ko if: conversationEntity().is_request() -->
          <div class="panel__action-item"  data-bind="click: clickToCancelRequest" data-uie-name="do-cancel-request">
            <close-icon class="panel__action-item__icon"></close-icon>
            <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionCancelRequest"></div>
          </div>
        <!-- /ko -->
        <!-- ko if: !conversationEntity().is_request() && !conversationEntity().is_cleared() -->
          <div class="panel__action-item"  data-bind="click: clickToClear" data-uie-name="do-clear">
            <delete-icon class="panel__action-item__icon"></delete-icon>
            <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionClear"></div>
          </div>
        <!-- /ko -->
        <!-- ko if: !conversationEntity().is_group() && (conversationEntity().firstUserEntity().is_connected() || conversationEntity().firstUserEntity().is_request()) -->
          <div class="panel__action-item"  data-bind="click: clickToBlock" data-uie-name="do-block">
            <block-icon class="panel__action-item__icon"></block-icon>
            <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionBlock"></div>
          </div>
        <!-- /ko -->
        <!-- ko if: conversationEntity().is_group() && !conversationEntity().removed_from_conversation() -->
          <div class="panel__action-item"  data-bind="click: clickToLeave" data-uie-name="do-leave">
            <leave-icon class="panel__action-item__icon"></leave-icon>
            <div class="panel__action-item__text" data-bind="l10n_text: z.string.conversationDetailsActionLeave"></div>
          </div>
        <!-- /ko -->
      </div>
    </div>
  <!-- /ko -->
</div>
